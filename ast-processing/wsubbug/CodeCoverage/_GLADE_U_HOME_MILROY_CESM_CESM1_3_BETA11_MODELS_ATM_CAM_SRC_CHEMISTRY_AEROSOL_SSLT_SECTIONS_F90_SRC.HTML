<html>
<head>
<title>Listing of sslt_sections.F90</title>
</head>
<body bgcolor="FFFFFF">
<h4>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sslt_sections.F90&#160;&#160;&#160;&#160;&#160;&#160;&#160;<font size=-1>coverage:&#160 100.00&#160;%func&#160;&#160;&#160;&#160; 100.00&#160;%block</font></h4>
<hr size=1 noshade>
<pre>
     1) <a name="l1" style="background-color: #ffffff">!===============================================================================</a>
     2) <a name="l2" style="background-color: #ffffff">! used to compute sea salt surface emissions for modal and sectional aerosol models</a>
     3) <a name="l3" style="background-color: #ffffff">!===============================================================================</a>
     4) <a name="l4" style="background-color: #ffffff">module sslt_sections</a>
     5) <a name="l5" style="background-color: #ffffff">  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</a>
     6) <a name="l6" style="background-color: #ffffff"></a>
     7) <a name="l7" style="background-color: #ffffff">  implicit none</a>
     8) <a name="l8" style="background-color: #ffffff"></a>
     9) <a name="l9" style="background-color: #ffffff">  private</a>
    10) <a name="l10" style="background-color: #ffffff"></a>
    11) <a name="l11" style="background-color: #ffffff">  public :: sslt_sections_init</a>
    12) <a name="l12" style="background-color: #ffffff">  public :: fluxes</a>
    13) <a name="l13" style="background-color: #ffffff">  public :: nsections</a>
    14) <a name="l14" style="background-color: #ffffff">  public :: Dg</a>
    15) <a name="l15" style="background-color: #ffffff">  public :: rdry</a>
    16) <a name="l16" style="background-color: #ffffff"></a>
    17) <a name="l17" style="background-color: #ffffff">  integer,parameter :: nsections = 31</a>
    18) <a name="l18" style="background-color: #ffffff"></a>
    19) <a name="l19" style="background-color: #ffffff">  ! only use up to ~20um</a>
    20) <a name="l20" style="background-color: #ffffff">  real(r8),parameter :: Dg(nsections) = (/  &amp;</a>
    21) <a name="l21" style="background-color: #ffffff">       0.0020e-5_r8, 0.0025e-5_r8, 0.0032e-5_r8,  &amp;</a>
    22) <a name="l22" style="background-color: #ffffff">       0.0040e-5_r8, 0.0051e-5_r8, 0.0065e-5_r8,  &amp;</a>
    23) <a name="l23" style="background-color: #ffffff">       0.0082e-5_r8, 0.0104e-5_r8, 0.0132e-5_r8,  &amp;</a>
    24) <a name="l24" style="background-color: #ffffff">       0.0167e-5_r8, 0.0211e-5_r8, 0.0267e-5_r8,  &amp;</a>
    25) <a name="l25" style="background-color: #ffffff">       0.0338e-5_r8, 0.0428e-5_r8, 0.0541e-5_r8,  &amp;</a>
    26) <a name="l26" style="background-color: #ffffff">       0.0685e-5_r8, 0.0867e-5_r8, 0.1098e-5_r8,  &amp;</a>
    27) <a name="l27" style="background-color: #ffffff">       0.1389e-5_r8, 0.1759e-5_r8, 0.2226e-5_r8,  &amp;</a>
    28) <a name="l28" style="background-color: #ffffff">       0.2818e-5_r8, 0.3571e-5_r8, 0.4526e-5_r8,  &amp;</a>
    29) <a name="l29" style="background-color: #ffffff">       0.5735e-5_r8, 0.7267e-5_r8, 0.9208e-5_r8,  &amp;</a>
    30) <a name="l30" style="background-color: #ffffff">       1.1668e-5_r8, 1.4786e-5_r8, 1.8736e-5_r8,  &amp;</a>
    31) <a name="l31" style="background-color: #ffffff">       2.3742e-5_r8 /)</a>
    32) <a name="l32" style="background-color: #ffffff"></a>
    33) <a name="l33" style="background-color: #ffffff">  real(r8), dimension(nsections) :: bm, rdry, rm</a>
    34) <a name="l34" style="background-color: #ffffff">  real(r8), dimension(4,nsections) :: consta, constb  !constants for calculating emission polynomial</a>
    35) <a name="l35" style="background-color: #ffffff"></a>
    36) <a name="l36" style="background-color: #ffffff">contains</a>
    37) <a name="l37" style="background-color: #ffffff">  </a>
    38) <a name="l38" style="background-color: #ffffff">  !===========================================================================</a>
    39) <a name="l39" style="background-color: #ffffff">  !===========================================================================</a>
    40) <a name="l40" style="background-color: #ffffff">  subroutine sslt_sections_init()</a>
    41) <a name="l41" style="background-color: #ffffff"></a>
    42) <a name="l42" style="background-color: #ffffff">    integer :: m</a>
    43) <a name="l43" style="background-color: #ffffff"></a>
    44) <a name="l44" style="background-color: #ffffff">    ! use Ekman's ss</a>
    45) <a name="l45" style="background-color: #ffffff">    rdry(:)=Dg(:)/2._r8   ! meter</a>
    46) <a name="l46" style="background-color: #ffffff">    ! multiply rm with 1.814 because it should be RH=80% and not dry particles</a>
    47) <a name="l47" style="background-color: #ffffff">    ! for the parameterization</a>
    48) <a name="l48" style="background-color: #ffffff">    rm(:)=1.814_r8*rdry(:)*1.e6_r8   ! um</a>
    49) <a name="l49" style="background-color: #ffffff">    bm(:)=(0.380_r8-log10(rm(:)))/0.65_r8  ! use in Manahan</a>
    50) <a name="l50" style="background-color: #ffffff"></a>
    51) <a name="l51" style="background-color: #ffffff">    ! calculate constants form emission polynomials</a>
    52) <a name="l52" style="background-color: #ffffff">    do m=1,nsections</a>
    53) <a name="l53" style="background-color: #ffffff">       if ((m).le.9)then</a>
    54) <a name="l54" style="background-color: #ffffff">          consta(1,m) = (-2.576_r8)*10._r8**35*Dg(m)**4+5.932_r8*10._r8**28  &amp;</a>
    55) <a name="l55" style="background-color: #ffffff">               * Dg(m)**3+(-2.867_r8)*10._r8**21*Dg(m)**2+(-3.003_r8)  &amp;</a>
    56) <a name="l56" style="background-color: #ffffff">               * 10._r8**13*Dg(m) + (-2.881_r8)*10._r8**6</a>
    57) <a name="l57" style="background-color: #ffffff">          constb(1,m) = 7.188_r8*10._r8**37  &amp;</a>
    58) <a name="l58" style="background-color: #ffffff">               * Dg(m)**4+(-1.616_r8)*10._r8**31*Dg(m)**3+6.791_r8*10._r8**23  &amp;</a>
    59) <a name="l59" style="background-color: #ffffff">               * Dg(m)**2+1.829_r8*10._r8**16*Dg(m)+7.609_r8*10._r8**8</a>
    60) <a name="l60" style="background-color: #ffffff">       elseif ((m).ge.10.and.(m).le.13)then</a>
    61) <a name="l61" style="background-color: #ffffff">          consta(2,m) = (-2.452_r8)*10._r8**33*Dg(m)**4+2.404_r8*10._r8**27  &amp;</a>
    62) <a name="l62" style="background-color: #ffffff">               * Dg(m)**3+(-8.148_r8)*10._r8**20*Dg(m)**2+(1.183_r8)*10._r8**14  &amp;</a>
    63) <a name="l63" style="background-color: #ffffff">               * Dg(m)+(-6.743_r8)*10._r8**6</a>
    64) <a name="l64" style="background-color: #ffffff">          constb(2,m) = 7.368_r8*10._r8**35  &amp;</a>
    65) <a name="l65" style="background-color: #ffffff">               * Dg(m)**4+(-7.310_r8)*10._r8**29*Dg(m)**3+ 2.528_r8*10._r8**23  &amp;</a>
    66) <a name="l66" style="background-color: #ffffff">               * Dg(m)**2+(-3.787_r8)*10._r8**16*Dg(m)+ 2.279_r8*10._r8**9</a>
    67) <a name="l67" style="background-color: #ffffff">       elseif ((m).ge.14.and.(m).lt.22)then</a>
    68) <a name="l68" style="background-color: #ffffff">          consta(3,m) = (1.085_r8)*10._r8**29*Dg(m)**4+(-9.841_r8)*10._r8**23  &amp;</a>
    69) <a name="l69" style="background-color: #ffffff">               * Dg(m)**3+(3.132_r8)*10._r8**18*Dg(m)**2+(-4.165_r8)*10._r8**12  &amp;</a>
    70) <a name="l70" style="background-color: #ffffff">               * Dg(m)+(2.181_r8)*10._r8**6</a>
    71) <a name="l71" style="background-color: #ffffff">          constb(3,m) = (-2.859_r8)*10._r8**31  &amp;</a>
    72) <a name="l72" style="background-color: #ffffff">               * Dg(m)**4+(2.601_r8)*10._r8**26*Dg(m)**3+(-8.297_r8)*10._r8**20  &amp;</a>
    73) <a name="l73" style="background-color: #ffffff">               * Dg(m)**2+(1.105_r8)*10._r8**15*Dg(m)+(-5.800_r8)*10._r8**8</a>
    74) <a name="l74" style="background-color: #ffffff">       elseif (m.ge.22.and.m.le.40)then</a>
    75) <a name="l75" style="background-color: #ffffff">          ! use monahan</a>
    76) <a name="l76" style="background-color: #ffffff">          consta(4,m) = (1.373_r8*rm(m)**(-3)*(1+0.057_r8*rm(m)**1.05_r8)  &amp;</a>
    77) <a name="l77" style="background-color: #ffffff">               * 10**(1.19_r8*exp(-bm(m)**2)))  &amp;</a>
    78) <a name="l78" style="background-color: #ffffff">               * (rm(m)-rm(m-1))</a>
    79) <a name="l79" style="background-color: #ffffff">       endif</a>
    80) <a name="l80" style="background-color: #ffffff">    enddo</a>
    81) <a name="l81" style="background-color: #ffffff">  end subroutine sslt_sections_init</a>
    82) <a name="l82" style="background-color: #ffffff"></a>
    83) <a name="l83" style="background-color: #ffffff">  !===========================================================================</a>
    84) <a name="l84" style="background-color: #ffffff">  !===========================================================================</a>
    85) <a name="l85" style="background-color: #ffffff">  function fluxes ( sst, u10cubed, ncol ) result(fi)</a>
    86) <a name="l86" style="background-color: #ffffff"></a>
    87) <a name="l87" style="background-color: #ffffff">    real (r8),intent(in) :: sst(:)</a>
    88) <a name="l88" style="background-color: #ffffff">    real (r8),intent(in) :: u10cubed(:)</a>
    89) <a name="l89" style="background-color: #ffffff">    integer  ,intent(in) :: ncol</a>
    90) <a name="l90" style="background-color: #ffffff"></a>
    91) <a name="l91" style="background-color: #ffffff">    real (r8) :: fi(ncol,nsections)</a>
    92) <a name="l92" style="background-color: #ffffff"></a>
    93) <a name="l93" style="background-color: #ffffff">    integer :: m</a>
    94) <a name="l94" style="background-color: #ffffff">    real (r8) :: W(ncol)</a>
    95) <a name="l95" style="background-color: #ffffff"></a>
    96) <a name="l96" style="background-color: #ffffff">    ! Calculations of source strength and size distribution</a>
    97) <a name="l97" style="background-color: #ffffff">    ! NB the 0.1 is the dlogDp we have to multiplie with to get the flux, but the value dependence</a>
    98) <a name="l98" style="background-color: #ffffff">    ! of course on what dlogDp you have. You will also have to change the sections of Dg if you use</a>
    99) <a name="l99" style="background-color: #ffffff">    ! a different number of size bins with different intervals.</a>
   100) <a name="l100" style="background-color: #ffffff"></a>
   101) <a name="l101" style="background-color: #ffffff">    W(:ncol)=3.84e-6_r8*u10cubed(:ncol)*0.1_r8 ! whitecap area</a>
   102) <a name="l102" style="background-color: #ffffff"></a>
   103) <a name="l103" style="background-color: #ffffff">    ! calculate number flux fi (#/m2/s)</a>
   104) <a name="l104" style="background-color: #ffffff">    fi(:,:)=0._r8</a>
   105) <a name="l105" style="background-color: #ffffff">    do m=1,nsections</a>
   106) <a name="l106" style="background-color: #ffffff">       if (m.le.9)then</a>
   107) <a name="l107" style="background-color: #ffffff">          fi(:ncol,m)=W(:ncol)*((sst(:ncol))*consta(1,m)+constb(1,m))</a>
   108) <a name="l108" style="background-color: #ffffff">       elseif (m.ge.10.and.m.le.13)then</a>
   109) <a name="l109" style="background-color: #ffffff">          fi(:ncol,m)=W(:ncol)*((sst(:ncol))*consta(2,m)+constb(2,m))</a>
   110) <a name="l110" style="background-color: #ffffff">       elseif (m.ge.14.and.m.lt.22)then</a>
   111) <a name="l111" style="background-color: #ffffff">          fi(:ncol,m)=W(:ncol)*((sst(:ncol))*consta(3,m)+constb(3,m))</a>
   112) <a name="l112" style="background-color: #ffffff">       elseif (m.ge.22.and.m.le.40)then</a>
   113) <a name="l113" style="background-color: #ffffff">          ! use Monahan</a>
   114) <a name="l114" style="background-color: #ffffff">          fi(:ncol,m)=consta(4,m)*u10cubed(:ncol)</a>
   115) <a name="l115" style="background-color: #ffffff">       endif</a>
   116) <a name="l116" style="background-color: #ffffff">    enddo</a>
   117) <a name="l117" style="background-color: #ffffff"></a>
   118) <a name="l118" style="background-color: #ffffff">  end function fluxes</a>
   119) <a name="l119" style="background-color: #ffffff"></a>
   120) <a name="l120" style="background-color: #ffffff">end module sslt_sections</a>
</pre>
<hr size=1 noshade>
<table border=0 cellpadding=3 cellspacing=0 width="100%" style="color:black;font-weight:normal;font-family:Verdana,Arial;font-size:xx-small">
<td width="50%">
<table border=0 cellpadding=3 cellspacing=0>
<tr>
<td>
<a target="_new" href="http://www.intel.com"><img src="__IntelR.gif" border="0"></a>
</td>
<td style="font-size:xx-small">
<i>generated by </i><BR><a target="_new" href="http://www.intel.com/software/products/compilers">Intel(R) C++/Fortran Compiler code-coverage tool</a>
</td>
</tr>
</table>
</td>
<td>
<table border=0 cellpadding=3 cellspacing=0 width="50%">
<tr><a>Web-Page Owner: <a href="mailto:nobody">Nobody</a></tr>
</table>
</td>
</table>
</body>
</html>
