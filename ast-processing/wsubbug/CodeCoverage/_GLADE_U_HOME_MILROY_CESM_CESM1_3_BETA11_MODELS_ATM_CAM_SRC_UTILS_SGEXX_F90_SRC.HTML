<html>
<head>
<title>Listing of sgexx.F90</title>
</head>
<body bgcolor="FFFFFF">
<h4>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sgexx.F90&#160;&#160;&#160;&#160;&#160;&#160;&#160;<font size=-1>coverage:&#160  0.00&#160;%func&#160;&#160;&#160;&#160;  0.00&#160;%block</font></h4>
<hr size=1 noshade>
<pre>
     1) <a name="l1" style="background-color: #ffffff">module sgexx</a>
     2) <a name="l2" style="background-color: #ffffff"></a>
     3) <a name="l3" style="background-color: #ffffff">! A few LINPACK/LAPACK and supporting BLAS routines</a>
     4) <a name="l4" style="background-color: #ffffff"></a>
     5) <a name="l5" style="background-color: #ffffff">! The routines have all been converted to use the shr_kind_r8 type which</a>
     6) <a name="l6" style="background-color: #ffffff">! is set to double precision.  The LINPACK naming convention isn't </a>
     7) <a name="l7" style="background-color: #ffffff">! followed by the 's' routines (which should contain 'd's).</a>
     8) <a name="l8" style="background-color: #ffffff"></a>
     9) <a name="l9" style="background-color: #ffffff">use shr_kind_mod,    only: r8 =&gt; shr_kind_r8</a>
    10) <a name="l10" style="background-color: #ffffff">use cam_logfile,     only: iulog</a>
    11) <a name="l11" style="background-color: #ffffff">use abortutils,      only: endrun</a>
    12) <a name="l12" style="background-color: #ffffff"></a>
    13) <a name="l13" style="background-color: #ffffff">implicit none</a>
    14) <a name="l14" style="background-color: #ffffff"></a>
    15) <a name="l15" style="background-color: #ffffff">public :: &amp;</a>
    16) <a name="l16" style="background-color: #ffffff">   dgeco,  &amp;</a>
    17) <a name="l17" style="background-color: #ffffff">   dgedi,  &amp;</a>
    18) <a name="l18" style="background-color: #ffffff">   sgefa,  &amp;</a>
    19) <a name="l19" style="background-color: #ffffff">   sdot,   &amp;</a>
    20) <a name="l20" style="background-color: #ffffff">   isamax, &amp;</a>
    21) <a name="l21" style="background-color: #ffffff">   sasum,  &amp;</a>
    22) <a name="l22" style="background-color: #ffffff">   saxpy,  &amp;</a>
    23) <a name="l23" style="background-color: #ffffff">   sscal,  &amp;</a>
    24) <a name="l24" style="background-color: #ffffff">   sswap,  &amp;</a>
    25) <a name="l25" style="background-color: #ffffff">   sgeev,  &amp;</a>
    26) <a name="l26" style="background-color: #ffffff">   sgebak, &amp;</a>
    27) <a name="l27" style="background-color: #ffffff">   sgebal, &amp;</a>
    28) <a name="l28" style="background-color: #ffffff">   sgehd2, &amp;</a>
    29) <a name="l29" style="background-color: #ffffff">   sgehrd, &amp;</a>
    30) <a name="l30" style="background-color: #ffffff">   shseqr, &amp;</a>
    31) <a name="l31" style="background-color: #ffffff">   slabad, &amp;</a>
    32) <a name="l32" style="background-color: #ffffff">   slacpy, &amp;</a>
    33) <a name="l33" style="background-color: #ffffff">   sladiv, &amp;</a>
    34) <a name="l34" style="background-color: #ffffff">   slahqr, &amp;</a>
    35) <a name="l35" style="background-color: #ffffff">   slahrd, &amp;</a>
    36) <a name="l36" style="background-color: #ffffff">   slaln2, &amp;</a>
    37) <a name="l37" style="background-color: #ffffff">   slange, &amp;</a>
    38) <a name="l38" style="background-color: #ffffff">   slanhs, &amp;</a>
    39) <a name="l39" style="background-color: #ffffff">   slanv2, &amp;</a>
    40) <a name="l40" style="background-color: #ffffff">   slapy2, &amp;</a>
    41) <a name="l41" style="background-color: #ffffff">   slarf,  &amp;</a>
    42) <a name="l42" style="background-color: #ffffff">   slarfb, &amp;</a>
    43) <a name="l43" style="background-color: #ffffff">   slarfg, &amp;</a>
    44) <a name="l44" style="background-color: #ffffff">   slarft, &amp;</a>
    45) <a name="l45" style="background-color: #ffffff">   slarfx, &amp;</a>
    46) <a name="l46" style="background-color: #ffffff">   slartg, &amp;</a>
    47) <a name="l47" style="background-color: #ffffff">   slascl, &amp;</a>
    48) <a name="l48" style="background-color: #ffffff">   slaset, &amp;</a>
    49) <a name="l49" style="background-color: #ffffff">   slassq, &amp;</a>
    50) <a name="l50" style="background-color: #ffffff">   sorg2r, &amp;</a>
    51) <a name="l51" style="background-color: #ffffff">   sorghr, &amp;</a>
    52) <a name="l52" style="background-color: #ffffff">   sorgqr, &amp;</a>
    53) <a name="l53" style="background-color: #ffffff">   strevc, &amp;</a>
    54) <a name="l54" style="background-color: #ffffff">   ilaenv, &amp;</a>
    55) <a name="l55" style="background-color: #ffffff">   lsame,  &amp;</a>
    56) <a name="l56" style="background-color: #ffffff">   slamch, &amp;</a>
    57) <a name="l57" style="background-color: #ffffff">   slamc1, &amp;</a>
    58) <a name="l58" style="background-color: #ffffff">   slamc2, &amp;</a>
    59) <a name="l59" style="background-color: #ffffff">   slamc3, &amp;</a>
    60) <a name="l60" style="background-color: #ffffff">   slamc4, &amp;</a>
    61) <a name="l61" style="background-color: #ffffff">   slamc5, &amp;</a>
    62) <a name="l62" style="background-color: #ffffff">   xerbla, &amp;</a>
    63) <a name="l63" style="background-color: #ffffff">   scopy,  &amp;</a>
    64) <a name="l64" style="background-color: #ffffff">   sger,   &amp;</a>
    65) <a name="l65" style="background-color: #ffffff">   snrm2,  &amp;</a>
    66) <a name="l66" style="background-color: #ffffff">   srot,   &amp;</a>
    67) <a name="l67" style="background-color: #ffffff">   sgemm,  &amp;</a>
    68) <a name="l68" style="background-color: #ffffff">   sgemv,  &amp;</a>
    69) <a name="l69" style="background-color: #ffffff">   strmm,  &amp;</a>
    70) <a name="l70" style="background-color: #ffffff">   strmv</a>
    71) <a name="l71" style="background-color: #ffffff"></a>
    72) <a name="l72" style="background-color: #ffffff">!-----------------------------------------------------------------------</a>
    73) <a name="l73" style="background-color: #ffffff">contains</a>
    74) <a name="l74" style="background-color: #ffffff">!-----------------------------------------------------------------------</a>
    75) <a name="l75" style="background-color: #ffffff"></a>
    76) <a name="l76" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">DGECO (A,LDA,N,IPVT,RCOND,Z)</a>
    77) <a name="l77" style="background-color: #ffcccc">!</a>
    78) <a name="l78" style="background-color: #ffcccc"></a>
    79) <a name="l79" style="background-color: #ffcccc">      INTEGER LDA,N,IPVT(N)</a>
    80) <a name="l80" style="background-color: #ffcccc">      REAL(r8) A(LDA,*),Z(*)</a>
    81) <a name="l81" style="background-color: #ffcccc">      REAL(r8) RCOND</a>
    82) <a name="l82" style="background-color: #ffcccc">!</a>
    83) <a name="l83" style="background-color: #ffcccc">!     SGECO FACTORS A REAL MATRIX BY GAUSSIAN ELIMINATION</a>
    84) <a name="l84" style="background-color: #ffcccc">!     AND ESTIMATES THE CONDITION OF THE MATRIX.</a>
    85) <a name="l85" style="background-color: #ffcccc">!</a>
    86) <a name="l86" style="background-color: #ffcccc">!     IF  RCOND  IS NOT NEEDED, SGEFA IS SLIGHTLY FASTER.</a>
    87) <a name="l87" style="background-color: #ffcccc">!     TO SOLVE  A*X = B , FOLLOW SGECO BY SGESL.</a>
    88) <a name="l88" style="background-color: #ffcccc">!     TO COMPUTE  INVERSE(A)*C , FOLLOW SGECO BY SGESL.</a>
    89) <a name="l89" style="background-color: #ffcccc">!     TO COMPUTE  DETERMINANT(A) , FOLLOW SGECO BY SGEDI.</a>
    90) <a name="l90" style="background-color: #ffcccc">!     TO COMPUTE  INVERSE(A) , FOLLOW SGECO BY SGEDI.</a>
    91) <a name="l91" style="background-color: #ffcccc">!</a>
    92) <a name="l92" style="background-color: #ffcccc">!     ON ENTRY</a>
    93) <a name="l93" style="background-color: #ffcccc">!</a>
    94) <a name="l94" style="background-color: #ffcccc">!        A       REAL(LDA, N)</a>
    95) <a name="l95" style="background-color: #ffcccc">!                THE MATRIX TO BE FACTORED.</a>
    96) <a name="l96" style="background-color: #ffcccc">!</a>
    97) <a name="l97" style="background-color: #ffcccc">!        LDA     INTEGER</a>
    98) <a name="l98" style="background-color: #ffcccc">!                THE LEADING DIMENSION OF THE ARRAY  A .</a>
    99) <a name="l99" style="background-color: #ffcccc">!</a>
   100) <a name="l100" style="background-color: #ffcccc">!        N       INTEGER</a>
   101) <a name="l101" style="background-color: #ffcccc">!                THE ORDER OF THE MATRIX  A .</a>
   102) <a name="l102" style="background-color: #ffcccc">!</a>
   103) <a name="l103" style="background-color: #ffcccc">!     ON RETURN</a>
   104) <a name="l104" style="background-color: #ffcccc">!</a>
   105) <a name="l105" style="background-color: #ffcccc">!        A       AN UPPER TRIANGULAR MATRIX AND THE MULTIPLIERS</a>
   106) <a name="l106" style="background-color: #ffcccc">!                WHICH WERE USED TO OBTAIN IT.</a>
   107) <a name="l107" style="background-color: #ffcccc">!                THE FACTORIZATION CAN BE WRITTEN  A = L*U  WHERE</a>
   108) <a name="l108" style="background-color: #ffcccc">!                L  IS A PRODUCT OF PERMUTATION AND UNIT LOWER</a>
   109) <a name="l109" style="background-color: #ffcccc">!                TRIANGULAR MATRICES AND  U  IS UPPER TRIANGULAR.</a>
   110) <a name="l110" style="background-color: #ffcccc">!</a>
   111) <a name="l111" style="background-color: #ffcccc">!        IPVT    INTEGER(N)</a>
   112) <a name="l112" style="background-color: #ffcccc">!                AN INTEGER VECTOR OF PIVOT INDICES.</a>
   113) <a name="l113" style="background-color: #ffcccc">!</a>
   114) <a name="l114" style="background-color: #ffcccc">!        RCOND   REAL</a>
   115) <a name="l115" style="background-color: #ffcccc">!                AN ESTIMATE OF THE RECIPROCAL CONDITION OF  A .</a>
   116) <a name="l116" style="background-color: #ffcccc">!                FOR THE SYSTEM  A*X = B , RELATIVE PERTURBATIONS</a>
   117) <a name="l117" style="background-color: #ffcccc">!                IN  A  AND  B  OF SIZE  EPSILON  MAY CAUSE</a>
   118) <a name="l118" style="background-color: #ffcccc">!                RELATIVE PERTURBATIONS IN  X  OF SIZE  EPSILON/RCOND .</a>
   119) <a name="l119" style="background-color: #ffcccc">!                IF  RCOND  IS SO SMALL THAT THE LOGICAL EXPRESSION</a>
   120) <a name="l120" style="background-color: #ffcccc">!                           1.0 + RCOND .EQ. 1.0</a>
   121) <a name="l121" style="background-color: #ffcccc">!                IS TRUE, THEN  A  MAY BE SINGULAR TO WORKING</a>
   122) <a name="l122" style="background-color: #ffcccc">!                PRECISION.  IN PARTICULAR,  RCOND  IS ZERO  IF</a>
   123) <a name="l123" style="background-color: #ffcccc">!                EXACT SINGULARITY IS DETECTED OR THE ESTIMATE</a>
   124) <a name="l124" style="background-color: #ffcccc">!                UNDERFLOWS.</a>
   125) <a name="l125" style="background-color: #ffcccc">!</a>
   126) <a name="l126" style="background-color: #ffcccc">!        Z       REAL(N)</a>
   127) <a name="l127" style="background-color: #ffcccc">!                A WORK VECTOR WHOSE CONTENTS ARE USUALLY UNIMPORTANT.</a>
   128) <a name="l128" style="background-color: #ffcccc">!                IF  A  IS CLOSE TO A SINGULAR MATRIX, THEN  Z  IS</a>
   129) <a name="l129" style="background-color: #ffcccc">!                AN APPROXIMATE NULL VECTOR IN THE SENSE THAT</a>
   130) <a name="l130" style="background-color: #ffcccc">!                NORM(A*Z) = RCOND*NORM(A)*NORM(Z) .</a>
   131) <a name="l131" style="background-color: #ffcccc">!</a>
   132) <a name="l132" style="background-color: #ffcccc">!     LINPACK. THIS VERSION DATED 08/14/78 .</a>
   133) <a name="l133" style="background-color: #ffcccc">!     CLEVE MOLER, UNIVERSITY OF NEW MEXICO, ARGONNE NATIONAL LAB.</a>
   134) <a name="l134" style="background-color: #ffcccc">!</a>
   135) <a name="l135" style="background-color: #ffcccc">!     SUBROUTINES AND FUNCTIONS</a>
   136) <a name="l136" style="background-color: #ffcccc">!</a>
   137) <a name="l137" style="background-color: #ffcccc">!     LINPACK SGEFA</a>
   138) <a name="l138" style="background-color: #ffcccc">!     BLAS SAXPY,SDOT,SSCAL,SASUM</a>
   139) <a name="l139" style="background-color: #ffcccc">!     FORTRAN ABS,MAX,SIGN</a>
   140) <a name="l140" style="background-color: #ffcccc">!</a>
   141) <a name="l141" style="background-color: #ffcccc">!     INTERNAL VARIABLES</a>
   142) <a name="l142" style="background-color: #ffcccc">!</a>
   143) <a name="l143" style="background-color: #ffcccc">      REAL(r8) EK,T,WK,WKM</a>
   144) <a name="l144" style="background-color: #ffcccc">      REAL(r8) ANORM,S,SM,YNORM</a>
   145) <a name="l145" style="background-color: #ffcccc">      INTEGER INFO,J,K,KB,KP1,L</a>
   146) <a name="l146" style="background-color: #ffcccc">!</a>
   147) <a name="l147" style="background-color: #ffcccc">!</a>
   148) <a name="l148" style="background-color: #ffcccc">!</a>
   149) <a name="l149" style="background-color: #ffcccc">!     COMPUTE 1-NORM OF A</a>
   150) <a name="l150" style="background-color: #ffcccc">!</a>
   151) <a name="l151" style="background-color: #ffcccc">      ANORM = 0.0E0_r8</a>
   152) <a name="l152" style="background-color: #ffcccc">      DO 10 J = 1, N</a>
   153) <a name="l153" style="background-color: #ffcccc">         ANORM = MAX(ANORM,SASUM(N,A(1,J),1))</a>
   154) <a name="l154" style="background-color: #ffcccc">   10 CONTINUE</a>
   155) <a name="l155" style="background-color: #ffcccc">!</a>
   156) <a name="l156" style="background-color: #ffcccc">!     FACTOR</a>
   157) <a name="l157" style="background-color: #ffcccc">!</a>
   158) <a name="l158" style="background-color: #ffcccc">      CALL SGEFA(A,LDA,N,IPVT,INFO)</a>
   159) <a name="l159" style="background-color: #ffcccc">!</a>
   160) <a name="l160" style="background-color: #ffcccc">!     RCOND = 1/(NORM(A)*(ESTIMATE OF NORM(INVERSE(A)))) .</a>
   161) <a name="l161" style="background-color: #ffcccc">!     ESTIMATE = NORM(Z)/NORM(Y) WHERE  A*Z = Y  AND  TRANS(A)*Y = E .</a>
   162) <a name="l162" style="background-color: #ffcccc">!     TRANS(A)  IS THE TRANSPOSE OF A .  THE COMPONENTS OF  E  ARE</a>
   163) <a name="l163" style="background-color: #ffcccc">!     CHOSEN TO CAUSE MAXIMUM LOCAL GROWTH IN THE ELEMENTS OF W  WHERE</a>
   164) <a name="l164" style="background-color: #ffcccc">!     TRANS(U)*W = E .  THE VECTORS ARE FREQUENTLY RESCALED TO AVOID</a>
   165) <a name="l165" style="background-color: #ffcccc">!     OVERFLOW.</a>
   166) <a name="l166" style="background-color: #ffcccc">!</a>
   167) <a name="l167" style="background-color: #ffcccc">!     SOLVE TRANS(U)*W = E</a>
   168) <a name="l168" style="background-color: #ffcccc">!</a>
   169) <a name="l169" style="background-color: #ffcccc">      EK = 1.0E0_r8</a>
   170) <a name="l170" style="background-color: #ffcccc">      DO 20 J = 1, N</a>
   171) <a name="l171" style="background-color: #ffcccc">         Z(J) = 0.0E0_r8</a>
   172) <a name="l172" style="background-color: #ffcccc">   20 CONTINUE</a>
   173) <a name="l173" style="background-color: #ffcccc">      DO 100 K = 1, N</a>
   174) <a name="l174" style="background-color: #ffcccc">         IF (Z(K) .NE. 0.0E0_r8) EK = SIGN(EK,-Z(K))</a>
   175) <a name="l175" style="background-color: #ffcccc">         IF (ABS(EK-Z(K)) .LE. ABS(A(K,K))) GO TO 30</a>
   176) <a name="l176" style="background-color: #ffcccc">            S = ABS(A(K,K))/ABS(EK-Z(K))</a>
   177) <a name="l177" style="background-color: #ffcccc">            CALL SSCAL(N,S,Z,1)</a>
   178) <a name="l178" style="background-color: #ffcccc">            EK = S*EK</a>
   179) <a name="l179" style="background-color: #ffcccc">   30    CONTINUE</a>
   180) <a name="l180" style="background-color: #ffcccc">         WK = EK - Z(K)</a>
   181) <a name="l181" style="background-color: #ffcccc">         WKM = -EK - Z(K)</a>
   182) <a name="l182" style="background-color: #ffcccc">         S = ABS(WK)</a>
   183) <a name="l183" style="background-color: #ffcccc">         SM = ABS(WKM)</a>
   184) <a name="l184" style="background-color: #ffcccc">         IF (A(K,K) .EQ. 0.0E0_r8) GO TO 40</a>
   185) <a name="l185" style="background-color: #ffcccc">            WK = WK/A(K,K)</a>
   186) <a name="l186" style="background-color: #ffcccc">            WKM = WKM/A(K,K)</a>
   187) <a name="l187" style="background-color: #ffcccc">         GO TO 50</a>
   188) <a name="l188" style="background-color: #ffcccc">   40    CONTINUE</a>
   189) <a name="l189" style="background-color: #ffcccc">            WK = 1.0E0_r8</a>
   190) <a name="l190" style="background-color: #ffcccc">            WKM = 1.0E0_r8</a>
   191) <a name="l191" style="background-color: #ffcccc">   50    CONTINUE</a>
   192) <a name="l192" style="background-color: #ffcccc">         KP1 = K + 1</a>
   193) <a name="l193" style="background-color: #ffcccc">         IF (KP1 .GT. N) GO TO 90</a>
   194) <a name="l194" style="background-color: #ffcccc">            DO 60 J = KP1, N</a>
   195) <a name="l195" style="background-color: #ffcccc">               SM = SM + ABS(Z(J)+WKM*A(K,J))</a>
   196) <a name="l196" style="background-color: #ffcccc">               Z(J) = Z(J) + WK*A(K,J)</a>
   197) <a name="l197" style="background-color: #ffcccc">               S = S + ABS(Z(J))</a>
   198) <a name="l198" style="background-color: #ffcccc">   60       CONTINUE</a>
   199) <a name="l199" style="background-color: #ffcccc">            IF (S .GE. SM) GO TO 80</a>
   200) <a name="l200" style="background-color: #ffcccc">               T = WKM - WK</a>
   201) <a name="l201" style="background-color: #ffcccc">               WK = WKM</a>
   202) <a name="l202" style="background-color: #ffcccc">               DO 70 J = KP1, N</a>
   203) <a name="l203" style="background-color: #ffcccc">                  Z(J) = Z(J) + T*A(K,J)</a>
   204) <a name="l204" style="background-color: #ffcccc">   70          CONTINUE</a>
   205) <a name="l205" style="background-color: #ffcccc">   80       CONTINUE</a>
   206) <a name="l206" style="background-color: #ffcccc">   90    CONTINUE</a>
   207) <a name="l207" style="background-color: #ffcccc">         Z(K) = WK</a>
   208) <a name="l208" style="background-color: #ffcccc">  100 CONTINUE</a>
   209) <a name="l209" style="background-color: #ffcccc">      S = 1.0E0_r8/SASUM(N,Z,1)</a>
   210) <a name="l210" style="background-color: #ffcccc">      CALL SSCAL(N,S,Z,1)</a>
   211) <a name="l211" style="background-color: #ffcccc">!</a>
   212) <a name="l212" style="background-color: #ffcccc">!     SOLVE TRANS(L)*Y = W</a>
   213) <a name="l213" style="background-color: #ffcccc">!</a>
   214) <a name="l214" style="background-color: #ffcccc">      DO 120 KB = 1, N</a>
   215) <a name="l215" style="background-color: #ffcccc">         K = N + 1 - KB</a>
   216) <a name="l216" style="background-color: #ffcccc">         IF (K .LT. N) Z(K) = Z(K) + SDOT(N-K,A(K+1,K),1,Z(K+1),1)</a>
   217) <a name="l217" style="background-color: #ffcccc">         IF (ABS(Z(K)) .LE. 1.0E0_r8) GO TO 110</a>
   218) <a name="l218" style="background-color: #ffcccc">            S = 1.0E0_r8/ABS(Z(K))</a>
   219) <a name="l219" style="background-color: #ffcccc">            CALL SSCAL(N,S,Z,1)</a>
   220) <a name="l220" style="background-color: #ffcccc">  110    CONTINUE</a>
   221) <a name="l221" style="background-color: #ffcccc">         L = IPVT(K)</a>
   222) <a name="l222" style="background-color: #ffcccc">         T = Z(L)</a>
   223) <a name="l223" style="background-color: #ffcccc">         Z(L) = Z(K)</a>
   224) <a name="l224" style="background-color: #ffcccc">         Z(K) = T</a>
   225) <a name="l225" style="background-color: #ffcccc">  120 CONTINUE</a>
   226) <a name="l226" style="background-color: #ffcccc">      S = 1.0E0_r8/SASUM(N,Z,1)</a>
   227) <a name="l227" style="background-color: #ffcccc">      CALL SSCAL(N,S,Z,1)</a>
   228) <a name="l228" style="background-color: #ffcccc">!</a>
   229) <a name="l229" style="background-color: #ffcccc">      YNORM = 1.0E0_r8</a>
   230) <a name="l230" style="background-color: #ffcccc">!</a>
   231) <a name="l231" style="background-color: #ffcccc">!     SOLVE L*V = Y</a>
   232) <a name="l232" style="background-color: #ffcccc">!</a>
   233) <a name="l233" style="background-color: #ffcccc">      DO 140 K = 1, N</a>
   234) <a name="l234" style="background-color: #ffcccc">         L = IPVT(K)</a>
   235) <a name="l235" style="background-color: #ffcccc">         T = Z(L)</a>
   236) <a name="l236" style="background-color: #ffcccc">         Z(L) = Z(K)</a>
   237) <a name="l237" style="background-color: #ffcccc">         Z(K) = T</a>
   238) <a name="l238" style="background-color: #ffcccc">         IF (K .LT. N) CALL SAXPY(N-K,T,A(K+1,K),1,Z(K+1),1)</a>
   239) <a name="l239" style="background-color: #ffcccc">         IF (ABS(Z(K)) .LE. 1.0E0_r8) GO TO 130</a>
   240) <a name="l240" style="background-color: #ffcccc">            S = 1.0E0_r8/ABS(Z(K))</a>
   241) <a name="l241" style="background-color: #ffcccc">            CALL SSCAL(N,S,Z,1)</a>
   242) <a name="l242" style="background-color: #ffcccc">            YNORM = S*YNORM</a>
   243) <a name="l243" style="background-color: #ffcccc">  130    CONTINUE</a>
   244) <a name="l244" style="background-color: #ffcccc">  140 CONTINUE</a>
   245) <a name="l245" style="background-color: #ffcccc">      S = 1.0E0_r8/SASUM(N,Z,1)</a>
   246) <a name="l246" style="background-color: #ffcccc">      CALL SSCAL(N,S,Z,1)</a>
   247) <a name="l247" style="background-color: #ffcccc">      YNORM = S*YNORM</a>
   248) <a name="l248" style="background-color: #ffcccc">!</a>
   249) <a name="l249" style="background-color: #ffcccc">!     SOLVE  U*Z = V</a>
   250) <a name="l250" style="background-color: #ffcccc">!</a>
   251) <a name="l251" style="background-color: #ffcccc">      DO 160 KB = 1, N</a>
   252) <a name="l252" style="background-color: #ffcccc">         K = N + 1 - KB</a>
   253) <a name="l253" style="background-color: #ffcccc">         IF (ABS(Z(K)) .LE. ABS(A(K,K))) GO TO 150</a>
   254) <a name="l254" style="background-color: #ffcccc">            S = ABS(A(K,K))/ABS(Z(K))</a>
   255) <a name="l255" style="background-color: #ffcccc">            CALL SSCAL(N,S,Z,1)</a>
   256) <a name="l256" style="background-color: #ffcccc">            YNORM = S*YNORM</a>
   257) <a name="l257" style="background-color: #ffcccc">  150    CONTINUE</a>
   258) <a name="l258" style="background-color: #ffcccc">         IF (A(K,K) .NE. 0.0E0_r8) Z(K) = Z(K)/A(K,K)</a>
   259) <a name="l259" style="background-color: #ffcccc">         IF (A(K,K) .EQ. 0.0E0_r8) Z(K) = 1.0E0_r8</a>
   260) <a name="l260" style="background-color: #ffcccc">         T = -Z(K)</a>
   261) <a name="l261" style="background-color: #ffcccc">         CALL SAXPY(K-1,T,A(1,K),1,Z(1),1)</a>
   262) <a name="l262" style="background-color: #ffcccc">  160 CONTINUE</a>
   263) <a name="l263" style="background-color: #ffcccc">!     MAKE ZNORM = 1.0</a>
   264) <a name="l264" style="background-color: #ffcccc">      S = 1.0E0_r8/SASUM(N,Z,1)</a>
   265) <a name="l265" style="background-color: #ffcccc">      CALL SSCAL(N,S,Z,1)</a>
   266) <a name="l266" style="background-color: #ffcccc">      YNORM = S*YNORM</a>
   267) <a name="l267" style="background-color: #ffcccc">!</a>
   268) <a name="l268" style="background-color: #ffcccc">      IF (ANORM .NE. 0.0E0_r8) RCOND = YNORM/ANORM</a>
   269) <a name="l269" style="background-color: #ffcccc">      IF (ANORM .EQ. 0.0E0_r8) RCOND = 0.0E0_r8</a>
   270) <a name="l270" style="background-color: #ffcccc">      RETURN</a>
   271) <a name="l271" style="background-color: #ffcccc">      END SUBROUTINE DGECO</a>
   272) <a name="l272" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
   273) <a name="l273" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
   274) <a name="l274" style="background-color: #ffffff"></a>
   275) <a name="l275" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">DGEDI (A,LDA,N,IPVT,DET,WORK,JOB)</a>
   276) <a name="l276" style="background-color: #ffcccc"></a>
   277) <a name="l277" style="background-color: #ffcccc">      INTEGER LDA,N,IPVT(N),JOB</a>
   278) <a name="l278" style="background-color: #ffcccc">      REAL(r8) A(LDA,*),DET(2),WORK(*)</a>
   279) <a name="l279" style="background-color: #ffcccc">!</a>
   280) <a name="l280" style="background-color: #ffcccc">!     SGEDI COMPUTES THE DETERMINANT AND INVERSE OF A MATRIX</a>
   281) <a name="l281" style="background-color: #ffcccc">!     USING THE FACTORS COMPUTED BY SGECO OR SGEFA.</a>
   282) <a name="l282" style="background-color: #ffcccc">!</a>
   283) <a name="l283" style="background-color: #ffcccc">!     ON ENTRY</a>
   284) <a name="l284" style="background-color: #ffcccc">!</a>
   285) <a name="l285" style="background-color: #ffcccc">!        A       REAL(LDA, N)</a>
   286) <a name="l286" style="background-color: #ffcccc">!                THE OUTPUT FROM SGECO OR SGEFA.</a>
   287) <a name="l287" style="background-color: #ffcccc">!</a>
   288) <a name="l288" style="background-color: #ffcccc">!        LDA     INTEGER</a>
   289) <a name="l289" style="background-color: #ffcccc">!                THE LEADING DIMENSION OF THE ARRAY  A .</a>
   290) <a name="l290" style="background-color: #ffcccc">!</a>
   291) <a name="l291" style="background-color: #ffcccc">!        N       INTEGER</a>
   292) <a name="l292" style="background-color: #ffcccc">!                THE ORDER OF THE MATRIX  A .</a>
   293) <a name="l293" style="background-color: #ffcccc">!</a>
   294) <a name="l294" style="background-color: #ffcccc">!        IPVT    INTEGER(N)</a>
   295) <a name="l295" style="background-color: #ffcccc">!                THE PIVOT VECTOR FROM SGECO OR SGEFA.</a>
   296) <a name="l296" style="background-color: #ffcccc">!</a>
   297) <a name="l297" style="background-color: #ffcccc">!        WORK    REAL(N)</a>
   298) <a name="l298" style="background-color: #ffcccc">!                WORK VECTOR.  CONTENTS DESTROYED.</a>
   299) <a name="l299" style="background-color: #ffcccc">!</a>
   300) <a name="l300" style="background-color: #ffcccc">!        JOB     INTEGER</a>
   301) <a name="l301" style="background-color: #ffcccc">!                = 11   BOTH DETERMINANT AND INVERSE.</a>
   302) <a name="l302" style="background-color: #ffcccc">!                = 01   INVERSE ONLY.</a>
   303) <a name="l303" style="background-color: #ffcccc">!                = 10   DETERMINANT ONLY.</a>
   304) <a name="l304" style="background-color: #ffcccc">!</a>
   305) <a name="l305" style="background-color: #ffcccc">!     ON RETURN</a>
   306) <a name="l306" style="background-color: #ffcccc">!</a>
   307) <a name="l307" style="background-color: #ffcccc">!        A       INVERSE OF ORIGINAL MATRIX IF REQUESTED.</a>
   308) <a name="l308" style="background-color: #ffcccc">!                OTHERWISE UNCHANGED.</a>
   309) <a name="l309" style="background-color: #ffcccc">!</a>
   310) <a name="l310" style="background-color: #ffcccc">!        DET     REAL(2)</a>
   311) <a name="l311" style="background-color: #ffcccc">!                DETERMINANT OF ORIGINAL MATRIX IF REQUESTED.</a>
   312) <a name="l312" style="background-color: #ffcccc">!                OTHERWISE NOT REFERENCED.</a>
   313) <a name="l313" style="background-color: #ffcccc">!                DETERMINANT = DET(1) * 10.0**DET(2)</a>
   314) <a name="l314" style="background-color: #ffcccc">!                WITH  1.0 .LE. ABS(DET(1)) .LT. 10.0</a>
   315) <a name="l315" style="background-color: #ffcccc">!                OR  DET(1) .EQ. 0.0 .</a>
   316) <a name="l316" style="background-color: #ffcccc">!</a>
   317) <a name="l317" style="background-color: #ffcccc">!     ERROR CONDITION</a>
   318) <a name="l318" style="background-color: #ffcccc">!</a>
   319) <a name="l319" style="background-color: #ffcccc">!        A DIVISION BY ZERO WILL OCCUR IF THE INPUT FACTOR CONTAINS</a>
   320) <a name="l320" style="background-color: #ffcccc">!        A ZERO ON THE DIAGONAL AND THE INVERSE IS REQUESTED.</a>
   321) <a name="l321" style="background-color: #ffcccc">!        IT WILL NOT OCCUR IF THE SUBROUTINES ARE CALLED CORRECTLY</a>
   322) <a name="l322" style="background-color: #ffcccc">!        AND IF SGECO HAS SET RCOND .GT. 0.0 OR SGEFA HAS SET</a>
   323) <a name="l323" style="background-color: #ffcccc">!        INFO .EQ. 0 .</a>
   324) <a name="l324" style="background-color: #ffcccc">!</a>
   325) <a name="l325" style="background-color: #ffcccc">!     LINPACK. THIS VERSION DATED 08/14/78 .</a>
   326) <a name="l326" style="background-color: #ffcccc">!     CLEVE MOLER, UNIVERSITY OF NEW MEXICO, ARGONNE NATIONAL LAB.</a>
   327) <a name="l327" style="background-color: #ffcccc">!</a>
   328) <a name="l328" style="background-color: #ffcccc">!     SUBROUTINES AND FUNCTIONS</a>
   329) <a name="l329" style="background-color: #ffcccc">!</a>
   330) <a name="l330" style="background-color: #ffcccc">!     BLAS SAXPY,SSCAL,SSWAP</a>
   331) <a name="l331" style="background-color: #ffcccc">!     FORTRAN ABS,MOD</a>
   332) <a name="l332" style="background-color: #ffcccc">!</a>
   333) <a name="l333" style="background-color: #ffcccc">!     INTERNAL VARIABLES</a>
   334) <a name="l334" style="background-color: #ffcccc">!</a>
   335) <a name="l335" style="background-color: #ffcccc">      REAL(r8) T</a>
   336) <a name="l336" style="background-color: #ffcccc">      REAL(r8) TEN</a>
   337) <a name="l337" style="background-color: #ffcccc">      INTEGER I,J,K,KB,KP1,L,NM1</a>
   338) <a name="l338" style="background-color: #ffcccc">!</a>
   339) <a name="l339" style="background-color: #ffcccc">!</a>
   340) <a name="l340" style="background-color: #ffcccc">!</a>
   341) <a name="l341" style="background-color: #ffcccc">!     COMPUTE DETERMINANT</a>
   342) <a name="l342" style="background-color: #ffcccc">!</a>
   343) <a name="l343" style="background-color: #ffcccc">      IF (JOB/10 .EQ. 0) GO TO 70</a>
   344) <a name="l344" style="background-color: #ffcccc">         DET(1) = 1.0E0_r8</a>
   345) <a name="l345" style="background-color: #ffcccc">         DET(2) = 0.0E0_r8</a>
   346) <a name="l346" style="background-color: #ffcccc">         TEN = 10.0E0_r8</a>
   347) <a name="l347" style="background-color: #ffcccc">         DO 50 I = 1, N</a>
   348) <a name="l348" style="background-color: #ffcccc">            IF (IPVT(I) .NE. I) DET(1) = -DET(1)</a>
   349) <a name="l349" style="background-color: #ffcccc">            DET(1) = A(I,I)*DET(1)</a>
   350) <a name="l350" style="background-color: #ffcccc">!        ...EXIT</a>
   351) <a name="l351" style="background-color: #ffcccc">            IF (DET(1) .EQ. 0.0E0_r8) GO TO 60</a>
   352) <a name="l352" style="background-color: #ffcccc">   10       IF (ABS(DET(1)) .GE. 1.0E0_r8) GO TO 20</a>
   353) <a name="l353" style="background-color: #ffcccc">               DET(1) = TEN*DET(1)</a>
   354) <a name="l354" style="background-color: #ffcccc">               DET(2) = DET(2) - 1.0E0_r8</a>
   355) <a name="l355" style="background-color: #ffcccc">            GO TO 10</a>
   356) <a name="l356" style="background-color: #ffcccc">   20       CONTINUE</a>
   357) <a name="l357" style="background-color: #ffcccc">   30       IF (ABS(DET(1)) .LT. TEN) GO TO 40</a>
   358) <a name="l358" style="background-color: #ffcccc">               DET(1) = DET(1)/TEN</a>
   359) <a name="l359" style="background-color: #ffcccc">               DET(2) = DET(2) + 1.0E0_r8</a>
   360) <a name="l360" style="background-color: #ffcccc">            GO TO 30</a>
   361) <a name="l361" style="background-color: #ffcccc">   40       CONTINUE</a>
   362) <a name="l362" style="background-color: #ffcccc">   50    CONTINUE</a>
   363) <a name="l363" style="background-color: #ffcccc">   60    CONTINUE</a>
   364) <a name="l364" style="background-color: #ffcccc">   70 CONTINUE</a>
   365) <a name="l365" style="background-color: #ffcccc">!</a>
   366) <a name="l366" style="background-color: #ffcccc">!     COMPUTE INVERSE(U)</a>
   367) <a name="l367" style="background-color: #ffcccc">!</a>
   368) <a name="l368" style="background-color: #ffcccc">      IF (MOD(JOB,10) .EQ. 0) GO TO 150</a>
   369) <a name="l369" style="background-color: #ffcccc">         DO 100 K = 1, N</a>
   370) <a name="l370" style="background-color: #ffcccc">            A(K,K) = 1.0E0_r8/A(K,K)</a>
   371) <a name="l371" style="background-color: #ffcccc">            T = -A(K,K)</a>
   372) <a name="l372" style="background-color: #ffcccc">            CALL SSCAL(K-1,T,A(1,K),1)</a>
   373) <a name="l373" style="background-color: #ffcccc">            KP1 = K + 1</a>
   374) <a name="l374" style="background-color: #ffcccc">            IF (N .LT. KP1) GO TO 90</a>
   375) <a name="l375" style="background-color: #ffcccc">            DO 80 J = KP1, N</a>
   376) <a name="l376" style="background-color: #ffcccc">               T = A(K,J)</a>
   377) <a name="l377" style="background-color: #ffcccc">               A(K,J) = 0.0E0_r8</a>
   378) <a name="l378" style="background-color: #ffcccc">               CALL SAXPY(K,T,A(1,K),1,A(1,J),1)</a>
   379) <a name="l379" style="background-color: #ffcccc">   80       CONTINUE</a>
   380) <a name="l380" style="background-color: #ffcccc">   90       CONTINUE</a>
   381) <a name="l381" style="background-color: #ffcccc">  100    CONTINUE</a>
   382) <a name="l382" style="background-color: #ffcccc">!</a>
   383) <a name="l383" style="background-color: #ffcccc">!        FORM INVERSE(U)*INVERSE(L)</a>
   384) <a name="l384" style="background-color: #ffcccc">!</a>
   385) <a name="l385" style="background-color: #ffcccc">         NM1 = N - 1</a>
   386) <a name="l386" style="background-color: #ffcccc">         IF (NM1 .LT. 1) GO TO 140</a>
   387) <a name="l387" style="background-color: #ffcccc">         DO 130 KB = 1, NM1</a>
   388) <a name="l388" style="background-color: #ffcccc">            K = N - KB</a>
   389) <a name="l389" style="background-color: #ffcccc">            KP1 = K + 1</a>
   390) <a name="l390" style="background-color: #ffcccc">            DO 110 I = KP1, N</a>
   391) <a name="l391" style="background-color: #ffcccc">               WORK(I) = A(I,K)</a>
   392) <a name="l392" style="background-color: #ffcccc">               A(I,K) = 0.0E0_r8</a>
   393) <a name="l393" style="background-color: #ffcccc">  110       CONTINUE</a>
   394) <a name="l394" style="background-color: #ffcccc">            DO 120 J = KP1, N</a>
   395) <a name="l395" style="background-color: #ffcccc">               T = WORK(J)</a>
   396) <a name="l396" style="background-color: #ffcccc">               CALL SAXPY(N,T,A(1,J),1,A(1,K),1)</a>
   397) <a name="l397" style="background-color: #ffcccc">  120       CONTINUE</a>
   398) <a name="l398" style="background-color: #ffcccc">            L = IPVT(K)</a>
   399) <a name="l399" style="background-color: #ffcccc">            IF (L .NE. K) CALL SSWAP(N,A(1,K),1,A(1,L),1)</a>
   400) <a name="l400" style="background-color: #ffcccc">  130    CONTINUE</a>
   401) <a name="l401" style="background-color: #ffcccc">  140    CONTINUE</a>
   402) <a name="l402" style="background-color: #ffcccc">  150 CONTINUE</a>
   403) <a name="l403" style="background-color: #ffcccc">      RETURN</a>
   404) <a name="l404" style="background-color: #ffcccc">      END SUBROUTINE DGEDI</a>
   405) <a name="l405" style="background-color: #ffffff"></a>
   406) <a name="l406" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
   407) <a name="l407" style="background-color: #ffffff"></a>
   408) <a name="l408" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SGEFA (A,LDA,N,IPVT,INFO)</a>
   409) <a name="l409" style="background-color: #ffcccc"></a>
   410) <a name="l410" style="background-color: #ffcccc">      INTEGER LDA,N,IPVT(N),INFO</a>
   411) <a name="l411" style="background-color: #ffcccc">      REAL(r8) A(LDA,*)</a>
   412) <a name="l412" style="background-color: #ffcccc">!</a>
   413) <a name="l413" style="background-color: #ffcccc">!     SGEFA FACTORS A REAL MATRIX BY GAUSSIAN ELIMINATION.</a>
   414) <a name="l414" style="background-color: #ffcccc">!</a>
   415) <a name="l415" style="background-color: #ffcccc">!     SGEFA IS USUALLY CALLED BY SGECO, BUT IT CAN BE CALLED</a>
   416) <a name="l416" style="background-color: #ffcccc">!     DIRECTLY WITH A SAVING IN TIME IF  RCOND  IS NOT NEEDED.</a>
   417) <a name="l417" style="background-color: #ffcccc">!     (TIME FOR SGECO) = (1 + 9/N)*(TIME FOR SGEFA) .</a>
   418) <a name="l418" style="background-color: #ffcccc">!</a>
   419) <a name="l419" style="background-color: #ffcccc">!     ON ENTRY</a>
   420) <a name="l420" style="background-color: #ffcccc">!</a>
   421) <a name="l421" style="background-color: #ffcccc">!        A       REAL(LDA, N)</a>
   422) <a name="l422" style="background-color: #ffcccc">!                THE MATRIX TO BE FACTORED.</a>
   423) <a name="l423" style="background-color: #ffcccc">!</a>
   424) <a name="l424" style="background-color: #ffcccc">!        LDA     INTEGER</a>
   425) <a name="l425" style="background-color: #ffcccc">!                THE LEADING DIMENSION OF THE ARRAY  A .</a>
   426) <a name="l426" style="background-color: #ffcccc">!</a>
   427) <a name="l427" style="background-color: #ffcccc">!        N       INTEGER</a>
   428) <a name="l428" style="background-color: #ffcccc">!                THE ORDER OF THE MATRIX  A .</a>
   429) <a name="l429" style="background-color: #ffcccc">!</a>
   430) <a name="l430" style="background-color: #ffcccc">!     ON RETURN</a>
   431) <a name="l431" style="background-color: #ffcccc">!</a>
   432) <a name="l432" style="background-color: #ffcccc">!        A       AN UPPER TRIANGULAR MATRIX AND THE MULTIPLIERS</a>
   433) <a name="l433" style="background-color: #ffcccc">!                WHICH WERE USED TO OBTAIN IT.</a>
   434) <a name="l434" style="background-color: #ffcccc">!                THE FACTORIZATION CAN BE WRITTEN  A = L*U  WHERE</a>
   435) <a name="l435" style="background-color: #ffcccc">!                L  IS A PRODUCT OF PERMUTATION AND UNIT LOWER</a>
   436) <a name="l436" style="background-color: #ffcccc">!                TRIANGULAR MATRICES AND  U  IS UPPER TRIANGULAR.</a>
   437) <a name="l437" style="background-color: #ffcccc">!</a>
   438) <a name="l438" style="background-color: #ffcccc">!        IPVT    INTEGER(N)</a>
   439) <a name="l439" style="background-color: #ffcccc">!                AN INTEGER VECTOR OF PIVOT INDICES.</a>
   440) <a name="l440" style="background-color: #ffcccc">!</a>
   441) <a name="l441" style="background-color: #ffcccc">!        INFO    INTEGER</a>
   442) <a name="l442" style="background-color: #ffcccc">!                = 0  NORMAL VALUE.</a>
   443) <a name="l443" style="background-color: #ffcccc">!                = K  IF  U(K,K) .EQ. 0.0 .  THIS IS NOT AN ERROR</a>
   444) <a name="l444" style="background-color: #ffcccc">!                     CONDITION FOR THIS SUBROUTINE, BUT IT DOES</a>
   445) <a name="l445" style="background-color: #ffcccc">!                     INDICATE THAT SGESL OR SGEDI WILL DIVIDE BY ZERO</a>
   446) <a name="l446" style="background-color: #ffcccc">!                     IF CALLED.  USE  RCOND  IN SGECO FOR A RELIABLE</a>
   447) <a name="l447" style="background-color: #ffcccc">!                     INDICATION OF SINGULARITY.</a>
   448) <a name="l448" style="background-color: #ffcccc">!</a>
   449) <a name="l449" style="background-color: #ffcccc">!     LINPACK. THIS VERSION DATED 08/14/78 .</a>
   450) <a name="l450" style="background-color: #ffcccc">!     CLEVE MOLER, UNIVERSITY OF NEW MEXICO, ARGONNE NATIONAL LAB.</a>
   451) <a name="l451" style="background-color: #ffcccc">!</a>
   452) <a name="l452" style="background-color: #ffcccc">!     SUBROUTINES AND FUNCTIONS</a>
   453) <a name="l453" style="background-color: #ffcccc">!</a>
   454) <a name="l454" style="background-color: #ffcccc">!     BLAS SAXPY,SSCAL,ISAMAX</a>
   455) <a name="l455" style="background-color: #ffcccc">!</a>
   456) <a name="l456" style="background-color: #ffcccc">!     INTERNAL VARIABLES</a>
   457) <a name="l457" style="background-color: #ffcccc">!</a>
   458) <a name="l458" style="background-color: #ffcccc">      REAL(r8) T</a>
   459) <a name="l459" style="background-color: #ffcccc">      INTEGER J,K,KP1,L,NM1</a>
   460) <a name="l460" style="background-color: #ffcccc">!</a>
   461) <a name="l461" style="background-color: #ffcccc">!</a>
   462) <a name="l462" style="background-color: #ffcccc">!</a>
   463) <a name="l463" style="background-color: #ffcccc">!     GAUSSIAN ELIMINATION WITH PARTIAL PIVOTING</a>
   464) <a name="l464" style="background-color: #ffcccc">!</a>
   465) <a name="l465" style="background-color: #ffcccc">      INFO = 0</a>
   466) <a name="l466" style="background-color: #ffcccc">      NM1 = N - 1</a>
   467) <a name="l467" style="background-color: #ffcccc">      IF (NM1 .LT. 1) GO TO 70</a>
   468) <a name="l468" style="background-color: #ffcccc">      DO 60 K = 1, NM1</a>
   469) <a name="l469" style="background-color: #ffcccc">         KP1 = K + 1</a>
   470) <a name="l470" style="background-color: #ffcccc">!</a>
   471) <a name="l471" style="background-color: #ffcccc">!        FIND L = PIVOT INDEX</a>
   472) <a name="l472" style="background-color: #ffcccc">!</a>
   473) <a name="l473" style="background-color: #ffcccc">         L = ISAMAX(N-K+1,A(K,K),1) + K - 1</a>
   474) <a name="l474" style="background-color: #ffcccc">         IPVT(K) = L</a>
   475) <a name="l475" style="background-color: #ffcccc">!</a>
   476) <a name="l476" style="background-color: #ffcccc">!        ZERO PIVOT IMPLIES THIS COLUMN ALREADY TRIANGULARIZED</a>
   477) <a name="l477" style="background-color: #ffcccc">!</a>
   478) <a name="l478" style="background-color: #ffcccc">         IF (A(L,K) .EQ. 0.0E0_r8) GO TO 40</a>
   479) <a name="l479" style="background-color: #ffcccc">!</a>
   480) <a name="l480" style="background-color: #ffcccc">!           INTERCHANGE IF NECESSARY</a>
   481) <a name="l481" style="background-color: #ffcccc">!</a>
   482) <a name="l482" style="background-color: #ffcccc">            IF (L .EQ. K) GO TO 10</a>
   483) <a name="l483" style="background-color: #ffcccc">               T = A(L,K)</a>
   484) <a name="l484" style="background-color: #ffcccc">               A(L,K) = A(K,K)</a>
   485) <a name="l485" style="background-color: #ffcccc">               A(K,K) = T</a>
   486) <a name="l486" style="background-color: #ffcccc">   10       CONTINUE</a>
   487) <a name="l487" style="background-color: #ffcccc">!</a>
   488) <a name="l488" style="background-color: #ffcccc">!           COMPUTE MULTIPLIERS</a>
   489) <a name="l489" style="background-color: #ffcccc">!</a>
   490) <a name="l490" style="background-color: #ffcccc">            T = -1.0E0_r8/A(K,K)</a>
   491) <a name="l491" style="background-color: #ffcccc">            CALL SSCAL(N-K,T,A(K+1,K),1)</a>
   492) <a name="l492" style="background-color: #ffcccc">!</a>
   493) <a name="l493" style="background-color: #ffcccc">!           ROW ELIMINATION WITH COLUMN INDEXING</a>
   494) <a name="l494" style="background-color: #ffcccc">!</a>
   495) <a name="l495" style="background-color: #ffcccc">            DO 30 J = KP1, N</a>
   496) <a name="l496" style="background-color: #ffcccc">               T = A(L,J)</a>
   497) <a name="l497" style="background-color: #ffcccc">               IF (L .EQ. K) GO TO 20</a>
   498) <a name="l498" style="background-color: #ffcccc">                  A(L,J) = A(K,J)</a>
   499) <a name="l499" style="background-color: #ffcccc">                  A(K,J) = T</a>
   500) <a name="l500" style="background-color: #ffcccc">   20          CONTINUE</a>
   501) <a name="l501" style="background-color: #ffcccc">               CALL SAXPY(N-K,T,A(K+1,K),1,A(K+1,J),1)</a>
   502) <a name="l502" style="background-color: #ffcccc">   30       CONTINUE</a>
   503) <a name="l503" style="background-color: #ffcccc">         GO TO 50</a>
   504) <a name="l504" style="background-color: #ffcccc">   40    CONTINUE</a>
   505) <a name="l505" style="background-color: #ffcccc">            INFO = K</a>
   506) <a name="l506" style="background-color: #ffcccc">   50    CONTINUE</a>
   507) <a name="l507" style="background-color: #ffcccc">   60 CONTINUE</a>
   508) <a name="l508" style="background-color: #ffcccc">   70 CONTINUE</a>
   509) <a name="l509" style="background-color: #ffcccc">      IPVT(N) = N</a>
   510) <a name="l510" style="background-color: #ffcccc">      IF (A(N,N) .EQ. 0.0E0_r8) INFO = N</a>
   511) <a name="l511" style="background-color: #ffcccc">      RETURN</a>
   512) <a name="l512" style="background-color: #ffcccc">      END SUBROUTINE SGEFA</a>
   513) <a name="l513" style="background-color: #ffffff"></a>
   514) <a name="l514" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
   515) <a name="l515" style="background-color: #ffffff"> </a>
   516) <a name="l516" style="background-color: #ffffff">      FUNCTION </a><a style="background-color: #ffcccc">SDOT(N,SX,INCX,SY,INCY)</a>
   517) <a name="l517" style="background-color: #ffcccc">!</a>
   518) <a name="l518" style="background-color: #ffcccc">!     FORMS THE DOT PRODUCT OF TWO VECTORS.</a>
   519) <a name="l519" style="background-color: #ffcccc">!     USES UNROLLED LOOPS FOR INCREMENTS EQUAL TO ONE.</a>
   520) <a name="l520" style="background-color: #ffcccc">!     JACK DONGARRA, LINPACK, 3/11/78.</a>
   521) <a name="l521" style="background-color: #ffcccc">!</a>
   522) <a name="l522" style="background-color: #ffcccc">!</a>
   523) <a name="l523" style="background-color: #ffcccc">      real(r8) sdot</a>
   524) <a name="l524" style="background-color: #ffcccc"></a>
   525) <a name="l525" style="background-color: #ffcccc">      REAL(r8) SX(*),SY(*),STEMP</a>
   526) <a name="l526" style="background-color: #ffcccc">      INTEGER I,INCX,INCY,IX,IY,M,MP1,N</a>
   527) <a name="l527" style="background-color: #ffcccc">!</a>
   528) <a name="l528" style="background-color: #ffcccc">      STEMP = 0.0E0_r8</a>
   529) <a name="l529" style="background-color: #ffcccc">      SDOT = 0.0E0_r8</a>
   530) <a name="l530" style="background-color: #ffcccc">      IF(N.LE.0)RETURN</a>
   531) <a name="l531" style="background-color: #ffcccc">      IF(INCX.EQ.1.AND.INCY.EQ.1)GO TO 20</a>
   532) <a name="l532" style="background-color: #ffcccc">!</a>
   533) <a name="l533" style="background-color: #ffcccc">!        CODE FOR UNEQUAL INCREMENTS OR EQUAL INCREMENTS</a>
   534) <a name="l534" style="background-color: #ffcccc">!          NOT EQUAL TO 1</a>
   535) <a name="l535" style="background-color: #ffcccc">!</a>
   536) <a name="l536" style="background-color: #ffcccc">      IX = 1</a>
   537) <a name="l537" style="background-color: #ffcccc">      IY = 1</a>
   538) <a name="l538" style="background-color: #ffcccc">      IF(INCX.LT.0)IX = (-N+1)*INCX + 1</a>
   539) <a name="l539" style="background-color: #ffcccc">      IF(INCY.LT.0)IY = (-N+1)*INCY + 1</a>
   540) <a name="l540" style="background-color: #ffcccc">      DO 10 I = 1,N</a>
   541) <a name="l541" style="background-color: #ffcccc">        STEMP = STEMP + SX(IX)*SY(IY)</a>
   542) <a name="l542" style="background-color: #ffcccc">        IX = IX + INCX</a>
   543) <a name="l543" style="background-color: #ffcccc">        IY = IY + INCY</a>
   544) <a name="l544" style="background-color: #ffcccc">   10 CONTINUE</a>
   545) <a name="l545" style="background-color: #ffcccc">      SDOT = STEMP</a>
   546) <a name="l546" style="background-color: #ffcccc">      RETURN</a>
   547) <a name="l547" style="background-color: #ffcccc">!</a>
   548) <a name="l548" style="background-color: #ffcccc">!        CODE FOR BOTH INCREMENTS EQUAL TO 1</a>
   549) <a name="l549" style="background-color: #ffcccc">!</a>
   550) <a name="l550" style="background-color: #ffcccc">!</a>
   551) <a name="l551" style="background-color: #ffcccc">!        CLEAN-UP LOOP</a>
   552) <a name="l552" style="background-color: #ffcccc">!</a>
   553) <a name="l553" style="background-color: #ffcccc">   20 M = MOD(N,5)</a>
   554) <a name="l554" style="background-color: #ffcccc">      IF( M .EQ. 0 ) GO TO 40</a>
   555) <a name="l555" style="background-color: #ffcccc">      DO 30 I = 1,M</a>
   556) <a name="l556" style="background-color: #ffcccc">        STEMP = STEMP + SX(I)*SY(I)</a>
   557) <a name="l557" style="background-color: #ffcccc">   30 CONTINUE</a>
   558) <a name="l558" style="background-color: #ffcccc">      IF( N .LT. 5 ) GO TO 60</a>
   559) <a name="l559" style="background-color: #ffcccc">   40 MP1 = M + 1</a>
   560) <a name="l560" style="background-color: #ffcccc">      DO 50 I = MP1,N,5</a>
   561) <a name="l561" style="background-color: #ffcccc">        STEMP = STEMP + SX(I)*SY(I) + SX(I + 1)*SY(I + 1) + &amp;</a>
   562) <a name="l562" style="background-color: #ffcccc">         SX(I + 2)*SY(I + 2) + SX(I + 3)*SY(I + 3) + SX(I + 4)*SY(I + 4)</a>
   563) <a name="l563" style="background-color: #ffcccc">   50 CONTINUE</a>
   564) <a name="l564" style="background-color: #ffcccc">   60 SDOT = STEMP</a>
   565) <a name="l565" style="background-color: #ffcccc">      RETURN</a>
   566) <a name="l566" style="background-color: #ffcccc">      END FUNCTION SDOT</a>
   567) <a name="l567" style="background-color: #ffffff"></a>
   568) <a name="l568" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
   569) <a name="l569" style="background-color: #ffffff"></a>
   570) <a name="l570" style="background-color: #ffffff">      INTEGER FUNCTION </a><a style="background-color: #ffcccc">ISAMAX(N,SX,INCX)</a>
   571) <a name="l571" style="background-color: #ffcccc">!</a>
   572) <a name="l572" style="background-color: #ffcccc">!     FINDS THE INDEX OF ELEMENT HAVING MAX. ABSOLUTE VALUE.</a>
   573) <a name="l573" style="background-color: #ffcccc">!     JACK DONGARRA, LINPACK, 3/11/78.</a>
   574) <a name="l574" style="background-color: #ffcccc">!</a>
   575) <a name="l575" style="background-color: #ffcccc">      REAL(r8) SX(*),SMAX</a>
   576) <a name="l576" style="background-color: #ffcccc">      INTEGER I,INCX,IX,N</a>
   577) <a name="l577" style="background-color: #ffcccc">!</a>
   578) <a name="l578" style="background-color: #ffcccc">      ISAMAX = 0</a>
   579) <a name="l579" style="background-color: #ffcccc">      IF( N .LT. 1 ) RETURN</a>
   580) <a name="l580" style="background-color: #ffcccc">      ISAMAX = 1</a>
   581) <a name="l581" style="background-color: #ffcccc">      IF(N.EQ.1)RETURN</a>
   582) <a name="l582" style="background-color: #ffcccc">      IF(INCX.EQ.1)GO TO 20</a>
   583) <a name="l583" style="background-color: #ffcccc">!</a>
   584) <a name="l584" style="background-color: #ffcccc">!        CODE FOR INCREMENT NOT EQUAL TO 1</a>
   585) <a name="l585" style="background-color: #ffcccc">!</a>
   586) <a name="l586" style="background-color: #ffcccc">      IX = 1</a>
   587) <a name="l587" style="background-color: #ffcccc">      SMAX = ABS(SX(1))</a>
   588) <a name="l588" style="background-color: #ffcccc">      IX = IX + INCX</a>
   589) <a name="l589" style="background-color: #ffcccc">      DO 10 I = 2,N</a>
   590) <a name="l590" style="background-color: #ffcccc">         IF(ABS(SX(IX)).LE.SMAX) GO TO 5</a>
   591) <a name="l591" style="background-color: #ffcccc">         ISAMAX = I</a>
   592) <a name="l592" style="background-color: #ffcccc">         SMAX = ABS(SX(IX))</a>
   593) <a name="l593" style="background-color: #ffcccc">    5    IX = IX + INCX</a>
   594) <a name="l594" style="background-color: #ffcccc">   10 CONTINUE</a>
   595) <a name="l595" style="background-color: #ffcccc">      RETURN</a>
   596) <a name="l596" style="background-color: #ffcccc">!</a>
   597) <a name="l597" style="background-color: #ffcccc">!        CODE FOR INCREMENT EQUAL TO 1</a>
   598) <a name="l598" style="background-color: #ffcccc">!</a>
   599) <a name="l599" style="background-color: #ffcccc">   20 SMAX = ABS(SX(1))</a>
   600) <a name="l600" style="background-color: #ffcccc">      DO 30 I = 2,N</a>
   601) <a name="l601" style="background-color: #ffcccc">         IF(ABS(SX(I)).LE.SMAX) GO TO 30</a>
   602) <a name="l602" style="background-color: #ffcccc">         ISAMAX = I</a>
   603) <a name="l603" style="background-color: #ffcccc">         SMAX = ABS(SX(I))</a>
   604) <a name="l604" style="background-color: #ffcccc">   30 CONTINUE</a>
   605) <a name="l605" style="background-color: #ffcccc">      RETURN</a>
   606) <a name="l606" style="background-color: #ffcccc">      END FUNCTION ISAMAX</a>
   607) <a name="l607" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
   608) <a name="l608" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
   609) <a name="l609" style="background-color: #ffffff"></a>
   610) <a name="l610" style="background-color: #ffffff">      FUNCTION </a><a style="background-color: #ffcccc">SASUM(N,SX,INCX)</a>
   611) <a name="l611" style="background-color: #ffcccc">!</a>
   612) <a name="l612" style="background-color: #ffcccc">!     TAKES THE SUM OF THE ABSOLUTE VALUES.</a>
   613) <a name="l613" style="background-color: #ffcccc">!     USES UNROLLED LOOPS FOR INCREMENT EQUAL TO ONE.</a>
   614) <a name="l614" style="background-color: #ffcccc">!     JACK DONGARRA, LINPACK, 3/11/78.</a>
   615) <a name="l615" style="background-color: #ffcccc">!</a>
   616) <a name="l616" style="background-color: #ffcccc">      real(r8) sasum</a>
   617) <a name="l617" style="background-color: #ffcccc"></a>
   618) <a name="l618" style="background-color: #ffcccc">      REAL(r8) SX(*),STEMP</a>
   619) <a name="l619" style="background-color: #ffcccc">      INTEGER I,INCX,M,MP1,N,NINCX</a>
   620) <a name="l620" style="background-color: #ffcccc">!</a>
   621) <a name="l621" style="background-color: #ffcccc">      SASUM = 0.0E0_r8</a>
   622) <a name="l622" style="background-color: #ffcccc">      STEMP = 0.0E0_r8</a>
   623) <a name="l623" style="background-color: #ffcccc">      IF(N.LE.0)RETURN</a>
   624) <a name="l624" style="background-color: #ffcccc">      IF(INCX.EQ.1)GO TO 20</a>
   625) <a name="l625" style="background-color: #ffcccc">!</a>
   626) <a name="l626" style="background-color: #ffcccc">!        CODE FOR INCREMENT NOT EQUAL TO 1</a>
   627) <a name="l627" style="background-color: #ffcccc">!</a>
   628) <a name="l628" style="background-color: #ffcccc">      NINCX = N*INCX</a>
   629) <a name="l629" style="background-color: #ffcccc">      DO 10 I = 1,NINCX,INCX</a>
   630) <a name="l630" style="background-color: #ffcccc">        STEMP = STEMP + ABS(SX(I))</a>
   631) <a name="l631" style="background-color: #ffcccc">   10 CONTINUE</a>
   632) <a name="l632" style="background-color: #ffcccc">      SASUM = STEMP</a>
   633) <a name="l633" style="background-color: #ffcccc">      RETURN</a>
   634) <a name="l634" style="background-color: #ffcccc">!</a>
   635) <a name="l635" style="background-color: #ffcccc">!        CODE FOR INCREMENT EQUAL TO 1</a>
   636) <a name="l636" style="background-color: #ffcccc">!</a>
   637) <a name="l637" style="background-color: #ffcccc">!</a>
   638) <a name="l638" style="background-color: #ffcccc">!        CLEAN-UP LOOP</a>
   639) <a name="l639" style="background-color: #ffcccc">!</a>
   640) <a name="l640" style="background-color: #ffcccc">   20 M = MOD(N,6)</a>
   641) <a name="l641" style="background-color: #ffcccc">      IF( M .EQ. 0 ) GO TO 40</a>
   642) <a name="l642" style="background-color: #ffcccc">      DO 30 I = 1,M</a>
   643) <a name="l643" style="background-color: #ffcccc">        STEMP = STEMP + ABS(SX(I))</a>
   644) <a name="l644" style="background-color: #ffcccc">   30 CONTINUE</a>
   645) <a name="l645" style="background-color: #ffcccc">      IF( N .LT. 6 ) GO TO 60</a>
   646) <a name="l646" style="background-color: #ffcccc">   40 MP1 = M + 1</a>
   647) <a name="l647" style="background-color: #ffcccc">      DO 50 I = MP1,N,6</a>
   648) <a name="l648" style="background-color: #ffcccc">        STEMP = STEMP + ABS(SX(I)) + ABS(SX(I + 1)) + ABS(SX(I + 2)) &amp;</a>
   649) <a name="l649" style="background-color: #ffcccc">        + ABS(SX(I + 3)) + ABS(SX(I + 4)) + ABS(SX(I + 5))</a>
   650) <a name="l650" style="background-color: #ffcccc">   50 CONTINUE</a>
   651) <a name="l651" style="background-color: #ffcccc">   60 SASUM = STEMP</a>
   652) <a name="l652" style="background-color: #ffcccc">      RETURN</a>
   653) <a name="l653" style="background-color: #ffcccc">      END FUNCTION SASUM</a>
   654) <a name="l654" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
   655) <a name="l655" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
   656) <a name="l656" style="background-color: #ffffff"></a>
   657) <a name="l657" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SAXPY(N,SA,SX,INCX,SY,INCY)</a>
   658) <a name="l658" style="background-color: #ffcccc">!</a>
   659) <a name="l659" style="background-color: #ffcccc">!     CONSTANT TIMES A VECTOR PLUS A VECTOR.</a>
   660) <a name="l660" style="background-color: #ffcccc">!     USES UNROLLED LOOP FOR INCREMENTS EQUAL TO ONE.</a>
   661) <a name="l661" style="background-color: #ffcccc">!     JACK DONGARRA, LINPACK, 3/11/78.</a>
   662) <a name="l662" style="background-color: #ffcccc">!</a>
   663) <a name="l663" style="background-color: #ffcccc">      REAL(r8) SX(*),SY(*),SA</a>
   664) <a name="l664" style="background-color: #ffcccc">      INTEGER I,INCX,INCY,IX,IY,M,MP1,N</a>
   665) <a name="l665" style="background-color: #ffcccc">!</a>
   666) <a name="l666" style="background-color: #ffcccc">      IF(N.LE.0)RETURN</a>
   667) <a name="l667" style="background-color: #ffcccc">      IF (SA .EQ. 0.0_r8) RETURN</a>
   668) <a name="l668" style="background-color: #ffcccc">      IF(INCX.EQ.1.AND.INCY.EQ.1)GO TO 20</a>
   669) <a name="l669" style="background-color: #ffcccc">!</a>
   670) <a name="l670" style="background-color: #ffcccc">!        CODE FOR UNEQUAL INCREMENTS OR EQUAL INCREMENTS</a>
   671) <a name="l671" style="background-color: #ffcccc">!          NOT EQUAL TO 1</a>
   672) <a name="l672" style="background-color: #ffcccc">!</a>
   673) <a name="l673" style="background-color: #ffcccc">      IX = 1</a>
   674) <a name="l674" style="background-color: #ffcccc">      IY = 1</a>
   675) <a name="l675" style="background-color: #ffcccc">      IF(INCX.LT.0)IX = (-N+1)*INCX + 1</a>
   676) <a name="l676" style="background-color: #ffcccc">      IF(INCY.LT.0)IY = (-N+1)*INCY + 1</a>
   677) <a name="l677" style="background-color: #ffcccc">      DO 10 I = 1,N</a>
   678) <a name="l678" style="background-color: #ffcccc">        SY(IY) = SY(IY) + SA*SX(IX)</a>
   679) <a name="l679" style="background-color: #ffcccc">        IX = IX + INCX</a>
   680) <a name="l680" style="background-color: #ffcccc">        IY = IY + INCY</a>
   681) <a name="l681" style="background-color: #ffcccc">   10 CONTINUE</a>
   682) <a name="l682" style="background-color: #ffcccc">      RETURN</a>
   683) <a name="l683" style="background-color: #ffcccc">!</a>
   684) <a name="l684" style="background-color: #ffcccc">!        CODE FOR BOTH INCREMENTS EQUAL TO 1</a>
   685) <a name="l685" style="background-color: #ffcccc">!</a>
   686) <a name="l686" style="background-color: #ffcccc">!</a>
   687) <a name="l687" style="background-color: #ffcccc">!        CLEAN-UP LOOP</a>
   688) <a name="l688" style="background-color: #ffcccc">!</a>
   689) <a name="l689" style="background-color: #ffcccc">   20 M = MOD(N,4)</a>
   690) <a name="l690" style="background-color: #ffcccc">      IF( M .EQ. 0 ) GO TO 40</a>
   691) <a name="l691" style="background-color: #ffcccc">      DO 30 I = 1,M</a>
   692) <a name="l692" style="background-color: #ffcccc">        SY(I) = SY(I) + SA*SX(I)</a>
   693) <a name="l693" style="background-color: #ffcccc">   30 CONTINUE</a>
   694) <a name="l694" style="background-color: #ffcccc">      IF( N .LT. 4 ) RETURN</a>
   695) <a name="l695" style="background-color: #ffcccc">   40 MP1 = M + 1</a>
   696) <a name="l696" style="background-color: #ffcccc">      DO 50 I = MP1,N,4</a>
   697) <a name="l697" style="background-color: #ffcccc">        SY(I) = SY(I) + SA*SX(I)</a>
   698) <a name="l698" style="background-color: #ffcccc">        SY(I + 1) = SY(I + 1) + SA*SX(I + 1)</a>
   699) <a name="l699" style="background-color: #ffcccc">        SY(I + 2) = SY(I + 2) + SA*SX(I + 2)</a>
   700) <a name="l700" style="background-color: #ffcccc">        SY(I + 3) = SY(I + 3) + SA*SX(I + 3)</a>
   701) <a name="l701" style="background-color: #ffcccc">   50 CONTINUE</a>
   702) <a name="l702" style="background-color: #ffcccc">      RETURN</a>
   703) <a name="l703" style="background-color: #ffcccc">      END SUBROUTINE SAXPY</a>
   704) <a name="l704" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
   705) <a name="l705" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
   706) <a name="l706" style="background-color: #ffffff"></a>
   707) <a name="l707" style="background-color: #ffffff">      subroutine </a><a style="background-color: #ffcccc">sscal(n,sa,sx,incx)</a>
   708) <a name="l708" style="background-color: #ffcccc">!</a>
   709) <a name="l709" style="background-color: #ffcccc">!     scales a vector by a constant.</a>
   710) <a name="l710" style="background-color: #ffcccc">!     uses unrolled loops for increment equal to 1.</a>
   711) <a name="l711" style="background-color: #ffcccc">!     jack dongarra, linpack, 3/11/78.</a>
   712) <a name="l712" style="background-color: #ffcccc">!     modified 3/93 to return if incx .le. 0.</a>
   713) <a name="l713" style="background-color: #ffcccc">!     modified 12/3/93, array(1) declarations changed to array(*)</a>
   714) <a name="l714" style="background-color: #ffcccc">!</a>
   715) <a name="l715" style="background-color: #ffcccc">      integer i,incx,m,mp1,n,nincx</a>
   716) <a name="l716" style="background-color: #ffcccc">      real(r8) sa,sx(*)</a>
   717) <a name="l717" style="background-color: #ffcccc">!</a>
   718) <a name="l718" style="background-color: #ffcccc">      if( n.le.0 .or. incx.le.0 )return</a>
   719) <a name="l719" style="background-color: #ffcccc">      if(incx.eq.1)go to 20</a>
   720) <a name="l720" style="background-color: #ffcccc">!</a>
   721) <a name="l721" style="background-color: #ffcccc">!        code for increment not equal to 1</a>
   722) <a name="l722" style="background-color: #ffcccc">!</a>
   723) <a name="l723" style="background-color: #ffcccc">      nincx = n*incx</a>
   724) <a name="l724" style="background-color: #ffcccc">      do 10 i = 1,nincx,incx</a>
   725) <a name="l725" style="background-color: #ffcccc">        sx(i) = sa*sx(i)</a>
   726) <a name="l726" style="background-color: #ffcccc">   10 continue</a>
   727) <a name="l727" style="background-color: #ffcccc">      return</a>
   728) <a name="l728" style="background-color: #ffcccc">!</a>
   729) <a name="l729" style="background-color: #ffcccc">!        code for increment equal to 1</a>
   730) <a name="l730" style="background-color: #ffcccc">!</a>
   731) <a name="l731" style="background-color: #ffcccc">!</a>
   732) <a name="l732" style="background-color: #ffcccc">!        clean-up loop</a>
   733) <a name="l733" style="background-color: #ffcccc">!</a>
   734) <a name="l734" style="background-color: #ffcccc">   20 m = mod(n,5)</a>
   735) <a name="l735" style="background-color: #ffcccc">      if( m .eq. 0 ) go to 40</a>
   736) <a name="l736" style="background-color: #ffcccc">      do 30 i = 1,m</a>
   737) <a name="l737" style="background-color: #ffcccc">        sx(i) = sa*sx(i)</a>
   738) <a name="l738" style="background-color: #ffcccc">   30 continue</a>
   739) <a name="l739" style="background-color: #ffcccc">      if( n .lt. 5 ) return</a>
   740) <a name="l740" style="background-color: #ffcccc">   40 mp1 = m + 1</a>
   741) <a name="l741" style="background-color: #ffcccc">      do 50 i = mp1,n,5</a>
   742) <a name="l742" style="background-color: #ffcccc">        sx(i) = sa*sx(i)</a>
   743) <a name="l743" style="background-color: #ffcccc">        sx(i + 1) = sa*sx(i + 1)</a>
   744) <a name="l744" style="background-color: #ffcccc">        sx(i + 2) = sa*sx(i + 2)</a>
   745) <a name="l745" style="background-color: #ffcccc">        sx(i + 3) = sa*sx(i + 3)</a>
   746) <a name="l746" style="background-color: #ffcccc">        sx(i + 4) = sa*sx(i + 4)</a>
   747) <a name="l747" style="background-color: #ffcccc">   50 continue</a>
   748) <a name="l748" style="background-color: #ffcccc">      return</a>
   749) <a name="l749" style="background-color: #ffcccc">      end subroutine sscal</a>
   750) <a name="l750" style="background-color: #ffffff"></a>
   751) <a name="l751" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
   752) <a name="l752" style="background-color: #ffffff"></a>
   753) <a name="l753" style="background-color: #ffffff">      subroutine </a><a style="background-color: #ffcccc">sswap (n,sx,incx,sy,incy)</a>
   754) <a name="l754" style="background-color: #ffcccc">!</a>
   755) <a name="l755" style="background-color: #ffcccc">!     interchanges two vectors.</a>
   756) <a name="l756" style="background-color: #ffcccc">!     uses unrolled loops for increments equal to 1.</a>
   757) <a name="l757" style="background-color: #ffcccc">!     jack dongarra, linpack, 3/11/78.</a>
   758) <a name="l758" style="background-color: #ffcccc">!     modified 12/3/93, array(1) declarations changed to array(*)</a>
   759) <a name="l759" style="background-color: #ffcccc">!</a>
   760) <a name="l760" style="background-color: #ffcccc">      real(r8) sx(*),sy(*),stemp</a>
   761) <a name="l761" style="background-color: #ffcccc">      integer i,incx,incy,ix,iy,m,mp1,n</a>
   762) <a name="l762" style="background-color: #ffcccc">!</a>
   763) <a name="l763" style="background-color: #ffcccc">      if(n.le.0)return</a>
   764) <a name="l764" style="background-color: #ffcccc">      if(incx.eq.1.and.incy.eq.1)go to 20</a>
   765) <a name="l765" style="background-color: #ffcccc">!</a>
   766) <a name="l766" style="background-color: #ffcccc">!       code for unequal increments or equal increments not equal</a>
   767) <a name="l767" style="background-color: #ffcccc">!         to 1</a>
   768) <a name="l768" style="background-color: #ffcccc">!</a>
   769) <a name="l769" style="background-color: #ffcccc">      ix = 1</a>
   770) <a name="l770" style="background-color: #ffcccc">      iy = 1</a>
   771) <a name="l771" style="background-color: #ffcccc">      if(incx.lt.0)ix = (-n+1)*incx + 1</a>
   772) <a name="l772" style="background-color: #ffcccc">      if(incy.lt.0)iy = (-n+1)*incy + 1</a>
   773) <a name="l773" style="background-color: #ffcccc">      do 10 i = 1,n</a>
   774) <a name="l774" style="background-color: #ffcccc">        stemp = sx(ix)</a>
   775) <a name="l775" style="background-color: #ffcccc">        sx(ix) = sy(iy)</a>
   776) <a name="l776" style="background-color: #ffcccc">        sy(iy) = stemp</a>
   777) <a name="l777" style="background-color: #ffcccc">        ix = ix + incx</a>
   778) <a name="l778" style="background-color: #ffcccc">        iy = iy + incy</a>
   779) <a name="l779" style="background-color: #ffcccc">   10 continue</a>
   780) <a name="l780" style="background-color: #ffcccc">      return</a>
   781) <a name="l781" style="background-color: #ffcccc">!</a>
   782) <a name="l782" style="background-color: #ffcccc">!       code for both increments equal to 1</a>
   783) <a name="l783" style="background-color: #ffcccc">!</a>
   784) <a name="l784" style="background-color: #ffcccc">!</a>
   785) <a name="l785" style="background-color: #ffcccc">!       clean-up loop</a>
   786) <a name="l786" style="background-color: #ffcccc">!</a>
   787) <a name="l787" style="background-color: #ffcccc">   20 m = mod(n,3)</a>
   788) <a name="l788" style="background-color: #ffcccc">      if( m .eq. 0 ) go to 40</a>
   789) <a name="l789" style="background-color: #ffcccc">      do 30 i = 1,m</a>
   790) <a name="l790" style="background-color: #ffcccc">        stemp = sx(i)</a>
   791) <a name="l791" style="background-color: #ffcccc">        sx(i) = sy(i)</a>
   792) <a name="l792" style="background-color: #ffcccc">        sy(i) = stemp</a>
   793) <a name="l793" style="background-color: #ffcccc">   30 continue</a>
   794) <a name="l794" style="background-color: #ffcccc">      if( n .lt. 3 ) return</a>
   795) <a name="l795" style="background-color: #ffcccc">   40 mp1 = m + 1</a>
   796) <a name="l796" style="background-color: #ffcccc">      do 50 i = mp1,n,3</a>
   797) <a name="l797" style="background-color: #ffcccc">        stemp = sx(i)</a>
   798) <a name="l798" style="background-color: #ffcccc">        sx(i) = sy(i)</a>
   799) <a name="l799" style="background-color: #ffcccc">        sy(i) = stemp</a>
   800) <a name="l800" style="background-color: #ffcccc">        stemp = sx(i + 1)</a>
   801) <a name="l801" style="background-color: #ffcccc">        sx(i + 1) = sy(i + 1)</a>
   802) <a name="l802" style="background-color: #ffcccc">        sy(i + 1) = stemp</a>
   803) <a name="l803" style="background-color: #ffcccc">        stemp = sx(i + 2)</a>
   804) <a name="l804" style="background-color: #ffcccc">        sx(i + 2) = sy(i + 2)</a>
   805) <a name="l805" style="background-color: #ffcccc">        sy(i + 2) = stemp</a>
   806) <a name="l806" style="background-color: #ffcccc">   50 continue</a>
   807) <a name="l807" style="background-color: #ffcccc">      return</a>
   808) <a name="l808" style="background-color: #ffcccc">      end subroutine sswap</a>
   809) <a name="l809" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
   810) <a name="l810" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
   811) <a name="l811" style="background-color: #ffffff"></a>
   812) <a name="l812" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SGEEV( JOBVL, JOBVR, N, A, LDA, WR, WI, VL, LDVL, VR, &amp;</a>
   813) <a name="l813" style="background-color: #ffcccc">                        LDVR, WORK, LWORK, INFO )</a>
   814) <a name="l814" style="background-color: #ffcccc"></a>
   815) <a name="l815" style="background-color: #ffcccc">!</a>
   816) <a name="l816" style="background-color: #ffcccc">!  -- LAPACK driver routine (version 2.0) --</a>
   817) <a name="l817" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
   818) <a name="l818" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
   819) <a name="l819" style="background-color: #ffcccc">!     September 30, 1994</a>
   820) <a name="l820" style="background-color: #ffcccc">!</a>
   821) <a name="l821" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
   822) <a name="l822" style="background-color: #ffcccc">      CHARACTER          JOBVL, JOBVR</a>
   823) <a name="l823" style="background-color: #ffcccc">      INTEGER            INFO, LDA, LDVL, LDVR, LWORK, N</a>
   824) <a name="l824" style="background-color: #ffcccc">!     ..</a>
   825) <a name="l825" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
   826) <a name="l826" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), VL( LDVL, * ), VR( LDVR, * ), &amp;</a>
   827) <a name="l827" style="background-color: #ffcccc">                         WI( * ), WORK( * ), WR( * )</a>
   828) <a name="l828" style="background-color: #ffcccc">!     ..</a>
   829) <a name="l829" style="background-color: #ffcccc">!</a>
   830) <a name="l830" style="background-color: #ffcccc">!  Purpose</a>
   831) <a name="l831" style="background-color: #ffcccc">!  =======</a>
   832) <a name="l832" style="background-color: #ffcccc">!</a>
   833) <a name="l833" style="background-color: #ffcccc">!  SGEEV computes for an N-by-N real nonsymmetric matrix A, the</a>
   834) <a name="l834" style="background-color: #ffcccc">!  eigenvalues and, optionally, the left and/or right eigenvectors.</a>
   835) <a name="l835" style="background-color: #ffcccc">!</a>
   836) <a name="l836" style="background-color: #ffcccc">!  The right eigenvector v(j) of A satisfies</a>
   837) <a name="l837" style="background-color: #ffcccc">!                   A * v(j) = lambda(j) * v(j)</a>
   838) <a name="l838" style="background-color: #ffcccc">!  where lambda(j) is its eigenvalue.</a>
   839) <a name="l839" style="background-color: #ffcccc">!  The left eigenvector u(j) of A satisfies</a>
   840) <a name="l840" style="background-color: #ffcccc">!                u(j)**H * A = lambda(j) * u(j)**H</a>
   841) <a name="l841" style="background-color: #ffcccc">!  where u(j)**H denotes the conjugate transpose of u(j).</a>
   842) <a name="l842" style="background-color: #ffcccc">!</a>
   843) <a name="l843" style="background-color: #ffcccc">!  The computed eigenvectors are normalized to have Euclidean norm</a>
   844) <a name="l844" style="background-color: #ffcccc">!  equal to 1 and largest component real.</a>
   845) <a name="l845" style="background-color: #ffcccc">!</a>
   846) <a name="l846" style="background-color: #ffcccc">!  Arguments</a>
   847) <a name="l847" style="background-color: #ffcccc">!  =========</a>
   848) <a name="l848" style="background-color: #ffcccc">!</a>
   849) <a name="l849" style="background-color: #ffcccc">!  JOBVL   (input) CHARACTER*1</a>
   850) <a name="l850" style="background-color: #ffcccc">!          = 'N': left eigenvectors of A are not computed;</a>
   851) <a name="l851" style="background-color: #ffcccc">!          = 'V': left eigenvectors of A are computed.</a>
   852) <a name="l852" style="background-color: #ffcccc">!</a>
   853) <a name="l853" style="background-color: #ffcccc">!  JOBVR   (input) CHARACTER*1</a>
   854) <a name="l854" style="background-color: #ffcccc">!          = 'N': right eigenvectors of A are not computed;</a>
   855) <a name="l855" style="background-color: #ffcccc">!          = 'V': right eigenvectors of A are computed.</a>
   856) <a name="l856" style="background-color: #ffcccc">!</a>
   857) <a name="l857" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
   858) <a name="l858" style="background-color: #ffcccc">!          The order of the matrix A. N &gt;= 0.</a>
   859) <a name="l859" style="background-color: #ffcccc">!</a>
   860) <a name="l860" style="background-color: #ffcccc">!  A       (input/output) REAL array, dimension (LDA,N)</a>
   861) <a name="l861" style="background-color: #ffcccc">!          On entry, the N-by-N matrix A.</a>
   862) <a name="l862" style="background-color: #ffcccc">!          On exit, A has been overwritten.</a>
   863) <a name="l863" style="background-color: #ffcccc">!</a>
   864) <a name="l864" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
   865) <a name="l865" style="background-color: #ffcccc">!          The leading dimension of the array A.  LDA &gt;= max(1,N).</a>
   866) <a name="l866" style="background-color: #ffcccc">!</a>
   867) <a name="l867" style="background-color: #ffcccc">!  WR      (output) REAL array, dimension (N)</a>
   868) <a name="l868" style="background-color: #ffcccc">!  WI      (output) REAL array, dimension (N)</a>
   869) <a name="l869" style="background-color: #ffcccc">!          WR and WI contain the real and imaginary parts,</a>
   870) <a name="l870" style="background-color: #ffcccc">!          respectively, of the computed eigenvalues.  Complex</a>
   871) <a name="l871" style="background-color: #ffcccc">!          conjugate pairs of eigenvalues appear consecutively</a>
   872) <a name="l872" style="background-color: #ffcccc">!          with the eigenvalue having the positive imaginary part</a>
   873) <a name="l873" style="background-color: #ffcccc">!          first.</a>
   874) <a name="l874" style="background-color: #ffcccc">!</a>
   875) <a name="l875" style="background-color: #ffcccc">!  VL      (output) REAL array, dimension (LDVL,N)</a>
   876) <a name="l876" style="background-color: #ffcccc">!          If JOBVL = 'V', the left eigenvectors u(j) are stored one</a>
   877) <a name="l877" style="background-color: #ffcccc">!          after another in the columns of VL, in the same order</a>
   878) <a name="l878" style="background-color: #ffcccc">!          as their eigenvalues.</a>
   879) <a name="l879" style="background-color: #ffcccc">!          If JOBVL = 'N', VL is not referenced.</a>
   880) <a name="l880" style="background-color: #ffcccc">!          If the j-th eigenvalue is real, then u(j) = VL(:,j),</a>
   881) <a name="l881" style="background-color: #ffcccc">!          the j-th column of VL.</a>
   882) <a name="l882" style="background-color: #ffcccc">!          If the j-th and (j+1)-st eigenvalues form a complex</a>
   883) <a name="l883" style="background-color: #ffcccc">!          conjugate pair, then u(j) = VL(:,j) + i*VL(:,j+1) and</a>
   884) <a name="l884" style="background-color: #ffcccc">!          u(j+1) = VL(:,j) - i*VL(:,j+1).</a>
   885) <a name="l885" style="background-color: #ffcccc">!</a>
   886) <a name="l886" style="background-color: #ffcccc">!  LDVL    (input) INTEGER</a>
   887) <a name="l887" style="background-color: #ffcccc">!          The leading dimension of the array VL.  LDVL &gt;= 1; if</a>
   888) <a name="l888" style="background-color: #ffcccc">!          JOBVL = 'V', LDVL &gt;= N.</a>
   889) <a name="l889" style="background-color: #ffcccc">!</a>
   890) <a name="l890" style="background-color: #ffcccc">!  VR      (output) REAL array, dimension (LDVR,N)</a>
   891) <a name="l891" style="background-color: #ffcccc">!          If JOBVR = 'V', the right eigenvectors v(j) are stored one</a>
   892) <a name="l892" style="background-color: #ffcccc">!          after another in the columns of VR, in the same order</a>
   893) <a name="l893" style="background-color: #ffcccc">!          as their eigenvalues.</a>
   894) <a name="l894" style="background-color: #ffcccc">!          If JOBVR = 'N', VR is not referenced.</a>
   895) <a name="l895" style="background-color: #ffcccc">!          If the j-th eigenvalue is real, then v(j) = VR(:,j),</a>
   896) <a name="l896" style="background-color: #ffcccc">!          the j-th column of VR.</a>
   897) <a name="l897" style="background-color: #ffcccc">!          If the j-th and (j+1)-st eigenvalues form a complex</a>
   898) <a name="l898" style="background-color: #ffcccc">!          conjugate pair, then v(j) = VR(:,j) + i*VR(:,j+1) and</a>
   899) <a name="l899" style="background-color: #ffcccc">!          v(j+1) = VR(:,j) - i*VR(:,j+1).</a>
   900) <a name="l900" style="background-color: #ffcccc">!</a>
   901) <a name="l901" style="background-color: #ffcccc">!  LDVR    (input) INTEGER</a>
   902) <a name="l902" style="background-color: #ffcccc">!          The leading dimension of the array VR.  LDVR &gt;= 1; if</a>
   903) <a name="l903" style="background-color: #ffcccc">!          JOBVR = 'V', LDVR &gt;= N.</a>
   904) <a name="l904" style="background-color: #ffcccc">!</a>
   905) <a name="l905" style="background-color: #ffcccc">!  WORK    (workspace/output) REAL array, dimension (LWORK)</a>
   906) <a name="l906" style="background-color: #ffcccc">!          On exit, if INFO = 0, WORK(1) returns the optimal LWORK.</a>
   907) <a name="l907" style="background-color: #ffcccc">!</a>
   908) <a name="l908" style="background-color: #ffcccc">!  LWORK   (input) INTEGER</a>
   909) <a name="l909" style="background-color: #ffcccc">!          The dimension of the array WORK.  LWORK &gt;= max(1,3*N), and</a>
   910) <a name="l910" style="background-color: #ffcccc">!          if JOBVL = 'V' or JOBVR = 'V', LWORK &gt;= 4*N.  For good</a>
   911) <a name="l911" style="background-color: #ffcccc">!          performance, LWORK must generally be larger.</a>
   912) <a name="l912" style="background-color: #ffcccc">!</a>
   913) <a name="l913" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
   914) <a name="l914" style="background-color: #ffcccc">!          = 0:  successful exit</a>
   915) <a name="l915" style="background-color: #ffcccc">!          &lt; 0:  if INFO = -i, the i-th argument had an illegal value.</a>
   916) <a name="l916" style="background-color: #ffcccc">!          &gt; 0:  if INFO = i, the QR algorithm failed to compute all the</a>
   917) <a name="l917" style="background-color: #ffcccc">!                eigenvalues, and no eigenvectors have been computed;</a>
   918) <a name="l918" style="background-color: #ffcccc">!                elements i+1:N of WR and WI contain eigenvalues which</a>
   919) <a name="l919" style="background-color: #ffcccc">!                have converged.</a>
   920) <a name="l920" style="background-color: #ffcccc">!</a>
   921) <a name="l921" style="background-color: #ffcccc">!  =====================================================================</a>
   922) <a name="l922" style="background-color: #ffcccc">!</a>
   923) <a name="l923" style="background-color: #ffcccc">!     .. Parameters ..</a>
   924) <a name="l924" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
   925) <a name="l925" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E0_r8, ONE = 1.0E0_r8 )</a>
   926) <a name="l926" style="background-color: #ffcccc">!     ..</a>
   927) <a name="l927" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
   928) <a name="l928" style="background-color: #ffcccc">      LOGICAL            SCALEA, WANTVL, WANTVR</a>
   929) <a name="l929" style="background-color: #ffcccc">      CHARACTER          SIDE</a>
   930) <a name="l930" style="background-color: #ffcccc">      INTEGER            HSWORK, I, IBAL, IERR, IHI, ILO, ITAU, IWRK, K, &amp;</a>
   931) <a name="l931" style="background-color: #ffcccc">                         MAXB, MAXWRK, MINWRK, NOUT</a>
   932) <a name="l932" style="background-color: #ffcccc">      REAL(r8)               ANRM, BIGNUM, CS, CSCALE, EPS, R, SCL, SMLNUM, &amp;</a>
   933) <a name="l933" style="background-color: #ffcccc">                         SN</a>
   934) <a name="l934" style="background-color: #ffcccc">!     ..</a>
   935) <a name="l935" style="background-color: #ffcccc">!     .. Local Arrays ..</a>
   936) <a name="l936" style="background-color: #ffcccc">      LOGICAL            SELECT( 1 )</a>
   937) <a name="l937" style="background-color: #ffcccc">      REAL(r8)               DUM( 1 )</a>
   938) <a name="l938" style="background-color: #ffcccc">!     ..</a>
   939) <a name="l939" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
   940) <a name="l940" style="background-color: #ffcccc">!</a>
   941) <a name="l941" style="background-color: #ffcccc">!     Test the input arguments</a>
   942) <a name="l942" style="background-color: #ffcccc">!</a>
   943) <a name="l943" style="background-color: #ffcccc">      INFO = 0</a>
   944) <a name="l944" style="background-color: #ffcccc">      WANTVL = LSAME( JOBVL, 'V' )</a>
   945) <a name="l945" style="background-color: #ffcccc">      WANTVR = LSAME( JOBVR, 'V' )</a>
   946) <a name="l946" style="background-color: #ffcccc">      IF( ( .NOT.WANTVL ) .AND. ( .NOT.LSAME( JOBVL, 'N' ) ) ) THEN</a>
   947) <a name="l947" style="background-color: #ffcccc">         INFO = -1</a>
   948) <a name="l948" style="background-color: #ffcccc">      ELSE IF( ( .NOT.WANTVR ) .AND. ( .NOT.LSAME( JOBVR, 'N' ) ) ) THEN</a>
   949) <a name="l949" style="background-color: #ffcccc">         INFO = -2</a>
   950) <a name="l950" style="background-color: #ffcccc">      ELSE IF( N.LT.0 ) THEN</a>
   951) <a name="l951" style="background-color: #ffcccc">         INFO = -3</a>
   952) <a name="l952" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, N ) ) THEN</a>
   953) <a name="l953" style="background-color: #ffcccc">         INFO = -5</a>
   954) <a name="l954" style="background-color: #ffcccc">      ELSE IF( LDVL.LT.1 .OR. ( WANTVL .AND. LDVL.LT.N ) ) THEN</a>
   955) <a name="l955" style="background-color: #ffcccc">         INFO = -9</a>
   956) <a name="l956" style="background-color: #ffcccc">      ELSE IF( LDVR.LT.1 .OR. ( WANTVR .AND. LDVR.LT.N ) ) THEN</a>
   957) <a name="l957" style="background-color: #ffcccc">         INFO = -11</a>
   958) <a name="l958" style="background-color: #ffcccc">      END IF</a>
   959) <a name="l959" style="background-color: #ffcccc">!</a>
   960) <a name="l960" style="background-color: #ffcccc">!     Compute workspace</a>
   961) <a name="l961" style="background-color: #ffcccc">!      (Note: Comments in the code beginning &quot;Workspace:&quot; describe the</a>
   962) <a name="l962" style="background-color: #ffcccc">!       minimal amount of workspace needed at that point in the code,</a>
   963) <a name="l963" style="background-color: #ffcccc">!       as well as the preferred amount for good performance.</a>
   964) <a name="l964" style="background-color: #ffcccc">!       NB refers to the optimal block size for the immediately</a>
   965) <a name="l965" style="background-color: #ffcccc">!       following subroutine, as returned by ILAENV.</a>
   966) <a name="l966" style="background-color: #ffcccc">!       HSWORK refers to the workspace preferred by SHSEQR, as</a>
   967) <a name="l967" style="background-color: #ffcccc">!       calculated below. HSWORK is computed assuming ILO=1 and IHI=N,</a>
   968) <a name="l968" style="background-color: #ffcccc">!       the worst case.)</a>
   969) <a name="l969" style="background-color: #ffcccc">!</a>
   970) <a name="l970" style="background-color: #ffcccc">      MINWRK = 1</a>
   971) <a name="l971" style="background-color: #ffcccc">      IF( INFO.EQ.0 .AND. LWORK.GE.1 ) THEN</a>
   972) <a name="l972" style="background-color: #ffcccc">         MAXWRK = 2*N + N*ILAENV( 1, 'SGEHRD', ' ', N, 1, N, 0 )</a>
   973) <a name="l973" style="background-color: #ffcccc">         IF( ( .NOT.WANTVL ) .AND. ( .NOT.WANTVR ) ) THEN</a>
   974) <a name="l974" style="background-color: #ffcccc">            MINWRK = MAX( 1, 3*N )</a>
   975) <a name="l975" style="background-color: #ffcccc">            MAXB = MAX( ILAENV( 8, 'SHSEQR', 'EN', N, 1, N, -1 ), 2 )</a>
   976) <a name="l976" style="background-color: #ffcccc">            K = MIN( MAXB, N, MAX( 2, ILAENV( 4, 'SHSEQR', 'EN', N, 1, &amp;</a>
   977) <a name="l977" style="background-color: #ffcccc">                N, -1 ) ) )</a>
   978) <a name="l978" style="background-color: #ffcccc">            HSWORK = MAX( K*( K+2 ), 2*N )</a>
   979) <a name="l979" style="background-color: #ffcccc">            MAXWRK = MAX( MAXWRK, N+1, N+HSWORK )</a>
   980) <a name="l980" style="background-color: #ffcccc">         ELSE</a>
   981) <a name="l981" style="background-color: #ffcccc">            MINWRK = MAX( 1, 4*N )</a>
   982) <a name="l982" style="background-color: #ffcccc">            MAXWRK = MAX( MAXWRK, 2*N+( N-1 )* &amp;</a>
   983) <a name="l983" style="background-color: #ffcccc">                     ILAENV( 1, 'SORGHR', ' ', N, 1, N, -1 ) )</a>
   984) <a name="l984" style="background-color: #ffcccc">            MAXB = MAX( ILAENV( 8, 'SHSEQR', 'SV', N, 1, N, -1 ), 2 )</a>
   985) <a name="l985" style="background-color: #ffcccc">            K = MIN( MAXB, N, MAX( 2, ILAENV( 4, 'SHSEQR', 'SV', N, 1, &amp;</a>
   986) <a name="l986" style="background-color: #ffcccc">                N, -1 ) ) )</a>
   987) <a name="l987" style="background-color: #ffcccc">            HSWORK = MAX( K*( K+2 ), 2*N )</a>
   988) <a name="l988" style="background-color: #ffcccc">            MAXWRK = MAX( MAXWRK, N+1, N+HSWORK )</a>
   989) <a name="l989" style="background-color: #ffcccc">            MAXWRK = MAX( MAXWRK, 4*N )</a>
   990) <a name="l990" style="background-color: #ffcccc">         END IF</a>
   991) <a name="l991" style="background-color: #ffcccc">         WORK( 1 ) = MAXWRK</a>
   992) <a name="l992" style="background-color: #ffcccc">      END IF</a>
   993) <a name="l993" style="background-color: #ffcccc">      IF( LWORK.LT.MINWRK ) THEN</a>
   994) <a name="l994" style="background-color: #ffcccc">         INFO = -13</a>
   995) <a name="l995" style="background-color: #ffcccc">      END IF</a>
   996) <a name="l996" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
   997) <a name="l997" style="background-color: #ffcccc">         CALL XERBLA( 'SGEEV ', -INFO )</a>
   998) <a name="l998" style="background-color: #ffcccc">         RETURN</a>
   999) <a name="l999" style="background-color: #ffcccc">      END IF</a>
  1000) <a name="l1000" style="background-color: #ffcccc">!</a>
  1001) <a name="l1001" style="background-color: #ffcccc">!     Quick return if possible</a>
  1002) <a name="l1002" style="background-color: #ffcccc">!</a>
  1003) <a name="l1003" style="background-color: #ffcccc">      IF( N.EQ.0 ) &amp;</a>
  1004) <a name="l1004" style="background-color: #ffcccc">         RETURN</a>
  1005) <a name="l1005" style="background-color: #ffcccc">!</a>
  1006) <a name="l1006" style="background-color: #ffcccc">!     Get machine constants</a>
  1007) <a name="l1007" style="background-color: #ffcccc">!</a>
  1008) <a name="l1008" style="background-color: #ffcccc">      EPS = SLAMCH( 'P' )</a>
  1009) <a name="l1009" style="background-color: #ffcccc">      SMLNUM = SLAMCH( 'S' )</a>
  1010) <a name="l1010" style="background-color: #ffcccc">      BIGNUM = ONE / SMLNUM</a>
  1011) <a name="l1011" style="background-color: #ffcccc">      CALL SLABAD( SMLNUM, BIGNUM )</a>
  1012) <a name="l1012" style="background-color: #ffcccc">      SMLNUM = SQRT( SMLNUM ) / EPS</a>
  1013) <a name="l1013" style="background-color: #ffcccc">      BIGNUM = ONE / SMLNUM</a>
  1014) <a name="l1014" style="background-color: #ffcccc">!</a>
  1015) <a name="l1015" style="background-color: #ffcccc">!     Scale A if max element outside range [SMLNUM,BIGNUM]</a>
  1016) <a name="l1016" style="background-color: #ffcccc">!</a>
  1017) <a name="l1017" style="background-color: #ffcccc">      ANRM = SLANGE( 'M', N, N, A, LDA, DUM )</a>
  1018) <a name="l1018" style="background-color: #ffcccc">      SCALEA = .FALSE.</a>
  1019) <a name="l1019" style="background-color: #ffcccc">      IF( ANRM.GT.ZERO .AND. ANRM.LT.SMLNUM ) THEN</a>
  1020) <a name="l1020" style="background-color: #ffcccc">         SCALEA = .TRUE.</a>
  1021) <a name="l1021" style="background-color: #ffcccc">         CSCALE = SMLNUM</a>
  1022) <a name="l1022" style="background-color: #ffcccc">      ELSE IF( ANRM.GT.BIGNUM ) THEN</a>
  1023) <a name="l1023" style="background-color: #ffcccc">         SCALEA = .TRUE.</a>
  1024) <a name="l1024" style="background-color: #ffcccc">         CSCALE = BIGNUM</a>
  1025) <a name="l1025" style="background-color: #ffcccc">      END IF</a>
  1026) <a name="l1026" style="background-color: #ffcccc">      IF( SCALEA ) &amp;</a>
  1027) <a name="l1027" style="background-color: #ffcccc">         CALL SLASCL( 'G', 0, 0, ANRM, CSCALE, N, N, A, LDA, IERR )</a>
  1028) <a name="l1028" style="background-color: #ffcccc">!</a>
  1029) <a name="l1029" style="background-color: #ffcccc">!     Balance the matrix</a>
  1030) <a name="l1030" style="background-color: #ffcccc">!     (Workspace: need N)</a>
  1031) <a name="l1031" style="background-color: #ffcccc">!</a>
  1032) <a name="l1032" style="background-color: #ffcccc">      IBAL = 1</a>
  1033) <a name="l1033" style="background-color: #ffcccc">      CALL SGEBAL( 'B', N, A, LDA, ILO, IHI, WORK( IBAL ), IERR )</a>
  1034) <a name="l1034" style="background-color: #ffcccc">!</a>
  1035) <a name="l1035" style="background-color: #ffcccc">!     Reduce to upper Hessenberg form</a>
  1036) <a name="l1036" style="background-color: #ffcccc">!     (Workspace: need 3*N, prefer 2*N+N*NB)</a>
  1037) <a name="l1037" style="background-color: #ffcccc">!</a>
  1038) <a name="l1038" style="background-color: #ffcccc">      ITAU = IBAL + N</a>
  1039) <a name="l1039" style="background-color: #ffcccc">      IWRK = ITAU + N</a>
  1040) <a name="l1040" style="background-color: #ffcccc">      CALL SGEHRD( N, ILO, IHI, A, LDA, WORK( ITAU ), WORK( IWRK ), &amp;</a>
  1041) <a name="l1041" style="background-color: #ffcccc">                   LWORK-IWRK+1, IERR )</a>
  1042) <a name="l1042" style="background-color: #ffcccc">!</a>
  1043) <a name="l1043" style="background-color: #ffcccc">      IF( WANTVL ) THEN</a>
  1044) <a name="l1044" style="background-color: #ffcccc">!</a>
  1045) <a name="l1045" style="background-color: #ffcccc">!        Want left eigenvectors</a>
  1046) <a name="l1046" style="background-color: #ffcccc">!        Copy Householder vectors to VL</a>
  1047) <a name="l1047" style="background-color: #ffcccc">!</a>
  1048) <a name="l1048" style="background-color: #ffcccc">         SIDE = 'L'</a>
  1049) <a name="l1049" style="background-color: #ffcccc">         CALL SLACPY( 'L', N, N, A, LDA, VL, LDVL )</a>
  1050) <a name="l1050" style="background-color: #ffcccc">!</a>
  1051) <a name="l1051" style="background-color: #ffcccc">!        Generate orthogonal matrix in VL</a>
  1052) <a name="l1052" style="background-color: #ffcccc">!        (Workspace: need 3*N-1, prefer 2*N+(N-1)*NB)</a>
  1053) <a name="l1053" style="background-color: #ffcccc">!</a>
  1054) <a name="l1054" style="background-color: #ffcccc">         CALL SORGHR( N, ILO, IHI, VL, LDVL, WORK( ITAU ), WORK( IWRK ), &amp;</a>
  1055) <a name="l1055" style="background-color: #ffcccc">                      LWORK-IWRK+1, IERR )</a>
  1056) <a name="l1056" style="background-color: #ffcccc">!</a>
  1057) <a name="l1057" style="background-color: #ffcccc">!        Perform QR iteration, accumulating Schur vectors in VL</a>
  1058) <a name="l1058" style="background-color: #ffcccc">!        (Workspace: need N+1, prefer N+HSWORK (see comments) )</a>
  1059) <a name="l1059" style="background-color: #ffcccc">!</a>
  1060) <a name="l1060" style="background-color: #ffcccc">         IWRK = ITAU</a>
  1061) <a name="l1061" style="background-color: #ffcccc">         CALL SHSEQR( 'S', 'V', N, ILO, IHI, A, LDA, WR, WI, VL, LDVL, &amp;</a>
  1062) <a name="l1062" style="background-color: #ffcccc">                      WORK( IWRK ), LWORK-IWRK+1, INFO )</a>
  1063) <a name="l1063" style="background-color: #ffcccc">!</a>
  1064) <a name="l1064" style="background-color: #ffcccc">         IF( WANTVR ) THEN</a>
  1065) <a name="l1065" style="background-color: #ffcccc">!</a>
  1066) <a name="l1066" style="background-color: #ffcccc">!           Want left and right eigenvectors</a>
  1067) <a name="l1067" style="background-color: #ffcccc">!           Copy Schur vectors to VR</a>
  1068) <a name="l1068" style="background-color: #ffcccc">!</a>
  1069) <a name="l1069" style="background-color: #ffcccc">            SIDE = 'B'</a>
  1070) <a name="l1070" style="background-color: #ffcccc">            CALL SLACPY( 'F', N, N, VL, LDVL, VR, LDVR )</a>
  1071) <a name="l1071" style="background-color: #ffcccc">         END IF</a>
  1072) <a name="l1072" style="background-color: #ffcccc">!</a>
  1073) <a name="l1073" style="background-color: #ffcccc">      ELSE IF( WANTVR ) THEN</a>
  1074) <a name="l1074" style="background-color: #ffcccc">!</a>
  1075) <a name="l1075" style="background-color: #ffcccc">!        Want right eigenvectors</a>
  1076) <a name="l1076" style="background-color: #ffcccc">!        Copy Householder vectors to VR</a>
  1077) <a name="l1077" style="background-color: #ffcccc">!</a>
  1078) <a name="l1078" style="background-color: #ffcccc">         SIDE = 'R'</a>
  1079) <a name="l1079" style="background-color: #ffcccc">         CALL SLACPY( 'L', N, N, A, LDA, VR, LDVR )</a>
  1080) <a name="l1080" style="background-color: #ffcccc">!</a>
  1081) <a name="l1081" style="background-color: #ffcccc">!        Generate orthogonal matrix in VR</a>
  1082) <a name="l1082" style="background-color: #ffcccc">!        (Workspace: need 3*N-1, prefer 2*N+(N-1)*NB)</a>
  1083) <a name="l1083" style="background-color: #ffcccc">!</a>
  1084) <a name="l1084" style="background-color: #ffcccc">         CALL SORGHR( N, ILO, IHI, VR, LDVR, WORK( ITAU ), WORK( IWRK ), &amp;</a>
  1085) <a name="l1085" style="background-color: #ffcccc">                      LWORK-IWRK+1, IERR )</a>
  1086) <a name="l1086" style="background-color: #ffcccc">!</a>
  1087) <a name="l1087" style="background-color: #ffcccc">!        Perform QR iteration, accumulating Schur vectors in VR</a>
  1088) <a name="l1088" style="background-color: #ffcccc">!        (Workspace: need N+1, prefer N+HSWORK (see comments) )</a>
  1089) <a name="l1089" style="background-color: #ffcccc">!</a>
  1090) <a name="l1090" style="background-color: #ffcccc">         IWRK = ITAU</a>
  1091) <a name="l1091" style="background-color: #ffcccc">         CALL SHSEQR( 'S', 'V', N, ILO, IHI, A, LDA, WR, WI, VR, LDVR, &amp;</a>
  1092) <a name="l1092" style="background-color: #ffcccc">                      WORK( IWRK ), LWORK-IWRK+1, INFO )</a>
  1093) <a name="l1093" style="background-color: #ffcccc">!</a>
  1094) <a name="l1094" style="background-color: #ffcccc">      ELSE</a>
  1095) <a name="l1095" style="background-color: #ffcccc">!</a>
  1096) <a name="l1096" style="background-color: #ffcccc">!        Compute eigenvalues only</a>
  1097) <a name="l1097" style="background-color: #ffcccc">!        (Workspace: need N+1, prefer N+HSWORK (see comments) )</a>
  1098) <a name="l1098" style="background-color: #ffcccc">!</a>
  1099) <a name="l1099" style="background-color: #ffcccc">         IWRK = ITAU</a>
  1100) <a name="l1100" style="background-color: #ffcccc">         CALL SHSEQR( 'E', 'N', N, ILO, IHI, A, LDA, WR, WI, VR, LDVR, &amp;</a>
  1101) <a name="l1101" style="background-color: #ffcccc">                      WORK( IWRK ), LWORK-IWRK+1, INFO )</a>
  1102) <a name="l1102" style="background-color: #ffcccc">      END IF</a>
  1103) <a name="l1103" style="background-color: #ffcccc">!</a>
  1104) <a name="l1104" style="background-color: #ffcccc">!     If INFO &gt; 0 from SHSEQR, then quit</a>
  1105) <a name="l1105" style="background-color: #ffcccc">!</a>
  1106) <a name="l1106" style="background-color: #ffcccc">      IF( INFO.GT.0 ) &amp;</a>
  1107) <a name="l1107" style="background-color: #ffcccc">         GO TO 50</a>
  1108) <a name="l1108" style="background-color: #ffcccc">!</a>
  1109) <a name="l1109" style="background-color: #ffcccc">      IF( WANTVL .OR. WANTVR ) THEN</a>
  1110) <a name="l1110" style="background-color: #ffcccc">!</a>
  1111) <a name="l1111" style="background-color: #ffcccc">!        Compute left and/or right eigenvectors</a>
  1112) <a name="l1112" style="background-color: #ffcccc">!        (Workspace: need 4*N)</a>
  1113) <a name="l1113" style="background-color: #ffcccc">!</a>
  1114) <a name="l1114" style="background-color: #ffcccc">         CALL STREVC( SIDE, 'B', SELECT, N, A, LDA, VL, LDVL, VR, LDVR, &amp;</a>
  1115) <a name="l1115" style="background-color: #ffcccc">                      N, NOUT, WORK( IWRK ), IERR )</a>
  1116) <a name="l1116" style="background-color: #ffcccc">      END IF</a>
  1117) <a name="l1117" style="background-color: #ffcccc">!</a>
  1118) <a name="l1118" style="background-color: #ffcccc">      IF( WANTVL ) THEN</a>
  1119) <a name="l1119" style="background-color: #ffcccc">!</a>
  1120) <a name="l1120" style="background-color: #ffcccc">!        Undo balancing of left eigenvectors</a>
  1121) <a name="l1121" style="background-color: #ffcccc">!        (Workspace: need N)</a>
  1122) <a name="l1122" style="background-color: #ffcccc">!</a>
  1123) <a name="l1123" style="background-color: #ffcccc">         CALL SGEBAK( 'B', 'L', N, ILO, IHI, WORK( IBAL ), N, VL, LDVL, &amp;</a>
  1124) <a name="l1124" style="background-color: #ffcccc">                      IERR )</a>
  1125) <a name="l1125" style="background-color: #ffcccc">!</a>
  1126) <a name="l1126" style="background-color: #ffcccc">!        Normalize left eigenvectors and make largest component real</a>
  1127) <a name="l1127" style="background-color: #ffcccc">!</a>
  1128) <a name="l1128" style="background-color: #ffcccc">         DO 20 I = 1, N</a>
  1129) <a name="l1129" style="background-color: #ffcccc">            IF( WI( I ).EQ.ZERO ) THEN</a>
  1130) <a name="l1130" style="background-color: #ffcccc">               SCL = ONE / SNRM2( N, VL( 1, I ), 1 )</a>
  1131) <a name="l1131" style="background-color: #ffcccc">               CALL SSCAL( N, SCL, VL( 1, I ), 1 )</a>
  1132) <a name="l1132" style="background-color: #ffcccc">            ELSE IF( WI( I ).GT.ZERO ) THEN</a>
  1133) <a name="l1133" style="background-color: #ffcccc">               SCL = ONE / SLAPY2( SNRM2( N, VL( 1, I ), 1 ), &amp;</a>
  1134) <a name="l1134" style="background-color: #ffcccc">                     SNRM2( N, VL( 1, I+1 ), 1 ) )</a>
  1135) <a name="l1135" style="background-color: #ffcccc">               CALL SSCAL( N, SCL, VL( 1, I ), 1 )</a>
  1136) <a name="l1136" style="background-color: #ffcccc">               CALL SSCAL( N, SCL, VL( 1, I+1 ), 1 )</a>
  1137) <a name="l1137" style="background-color: #ffcccc">               DO 10 K = 1, N</a>
  1138) <a name="l1138" style="background-color: #ffcccc">                  WORK( IWRK+K-1 ) = VL( K, I )**2 + VL( K, I+1 )**2</a>
  1139) <a name="l1139" style="background-color: #ffcccc">   10          CONTINUE</a>
  1140) <a name="l1140" style="background-color: #ffcccc">               K = ISAMAX( N, WORK( IWRK ), 1 )</a>
  1141) <a name="l1141" style="background-color: #ffcccc">               CALL SLARTG( VL( K, I ), VL( K, I+1 ), CS, SN, R )</a>
  1142) <a name="l1142" style="background-color: #ffcccc">               CALL SROT( N, VL( 1, I ), 1, VL( 1, I+1 ), 1, CS, SN )</a>
  1143) <a name="l1143" style="background-color: #ffcccc">               VL( K, I+1 ) = ZERO</a>
  1144) <a name="l1144" style="background-color: #ffcccc">            END IF</a>
  1145) <a name="l1145" style="background-color: #ffcccc">   20    CONTINUE</a>
  1146) <a name="l1146" style="background-color: #ffcccc">      END IF</a>
  1147) <a name="l1147" style="background-color: #ffcccc">!</a>
  1148) <a name="l1148" style="background-color: #ffcccc">      IF( WANTVR ) THEN</a>
  1149) <a name="l1149" style="background-color: #ffcccc">!</a>
  1150) <a name="l1150" style="background-color: #ffcccc">!        Undo balancing of right eigenvectors</a>
  1151) <a name="l1151" style="background-color: #ffcccc">!        (Workspace: need N)</a>
  1152) <a name="l1152" style="background-color: #ffcccc">!</a>
  1153) <a name="l1153" style="background-color: #ffcccc">         CALL SGEBAK( 'B', 'R', N, ILO, IHI, WORK( IBAL ), N, VR, LDVR, &amp;</a>
  1154) <a name="l1154" style="background-color: #ffcccc">                      IERR )</a>
  1155) <a name="l1155" style="background-color: #ffcccc">!</a>
  1156) <a name="l1156" style="background-color: #ffcccc">!        Normalize right eigenvectors and make largest component real</a>
  1157) <a name="l1157" style="background-color: #ffcccc">!</a>
  1158) <a name="l1158" style="background-color: #ffcccc">         DO 40 I = 1, N</a>
  1159) <a name="l1159" style="background-color: #ffcccc">            IF( WI( I ).EQ.ZERO ) THEN</a>
  1160) <a name="l1160" style="background-color: #ffcccc">               SCL = ONE / SNRM2( N, VR( 1, I ), 1 )</a>
  1161) <a name="l1161" style="background-color: #ffcccc">               CALL SSCAL( N, SCL, VR( 1, I ), 1 )</a>
  1162) <a name="l1162" style="background-color: #ffcccc">            ELSE IF( WI( I ).GT.ZERO ) THEN</a>
  1163) <a name="l1163" style="background-color: #ffcccc">               SCL = ONE / SLAPY2( SNRM2( N, VR( 1, I ), 1 ), &amp;</a>
  1164) <a name="l1164" style="background-color: #ffcccc">                     SNRM2( N, VR( 1, I+1 ), 1 ) )</a>
  1165) <a name="l1165" style="background-color: #ffcccc">               CALL SSCAL( N, SCL, VR( 1, I ), 1 )</a>
  1166) <a name="l1166" style="background-color: #ffcccc">               CALL SSCAL( N, SCL, VR( 1, I+1 ), 1 )</a>
  1167) <a name="l1167" style="background-color: #ffcccc">               DO 30 K = 1, N</a>
  1168) <a name="l1168" style="background-color: #ffcccc">                  WORK( IWRK+K-1 ) = VR( K, I )**2 + VR( K, I+1 )**2</a>
  1169) <a name="l1169" style="background-color: #ffcccc">   30          CONTINUE</a>
  1170) <a name="l1170" style="background-color: #ffcccc">               K = ISAMAX( N, WORK( IWRK ), 1 )</a>
  1171) <a name="l1171" style="background-color: #ffcccc">               CALL SLARTG( VR( K, I ), VR( K, I+1 ), CS, SN, R )</a>
  1172) <a name="l1172" style="background-color: #ffcccc">               CALL SROT( N, VR( 1, I ), 1, VR( 1, I+1 ), 1, CS, SN )</a>
  1173) <a name="l1173" style="background-color: #ffcccc">               VR( K, I+1 ) = ZERO</a>
  1174) <a name="l1174" style="background-color: #ffcccc">            END IF</a>
  1175) <a name="l1175" style="background-color: #ffcccc">   40    CONTINUE</a>
  1176) <a name="l1176" style="background-color: #ffcccc">      END IF</a>
  1177) <a name="l1177" style="background-color: #ffcccc">!</a>
  1178) <a name="l1178" style="background-color: #ffcccc">!     Undo scaling if necessary</a>
  1179) <a name="l1179" style="background-color: #ffcccc">!</a>
  1180) <a name="l1180" style="background-color: #ffcccc">   50 CONTINUE</a>
  1181) <a name="l1181" style="background-color: #ffcccc">      IF( SCALEA ) THEN</a>
  1182) <a name="l1182" style="background-color: #ffcccc">         CALL SLASCL( 'G', 0, 0, CSCALE, ANRM, N-INFO, 1, WR( INFO+1 ), &amp;</a>
  1183) <a name="l1183" style="background-color: #ffcccc">                      MAX( N-INFO, 1 ), IERR )</a>
  1184) <a name="l1184" style="background-color: #ffcccc">         CALL SLASCL( 'G', 0, 0, CSCALE, ANRM, N-INFO, 1, WI( INFO+1 ), &amp;</a>
  1185) <a name="l1185" style="background-color: #ffcccc">                      MAX( N-INFO, 1 ), IERR )</a>
  1186) <a name="l1186" style="background-color: #ffcccc">         IF( INFO.GT.0 ) THEN</a>
  1187) <a name="l1187" style="background-color: #ffcccc">            CALL SLASCL( 'G', 0, 0, CSCALE, ANRM, ILO-1, 1, WR, N, &amp;</a>
  1188) <a name="l1188" style="background-color: #ffcccc">                         IERR )</a>
  1189) <a name="l1189" style="background-color: #ffcccc">            CALL SLASCL( 'G', 0, 0, CSCALE, ANRM, ILO-1, 1, WI, N, &amp;</a>
  1190) <a name="l1190" style="background-color: #ffcccc">                         IERR )</a>
  1191) <a name="l1191" style="background-color: #ffcccc">         END IF</a>
  1192) <a name="l1192" style="background-color: #ffcccc">      END IF</a>
  1193) <a name="l1193" style="background-color: #ffcccc">!</a>
  1194) <a name="l1194" style="background-color: #ffcccc">      WORK( 1 ) = MAXWRK</a>
  1195) <a name="l1195" style="background-color: #ffcccc">      RETURN</a>
  1196) <a name="l1196" style="background-color: #ffcccc">!</a>
  1197) <a name="l1197" style="background-color: #ffcccc">!     End of SGEEV</a>
  1198) <a name="l1198" style="background-color: #ffcccc">!</a>
  1199) <a name="l1199" style="background-color: #ffcccc">      END SUBROUTINE SGEEV</a>
  1200) <a name="l1200" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
  1201) <a name="l1201" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  1202) <a name="l1202" style="background-color: #ffffff"></a>
  1203) <a name="l1203" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SGEBAK( JOB, SIDE, N, ILO, IHI, SCALE, M, V, LDV, &amp;</a>
  1204) <a name="l1204" style="background-color: #ffcccc">                         INFO )</a>
  1205) <a name="l1205" style="background-color: #ffcccc"></a>
  1206) <a name="l1206" style="background-color: #ffcccc">!</a>
  1207) <a name="l1207" style="background-color: #ffcccc">!  -- LAPACK routine (version 2.0) --</a>
  1208) <a name="l1208" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  1209) <a name="l1209" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  1210) <a name="l1210" style="background-color: #ffcccc">!     September 30, 1994</a>
  1211) <a name="l1211" style="background-color: #ffcccc">!</a>
  1212) <a name="l1212" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  1213) <a name="l1213" style="background-color: #ffcccc">      CHARACTER          JOB, SIDE</a>
  1214) <a name="l1214" style="background-color: #ffcccc">      INTEGER            IHI, ILO, INFO, LDV, M, N</a>
  1215) <a name="l1215" style="background-color: #ffcccc">!     ..</a>
  1216) <a name="l1216" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  1217) <a name="l1217" style="background-color: #ffcccc">      REAL(r8)               V( LDV, * ), SCALE( * )</a>
  1218) <a name="l1218" style="background-color: #ffcccc">!     ..</a>
  1219) <a name="l1219" style="background-color: #ffcccc">!</a>
  1220) <a name="l1220" style="background-color: #ffcccc">!  Purpose</a>
  1221) <a name="l1221" style="background-color: #ffcccc">!  =======</a>
  1222) <a name="l1222" style="background-color: #ffcccc">!</a>
  1223) <a name="l1223" style="background-color: #ffcccc">!  SGEBAK forms the right or left eigenvectors of a real general matrix</a>
  1224) <a name="l1224" style="background-color: #ffcccc">!  by backward transformation on the computed eigenvectors of the</a>
  1225) <a name="l1225" style="background-color: #ffcccc">!  balanced matrix output by SGEBAL.</a>
  1226) <a name="l1226" style="background-color: #ffcccc">!</a>
  1227) <a name="l1227" style="background-color: #ffcccc">!  Arguments</a>
  1228) <a name="l1228" style="background-color: #ffcccc">!  =========</a>
  1229) <a name="l1229" style="background-color: #ffcccc">!</a>
  1230) <a name="l1230" style="background-color: #ffcccc">!  JOB     (input) CHARACTER*1</a>
  1231) <a name="l1231" style="background-color: #ffcccc">!          Specifies the type of backward transformation required:</a>
  1232) <a name="l1232" style="background-color: #ffcccc">!          = 'N', do nothing, return immediately;</a>
  1233) <a name="l1233" style="background-color: #ffcccc">!          = 'P', do backward transformation for permutation only;</a>
  1234) <a name="l1234" style="background-color: #ffcccc">!          = 'S', do backward transformation for scaling only;</a>
  1235) <a name="l1235" style="background-color: #ffcccc">!          = 'B', do backward transformations for both permutation and</a>
  1236) <a name="l1236" style="background-color: #ffcccc">!                 scaling.</a>
  1237) <a name="l1237" style="background-color: #ffcccc">!          JOB must be the same as the argument JOB supplied to SGEBAL.</a>
  1238) <a name="l1238" style="background-color: #ffcccc">!</a>
  1239) <a name="l1239" style="background-color: #ffcccc">!  SIDE    (input) CHARACTER*1</a>
  1240) <a name="l1240" style="background-color: #ffcccc">!          = 'R':  V contains right eigenvectors;</a>
  1241) <a name="l1241" style="background-color: #ffcccc">!          = 'L':  V contains left eigenvectors.</a>
  1242) <a name="l1242" style="background-color: #ffcccc">!</a>
  1243) <a name="l1243" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  1244) <a name="l1244" style="background-color: #ffcccc">!          The number of rows of the matrix V.  N &gt;= 0.</a>
  1245) <a name="l1245" style="background-color: #ffcccc">!</a>
  1246) <a name="l1246" style="background-color: #ffcccc">!  ILO     (input) INTEGER</a>
  1247) <a name="l1247" style="background-color: #ffcccc">!  IHI     (input) INTEGER</a>
  1248) <a name="l1248" style="background-color: #ffcccc">!          The integers ILO and IHI determined by SGEBAL.</a>
  1249) <a name="l1249" style="background-color: #ffcccc">!          1 &lt;= ILO &lt;= IHI &lt;= N, if N &gt; 0; ILO=1 and IHI=0, if N=0.</a>
  1250) <a name="l1250" style="background-color: #ffcccc">!</a>
  1251) <a name="l1251" style="background-color: #ffcccc">!  SCALE   (input) REAL array, dimension (N)</a>
  1252) <a name="l1252" style="background-color: #ffcccc">!          Details of the permutation and scaling factors, as returned</a>
  1253) <a name="l1253" style="background-color: #ffcccc">!          by SGEBAL.</a>
  1254) <a name="l1254" style="background-color: #ffcccc">!</a>
  1255) <a name="l1255" style="background-color: #ffcccc">!  M       (input) INTEGER</a>
  1256) <a name="l1256" style="background-color: #ffcccc">!          The number of columns of the matrix V.  M &gt;= 0.</a>
  1257) <a name="l1257" style="background-color: #ffcccc">!</a>
  1258) <a name="l1258" style="background-color: #ffcccc">!  V       (input/output) REAL array, dimension (LDV,M)</a>
  1259) <a name="l1259" style="background-color: #ffcccc">!          On entry, the matrix of right or left eigenvectors to be</a>
  1260) <a name="l1260" style="background-color: #ffcccc">!          transformed, as returned by SHSEIN or STREVC.</a>
  1261) <a name="l1261" style="background-color: #ffcccc">!          On exit, V is overwritten by the transformed eigenvectors.</a>
  1262) <a name="l1262" style="background-color: #ffcccc">!</a>
  1263) <a name="l1263" style="background-color: #ffcccc">!  LDV     (input) INTEGER</a>
  1264) <a name="l1264" style="background-color: #ffcccc">!          The leading dimension of the array V. LDV &gt;= max(1,N).</a>
  1265) <a name="l1265" style="background-color: #ffcccc">!</a>
  1266) <a name="l1266" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  1267) <a name="l1267" style="background-color: #ffcccc">!          = 0:  successful exit</a>
  1268) <a name="l1268" style="background-color: #ffcccc">!          &lt; 0:  if INFO = -i, the i-th argument had an illegal value.</a>
  1269) <a name="l1269" style="background-color: #ffcccc">!</a>
  1270) <a name="l1270" style="background-color: #ffcccc">!  =====================================================================</a>
  1271) <a name="l1271" style="background-color: #ffcccc">!</a>
  1272) <a name="l1272" style="background-color: #ffcccc">!     .. Parameters ..</a>
  1273) <a name="l1273" style="background-color: #ffcccc">      REAL(r8)               ONE</a>
  1274) <a name="l1274" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E+0_r8 )</a>
  1275) <a name="l1275" style="background-color: #ffcccc">!     ..</a>
  1276) <a name="l1276" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  1277) <a name="l1277" style="background-color: #ffcccc">      LOGICAL            LEFTV, RIGHTV</a>
  1278) <a name="l1278" style="background-color: #ffcccc">      INTEGER            I, II, K</a>
  1279) <a name="l1279" style="background-color: #ffcccc">      REAL(r8)               S</a>
  1280) <a name="l1280" style="background-color: #ffcccc">!     ..</a>
  1281) <a name="l1281" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  1282) <a name="l1282" style="background-color: #ffcccc">!</a>
  1283) <a name="l1283" style="background-color: #ffcccc">!     Decode and Test the input parameters</a>
  1284) <a name="l1284" style="background-color: #ffcccc">!</a>
  1285) <a name="l1285" style="background-color: #ffcccc">      RIGHTV = LSAME( SIDE, 'R' )</a>
  1286) <a name="l1286" style="background-color: #ffcccc">      LEFTV = LSAME( SIDE, 'L' )</a>
  1287) <a name="l1287" style="background-color: #ffcccc">!</a>
  1288) <a name="l1288" style="background-color: #ffcccc">      INFO = 0</a>
  1289) <a name="l1289" style="background-color: #ffcccc">      IF( .NOT.LSAME( JOB, 'N' ) .AND. .NOT.LSAME( JOB, 'P' ) .AND. &amp;</a>
  1290) <a name="l1290" style="background-color: #ffcccc">          .NOT.LSAME( JOB, 'S' ) .AND. .NOT.LSAME( JOB, 'B' ) ) THEN</a>
  1291) <a name="l1291" style="background-color: #ffcccc">         INFO = -1</a>
  1292) <a name="l1292" style="background-color: #ffcccc">      ELSE IF( .NOT.RIGHTV .AND. .NOT.LEFTV ) THEN</a>
  1293) <a name="l1293" style="background-color: #ffcccc">         INFO = -2</a>
  1294) <a name="l1294" style="background-color: #ffcccc">      ELSE IF( N.LT.0 ) THEN</a>
  1295) <a name="l1295" style="background-color: #ffcccc">         INFO = -3</a>
  1296) <a name="l1296" style="background-color: #ffcccc">      ELSE IF( ILO.LT.1 .OR. ILO.GT.MAX( 1, N ) ) THEN</a>
  1297) <a name="l1297" style="background-color: #ffcccc">         INFO = -4</a>
  1298) <a name="l1298" style="background-color: #ffcccc">      ELSE IF( IHI.LT.MIN( ILO, N ) .OR. IHI.GT.N ) THEN</a>
  1299) <a name="l1299" style="background-color: #ffcccc">         INFO = -5</a>
  1300) <a name="l1300" style="background-color: #ffcccc">      ELSE IF( M.LT.0 ) THEN</a>
  1301) <a name="l1301" style="background-color: #ffcccc">         INFO = -7</a>
  1302) <a name="l1302" style="background-color: #ffcccc">      ELSE IF( LDV.LT.MAX( 1, N ) ) THEN</a>
  1303) <a name="l1303" style="background-color: #ffcccc">         INFO = -9</a>
  1304) <a name="l1304" style="background-color: #ffcccc">      END IF</a>
  1305) <a name="l1305" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
  1306) <a name="l1306" style="background-color: #ffcccc">         CALL XERBLA( 'SGEBAK', -INFO )</a>
  1307) <a name="l1307" style="background-color: #ffcccc">         RETURN</a>
  1308) <a name="l1308" style="background-color: #ffcccc">      END IF</a>
  1309) <a name="l1309" style="background-color: #ffcccc">!</a>
  1310) <a name="l1310" style="background-color: #ffcccc">!     Quick return if possible</a>
  1311) <a name="l1311" style="background-color: #ffcccc">!</a>
  1312) <a name="l1312" style="background-color: #ffcccc">      IF( N.EQ.0 ) &amp;</a>
  1313) <a name="l1313" style="background-color: #ffcccc">         RETURN</a>
  1314) <a name="l1314" style="background-color: #ffcccc">      IF( M.EQ.0 ) &amp;</a>
  1315) <a name="l1315" style="background-color: #ffcccc">         RETURN</a>
  1316) <a name="l1316" style="background-color: #ffcccc">      IF( LSAME( JOB, 'N' ) ) &amp;</a>
  1317) <a name="l1317" style="background-color: #ffcccc">         RETURN</a>
  1318) <a name="l1318" style="background-color: #ffcccc">!</a>
  1319) <a name="l1319" style="background-color: #ffcccc">      IF( ILO.EQ.IHI ) &amp;</a>
  1320) <a name="l1320" style="background-color: #ffcccc">         GO TO 30</a>
  1321) <a name="l1321" style="background-color: #ffcccc">!</a>
  1322) <a name="l1322" style="background-color: #ffcccc">!     Backward balance</a>
  1323) <a name="l1323" style="background-color: #ffcccc">!</a>
  1324) <a name="l1324" style="background-color: #ffcccc">      IF( LSAME( JOB, 'S' ) .OR. LSAME( JOB, 'B' ) ) THEN</a>
  1325) <a name="l1325" style="background-color: #ffcccc">!</a>
  1326) <a name="l1326" style="background-color: #ffcccc">         IF( RIGHTV ) THEN</a>
  1327) <a name="l1327" style="background-color: #ffcccc">            DO 10 I = ILO, IHI</a>
  1328) <a name="l1328" style="background-color: #ffcccc">               S = SCALE( I )</a>
  1329) <a name="l1329" style="background-color: #ffcccc">               CALL SSCAL( M, S, V( I, 1 ), LDV )</a>
  1330) <a name="l1330" style="background-color: #ffcccc">   10       CONTINUE</a>
  1331) <a name="l1331" style="background-color: #ffcccc">         END IF</a>
  1332) <a name="l1332" style="background-color: #ffcccc">!</a>
  1333) <a name="l1333" style="background-color: #ffcccc">         IF( LEFTV ) THEN</a>
  1334) <a name="l1334" style="background-color: #ffcccc">            DO 20 I = ILO, IHI</a>
  1335) <a name="l1335" style="background-color: #ffcccc">               S = ONE / SCALE( I )</a>
  1336) <a name="l1336" style="background-color: #ffcccc">               CALL SSCAL( M, S, V( I, 1 ), LDV )</a>
  1337) <a name="l1337" style="background-color: #ffcccc">   20       CONTINUE</a>
  1338) <a name="l1338" style="background-color: #ffcccc">         END IF</a>
  1339) <a name="l1339" style="background-color: #ffcccc">!</a>
  1340) <a name="l1340" style="background-color: #ffcccc">      END IF</a>
  1341) <a name="l1341" style="background-color: #ffcccc">!</a>
  1342) <a name="l1342" style="background-color: #ffcccc">!     Backward permutation</a>
  1343) <a name="l1343" style="background-color: #ffcccc">!</a>
  1344) <a name="l1344" style="background-color: #ffcccc">!     For  I = ILO-1 step -1 until 1,</a>
  1345) <a name="l1345" style="background-color: #ffcccc">!              IHI+1 step 1 until N do --</a>
  1346) <a name="l1346" style="background-color: #ffcccc">!</a>
  1347) <a name="l1347" style="background-color: #ffcccc">   30 CONTINUE</a>
  1348) <a name="l1348" style="background-color: #ffcccc">      IF( LSAME( JOB, 'P' ) .OR. LSAME( JOB, 'B' ) ) THEN</a>
  1349) <a name="l1349" style="background-color: #ffcccc">         IF( RIGHTV ) THEN</a>
  1350) <a name="l1350" style="background-color: #ffcccc">            DO 40 II = 1, N</a>
  1351) <a name="l1351" style="background-color: #ffcccc">               I = II</a>
  1352) <a name="l1352" style="background-color: #ffcccc">               IF( I.GE.ILO .AND. I.LE.IHI ) &amp;</a>
  1353) <a name="l1353" style="background-color: #ffcccc">                  GO TO 40</a>
  1354) <a name="l1354" style="background-color: #ffcccc">               IF( I.LT.ILO ) &amp;</a>
  1355) <a name="l1355" style="background-color: #ffcccc">                  I = ILO - II</a>
  1356) <a name="l1356" style="background-color: #ffcccc">               K = SCALE( I )</a>
  1357) <a name="l1357" style="background-color: #ffcccc">               IF( K.EQ.I ) &amp;</a>
  1358) <a name="l1358" style="background-color: #ffcccc">                  GO TO 40</a>
  1359) <a name="l1359" style="background-color: #ffcccc">               CALL SSWAP( M, V( I, 1 ), LDV, V( K, 1 ), LDV )</a>
  1360) <a name="l1360" style="background-color: #ffcccc">   40       CONTINUE</a>
  1361) <a name="l1361" style="background-color: #ffcccc">         END IF</a>
  1362) <a name="l1362" style="background-color: #ffcccc">!</a>
  1363) <a name="l1363" style="background-color: #ffcccc">         IF( LEFTV ) THEN</a>
  1364) <a name="l1364" style="background-color: #ffcccc">            DO 50 II = 1, N</a>
  1365) <a name="l1365" style="background-color: #ffcccc">               I = II</a>
  1366) <a name="l1366" style="background-color: #ffcccc">               IF( I.GE.ILO .AND. I.LE.IHI ) &amp;</a>
  1367) <a name="l1367" style="background-color: #ffcccc">                  GO TO 50</a>
  1368) <a name="l1368" style="background-color: #ffcccc">               IF( I.LT.ILO ) &amp;</a>
  1369) <a name="l1369" style="background-color: #ffcccc">                  I = ILO - II</a>
  1370) <a name="l1370" style="background-color: #ffcccc">               K = SCALE( I )</a>
  1371) <a name="l1371" style="background-color: #ffcccc">               IF( K.EQ.I ) &amp;</a>
  1372) <a name="l1372" style="background-color: #ffcccc">                  GO TO 50</a>
  1373) <a name="l1373" style="background-color: #ffcccc">               CALL SSWAP( M, V( I, 1 ), LDV, V( K, 1 ), LDV )</a>
  1374) <a name="l1374" style="background-color: #ffcccc">   50       CONTINUE</a>
  1375) <a name="l1375" style="background-color: #ffcccc">         END IF</a>
  1376) <a name="l1376" style="background-color: #ffcccc">      END IF</a>
  1377) <a name="l1377" style="background-color: #ffcccc">!</a>
  1378) <a name="l1378" style="background-color: #ffcccc">      RETURN</a>
  1379) <a name="l1379" style="background-color: #ffcccc">!</a>
  1380) <a name="l1380" style="background-color: #ffcccc">!     End of SGEBAK </a>
  1381) <a name="l1381" style="background-color: #ffcccc">!</a>
  1382) <a name="l1382" style="background-color: #ffcccc">      END SUBROUTINE SGEBAK</a>
  1383) <a name="l1383" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
  1384) <a name="l1384" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  1385) <a name="l1385" style="background-color: #ffffff"></a>
  1386) <a name="l1386" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SGEBAL( JOB, N, A, LDA, ILO, IHI, SCALE, INFO )</a>
  1387) <a name="l1387" style="background-color: #ffcccc"></a>
  1388) <a name="l1388" style="background-color: #ffcccc">!</a>
  1389) <a name="l1389" style="background-color: #ffcccc">!  -- LAPACK routine (version 2.0) --</a>
  1390) <a name="l1390" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  1391) <a name="l1391" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  1392) <a name="l1392" style="background-color: #ffcccc">!     September 30, 1994</a>
  1393) <a name="l1393" style="background-color: #ffcccc">!</a>
  1394) <a name="l1394" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  1395) <a name="l1395" style="background-color: #ffcccc">      CHARACTER          JOB</a>
  1396) <a name="l1396" style="background-color: #ffcccc">      INTEGER            IHI, ILO, INFO, LDA, N</a>
  1397) <a name="l1397" style="background-color: #ffcccc">!     ..</a>
  1398) <a name="l1398" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  1399) <a name="l1399" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), SCALE( * )</a>
  1400) <a name="l1400" style="background-color: #ffcccc">!     ..</a>
  1401) <a name="l1401" style="background-color: #ffcccc">!</a>
  1402) <a name="l1402" style="background-color: #ffcccc">!  Purpose</a>
  1403) <a name="l1403" style="background-color: #ffcccc">!  =======</a>
  1404) <a name="l1404" style="background-color: #ffcccc">!</a>
  1405) <a name="l1405" style="background-color: #ffcccc">!  SGEBAL balances a general real matrix A.  This involves, first,</a>
  1406) <a name="l1406" style="background-color: #ffcccc">!  permuting A by a similarity transformation to isolate eigenvalues</a>
  1407) <a name="l1407" style="background-color: #ffcccc">!  in the first 1 to ILO-1 and last IHI+1 to N elements on the</a>
  1408) <a name="l1408" style="background-color: #ffcccc">!  diagonal; and second, applying a diagonal similarity transformation</a>
  1409) <a name="l1409" style="background-color: #ffcccc">!  to rows and columns ILO to IHI to make the rows and columns as</a>
  1410) <a name="l1410" style="background-color: #ffcccc">!  close in norm as possible.  Both steps are optional.</a>
  1411) <a name="l1411" style="background-color: #ffcccc">!</a>
  1412) <a name="l1412" style="background-color: #ffcccc">!  Balancing may reduce the 1-norm of the matrix, and improve the</a>
  1413) <a name="l1413" style="background-color: #ffcccc">!  accuracy of the computed eigenvalues and/or eigenvectors.</a>
  1414) <a name="l1414" style="background-color: #ffcccc">!</a>
  1415) <a name="l1415" style="background-color: #ffcccc">!  Arguments</a>
  1416) <a name="l1416" style="background-color: #ffcccc">!  =========</a>
  1417) <a name="l1417" style="background-color: #ffcccc">!</a>
  1418) <a name="l1418" style="background-color: #ffcccc">!  JOB     (input) CHARACTER*1</a>
  1419) <a name="l1419" style="background-color: #ffcccc">!          Specifies the operations to be performed on A:</a>
  1420) <a name="l1420" style="background-color: #ffcccc">!          = 'N':  none:  simply set ILO = 1, IHI = N, SCALE(I) = 1.0</a>
  1421) <a name="l1421" style="background-color: #ffcccc">!                  for i = 1,...,N;</a>
  1422) <a name="l1422" style="background-color: #ffcccc">!          = 'P':  permute only;</a>
  1423) <a name="l1423" style="background-color: #ffcccc">!          = 'S':  scale only;</a>
  1424) <a name="l1424" style="background-color: #ffcccc">!          = 'B':  both permute and scale.</a>
  1425) <a name="l1425" style="background-color: #ffcccc">!</a>
  1426) <a name="l1426" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  1427) <a name="l1427" style="background-color: #ffcccc">!          The order of the matrix A.  N &gt;= 0.</a>
  1428) <a name="l1428" style="background-color: #ffcccc">!</a>
  1429) <a name="l1429" style="background-color: #ffcccc">!  A       (input/output) REAL array, dimension (LDA,N)</a>
  1430) <a name="l1430" style="background-color: #ffcccc">!          On entry, the input matrix A.</a>
  1431) <a name="l1431" style="background-color: #ffcccc">!          On exit,  A is overwritten by the balanced matrix.</a>
  1432) <a name="l1432" style="background-color: #ffcccc">!          If JOB = 'N', A is not referenced.</a>
  1433) <a name="l1433" style="background-color: #ffcccc">!          See Further Details.</a>
  1434) <a name="l1434" style="background-color: #ffcccc">!</a>
  1435) <a name="l1435" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  1436) <a name="l1436" style="background-color: #ffcccc">!          The leading dimension of the array A.  LDA &gt;= max(1,N).</a>
  1437) <a name="l1437" style="background-color: #ffcccc">!</a>
  1438) <a name="l1438" style="background-color: #ffcccc">!  ILO     (output) INTEGER</a>
  1439) <a name="l1439" style="background-color: #ffcccc">!  IHI     (output) INTEGER</a>
  1440) <a name="l1440" style="background-color: #ffcccc">!          ILO and IHI are set to integers such that on exit</a>
  1441) <a name="l1441" style="background-color: #ffcccc">!          A(i,j) = 0 if i &gt; j and j = 1,...,ILO-1 or I = IHI+1,...,N.</a>
  1442) <a name="l1442" style="background-color: #ffcccc">!          If JOB = 'N' or 'S', ILO = 1 and IHI = N.</a>
  1443) <a name="l1443" style="background-color: #ffcccc">!</a>
  1444) <a name="l1444" style="background-color: #ffcccc">!  SCALE   (output) REAL array, dimension (N)</a>
  1445) <a name="l1445" style="background-color: #ffcccc">!          Details of the permutations and scaling factors applied to</a>
  1446) <a name="l1446" style="background-color: #ffcccc">!          A.  If P(j) is the index of the row and column interchanged</a>
  1447) <a name="l1447" style="background-color: #ffcccc">!          with row and column j and D(j) is the scaling factor</a>
  1448) <a name="l1448" style="background-color: #ffcccc">!          applied to row and column j, then</a>
  1449) <a name="l1449" style="background-color: #ffcccc">!          SCALE(j) = P(j)    for j = 1,...,ILO-1</a>
  1450) <a name="l1450" style="background-color: #ffcccc">!                   = D(j)    for j = ILO,...,IHI</a>
  1451) <a name="l1451" style="background-color: #ffcccc">!                   = P(j)    for j = IHI+1,...,N.</a>
  1452) <a name="l1452" style="background-color: #ffcccc">!          The order in which the interchanges are made is N to IHI+1,</a>
  1453) <a name="l1453" style="background-color: #ffcccc">!          then 1 to ILO-1.</a>
  1454) <a name="l1454" style="background-color: #ffcccc">!</a>
  1455) <a name="l1455" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  1456) <a name="l1456" style="background-color: #ffcccc">!          = 0:  successful exit.</a>
  1457) <a name="l1457" style="background-color: #ffcccc">!          &lt; 0:  if INFO = -i, the i-th argument had an illegal value.</a>
  1458) <a name="l1458" style="background-color: #ffcccc">!</a>
  1459) <a name="l1459" style="background-color: #ffcccc">!  Further Details</a>
  1460) <a name="l1460" style="background-color: #ffcccc">!  ===============</a>
  1461) <a name="l1461" style="background-color: #ffcccc">!</a>
  1462) <a name="l1462" style="background-color: #ffcccc">!  The permutations consist of row and column interchanges which put</a>
  1463) <a name="l1463" style="background-color: #ffcccc">!  the matrix in the form</a>
  1464) <a name="l1464" style="background-color: #ffcccc">!</a>
  1465) <a name="l1465" style="background-color: #ffcccc">!             ( T1   X   Y  )</a>
  1466) <a name="l1466" style="background-color: #ffcccc">!     P A P = (  0   B   Z  )</a>
  1467) <a name="l1467" style="background-color: #ffcccc">!             (  0   0   T2 )</a>
  1468) <a name="l1468" style="background-color: #ffcccc">!</a>
  1469) <a name="l1469" style="background-color: #ffcccc">!  where T1 and T2 are upper triangular matrices whose eigenvalues lie</a>
  1470) <a name="l1470" style="background-color: #ffcccc">!  along the diagonal.  The column indices ILO and IHI mark the starting</a>
  1471) <a name="l1471" style="background-color: #ffcccc">!  and ending columns of the submatrix B. Balancing consists of applying</a>
  1472) <a name="l1472" style="background-color: #ffcccc">!  a diagonal similarity transformation inv(D) * B * D to make the</a>
  1473) <a name="l1473" style="background-color: #ffcccc">!  1-norms of each row of B and its corresponding column nearly equal.</a>
  1474) <a name="l1474" style="background-color: #ffcccc">!  The output matrix is</a>
  1475) <a name="l1475" style="background-color: #ffcccc">!</a>
  1476) <a name="l1476" style="background-color: #ffcccc">!     ( T1     X*D          Y    )</a>
  1477) <a name="l1477" style="background-color: #ffcccc">!     (  0  inv(D)*B*D  inv(D)*Z ).</a>
  1478) <a name="l1478" style="background-color: #ffcccc">!     (  0      0           T2   )</a>
  1479) <a name="l1479" style="background-color: #ffcccc">!</a>
  1480) <a name="l1480" style="background-color: #ffcccc">!  Information about the permutations P and the diagonal matrix D is</a>
  1481) <a name="l1481" style="background-color: #ffcccc">!  returned in the vector SCALE.</a>
  1482) <a name="l1482" style="background-color: #ffcccc">!</a>
  1483) <a name="l1483" style="background-color: #ffcccc">!  This subroutine is based on the EISPACK routine BALANC.</a>
  1484) <a name="l1484" style="background-color: #ffcccc">!</a>
  1485) <a name="l1485" style="background-color: #ffcccc">!  =====================================================================</a>
  1486) <a name="l1486" style="background-color: #ffcccc">!</a>
  1487) <a name="l1487" style="background-color: #ffcccc">!     .. Parameters ..</a>
  1488) <a name="l1488" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
  1489) <a name="l1489" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8, ONE = 1.0E+0_r8 )</a>
  1490) <a name="l1490" style="background-color: #ffcccc">      REAL(r8)               SCLFAC</a>
  1491) <a name="l1491" style="background-color: #ffcccc">      PARAMETER          ( SCLFAC = 1.0E+1_r8 )</a>
  1492) <a name="l1492" style="background-color: #ffcccc">      REAL(r8)               FACTOR</a>
  1493) <a name="l1493" style="background-color: #ffcccc">      PARAMETER          ( FACTOR = 0.95E+0_r8 )</a>
  1494) <a name="l1494" style="background-color: #ffcccc">!     ..</a>
  1495) <a name="l1495" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  1496) <a name="l1496" style="background-color: #ffcccc">      LOGICAL            NOCONV</a>
  1497) <a name="l1497" style="background-color: #ffcccc">      INTEGER            I, ICA, IEXC, IRA, J, K, L, M</a>
  1498) <a name="l1498" style="background-color: #ffcccc">      REAL(r8)               C, CA, F, G, R, RA, S, SFMAX1, SFMAX2, SFMIN1, &amp;</a>
  1499) <a name="l1499" style="background-color: #ffcccc">                         SFMIN2</a>
  1500) <a name="l1500" style="background-color: #ffcccc">!     ..</a>
  1501) <a name="l1501" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  1502) <a name="l1502" style="background-color: #ffcccc">!</a>
  1503) <a name="l1503" style="background-color: #ffcccc">!     Test the input parameters</a>
  1504) <a name="l1504" style="background-color: #ffcccc">!</a>
  1505) <a name="l1505" style="background-color: #ffcccc">      INFO = 0</a>
  1506) <a name="l1506" style="background-color: #ffcccc">      IF( .NOT.LSAME( JOB, 'N' ) .AND. .NOT.LSAME( JOB, 'P' ) .AND. &amp;</a>
  1507) <a name="l1507" style="background-color: #ffcccc">          .NOT.LSAME( JOB, 'S' ) .AND. .NOT.LSAME( JOB, 'B' ) ) THEN</a>
  1508) <a name="l1508" style="background-color: #ffcccc">         INFO = -1</a>
  1509) <a name="l1509" style="background-color: #ffcccc">      ELSE IF( N.LT.0 ) THEN</a>
  1510) <a name="l1510" style="background-color: #ffcccc">         INFO = -2</a>
  1511) <a name="l1511" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, N ) ) THEN</a>
  1512) <a name="l1512" style="background-color: #ffcccc">         INFO = -4</a>
  1513) <a name="l1513" style="background-color: #ffcccc">      END IF</a>
  1514) <a name="l1514" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
  1515) <a name="l1515" style="background-color: #ffcccc">         CALL XERBLA( 'SGEBAL', -INFO )</a>
  1516) <a name="l1516" style="background-color: #ffcccc">         RETURN</a>
  1517) <a name="l1517" style="background-color: #ffcccc">      END IF</a>
  1518) <a name="l1518" style="background-color: #ffcccc">!</a>
  1519) <a name="l1519" style="background-color: #ffcccc">      K = 1</a>
  1520) <a name="l1520" style="background-color: #ffcccc">      L = N</a>
  1521) <a name="l1521" style="background-color: #ffcccc">!</a>
  1522) <a name="l1522" style="background-color: #ffcccc">      IF( N.EQ.0 ) &amp;</a>
  1523) <a name="l1523" style="background-color: #ffcccc">         GO TO 210</a>
  1524) <a name="l1524" style="background-color: #ffcccc">!</a>
  1525) <a name="l1525" style="background-color: #ffcccc">      IF( LSAME( JOB, 'N' ) ) THEN</a>
  1526) <a name="l1526" style="background-color: #ffcccc">         DO 10 I = 1, N</a>
  1527) <a name="l1527" style="background-color: #ffcccc">            SCALE( I ) = ONE</a>
  1528) <a name="l1528" style="background-color: #ffcccc">   10    CONTINUE</a>
  1529) <a name="l1529" style="background-color: #ffcccc">         GO TO 210</a>
  1530) <a name="l1530" style="background-color: #ffcccc">      END IF</a>
  1531) <a name="l1531" style="background-color: #ffcccc">!</a>
  1532) <a name="l1532" style="background-color: #ffcccc">      IF( LSAME( JOB, 'S' ) ) &amp;</a>
  1533) <a name="l1533" style="background-color: #ffcccc">         GO TO 120</a>
  1534) <a name="l1534" style="background-color: #ffcccc">!</a>
  1535) <a name="l1535" style="background-color: #ffcccc">!     Permutation to isolate eigenvalues if possible</a>
  1536) <a name="l1536" style="background-color: #ffcccc">!</a>
  1537) <a name="l1537" style="background-color: #ffcccc">      GO TO 50</a>
  1538) <a name="l1538" style="background-color: #ffcccc">!</a>
  1539) <a name="l1539" style="background-color: #ffcccc">!     Row and column exchange.</a>
  1540) <a name="l1540" style="background-color: #ffcccc">!</a>
  1541) <a name="l1541" style="background-color: #ffcccc">   20 CONTINUE</a>
  1542) <a name="l1542" style="background-color: #ffcccc">      SCALE( M ) = J</a>
  1543) <a name="l1543" style="background-color: #ffcccc">      IF( J.EQ.M ) &amp;</a>
  1544) <a name="l1544" style="background-color: #ffcccc">         GO TO 30</a>
  1545) <a name="l1545" style="background-color: #ffcccc">!</a>
  1546) <a name="l1546" style="background-color: #ffcccc">      CALL SSWAP( L, A( 1, J ), 1, A( 1, M ), 1 )</a>
  1547) <a name="l1547" style="background-color: #ffcccc">      CALL SSWAP( N-K+1, A( J, K ), LDA, A( M, K ), LDA )</a>
  1548) <a name="l1548" style="background-color: #ffcccc">!</a>
  1549) <a name="l1549" style="background-color: #ffcccc">   30 CONTINUE</a>
  1550) <a name="l1550" style="background-color: #ffcccc">      GO TO ( 40, 80 )IEXC</a>
  1551) <a name="l1551" style="background-color: #ffcccc">!</a>
  1552) <a name="l1552" style="background-color: #ffcccc">!     Search for rows isolating an eigenvalue and push them down.</a>
  1553) <a name="l1553" style="background-color: #ffcccc">!</a>
  1554) <a name="l1554" style="background-color: #ffcccc">   40 CONTINUE</a>
  1555) <a name="l1555" style="background-color: #ffcccc">      IF( L.EQ.1 ) &amp;</a>
  1556) <a name="l1556" style="background-color: #ffcccc">         GO TO 210</a>
  1557) <a name="l1557" style="background-color: #ffcccc">      L = L - 1</a>
  1558) <a name="l1558" style="background-color: #ffcccc">!</a>
  1559) <a name="l1559" style="background-color: #ffcccc">   50 CONTINUE</a>
  1560) <a name="l1560" style="background-color: #ffcccc">      DO 70 J = L, 1, -1</a>
  1561) <a name="l1561" style="background-color: #ffcccc">!</a>
  1562) <a name="l1562" style="background-color: #ffcccc">         DO 60 I = 1, L</a>
  1563) <a name="l1563" style="background-color: #ffcccc">            IF( I.EQ.J ) &amp;</a>
  1564) <a name="l1564" style="background-color: #ffcccc">               GO TO 60</a>
  1565) <a name="l1565" style="background-color: #ffcccc">            IF( A( J, I ).NE.ZERO ) &amp;</a>
  1566) <a name="l1566" style="background-color: #ffcccc">               GO TO 70</a>
  1567) <a name="l1567" style="background-color: #ffcccc">   60    CONTINUE</a>
  1568) <a name="l1568" style="background-color: #ffcccc">!</a>
  1569) <a name="l1569" style="background-color: #ffcccc">         M = L</a>
  1570) <a name="l1570" style="background-color: #ffcccc">         IEXC = 1</a>
  1571) <a name="l1571" style="background-color: #ffcccc">         GO TO 20</a>
  1572) <a name="l1572" style="background-color: #ffcccc">   70 CONTINUE</a>
  1573) <a name="l1573" style="background-color: #ffcccc">!</a>
  1574) <a name="l1574" style="background-color: #ffcccc">      GO TO 90</a>
  1575) <a name="l1575" style="background-color: #ffcccc">!</a>
  1576) <a name="l1576" style="background-color: #ffcccc">!     Search for columns isolating an eigenvalue and push them left.</a>
  1577) <a name="l1577" style="background-color: #ffcccc">!</a>
  1578) <a name="l1578" style="background-color: #ffcccc">   80 CONTINUE</a>
  1579) <a name="l1579" style="background-color: #ffcccc">      K = K + 1</a>
  1580) <a name="l1580" style="background-color: #ffcccc">!</a>
  1581) <a name="l1581" style="background-color: #ffcccc">   90 CONTINUE</a>
  1582) <a name="l1582" style="background-color: #ffcccc">      DO 110 J = K, L</a>
  1583) <a name="l1583" style="background-color: #ffcccc">!</a>
  1584) <a name="l1584" style="background-color: #ffcccc">         DO 100 I = K, L</a>
  1585) <a name="l1585" style="background-color: #ffcccc">            IF( I.EQ.J ) &amp;</a>
  1586) <a name="l1586" style="background-color: #ffcccc">               GO TO 100</a>
  1587) <a name="l1587" style="background-color: #ffcccc">            IF( A( I, J ).NE.ZERO ) &amp;</a>
  1588) <a name="l1588" style="background-color: #ffcccc">               GO TO 110</a>
  1589) <a name="l1589" style="background-color: #ffcccc">  100    CONTINUE</a>
  1590) <a name="l1590" style="background-color: #ffcccc">!</a>
  1591) <a name="l1591" style="background-color: #ffcccc">         M = K</a>
  1592) <a name="l1592" style="background-color: #ffcccc">         IEXC = 2</a>
  1593) <a name="l1593" style="background-color: #ffcccc">         GO TO 20</a>
  1594) <a name="l1594" style="background-color: #ffcccc">  110 CONTINUE</a>
  1595) <a name="l1595" style="background-color: #ffcccc">!</a>
  1596) <a name="l1596" style="background-color: #ffcccc">  120 CONTINUE</a>
  1597) <a name="l1597" style="background-color: #ffcccc">      DO 130 I = K, L</a>
  1598) <a name="l1598" style="background-color: #ffcccc">         SCALE( I ) = ONE</a>
  1599) <a name="l1599" style="background-color: #ffcccc">  130 CONTINUE</a>
  1600) <a name="l1600" style="background-color: #ffcccc">!</a>
  1601) <a name="l1601" style="background-color: #ffcccc">      IF( LSAME( JOB, 'P' ) ) &amp;</a>
  1602) <a name="l1602" style="background-color: #ffcccc">         GO TO 210</a>
  1603) <a name="l1603" style="background-color: #ffcccc">!</a>
  1604) <a name="l1604" style="background-color: #ffcccc">!     Balance the submatrix in rows K to L.</a>
  1605) <a name="l1605" style="background-color: #ffcccc">!</a>
  1606) <a name="l1606" style="background-color: #ffcccc">!     Iterative loop for norm reduction</a>
  1607) <a name="l1607" style="background-color: #ffcccc">!</a>
  1608) <a name="l1608" style="background-color: #ffcccc">      SFMIN1 = SLAMCH( 'S' ) / SLAMCH( 'P' )</a>
  1609) <a name="l1609" style="background-color: #ffcccc">      SFMAX1 = ONE / SFMIN1</a>
  1610) <a name="l1610" style="background-color: #ffcccc">      SFMIN2 = SFMIN1*SCLFAC</a>
  1611) <a name="l1611" style="background-color: #ffcccc">      SFMAX2 = ONE / SFMIN2</a>
  1612) <a name="l1612" style="background-color: #ffcccc">  140 CONTINUE</a>
  1613) <a name="l1613" style="background-color: #ffcccc">      NOCONV = .FALSE.</a>
  1614) <a name="l1614" style="background-color: #ffcccc">!</a>
  1615) <a name="l1615" style="background-color: #ffcccc">      DO 200 I = K, L</a>
  1616) <a name="l1616" style="background-color: #ffcccc">         C = ZERO</a>
  1617) <a name="l1617" style="background-color: #ffcccc">         R = ZERO</a>
  1618) <a name="l1618" style="background-color: #ffcccc">!</a>
  1619) <a name="l1619" style="background-color: #ffcccc">         DO 150 J = K, L</a>
  1620) <a name="l1620" style="background-color: #ffcccc">            IF( J.EQ.I ) &amp;</a>
  1621) <a name="l1621" style="background-color: #ffcccc">               GO TO 150</a>
  1622) <a name="l1622" style="background-color: #ffcccc">            C = C + ABS( A( J, I ) )</a>
  1623) <a name="l1623" style="background-color: #ffcccc">            R = R + ABS( A( I, J ) )</a>
  1624) <a name="l1624" style="background-color: #ffcccc">  150    CONTINUE</a>
  1625) <a name="l1625" style="background-color: #ffcccc">         ICA = ISAMAX( L, A( 1, I ), 1 )</a>
  1626) <a name="l1626" style="background-color: #ffcccc">         CA = ABS( A( ICA, I ) )</a>
  1627) <a name="l1627" style="background-color: #ffcccc">         IRA = ISAMAX( N-K+1, A( I, K ), LDA )</a>
  1628) <a name="l1628" style="background-color: #ffcccc">         RA = ABS( A( I, IRA+K-1 ) )</a>
  1629) <a name="l1629" style="background-color: #ffcccc">!</a>
  1630) <a name="l1630" style="background-color: #ffcccc">!        Guard against zero C or R due to underflow.</a>
  1631) <a name="l1631" style="background-color: #ffcccc">!</a>
  1632) <a name="l1632" style="background-color: #ffcccc">         IF( C.EQ.ZERO .OR. R.EQ.ZERO ) &amp;</a>
  1633) <a name="l1633" style="background-color: #ffcccc">            GO TO 200</a>
  1634) <a name="l1634" style="background-color: #ffcccc">         G = R / SCLFAC</a>
  1635) <a name="l1635" style="background-color: #ffcccc">         F = ONE</a>
  1636) <a name="l1636" style="background-color: #ffcccc">         S = C + R</a>
  1637) <a name="l1637" style="background-color: #ffcccc">  160    CONTINUE</a>
  1638) <a name="l1638" style="background-color: #ffcccc">         IF( C.GE.G .OR. MAX( F, C, CA ).GE.SFMAX2 .OR. &amp;</a>
  1639) <a name="l1639" style="background-color: #ffcccc">             MIN( R, G, RA ).LE.SFMIN2 )GO TO 170</a>
  1640) <a name="l1640" style="background-color: #ffcccc">         F = F*SCLFAC</a>
  1641) <a name="l1641" style="background-color: #ffcccc">         C = C*SCLFAC</a>
  1642) <a name="l1642" style="background-color: #ffcccc">         CA = CA*SCLFAC</a>
  1643) <a name="l1643" style="background-color: #ffcccc">         R = R / SCLFAC</a>
  1644) <a name="l1644" style="background-color: #ffcccc">         G = G / SCLFAC</a>
  1645) <a name="l1645" style="background-color: #ffcccc">         RA = RA / SCLFAC</a>
  1646) <a name="l1646" style="background-color: #ffcccc">         GO TO 160</a>
  1647) <a name="l1647" style="background-color: #ffcccc">!</a>
  1648) <a name="l1648" style="background-color: #ffcccc">  170    CONTINUE</a>
  1649) <a name="l1649" style="background-color: #ffcccc">         G = C / SCLFAC</a>
  1650) <a name="l1650" style="background-color: #ffcccc">  180    CONTINUE</a>
  1651) <a name="l1651" style="background-color: #ffcccc">         IF( G.LT.R .OR. MAX( R, RA ).GE.SFMAX2 .OR. &amp;</a>
  1652) <a name="l1652" style="background-color: #ffcccc">             MIN( F, C, G, CA ).LE.SFMIN2 )GO TO 190</a>
  1653) <a name="l1653" style="background-color: #ffcccc">         F = F / SCLFAC</a>
  1654) <a name="l1654" style="background-color: #ffcccc">         C = C / SCLFAC</a>
  1655) <a name="l1655" style="background-color: #ffcccc">         G = G / SCLFAC</a>
  1656) <a name="l1656" style="background-color: #ffcccc">         CA = CA / SCLFAC</a>
  1657) <a name="l1657" style="background-color: #ffcccc">         R = R*SCLFAC</a>
  1658) <a name="l1658" style="background-color: #ffcccc">         RA = RA*SCLFAC</a>
  1659) <a name="l1659" style="background-color: #ffcccc">         GO TO 180</a>
  1660) <a name="l1660" style="background-color: #ffcccc">!</a>
  1661) <a name="l1661" style="background-color: #ffcccc">!        Now balance.</a>
  1662) <a name="l1662" style="background-color: #ffcccc">!</a>
  1663) <a name="l1663" style="background-color: #ffcccc">  190    CONTINUE</a>
  1664) <a name="l1664" style="background-color: #ffcccc">         IF( ( C+R ).GE.FACTOR*S ) &amp;</a>
  1665) <a name="l1665" style="background-color: #ffcccc">            GO TO 200</a>
  1666) <a name="l1666" style="background-color: #ffcccc">         IF( F.LT.ONE .AND. SCALE( I ).LT.ONE ) THEN</a>
  1667) <a name="l1667" style="background-color: #ffcccc">            IF( F*SCALE( I ).LE.SFMIN1 ) &amp;</a>
  1668) <a name="l1668" style="background-color: #ffcccc">               GO TO 200</a>
  1669) <a name="l1669" style="background-color: #ffcccc">         END IF</a>
  1670) <a name="l1670" style="background-color: #ffcccc">         IF( F.GT.ONE .AND. SCALE( I ).GT.ONE ) THEN</a>
  1671) <a name="l1671" style="background-color: #ffcccc">            IF( SCALE( I ).GE.SFMAX1 / F ) &amp;</a>
  1672) <a name="l1672" style="background-color: #ffcccc">               GO TO 200</a>
  1673) <a name="l1673" style="background-color: #ffcccc">         END IF</a>
  1674) <a name="l1674" style="background-color: #ffcccc">         G = ONE / F</a>
  1675) <a name="l1675" style="background-color: #ffcccc">         SCALE( I ) = SCALE( I )*F</a>
  1676) <a name="l1676" style="background-color: #ffcccc">         NOCONV = .TRUE.</a>
  1677) <a name="l1677" style="background-color: #ffcccc">!</a>
  1678) <a name="l1678" style="background-color: #ffcccc">         CALL SSCAL( N-K+1, G, A( I, K ), LDA )</a>
  1679) <a name="l1679" style="background-color: #ffcccc">         CALL SSCAL( L, F, A( 1, I ), 1 )</a>
  1680) <a name="l1680" style="background-color: #ffcccc">!</a>
  1681) <a name="l1681" style="background-color: #ffcccc">  200 CONTINUE</a>
  1682) <a name="l1682" style="background-color: #ffcccc">!</a>
  1683) <a name="l1683" style="background-color: #ffcccc">      IF( NOCONV ) &amp;</a>
  1684) <a name="l1684" style="background-color: #ffcccc">         GO TO 140</a>
  1685) <a name="l1685" style="background-color: #ffcccc">!</a>
  1686) <a name="l1686" style="background-color: #ffcccc">  210 CONTINUE</a>
  1687) <a name="l1687" style="background-color: #ffcccc">      ILO = K</a>
  1688) <a name="l1688" style="background-color: #ffcccc">      IHI = L</a>
  1689) <a name="l1689" style="background-color: #ffcccc">!</a>
  1690) <a name="l1690" style="background-color: #ffcccc">      RETURN</a>
  1691) <a name="l1691" style="background-color: #ffcccc">!</a>
  1692) <a name="l1692" style="background-color: #ffcccc">!     End of SGEBAL</a>
  1693) <a name="l1693" style="background-color: #ffcccc">!</a>
  1694) <a name="l1694" style="background-color: #ffcccc">      END SUBROUTINE SGEBAL</a>
  1695) <a name="l1695" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
  1696) <a name="l1696" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  1697) <a name="l1697" style="background-color: #ffffff"></a>
  1698) <a name="l1698" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SGEHD2( N, ILO, IHI, A, LDA, TAU, WORK, INFO )</a>
  1699) <a name="l1699" style="background-color: #ffcccc"></a>
  1700) <a name="l1700" style="background-color: #ffcccc">!</a>
  1701) <a name="l1701" style="background-color: #ffcccc">!  -- LAPACK routine (version 2.0) --</a>
  1702) <a name="l1702" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  1703) <a name="l1703" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  1704) <a name="l1704" style="background-color: #ffcccc">!     October 31, 1992</a>
  1705) <a name="l1705" style="background-color: #ffcccc">!</a>
  1706) <a name="l1706" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  1707) <a name="l1707" style="background-color: #ffcccc">      INTEGER            IHI, ILO, INFO, LDA, N</a>
  1708) <a name="l1708" style="background-color: #ffcccc">!     ..</a>
  1709) <a name="l1709" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  1710) <a name="l1710" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), TAU( * ), WORK( * )</a>
  1711) <a name="l1711" style="background-color: #ffcccc">!     ..</a>
  1712) <a name="l1712" style="background-color: #ffcccc">!</a>
  1713) <a name="l1713" style="background-color: #ffcccc">!  Purpose</a>
  1714) <a name="l1714" style="background-color: #ffcccc">!  =======</a>
  1715) <a name="l1715" style="background-color: #ffcccc">!</a>
  1716) <a name="l1716" style="background-color: #ffcccc">!  SGEHD2 reduces a real general matrix A to upper Hessenberg form H by</a>
  1717) <a name="l1717" style="background-color: #ffcccc">!  an orthogonal similarity transformation:  Q' * A * Q = H .</a>
  1718) <a name="l1718" style="background-color: #ffcccc">!</a>
  1719) <a name="l1719" style="background-color: #ffcccc">!  Arguments</a>
  1720) <a name="l1720" style="background-color: #ffcccc">!  =========</a>
  1721) <a name="l1721" style="background-color: #ffcccc">!</a>
  1722) <a name="l1722" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  1723) <a name="l1723" style="background-color: #ffcccc">!          The order of the matrix A.  N &gt;= 0.</a>
  1724) <a name="l1724" style="background-color: #ffcccc">!</a>
  1725) <a name="l1725" style="background-color: #ffcccc">!  ILO     (input) INTEGER</a>
  1726) <a name="l1726" style="background-color: #ffcccc">!  IHI     (input) INTEGER</a>
  1727) <a name="l1727" style="background-color: #ffcccc">!          It is assumed that A is already upper triangular in rows</a>
  1728) <a name="l1728" style="background-color: #ffcccc">!          and columns 1:ILO-1 and IHI+1:N. ILO and IHI are normally</a>
  1729) <a name="l1729" style="background-color: #ffcccc">!          set by a previous call to SGEBAL; otherwise they should be</a>
  1730) <a name="l1730" style="background-color: #ffcccc">!          set to 1 and N respectively. See Further Details.</a>
  1731) <a name="l1731" style="background-color: #ffcccc">!          1 &lt;= ILO &lt;= IHI &lt;= max(1,N).</a>
  1732) <a name="l1732" style="background-color: #ffcccc">!</a>
  1733) <a name="l1733" style="background-color: #ffcccc">!  A       (input/output) REAL array, dimension (LDA,N)</a>
  1734) <a name="l1734" style="background-color: #ffcccc">!          On entry, the n by n general matrix to be reduced.</a>
  1735) <a name="l1735" style="background-color: #ffcccc">!          On exit, the upper triangle and the first subdiagonal of A</a>
  1736) <a name="l1736" style="background-color: #ffcccc">!          are overwritten with the upper Hessenberg matrix H, and the</a>
  1737) <a name="l1737" style="background-color: #ffcccc">!          elements below the first subdiagonal, with the array TAU,</a>
  1738) <a name="l1738" style="background-color: #ffcccc">!          represent the orthogonal matrix Q as a product of elementary</a>
  1739) <a name="l1739" style="background-color: #ffcccc">!          reflectors. See Further Details.</a>
  1740) <a name="l1740" style="background-color: #ffcccc">!</a>
  1741) <a name="l1741" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  1742) <a name="l1742" style="background-color: #ffcccc">!          The leading dimension of the array A.  LDA &gt;= max(1,N).</a>
  1743) <a name="l1743" style="background-color: #ffcccc">!</a>
  1744) <a name="l1744" style="background-color: #ffcccc">!  TAU     (output) REAL array, dimension (N-1)</a>
  1745) <a name="l1745" style="background-color: #ffcccc">!          The scalar factors of the elementary reflectors (see Further</a>
  1746) <a name="l1746" style="background-color: #ffcccc">!          Details).</a>
  1747) <a name="l1747" style="background-color: #ffcccc">!</a>
  1748) <a name="l1748" style="background-color: #ffcccc">!  WORK    (workspace) REAL array, dimension (N)</a>
  1749) <a name="l1749" style="background-color: #ffcccc">!</a>
  1750) <a name="l1750" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  1751) <a name="l1751" style="background-color: #ffcccc">!          = 0:  successful exit.</a>
  1752) <a name="l1752" style="background-color: #ffcccc">!          &lt; 0:  if INFO = -i, the i-th argument had an illegal value.</a>
  1753) <a name="l1753" style="background-color: #ffcccc">!</a>
  1754) <a name="l1754" style="background-color: #ffcccc">!  Further Details</a>
  1755) <a name="l1755" style="background-color: #ffcccc">!  ===============</a>
  1756) <a name="l1756" style="background-color: #ffcccc">!</a>
  1757) <a name="l1757" style="background-color: #ffcccc">!  The matrix Q is represented as a product of (ihi-ilo) elementary</a>
  1758) <a name="l1758" style="background-color: #ffcccc">!  reflectors</a>
  1759) <a name="l1759" style="background-color: #ffcccc">!</a>
  1760) <a name="l1760" style="background-color: #ffcccc">!     Q = H(ilo) H(ilo+1) . . . H(ihi-1).</a>
  1761) <a name="l1761" style="background-color: #ffcccc">!</a>
  1762) <a name="l1762" style="background-color: #ffcccc">!  Each H(i) has the form</a>
  1763) <a name="l1763" style="background-color: #ffcccc">!</a>
  1764) <a name="l1764" style="background-color: #ffcccc">!     H(i) = I - tau * v * v'</a>
  1765) <a name="l1765" style="background-color: #ffcccc">!</a>
  1766) <a name="l1766" style="background-color: #ffcccc">!  where tau is a real scalar, and v is a real vector with</a>
  1767) <a name="l1767" style="background-color: #ffcccc">!  v(1:i) = 0, v(i+1) = 1 and v(ihi+1:n) = 0; v(i+2:ihi) is stored on</a>
  1768) <a name="l1768" style="background-color: #ffcccc">!  exit in A(i+2:ihi,i), and tau in TAU(i).</a>
  1769) <a name="l1769" style="background-color: #ffcccc">!</a>
  1770) <a name="l1770" style="background-color: #ffcccc">!  The contents of A are illustrated by the following example, with</a>
  1771) <a name="l1771" style="background-color: #ffcccc">!  n = 7, ilo = 2 and ihi = 6:</a>
  1772) <a name="l1772" style="background-color: #ffcccc">!</a>
  1773) <a name="l1773" style="background-color: #ffcccc">!  on entry,                        on exit,</a>
  1774) <a name="l1774" style="background-color: #ffcccc">!</a>
  1775) <a name="l1775" style="background-color: #ffcccc">!  ( a   a   a   a   a   a   a )    (  a   a   h   h   h   h   a )</a>
  1776) <a name="l1776" style="background-color: #ffcccc">!  (     a   a   a   a   a   a )    (      a   h   h   h   h   a )</a>
  1777) <a name="l1777" style="background-color: #ffcccc">!  (     a   a   a   a   a   a )    (      h   h   h   h   h   h )</a>
  1778) <a name="l1778" style="background-color: #ffcccc">!  (     a   a   a   a   a   a )    (      v2  h   h   h   h   h )</a>
  1779) <a name="l1779" style="background-color: #ffcccc">!  (     a   a   a   a   a   a )    (      v2  v3  h   h   h   h )</a>
  1780) <a name="l1780" style="background-color: #ffcccc">!  (     a   a   a   a   a   a )    (      v2  v3  v4  h   h   h )</a>
  1781) <a name="l1781" style="background-color: #ffcccc">!  (                         a )    (                          a )</a>
  1782) <a name="l1782" style="background-color: #ffcccc">!</a>
  1783) <a name="l1783" style="background-color: #ffcccc">!  where a denotes an element of the original matrix A, h denotes a</a>
  1784) <a name="l1784" style="background-color: #ffcccc">!  modified element of the upper Hessenberg matrix H, and vi denotes an</a>
  1785) <a name="l1785" style="background-color: #ffcccc">!  element of the vector defining H(i).</a>
  1786) <a name="l1786" style="background-color: #ffcccc">!</a>
  1787) <a name="l1787" style="background-color: #ffcccc">!  =====================================================================</a>
  1788) <a name="l1788" style="background-color: #ffcccc">!</a>
  1789) <a name="l1789" style="background-color: #ffcccc">!     .. Parameters ..</a>
  1790) <a name="l1790" style="background-color: #ffcccc">      REAL(r8)               ONE</a>
  1791) <a name="l1791" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E+0_r8 )</a>
  1792) <a name="l1792" style="background-color: #ffcccc">!     ..</a>
  1793) <a name="l1793" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  1794) <a name="l1794" style="background-color: #ffcccc">      INTEGER            I</a>
  1795) <a name="l1795" style="background-color: #ffcccc">      REAL(r8)               AII</a>
  1796) <a name="l1796" style="background-color: #ffcccc">!     ..</a>
  1797) <a name="l1797" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  1798) <a name="l1798" style="background-color: #ffcccc">!</a>
  1799) <a name="l1799" style="background-color: #ffcccc">!     Test the input parameters</a>
  1800) <a name="l1800" style="background-color: #ffcccc">!</a>
  1801) <a name="l1801" style="background-color: #ffcccc">      INFO = 0</a>
  1802) <a name="l1802" style="background-color: #ffcccc">      IF( N.LT.0 ) THEN</a>
  1803) <a name="l1803" style="background-color: #ffcccc">         INFO = -1</a>
  1804) <a name="l1804" style="background-color: #ffcccc">      ELSE IF( ILO.LT.1 .OR. ILO.GT.MAX( 1, N ) ) THEN</a>
  1805) <a name="l1805" style="background-color: #ffcccc">         INFO = -2</a>
  1806) <a name="l1806" style="background-color: #ffcccc">      ELSE IF( IHI.LT.MIN( ILO, N ) .OR. IHI.GT.N ) THEN</a>
  1807) <a name="l1807" style="background-color: #ffcccc">         INFO = -3</a>
  1808) <a name="l1808" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, N ) ) THEN</a>
  1809) <a name="l1809" style="background-color: #ffcccc">         INFO = -5</a>
  1810) <a name="l1810" style="background-color: #ffcccc">      END IF</a>
  1811) <a name="l1811" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
  1812) <a name="l1812" style="background-color: #ffcccc">         CALL XERBLA( 'SGEHD2', -INFO )</a>
  1813) <a name="l1813" style="background-color: #ffcccc">         RETURN</a>
  1814) <a name="l1814" style="background-color: #ffcccc">      END IF</a>
  1815) <a name="l1815" style="background-color: #ffcccc">!</a>
  1816) <a name="l1816" style="background-color: #ffcccc">      DO 10 I = ILO, IHI - 1</a>
  1817) <a name="l1817" style="background-color: #ffcccc">!</a>
  1818) <a name="l1818" style="background-color: #ffcccc">!        Compute elementary reflector H(i) to annihilate A(i+2:ihi,i)</a>
  1819) <a name="l1819" style="background-color: #ffcccc">!</a>
  1820) <a name="l1820" style="background-color: #ffcccc">         CALL SLARFG( IHI-I, A( I+1, I ), A( MIN( I+2, N ), I ), 1, &amp;</a>
  1821) <a name="l1821" style="background-color: #ffcccc">                      TAU( I ) )</a>
  1822) <a name="l1822" style="background-color: #ffcccc">         AII = A( I+1, I )</a>
  1823) <a name="l1823" style="background-color: #ffcccc">         A( I+1, I ) = ONE</a>
  1824) <a name="l1824" style="background-color: #ffcccc">!</a>
  1825) <a name="l1825" style="background-color: #ffcccc">!        Apply H(i) to A(1:ihi,i+1:ihi) from the right</a>
  1826) <a name="l1826" style="background-color: #ffcccc">!</a>
  1827) <a name="l1827" style="background-color: #ffcccc">         CALL SLARF( 'Right', IHI, IHI-I, A( I+1, I ), 1, TAU( I ), &amp;</a>
  1828) <a name="l1828" style="background-color: #ffcccc">                     A( 1, I+1 ), LDA, WORK )</a>
  1829) <a name="l1829" style="background-color: #ffcccc">!</a>
  1830) <a name="l1830" style="background-color: #ffcccc">!        Apply H(i) to A(i+1:ihi,i+1:n) from the left</a>
  1831) <a name="l1831" style="background-color: #ffcccc">!</a>
  1832) <a name="l1832" style="background-color: #ffcccc">         CALL SLARF( 'Left', IHI-I, N-I, A( I+1, I ), 1, TAU( I ), &amp;</a>
  1833) <a name="l1833" style="background-color: #ffcccc">                     A( I+1, I+1 ), LDA, WORK )</a>
  1834) <a name="l1834" style="background-color: #ffcccc">!</a>
  1835) <a name="l1835" style="background-color: #ffcccc">         A( I+1, I ) = AII</a>
  1836) <a name="l1836" style="background-color: #ffcccc">   10 CONTINUE</a>
  1837) <a name="l1837" style="background-color: #ffcccc">!</a>
  1838) <a name="l1838" style="background-color: #ffcccc">      RETURN</a>
  1839) <a name="l1839" style="background-color: #ffcccc">!</a>
  1840) <a name="l1840" style="background-color: #ffcccc">!     End of SGEHD2</a>
  1841) <a name="l1841" style="background-color: #ffcccc">!</a>
  1842) <a name="l1842" style="background-color: #ffcccc">      END SUBROUTINE SGEHD2</a>
  1843) <a name="l1843" style="background-color: #ffffff"></a>
  1844) <a name="l1844" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  1845) <a name="l1845" style="background-color: #ffffff"></a>
  1846) <a name="l1846" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SGEHRD( N, ILO, IHI, A, LDA, TAU, WORK, LWORK, INFO )</a>
  1847) <a name="l1847" style="background-color: #ffcccc"></a>
  1848) <a name="l1848" style="background-color: #ffcccc">!</a>
  1849) <a name="l1849" style="background-color: #ffcccc">!  -- LAPACK routine (version 2.0) --</a>
  1850) <a name="l1850" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  1851) <a name="l1851" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  1852) <a name="l1852" style="background-color: #ffcccc">!     September 30, 1994</a>
  1853) <a name="l1853" style="background-color: #ffcccc">!</a>
  1854) <a name="l1854" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  1855) <a name="l1855" style="background-color: #ffcccc">      INTEGER            IHI, ILO, INFO, LDA, LWORK, N</a>
  1856) <a name="l1856" style="background-color: #ffcccc">!     ..</a>
  1857) <a name="l1857" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  1858) <a name="l1858" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), TAU( * ), WORK( LWORK )</a>
  1859) <a name="l1859" style="background-color: #ffcccc">!     ..</a>
  1860) <a name="l1860" style="background-color: #ffcccc">!</a>
  1861) <a name="l1861" style="background-color: #ffcccc">!  Purpose</a>
  1862) <a name="l1862" style="background-color: #ffcccc">!  =======</a>
  1863) <a name="l1863" style="background-color: #ffcccc">!</a>
  1864) <a name="l1864" style="background-color: #ffcccc">!  SGEHRD reduces a real general matrix A to upper Hessenberg form H by</a>
  1865) <a name="l1865" style="background-color: #ffcccc">!  an orthogonal similarity transformation:  Q' * A * Q = H .</a>
  1866) <a name="l1866" style="background-color: #ffcccc">!</a>
  1867) <a name="l1867" style="background-color: #ffcccc">!  Arguments</a>
  1868) <a name="l1868" style="background-color: #ffcccc">!  =========</a>
  1869) <a name="l1869" style="background-color: #ffcccc">!</a>
  1870) <a name="l1870" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  1871) <a name="l1871" style="background-color: #ffcccc">!          The order of the matrix A.  N &gt;= 0.</a>
  1872) <a name="l1872" style="background-color: #ffcccc">!</a>
  1873) <a name="l1873" style="background-color: #ffcccc">!  ILO     (input) INTEGER</a>
  1874) <a name="l1874" style="background-color: #ffcccc">!  IHI     (input) INTEGER</a>
  1875) <a name="l1875" style="background-color: #ffcccc">!          It is assumed that A is already upper triangular in rows</a>
  1876) <a name="l1876" style="background-color: #ffcccc">!          and columns 1:ILO-1 and IHI+1:N. ILO and IHI are normally</a>
  1877) <a name="l1877" style="background-color: #ffcccc">!          set by a previous call to SGEBAL; otherwise they should be</a>
  1878) <a name="l1878" style="background-color: #ffcccc">!          set to 1 and N respectively. See Further Details.</a>
  1879) <a name="l1879" style="background-color: #ffcccc">!          1 &lt;= ILO &lt;= IHI &lt;= N, if N &gt; 0; ILO=1 and IHI=0, if N=0.</a>
  1880) <a name="l1880" style="background-color: #ffcccc">!</a>
  1881) <a name="l1881" style="background-color: #ffcccc">!  A       (input/output) REAL array, dimension (LDA,N)</a>
  1882) <a name="l1882" style="background-color: #ffcccc">!          On entry, the N-by-N general matrix to be reduced.</a>
  1883) <a name="l1883" style="background-color: #ffcccc">!          On exit, the upper triangle and the first subdiagonal of A</a>
  1884) <a name="l1884" style="background-color: #ffcccc">!          are overwritten with the upper Hessenberg matrix H, and the</a>
  1885) <a name="l1885" style="background-color: #ffcccc">!          elements below the first subdiagonal, with the array TAU,</a>
  1886) <a name="l1886" style="background-color: #ffcccc">!          represent the orthogonal matrix Q as a product of elementary</a>
  1887) <a name="l1887" style="background-color: #ffcccc">!          reflectors. See Further Details.</a>
  1888) <a name="l1888" style="background-color: #ffcccc">!</a>
  1889) <a name="l1889" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  1890) <a name="l1890" style="background-color: #ffcccc">!          The leading dimension of the array A.  LDA &gt;= max(1,N).</a>
  1891) <a name="l1891" style="background-color: #ffcccc">!</a>
  1892) <a name="l1892" style="background-color: #ffcccc">!  TAU     (output) REAL array, dimension (N-1)</a>
  1893) <a name="l1893" style="background-color: #ffcccc">!          The scalar factors of the elementary reflectors (see Further</a>
  1894) <a name="l1894" style="background-color: #ffcccc">!          Details). Elements 1:ILO-1 and IHI:N-1 of TAU are set to</a>
  1895) <a name="l1895" style="background-color: #ffcccc">!          zero.</a>
  1896) <a name="l1896" style="background-color: #ffcccc">!</a>
  1897) <a name="l1897" style="background-color: #ffcccc">!  WORK    (workspace/output) REAL array, dimension (LWORK)</a>
  1898) <a name="l1898" style="background-color: #ffcccc">!          On exit, if INFO = 0, WORK(1) returns the optimal LWORK.</a>
  1899) <a name="l1899" style="background-color: #ffcccc">!</a>
  1900) <a name="l1900" style="background-color: #ffcccc">!  LWORK   (input) INTEGER</a>
  1901) <a name="l1901" style="background-color: #ffcccc">!          The length of the array WORK.  LWORK &gt;= max(1,N).</a>
  1902) <a name="l1902" style="background-color: #ffcccc">!          For optimum performance LWORK &gt;= N*NB, where NB is the</a>
  1903) <a name="l1903" style="background-color: #ffcccc">!          optimal blocksize.</a>
  1904) <a name="l1904" style="background-color: #ffcccc">!</a>
  1905) <a name="l1905" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  1906) <a name="l1906" style="background-color: #ffcccc">!          = 0:  successful exit</a>
  1907) <a name="l1907" style="background-color: #ffcccc">!          &lt; 0:  if INFO = -i, the i-th argument had an illegal value.</a>
  1908) <a name="l1908" style="background-color: #ffcccc">!</a>
  1909) <a name="l1909" style="background-color: #ffcccc">!  Further Details</a>
  1910) <a name="l1910" style="background-color: #ffcccc">!  ===============</a>
  1911) <a name="l1911" style="background-color: #ffcccc">!</a>
  1912) <a name="l1912" style="background-color: #ffcccc">!  The matrix Q is represented as a product of (ihi-ilo) elementary</a>
  1913) <a name="l1913" style="background-color: #ffcccc">!  reflectors</a>
  1914) <a name="l1914" style="background-color: #ffcccc">!</a>
  1915) <a name="l1915" style="background-color: #ffcccc">!     Q = H(ilo) H(ilo+1) . . . H(ihi-1).</a>
  1916) <a name="l1916" style="background-color: #ffcccc">!</a>
  1917) <a name="l1917" style="background-color: #ffcccc">!  Each H(i) has the form</a>
  1918) <a name="l1918" style="background-color: #ffcccc">!</a>
  1919) <a name="l1919" style="background-color: #ffcccc">!     H(i) = I - tau * v * v'</a>
  1920) <a name="l1920" style="background-color: #ffcccc">!</a>
  1921) <a name="l1921" style="background-color: #ffcccc">!  where tau is a real scalar, and v is a real vector with</a>
  1922) <a name="l1922" style="background-color: #ffcccc">!  v(1:i) = 0, v(i+1) = 1 and v(ihi+1:n) = 0; v(i+2:ihi) is stored on</a>
  1923) <a name="l1923" style="background-color: #ffcccc">!  exit in A(i+2:ihi,i), and tau in TAU(i).</a>
  1924) <a name="l1924" style="background-color: #ffcccc">!</a>
  1925) <a name="l1925" style="background-color: #ffcccc">!  The contents of A are illustrated by the following example, with</a>
  1926) <a name="l1926" style="background-color: #ffcccc">!  n = 7, ilo = 2 and ihi = 6:</a>
  1927) <a name="l1927" style="background-color: #ffcccc">!</a>
  1928) <a name="l1928" style="background-color: #ffcccc">!  on entry,                        on exit,</a>
  1929) <a name="l1929" style="background-color: #ffcccc">!</a>
  1930) <a name="l1930" style="background-color: #ffcccc">!  ( a   a   a   a   a   a   a )    (  a   a   h   h   h   h   a )</a>
  1931) <a name="l1931" style="background-color: #ffcccc">!  (     a   a   a   a   a   a )    (      a   h   h   h   h   a )</a>
  1932) <a name="l1932" style="background-color: #ffcccc">!  (     a   a   a   a   a   a )    (      h   h   h   h   h   h )</a>
  1933) <a name="l1933" style="background-color: #ffcccc">!  (     a   a   a   a   a   a )    (      v2  h   h   h   h   h )</a>
  1934) <a name="l1934" style="background-color: #ffcccc">!  (     a   a   a   a   a   a )    (      v2  v3  h   h   h   h )</a>
  1935) <a name="l1935" style="background-color: #ffcccc">!  (     a   a   a   a   a   a )    (      v2  v3  v4  h   h   h )</a>
  1936) <a name="l1936" style="background-color: #ffcccc">!  (                         a )    (                          a )</a>
  1937) <a name="l1937" style="background-color: #ffcccc">!</a>
  1938) <a name="l1938" style="background-color: #ffcccc">!  where a denotes an element of the original matrix A, h denotes a</a>
  1939) <a name="l1939" style="background-color: #ffcccc">!  modified element of the upper Hessenberg matrix H, and vi denotes an</a>
  1940) <a name="l1940" style="background-color: #ffcccc">!  element of the vector defining H(i).</a>
  1941) <a name="l1941" style="background-color: #ffcccc">!</a>
  1942) <a name="l1942" style="background-color: #ffcccc">!  =====================================================================</a>
  1943) <a name="l1943" style="background-color: #ffcccc">!</a>
  1944) <a name="l1944" style="background-color: #ffcccc">!     .. Parameters ..</a>
  1945) <a name="l1945" style="background-color: #ffcccc">      INTEGER            NBMAX, LDT</a>
  1946) <a name="l1946" style="background-color: #ffcccc">      PARAMETER          ( NBMAX = 64, LDT = NBMAX+1 )</a>
  1947) <a name="l1947" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
  1948) <a name="l1948" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8, ONE = 1.0E+0_r8 )</a>
  1949) <a name="l1949" style="background-color: #ffcccc">!     ..</a>
  1950) <a name="l1950" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  1951) <a name="l1951" style="background-color: #ffcccc">      INTEGER            I, IB, IINFO, IWS, LDWORK, NB, NBMIN, NH, NX</a>
  1952) <a name="l1952" style="background-color: #ffcccc">      REAL(r8)               EI</a>
  1953) <a name="l1953" style="background-color: #ffcccc">!     ..</a>
  1954) <a name="l1954" style="background-color: #ffcccc">!     .. Local Arrays ..</a>
  1955) <a name="l1955" style="background-color: #ffcccc">      REAL(r8)               T( LDT, NBMAX )</a>
  1956) <a name="l1956" style="background-color: #ffcccc">!     ..</a>
  1957) <a name="l1957" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  1958) <a name="l1958" style="background-color: #ffcccc">!</a>
  1959) <a name="l1959" style="background-color: #ffcccc">!     Test the input parameters</a>
  1960) <a name="l1960" style="background-color: #ffcccc">!</a>
  1961) <a name="l1961" style="background-color: #ffcccc">      INFO = 0</a>
  1962) <a name="l1962" style="background-color: #ffcccc">      IF( N.LT.0 ) THEN</a>
  1963) <a name="l1963" style="background-color: #ffcccc">         INFO = -1</a>
  1964) <a name="l1964" style="background-color: #ffcccc">      ELSE IF( ILO.LT.1 .OR. ILO.GT.MAX( 1, N ) ) THEN</a>
  1965) <a name="l1965" style="background-color: #ffcccc">         INFO = -2</a>
  1966) <a name="l1966" style="background-color: #ffcccc">      ELSE IF( IHI.LT.MIN( ILO, N ) .OR. IHI.GT.N ) THEN</a>
  1967) <a name="l1967" style="background-color: #ffcccc">         INFO = -3</a>
  1968) <a name="l1968" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, N ) ) THEN</a>
  1969) <a name="l1969" style="background-color: #ffcccc">         INFO = -5</a>
  1970) <a name="l1970" style="background-color: #ffcccc">      ELSE IF( LWORK.LT.MAX( 1, N ) ) THEN</a>
  1971) <a name="l1971" style="background-color: #ffcccc">         INFO = -8</a>
  1972) <a name="l1972" style="background-color: #ffcccc">      END IF</a>
  1973) <a name="l1973" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
  1974) <a name="l1974" style="background-color: #ffcccc">         CALL XERBLA( 'SGEHRD', -INFO )</a>
  1975) <a name="l1975" style="background-color: #ffcccc">         RETURN</a>
  1976) <a name="l1976" style="background-color: #ffcccc">      END IF</a>
  1977) <a name="l1977" style="background-color: #ffcccc">!</a>
  1978) <a name="l1978" style="background-color: #ffcccc">!     Set elements 1:ILO-1 and IHI:N-1 of TAU to zero</a>
  1979) <a name="l1979" style="background-color: #ffcccc">!</a>
  1980) <a name="l1980" style="background-color: #ffcccc">      DO 10 I = 1, ILO - 1</a>
  1981) <a name="l1981" style="background-color: #ffcccc">         TAU( I ) = ZERO</a>
  1982) <a name="l1982" style="background-color: #ffcccc">   10 CONTINUE</a>
  1983) <a name="l1983" style="background-color: #ffcccc">      DO 20 I = MAX( 1, IHI ), N - 1</a>
  1984) <a name="l1984" style="background-color: #ffcccc">         TAU( I ) = ZERO</a>
  1985) <a name="l1985" style="background-color: #ffcccc">   20 CONTINUE</a>
  1986) <a name="l1986" style="background-color: #ffcccc">!</a>
  1987) <a name="l1987" style="background-color: #ffcccc">!     Quick return if possible</a>
  1988) <a name="l1988" style="background-color: #ffcccc">!</a>
  1989) <a name="l1989" style="background-color: #ffcccc">      NH = IHI - ILO + 1</a>
  1990) <a name="l1990" style="background-color: #ffcccc">      IF( NH.LE.1 ) THEN</a>
  1991) <a name="l1991" style="background-color: #ffcccc">         WORK( 1 ) = 1</a>
  1992) <a name="l1992" style="background-color: #ffcccc">         RETURN</a>
  1993) <a name="l1993" style="background-color: #ffcccc">      END IF</a>
  1994) <a name="l1994" style="background-color: #ffcccc">!</a>
  1995) <a name="l1995" style="background-color: #ffcccc">!     Determine the block size.</a>
  1996) <a name="l1996" style="background-color: #ffcccc">!</a>
  1997) <a name="l1997" style="background-color: #ffcccc">      NB = MIN( NBMAX, ILAENV( 1, 'SGEHRD', ' ', N, ILO, IHI, -1 ) )</a>
  1998) <a name="l1998" style="background-color: #ffcccc">      NBMIN = 2</a>
  1999) <a name="l1999" style="background-color: #ffcccc">      IWS = 1</a>
  2000) <a name="l2000" style="background-color: #ffcccc">      IF( NB.GT.1 .AND. NB.LT.NH ) THEN</a>
  2001) <a name="l2001" style="background-color: #ffcccc">!</a>
  2002) <a name="l2002" style="background-color: #ffcccc">!        Determine when to cross over from blocked to unblocked code</a>
  2003) <a name="l2003" style="background-color: #ffcccc">!        (last block is always handled by unblocked code).</a>
  2004) <a name="l2004" style="background-color: #ffcccc">!</a>
  2005) <a name="l2005" style="background-color: #ffcccc">         NX = MAX( NB, ILAENV( 3, 'SGEHRD', ' ', N, ILO, IHI, -1 ) )</a>
  2006) <a name="l2006" style="background-color: #ffcccc">         IF( NX.LT.NH ) THEN</a>
  2007) <a name="l2007" style="background-color: #ffcccc">!</a>
  2008) <a name="l2008" style="background-color: #ffcccc">!           Determine if workspace is large enough for blocked code.</a>
  2009) <a name="l2009" style="background-color: #ffcccc">!</a>
  2010) <a name="l2010" style="background-color: #ffcccc">            IWS = N*NB</a>
  2011) <a name="l2011" style="background-color: #ffcccc">            IF( LWORK.LT.IWS ) THEN</a>
  2012) <a name="l2012" style="background-color: #ffcccc">!</a>
  2013) <a name="l2013" style="background-color: #ffcccc">!              Not enough workspace to use optimal NB:  determine the</a>
  2014) <a name="l2014" style="background-color: #ffcccc">!              minimum value of NB, and reduce NB or force use of</a>
  2015) <a name="l2015" style="background-color: #ffcccc">!              unblocked code.</a>
  2016) <a name="l2016" style="background-color: #ffcccc">!</a>
  2017) <a name="l2017" style="background-color: #ffcccc">               NBMIN = MAX( 2, ILAENV( 2, 'SGEHRD', ' ', N, ILO, IHI, &amp;</a>
  2018) <a name="l2018" style="background-color: #ffcccc">                       -1 ) )</a>
  2019) <a name="l2019" style="background-color: #ffcccc">               IF( LWORK.GE.N*NBMIN ) THEN</a>
  2020) <a name="l2020" style="background-color: #ffcccc">                  NB = LWORK / N</a>
  2021) <a name="l2021" style="background-color: #ffcccc">               ELSE</a>
  2022) <a name="l2022" style="background-color: #ffcccc">                  NB = 1</a>
  2023) <a name="l2023" style="background-color: #ffcccc">               END IF</a>
  2024) <a name="l2024" style="background-color: #ffcccc">            END IF</a>
  2025) <a name="l2025" style="background-color: #ffcccc">         END IF</a>
  2026) <a name="l2026" style="background-color: #ffcccc">      END IF</a>
  2027) <a name="l2027" style="background-color: #ffcccc">      LDWORK = N</a>
  2028) <a name="l2028" style="background-color: #ffcccc">!</a>
  2029) <a name="l2029" style="background-color: #ffcccc">      IF( NB.LT.NBMIN .OR. NB.GE.NH ) THEN</a>
  2030) <a name="l2030" style="background-color: #ffcccc">!</a>
  2031) <a name="l2031" style="background-color: #ffcccc">!        Use unblocked code below</a>
  2032) <a name="l2032" style="background-color: #ffcccc">!</a>
  2033) <a name="l2033" style="background-color: #ffcccc">         I = ILO</a>
  2034) <a name="l2034" style="background-color: #ffcccc">!</a>
  2035) <a name="l2035" style="background-color: #ffcccc">      ELSE</a>
  2036) <a name="l2036" style="background-color: #ffcccc">!</a>
  2037) <a name="l2037" style="background-color: #ffcccc">!        Use blocked code</a>
  2038) <a name="l2038" style="background-color: #ffcccc">!</a>
  2039) <a name="l2039" style="background-color: #ffcccc">         DO 30 I = ILO, IHI - 1 - NX, NB</a>
  2040) <a name="l2040" style="background-color: #ffcccc">            IB = MIN( NB, IHI-I )</a>
  2041) <a name="l2041" style="background-color: #ffcccc">!</a>
  2042) <a name="l2042" style="background-color: #ffcccc">!           Reduce columns i:i+ib-1 to Hessenberg form, returning the</a>
  2043) <a name="l2043" style="background-color: #ffcccc">!           matrices V and T of the block reflector H = I - V*T*V'</a>
  2044) <a name="l2044" style="background-color: #ffcccc">!           which performs the reduction, and also the matrix Y = A*V*T</a>
  2045) <a name="l2045" style="background-color: #ffcccc">!</a>
  2046) <a name="l2046" style="background-color: #ffcccc">            CALL SLAHRD( IHI, I, IB, A( 1, I ), LDA, TAU( I ), T, LDT, &amp;</a>
  2047) <a name="l2047" style="background-color: #ffcccc">                         WORK, LDWORK )</a>
  2048) <a name="l2048" style="background-color: #ffcccc">!</a>
  2049) <a name="l2049" style="background-color: #ffcccc">!           Apply the block reflector H to A(1:ihi,i+ib:ihi) from the</a>
  2050) <a name="l2050" style="background-color: #ffcccc">!           right, computing  A := A - Y * V'. V(i+ib,ib-1) must be set</a>
  2051) <a name="l2051" style="background-color: #ffcccc">!           to 1.</a>
  2052) <a name="l2052" style="background-color: #ffcccc">!</a>
  2053) <a name="l2053" style="background-color: #ffcccc">            EI = A( I+IB, I+IB-1 )</a>
  2054) <a name="l2054" style="background-color: #ffcccc">            A( I+IB, I+IB-1 ) = ONE</a>
  2055) <a name="l2055" style="background-color: #ffcccc">            CALL SGEMM( 'No transpose', 'Transpose', IHI, IHI-I-IB+1, &amp;</a>
  2056) <a name="l2056" style="background-color: #ffcccc">                        IB, -ONE, WORK, LDWORK, A( I+IB, I ), LDA, ONE, &amp;</a>
  2057) <a name="l2057" style="background-color: #ffcccc">                        A( 1, I+IB ), LDA )</a>
  2058) <a name="l2058" style="background-color: #ffcccc">            A( I+IB, I+IB-1 ) = EI</a>
  2059) <a name="l2059" style="background-color: #ffcccc">!</a>
  2060) <a name="l2060" style="background-color: #ffcccc">!           Apply the block reflector H to A(i+1:ihi,i+ib:n) from the</a>
  2061) <a name="l2061" style="background-color: #ffcccc">!           left</a>
  2062) <a name="l2062" style="background-color: #ffcccc">!</a>
  2063) <a name="l2063" style="background-color: #ffcccc">            CALL SLARFB( 'Left', 'Transpose', 'Forward', 'Columnwise', &amp;</a>
  2064) <a name="l2064" style="background-color: #ffcccc">                         IHI-I, N-I-IB+1, IB, A( I+1, I ), LDA, T, LDT, &amp;</a>
  2065) <a name="l2065" style="background-color: #ffcccc">                         A( I+1, I+IB ), LDA, WORK, LDWORK )</a>
  2066) <a name="l2066" style="background-color: #ffcccc">   30    CONTINUE</a>
  2067) <a name="l2067" style="background-color: #ffcccc">      END IF</a>
  2068) <a name="l2068" style="background-color: #ffcccc">!</a>
  2069) <a name="l2069" style="background-color: #ffcccc">!     Use unblocked code to reduce the rest of the matrix</a>
  2070) <a name="l2070" style="background-color: #ffcccc">!</a>
  2071) <a name="l2071" style="background-color: #ffcccc">      CALL SGEHD2( N, I, IHI, A, LDA, TAU, WORK, IINFO )</a>
  2072) <a name="l2072" style="background-color: #ffcccc">      WORK( 1 ) = IWS</a>
  2073) <a name="l2073" style="background-color: #ffcccc">!</a>
  2074) <a name="l2074" style="background-color: #ffcccc">      RETURN</a>
  2075) <a name="l2075" style="background-color: #ffcccc">!</a>
  2076) <a name="l2076" style="background-color: #ffcccc">!     End of SGEHRD</a>
  2077) <a name="l2077" style="background-color: #ffcccc">!</a>
  2078) <a name="l2078" style="background-color: #ffcccc">      END SUBROUTINE SGEHRD</a>
  2079) <a name="l2079" style="background-color: #ffffff"></a>
  2080) <a name="l2080" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  2081) <a name="l2081" style="background-color: #ffffff"></a>
  2082) <a name="l2082" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SHSEQR( JOB, COMPZ, N, ILO, IHI, H, LDH, WR, WI, Z, &amp;</a>
  2083) <a name="l2083" style="background-color: #ffcccc">                         LDZ, WORK, LWORK, INFO )</a>
  2084) <a name="l2084" style="background-color: #ffcccc"></a>
  2085) <a name="l2085" style="background-color: #ffcccc">!</a>
  2086) <a name="l2086" style="background-color: #ffcccc">!  -- LAPACK routine (version 2.0) --</a>
  2087) <a name="l2087" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  2088) <a name="l2088" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  2089) <a name="l2089" style="background-color: #ffcccc">!     September 30, 1994</a>
  2090) <a name="l2090" style="background-color: #ffcccc">!</a>
  2091) <a name="l2091" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  2092) <a name="l2092" style="background-color: #ffcccc">      CHARACTER          COMPZ, JOB</a>
  2093) <a name="l2093" style="background-color: #ffcccc">      INTEGER            IHI, ILO, INFO, LDH, LDZ, LWORK, N</a>
  2094) <a name="l2094" style="background-color: #ffcccc">!     ..</a>
  2095) <a name="l2095" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  2096) <a name="l2096" style="background-color: #ffcccc">      REAL(r8)               H( LDH, * ), WI( * ), WORK( * ), WR( * ), &amp;</a>
  2097) <a name="l2097" style="background-color: #ffcccc">                         Z( LDZ, * )</a>
  2098) <a name="l2098" style="background-color: #ffcccc">!     ..</a>
  2099) <a name="l2099" style="background-color: #ffcccc">!</a>
  2100) <a name="l2100" style="background-color: #ffcccc">!  Purpose</a>
  2101) <a name="l2101" style="background-color: #ffcccc">!  =======</a>
  2102) <a name="l2102" style="background-color: #ffcccc">!</a>
  2103) <a name="l2103" style="background-color: #ffcccc">!  SHSEQR computes the eigenvalues of a real upper Hessenberg matrix H</a>
  2104) <a name="l2104" style="background-color: #ffcccc">!  and, optionally, the matrices T and Z from the Schur decomposition</a>
  2105) <a name="l2105" style="background-color: #ffcccc">!  H = Z T Z**T, where T is an upper quasi-triangular matrix (the Schur</a>
  2106) <a name="l2106" style="background-color: #ffcccc">!  form), and Z is the orthogonal matrix of Schur vectors.</a>
  2107) <a name="l2107" style="background-color: #ffcccc">!</a>
  2108) <a name="l2108" style="background-color: #ffcccc">!  Optionally Z may be postmultiplied into an input orthogonal matrix Q,</a>
  2109) <a name="l2109" style="background-color: #ffcccc">!  so that this routine can give the Schur factorization of a matrix A</a>
  2110) <a name="l2110" style="background-color: #ffcccc">!  which has been reduced to the Hessenberg form H by the orthogonal</a>
  2111) <a name="l2111" style="background-color: #ffcccc">!  matrix Q:  A = Q*H*Q**T = (QZ)*T*(QZ)**T.</a>
  2112) <a name="l2112" style="background-color: #ffcccc">!</a>
  2113) <a name="l2113" style="background-color: #ffcccc">!  Arguments</a>
  2114) <a name="l2114" style="background-color: #ffcccc">!  =========</a>
  2115) <a name="l2115" style="background-color: #ffcccc">!</a>
  2116) <a name="l2116" style="background-color: #ffcccc">!  JOB     (input) CHARACTER*1</a>
  2117) <a name="l2117" style="background-color: #ffcccc">!          = 'E':  compute eigenvalues only;</a>
  2118) <a name="l2118" style="background-color: #ffcccc">!          = 'S':  compute eigenvalues and the Schur form T.</a>
  2119) <a name="l2119" style="background-color: #ffcccc">!</a>
  2120) <a name="l2120" style="background-color: #ffcccc">!  COMPZ   (input) CHARACTER*1</a>
  2121) <a name="l2121" style="background-color: #ffcccc">!          = 'N':  no Schur vectors are computed;</a>
  2122) <a name="l2122" style="background-color: #ffcccc">!          = 'I':  Z is initialized to the unit matrix and the matrix Z</a>
  2123) <a name="l2123" style="background-color: #ffcccc">!                  of Schur vectors of H is returned;</a>
  2124) <a name="l2124" style="background-color: #ffcccc">!          = 'V':  Z must contain an orthogonal matrix Q on entry, and</a>
  2125) <a name="l2125" style="background-color: #ffcccc">!                  the product Q*Z is returned.</a>
  2126) <a name="l2126" style="background-color: #ffcccc">!</a>
  2127) <a name="l2127" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  2128) <a name="l2128" style="background-color: #ffcccc">!          The order of the matrix H.  N &gt;= 0.</a>
  2129) <a name="l2129" style="background-color: #ffcccc">!</a>
  2130) <a name="l2130" style="background-color: #ffcccc">!  ILO     (input) INTEGER</a>
  2131) <a name="l2131" style="background-color: #ffcccc">!  IHI     (input) INTEGER</a>
  2132) <a name="l2132" style="background-color: #ffcccc">!          It is assumed that H is already upper triangular in rows</a>
  2133) <a name="l2133" style="background-color: #ffcccc">!          and columns 1:ILO-1 and IHI+1:N. ILO and IHI are normally</a>
  2134) <a name="l2134" style="background-color: #ffcccc">!          set by a previous call to SGEBAL, and then passed to SGEHRD</a>
  2135) <a name="l2135" style="background-color: #ffcccc">!          when the matrix output by SGEBAL is reduced to Hessenberg</a>
  2136) <a name="l2136" style="background-color: #ffcccc">!          form. Otherwise ILO and IHI should be set to 1 and N</a>
  2137) <a name="l2137" style="background-color: #ffcccc">!          respectively.</a>
  2138) <a name="l2138" style="background-color: #ffcccc">!          1 &lt;= ILO &lt;= IHI &lt;= N, if N &gt; 0; ILO=1 and IHI=0, if N=0.</a>
  2139) <a name="l2139" style="background-color: #ffcccc">!</a>
  2140) <a name="l2140" style="background-color: #ffcccc">!  H       (input/output) REAL array, dimension (LDH,N)</a>
  2141) <a name="l2141" style="background-color: #ffcccc">!          On entry, the upper Hessenberg matrix H.</a>
  2142) <a name="l2142" style="background-color: #ffcccc">!          On exit, if JOB = 'S', H contains the upper quasi-triangular</a>
  2143) <a name="l2143" style="background-color: #ffcccc">!          matrix T from the Schur decomposition (the Schur form);</a>
  2144) <a name="l2144" style="background-color: #ffcccc">!          2-by-2 diagonal blocks (corresponding to complex conjugate</a>
  2145) <a name="l2145" style="background-color: #ffcccc">!          pairs of eigenvalues) are returned in standard form, with</a>
  2146) <a name="l2146" style="background-color: #ffcccc">!          H(i,i) = H(i+1,i+1) and H(i+1,i)*H(i,i+1) &lt; 0. If JOB = 'E',</a>
  2147) <a name="l2147" style="background-color: #ffcccc">!          the contents of H are unspecified on exit.</a>
  2148) <a name="l2148" style="background-color: #ffcccc">!</a>
  2149) <a name="l2149" style="background-color: #ffcccc">!  LDH     (input) INTEGER</a>
  2150) <a name="l2150" style="background-color: #ffcccc">!          The leading dimension of the array H. LDH &gt;= max(1,N).</a>
  2151) <a name="l2151" style="background-color: #ffcccc">!</a>
  2152) <a name="l2152" style="background-color: #ffcccc">!  WR      (output) REAL array, dimension (N)</a>
  2153) <a name="l2153" style="background-color: #ffcccc">!  WI      (output) REAL array, dimension (N)</a>
  2154) <a name="l2154" style="background-color: #ffcccc">!          The real and imaginary parts, respectively, of the computed</a>
  2155) <a name="l2155" style="background-color: #ffcccc">!          eigenvalues. If two eigenvalues are computed as a complex</a>
  2156) <a name="l2156" style="background-color: #ffcccc">!          conjugate pair, they are stored in consecutive elements of</a>
  2157) <a name="l2157" style="background-color: #ffcccc">!          WR and WI, say the i-th and (i+1)th, with WI(i) &gt; 0 and</a>
  2158) <a name="l2158" style="background-color: #ffcccc">!          WI(i+1) &lt; 0. If JOB = 'S', the eigenvalues are stored in the</a>
  2159) <a name="l2159" style="background-color: #ffcccc">!          same order as on the diagonal of the Schur form returned in</a>
  2160) <a name="l2160" style="background-color: #ffcccc">!          H, with WR(i) = H(i,i) and, if H(i:i+1,i:i+1) is a 2-by-2</a>
  2161) <a name="l2161" style="background-color: #ffcccc">!          diagonal block, WI(i) = sqrt(H(i+1,i)*H(i,i+1)) and</a>
  2162) <a name="l2162" style="background-color: #ffcccc">!          WI(i+1) = -WI(i).</a>
  2163) <a name="l2163" style="background-color: #ffcccc">!</a>
  2164) <a name="l2164" style="background-color: #ffcccc">!  Z       (input/output) REAL array, dimension (LDZ,N)</a>
  2165) <a name="l2165" style="background-color: #ffcccc">!          If COMPZ = 'N': Z is not referenced.</a>
  2166) <a name="l2166" style="background-color: #ffcccc">!          If COMPZ = 'I': on entry, Z need not be set, and on exit, Z</a>
  2167) <a name="l2167" style="background-color: #ffcccc">!          contains the orthogonal matrix Z of the Schur vectors of H.</a>
  2168) <a name="l2168" style="background-color: #ffcccc">!          If COMPZ = 'V': on entry Z must contain an N-by-N matrix Q,</a>
  2169) <a name="l2169" style="background-color: #ffcccc">!          which is assumed to be equal to the unit matrix except for</a>
  2170) <a name="l2170" style="background-color: #ffcccc">!          the submatrix Z(ILO:IHI,ILO:IHI); on exit Z contains Q*Z.</a>
  2171) <a name="l2171" style="background-color: #ffcccc">!          Normally Q is the orthogonal matrix generated by SORGHR after</a>
  2172) <a name="l2172" style="background-color: #ffcccc">!          the call to SGEHRD which formed the Hessenberg matrix H.</a>
  2173) <a name="l2173" style="background-color: #ffcccc">!</a>
  2174) <a name="l2174" style="background-color: #ffcccc">!  LDZ     (input) INTEGER</a>
  2175) <a name="l2175" style="background-color: #ffcccc">!          The leading dimension of the array Z.</a>
  2176) <a name="l2176" style="background-color: #ffcccc">!          LDZ &gt;= max(1,N) if COMPZ = 'I' or 'V'; LDZ &gt;= 1 otherwise.</a>
  2177) <a name="l2177" style="background-color: #ffcccc">!</a>
  2178) <a name="l2178" style="background-color: #ffcccc">!  WORK    (workspace) REAL array, dimension (N)</a>
  2179) <a name="l2179" style="background-color: #ffcccc">!</a>
  2180) <a name="l2180" style="background-color: #ffcccc">!  LWORK   (input) INTEGER</a>
  2181) <a name="l2181" style="background-color: #ffcccc">!          This argument is currently redundant.</a>
  2182) <a name="l2182" style="background-color: #ffcccc">!</a>
  2183) <a name="l2183" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  2184) <a name="l2184" style="background-color: #ffcccc">!          = 0:  successful exit</a>
  2185) <a name="l2185" style="background-color: #ffcccc">!          &lt; 0:  if INFO = -i, the i-th argument had an illegal value</a>
  2186) <a name="l2186" style="background-color: #ffcccc">!          &gt; 0:  if INFO = i, SHSEQR failed to compute all of the</a>
  2187) <a name="l2187" style="background-color: #ffcccc">!                eigenvalues in a total of 30*(IHI-ILO+1) iterations;</a>
  2188) <a name="l2188" style="background-color: #ffcccc">!                elements 1:ilo-1 and i+1:n of WR and WI contain those</a>
  2189) <a name="l2189" style="background-color: #ffcccc">!                eigenvalues which have been successfully computed.</a>
  2190) <a name="l2190" style="background-color: #ffcccc">!</a>
  2191) <a name="l2191" style="background-color: #ffcccc">!  =====================================================================</a>
  2192) <a name="l2192" style="background-color: #ffcccc">!</a>
  2193) <a name="l2193" style="background-color: #ffcccc">!     .. Parameters ..</a>
  2194) <a name="l2194" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE, TWO</a>
  2195) <a name="l2195" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8, ONE = 1.0E+0_r8, TWO = 2.0E+0_r8 )</a>
  2196) <a name="l2196" style="background-color: #ffcccc">      REAL(r8)               CONST</a>
  2197) <a name="l2197" style="background-color: #ffcccc">      PARAMETER          ( CONST = 1.5E+0_r8 )</a>
  2198) <a name="l2198" style="background-color: #ffcccc">      INTEGER            NSMAX, LDS</a>
  2199) <a name="l2199" style="background-color: #ffcccc">      PARAMETER          ( NSMAX = 15, LDS = NSMAX )</a>
  2200) <a name="l2200" style="background-color: #ffcccc">!     ..</a>
  2201) <a name="l2201" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  2202) <a name="l2202" style="background-color: #ffcccc">      LOGICAL            INITZ, WANTT, WANTZ</a>
  2203) <a name="l2203" style="background-color: #ffcccc">      INTEGER            I, I1, I2, IERR, II, ITEMP, ITN, ITS, J, K, L, &amp;</a>
  2204) <a name="l2204" style="background-color: #ffcccc">                         MAXB, NH, NR, NS, NV</a>
  2205) <a name="l2205" style="background-color: #ffcccc">      REAL(r8)               ABSW, OVFL, SMLNUM, TAU, TEMP, TST1, ULP, UNFL</a>
  2206) <a name="l2206" style="background-color: #ffcccc">!     ..</a>
  2207) <a name="l2207" style="background-color: #ffcccc">!     .. Local Arrays ..</a>
  2208) <a name="l2208" style="background-color: #ffcccc">      REAL(r8)               S( LDS, NSMAX ), V( NSMAX+1 ), VV( NSMAX+1 )</a>
  2209) <a name="l2209" style="background-color: #ffcccc">!     ..</a>
  2210) <a name="l2210" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  2211) <a name="l2211" style="background-color: #ffcccc">!</a>
  2212) <a name="l2212" style="background-color: #ffcccc">!     Decode and test the input parameters</a>
  2213) <a name="l2213" style="background-color: #ffcccc">!</a>
  2214) <a name="l2214" style="background-color: #ffcccc">      WANTT = LSAME( JOB, 'S' )</a>
  2215) <a name="l2215" style="background-color: #ffcccc">      INITZ = LSAME( COMPZ, 'I' )</a>
  2216) <a name="l2216" style="background-color: #ffcccc">      WANTZ = INITZ .OR. LSAME( COMPZ, 'V' )</a>
  2217) <a name="l2217" style="background-color: #ffcccc">!</a>
  2218) <a name="l2218" style="background-color: #ffcccc">      INFO = 0</a>
  2219) <a name="l2219" style="background-color: #ffcccc">      IF( .NOT.LSAME( JOB, 'E' ) .AND. .NOT.WANTT ) THEN</a>
  2220) <a name="l2220" style="background-color: #ffcccc">         INFO = -1</a>
  2221) <a name="l2221" style="background-color: #ffcccc">      ELSE IF( .NOT.LSAME( COMPZ, 'N' ) .AND. .NOT.WANTZ ) THEN</a>
  2222) <a name="l2222" style="background-color: #ffcccc">         INFO = -2</a>
  2223) <a name="l2223" style="background-color: #ffcccc">      ELSE IF( N.LT.0 ) THEN</a>
  2224) <a name="l2224" style="background-color: #ffcccc">         INFO = -3</a>
  2225) <a name="l2225" style="background-color: #ffcccc">      ELSE IF( ILO.LT.1 .OR. ILO.GT.MAX( 1, N ) ) THEN</a>
  2226) <a name="l2226" style="background-color: #ffcccc">         INFO = -4</a>
  2227) <a name="l2227" style="background-color: #ffcccc">      ELSE IF( IHI.LT.MIN( ILO, N ) .OR. IHI.GT.N ) THEN</a>
  2228) <a name="l2228" style="background-color: #ffcccc">         INFO = -5</a>
  2229) <a name="l2229" style="background-color: #ffcccc">      ELSE IF( LDH.LT.MAX( 1, N ) ) THEN</a>
  2230) <a name="l2230" style="background-color: #ffcccc">         INFO = -7</a>
  2231) <a name="l2231" style="background-color: #ffcccc">      ELSE IF( LDZ.LT.1 .OR. WANTZ .AND. LDZ.LT.MAX( 1, N ) ) THEN</a>
  2232) <a name="l2232" style="background-color: #ffcccc">         INFO = -11</a>
  2233) <a name="l2233" style="background-color: #ffcccc">      END IF</a>
  2234) <a name="l2234" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
  2235) <a name="l2235" style="background-color: #ffcccc">         CALL XERBLA( 'SHSEQR', -INFO )</a>
  2236) <a name="l2236" style="background-color: #ffcccc">         RETURN</a>
  2237) <a name="l2237" style="background-color: #ffcccc">      END IF</a>
  2238) <a name="l2238" style="background-color: #ffcccc">!</a>
  2239) <a name="l2239" style="background-color: #ffcccc">!     Initialize Z, if necessary</a>
  2240) <a name="l2240" style="background-color: #ffcccc">!</a>
  2241) <a name="l2241" style="background-color: #ffcccc">      IF( INITZ ) &amp;</a>
  2242) <a name="l2242" style="background-color: #ffcccc">         CALL SLASET( 'Full', N, N, ZERO, ONE, Z, LDZ )</a>
  2243) <a name="l2243" style="background-color: #ffcccc">!</a>
  2244) <a name="l2244" style="background-color: #ffcccc">!     Store the eigenvalues isolated by SGEBAL.</a>
  2245) <a name="l2245" style="background-color: #ffcccc">!</a>
  2246) <a name="l2246" style="background-color: #ffcccc">      DO 10 I = 1, ILO - 1</a>
  2247) <a name="l2247" style="background-color: #ffcccc">         WR( I ) = H( I, I )</a>
  2248) <a name="l2248" style="background-color: #ffcccc">         WI( I ) = ZERO</a>
  2249) <a name="l2249" style="background-color: #ffcccc">   10 CONTINUE</a>
  2250) <a name="l2250" style="background-color: #ffcccc">      DO 20 I = IHI + 1, N</a>
  2251) <a name="l2251" style="background-color: #ffcccc">         WR( I ) = H( I, I )</a>
  2252) <a name="l2252" style="background-color: #ffcccc">         WI( I ) = ZERO</a>
  2253) <a name="l2253" style="background-color: #ffcccc">   20 CONTINUE</a>
  2254) <a name="l2254" style="background-color: #ffcccc">!</a>
  2255) <a name="l2255" style="background-color: #ffcccc">!     Quick return if possible.</a>
  2256) <a name="l2256" style="background-color: #ffcccc">!</a>
  2257) <a name="l2257" style="background-color: #ffcccc">      IF( N.EQ.0 ) &amp;</a>
  2258) <a name="l2258" style="background-color: #ffcccc">         RETURN</a>
  2259) <a name="l2259" style="background-color: #ffcccc">      IF( ILO.EQ.IHI ) THEN</a>
  2260) <a name="l2260" style="background-color: #ffcccc">         WR( ILO ) = H( ILO, ILO )</a>
  2261) <a name="l2261" style="background-color: #ffcccc">         WI( ILO ) = ZERO</a>
  2262) <a name="l2262" style="background-color: #ffcccc">         RETURN</a>
  2263) <a name="l2263" style="background-color: #ffcccc">      END IF</a>
  2264) <a name="l2264" style="background-color: #ffcccc">!</a>
  2265) <a name="l2265" style="background-color: #ffcccc">!     Set rows and columns ILO to IHI to zero below the first</a>
  2266) <a name="l2266" style="background-color: #ffcccc">!     subdiagonal.</a>
  2267) <a name="l2267" style="background-color: #ffcccc">!</a>
  2268) <a name="l2268" style="background-color: #ffcccc">      DO 40 J = ILO, IHI - 2</a>
  2269) <a name="l2269" style="background-color: #ffcccc">         DO 30 I = J + 2, N</a>
  2270) <a name="l2270" style="background-color: #ffcccc">            H( I, J ) = ZERO</a>
  2271) <a name="l2271" style="background-color: #ffcccc">   30    CONTINUE</a>
  2272) <a name="l2272" style="background-color: #ffcccc">   40 CONTINUE</a>
  2273) <a name="l2273" style="background-color: #ffcccc">      NH = IHI - ILO + 1</a>
  2274) <a name="l2274" style="background-color: #ffcccc">!</a>
  2275) <a name="l2275" style="background-color: #ffcccc">!     Determine the order of the multi-shift QR algorithm to be used.</a>
  2276) <a name="l2276" style="background-color: #ffcccc">!</a>
  2277) <a name="l2277" style="background-color: #ffcccc">      NS = ILAENV( 4, 'SHSEQR', JOB // COMPZ, N, ILO, IHI, -1 )</a>
  2278) <a name="l2278" style="background-color: #ffcccc">      MAXB = ILAENV( 8, 'SHSEQR', JOB // COMPZ, N, ILO, IHI, -1 )</a>
  2279) <a name="l2279" style="background-color: #ffcccc">      IF( NS.LE.2 .OR. NS.GT.NH .OR. MAXB.GE.NH ) THEN</a>
  2280) <a name="l2280" style="background-color: #ffcccc">!</a>
  2281) <a name="l2281" style="background-color: #ffcccc">!        Use the standard double-shift algorithm</a>
  2282) <a name="l2282" style="background-color: #ffcccc">!</a>
  2283) <a name="l2283" style="background-color: #ffcccc">         CALL SLAHQR( WANTT, WANTZ, N, ILO, IHI, H, LDH, WR, WI, ILO, &amp;</a>
  2284) <a name="l2284" style="background-color: #ffcccc">                      IHI, Z, LDZ, INFO )</a>
  2285) <a name="l2285" style="background-color: #ffcccc">         RETURN</a>
  2286) <a name="l2286" style="background-color: #ffcccc">      END IF</a>
  2287) <a name="l2287" style="background-color: #ffcccc">      MAXB = MAX( 3, MAXB )</a>
  2288) <a name="l2288" style="background-color: #ffcccc">      NS = MIN( NS, MAXB, NSMAX )</a>
  2289) <a name="l2289" style="background-color: #ffcccc">!</a>
  2290) <a name="l2290" style="background-color: #ffcccc">!     Now 2 &lt; NS &lt;= MAXB &lt; NH.</a>
  2291) <a name="l2291" style="background-color: #ffcccc">!</a>
  2292) <a name="l2292" style="background-color: #ffcccc">!     Set machine-dependent constants for the stopping criterion.</a>
  2293) <a name="l2293" style="background-color: #ffcccc">!     If norm(H) &lt;= sqrt(OVFL), overflow should not occur.</a>
  2294) <a name="l2294" style="background-color: #ffcccc">!</a>
  2295) <a name="l2295" style="background-color: #ffcccc">      UNFL = SLAMCH( 'Safe minimum' )</a>
  2296) <a name="l2296" style="background-color: #ffcccc">      OVFL = ONE / UNFL</a>
  2297) <a name="l2297" style="background-color: #ffcccc">      CALL SLABAD( UNFL, OVFL )</a>
  2298) <a name="l2298" style="background-color: #ffcccc">      ULP = SLAMCH( 'Precision' )</a>
  2299) <a name="l2299" style="background-color: #ffcccc">      SMLNUM = UNFL*( NH / ULP )</a>
  2300) <a name="l2300" style="background-color: #ffcccc">!</a>
  2301) <a name="l2301" style="background-color: #ffcccc">!     I1 and I2 are the indices of the first row and last column of H</a>
  2302) <a name="l2302" style="background-color: #ffcccc">!     to which transformations must be applied. If eigenvalues only are</a>
  2303) <a name="l2303" style="background-color: #ffcccc">!     being computed, I1 and I2 are set inside the main loop.</a>
  2304) <a name="l2304" style="background-color: #ffcccc">!</a>
  2305) <a name="l2305" style="background-color: #ffcccc">      IF( WANTT ) THEN</a>
  2306) <a name="l2306" style="background-color: #ffcccc">         I1 = 1</a>
  2307) <a name="l2307" style="background-color: #ffcccc">         I2 = N</a>
  2308) <a name="l2308" style="background-color: #ffcccc">      END IF</a>
  2309) <a name="l2309" style="background-color: #ffcccc">!</a>
  2310) <a name="l2310" style="background-color: #ffcccc">!     ITN is the total number of multiple-shift QR iterations allowed.</a>
  2311) <a name="l2311" style="background-color: #ffcccc">!</a>
  2312) <a name="l2312" style="background-color: #ffcccc">      ITN = 30*NH</a>
  2313) <a name="l2313" style="background-color: #ffcccc">!</a>
  2314) <a name="l2314" style="background-color: #ffcccc">!     The main loop begins here. I is the loop index and decreases from</a>
  2315) <a name="l2315" style="background-color: #ffcccc">!     IHI to ILO in steps of at most MAXB. Each iteration of the loop</a>
  2316) <a name="l2316" style="background-color: #ffcccc">!     works with the active submatrix in rows and columns L to I.</a>
  2317) <a name="l2317" style="background-color: #ffcccc">!     Eigenvalues I+1 to IHI have already converged. Either L = ILO or</a>
  2318) <a name="l2318" style="background-color: #ffcccc">!     H(L,L-1) is negligible so that the matrix splits.</a>
  2319) <a name="l2319" style="background-color: #ffcccc">!</a>
  2320) <a name="l2320" style="background-color: #ffcccc">      I = IHI</a>
  2321) <a name="l2321" style="background-color: #ffcccc">   50 CONTINUE</a>
  2322) <a name="l2322" style="background-color: #ffcccc">      L = ILO</a>
  2323) <a name="l2323" style="background-color: #ffcccc">      IF( I.LT.ILO ) &amp;</a>
  2324) <a name="l2324" style="background-color: #ffcccc">         GO TO 170</a>
  2325) <a name="l2325" style="background-color: #ffcccc">!</a>
  2326) <a name="l2326" style="background-color: #ffcccc">!     Perform multiple-shift QR iterations on rows and columns ILO to I</a>
  2327) <a name="l2327" style="background-color: #ffcccc">!     until a submatrix of order at most MAXB splits off at the bottom</a>
  2328) <a name="l2328" style="background-color: #ffcccc">!     because a subdiagonal element has become negligible.</a>
  2329) <a name="l2329" style="background-color: #ffcccc">!</a>
  2330) <a name="l2330" style="background-color: #ffcccc">      DO 150 ITS = 0, ITN</a>
  2331) <a name="l2331" style="background-color: #ffcccc">!</a>
  2332) <a name="l2332" style="background-color: #ffcccc">!        Look for a single small subdiagonal element.</a>
  2333) <a name="l2333" style="background-color: #ffcccc">!</a>
  2334) <a name="l2334" style="background-color: #ffcccc">         DO 60 K = I, L + 1, -1</a>
  2335) <a name="l2335" style="background-color: #ffcccc">            TST1 = ABS( H( K-1, K-1 ) ) + ABS( H( K, K ) )</a>
  2336) <a name="l2336" style="background-color: #ffcccc">            IF( TST1.EQ.ZERO ) &amp;</a>
  2337) <a name="l2337" style="background-color: #ffcccc">               TST1 = SLANHS( '1', I-L+1, H( L, L ), LDH, WORK )</a>
  2338) <a name="l2338" style="background-color: #ffcccc">            IF( ABS( H( K, K-1 ) ).LE.MAX( ULP*TST1, SMLNUM ) ) &amp;</a>
  2339) <a name="l2339" style="background-color: #ffcccc">               GO TO 70</a>
  2340) <a name="l2340" style="background-color: #ffcccc">   60    CONTINUE</a>
  2341) <a name="l2341" style="background-color: #ffcccc">   70    CONTINUE</a>
  2342) <a name="l2342" style="background-color: #ffcccc">         L = K</a>
  2343) <a name="l2343" style="background-color: #ffcccc">         IF( L.GT.ILO ) THEN</a>
  2344) <a name="l2344" style="background-color: #ffcccc">!</a>
  2345) <a name="l2345" style="background-color: #ffcccc">!           H(L,L-1) is negligible.</a>
  2346) <a name="l2346" style="background-color: #ffcccc">!</a>
  2347) <a name="l2347" style="background-color: #ffcccc">            H( L, L-1 ) = ZERO</a>
  2348) <a name="l2348" style="background-color: #ffcccc">         END IF</a>
  2349) <a name="l2349" style="background-color: #ffcccc">!</a>
  2350) <a name="l2350" style="background-color: #ffcccc">!        Exit from loop if a submatrix of order &lt;= MAXB has split off.</a>
  2351) <a name="l2351" style="background-color: #ffcccc">!</a>
  2352) <a name="l2352" style="background-color: #ffcccc">         IF( L.GE.I-MAXB+1 ) &amp;</a>
  2353) <a name="l2353" style="background-color: #ffcccc">            GO TO 160</a>
  2354) <a name="l2354" style="background-color: #ffcccc">!</a>
  2355) <a name="l2355" style="background-color: #ffcccc">!        Now the active submatrix is in rows and columns L to I. If</a>
  2356) <a name="l2356" style="background-color: #ffcccc">!        eigenvalues only are being computed, only the active submatrix</a>
  2357) <a name="l2357" style="background-color: #ffcccc">!        need be transformed.</a>
  2358) <a name="l2358" style="background-color: #ffcccc">!</a>
  2359) <a name="l2359" style="background-color: #ffcccc">         IF( .NOT.WANTT ) THEN</a>
  2360) <a name="l2360" style="background-color: #ffcccc">            I1 = L</a>
  2361) <a name="l2361" style="background-color: #ffcccc">            I2 = I</a>
  2362) <a name="l2362" style="background-color: #ffcccc">         END IF</a>
  2363) <a name="l2363" style="background-color: #ffcccc">!</a>
  2364) <a name="l2364" style="background-color: #ffcccc">         IF( ITS.EQ.20 .OR. ITS.EQ.30 ) THEN</a>
  2365) <a name="l2365" style="background-color: #ffcccc">!</a>
  2366) <a name="l2366" style="background-color: #ffcccc">!           Exceptional shifts.</a>
  2367) <a name="l2367" style="background-color: #ffcccc">!</a>
  2368) <a name="l2368" style="background-color: #ffcccc">            DO 80 II = I - NS + 1, I</a>
  2369) <a name="l2369" style="background-color: #ffcccc">               WR( II ) = CONST*( ABS( H( II, II-1 ) )+ &amp;</a>
  2370) <a name="l2370" style="background-color: #ffcccc">                          ABS( H( II, II ) ) )</a>
  2371) <a name="l2371" style="background-color: #ffcccc">               WI( II ) = ZERO</a>
  2372) <a name="l2372" style="background-color: #ffcccc">   80       CONTINUE</a>
  2373) <a name="l2373" style="background-color: #ffcccc">         ELSE</a>
  2374) <a name="l2374" style="background-color: #ffcccc">!</a>
  2375) <a name="l2375" style="background-color: #ffcccc">!           Use eigenvalues of trailing submatrix of order NS as shifts.</a>
  2376) <a name="l2376" style="background-color: #ffcccc">!</a>
  2377) <a name="l2377" style="background-color: #ffcccc">            CALL SLACPY( 'Full', NS, NS, H( I-NS+1, I-NS+1 ), LDH, S, &amp;</a>
  2378) <a name="l2378" style="background-color: #ffcccc">                         LDS )</a>
  2379) <a name="l2379" style="background-color: #ffcccc">            CALL SLAHQR( .FALSE., .FALSE., NS, 1, NS, S, LDS, &amp;</a>
  2380) <a name="l2380" style="background-color: #ffcccc">                         WR( I-NS+1 ), WI( I-NS+1 ), 1, NS, Z, LDZ, &amp;</a>
  2381) <a name="l2381" style="background-color: #ffcccc">                         IERR )</a>
  2382) <a name="l2382" style="background-color: #ffcccc">            IF( IERR.GT.0 ) THEN</a>
  2383) <a name="l2383" style="background-color: #ffcccc">!</a>
  2384) <a name="l2384" style="background-color: #ffcccc">!              If SLAHQR failed to compute all NS eigenvalues, use the</a>
  2385) <a name="l2385" style="background-color: #ffcccc">!              unconverged diagonal elements as the remaining shifts.</a>
  2386) <a name="l2386" style="background-color: #ffcccc">!</a>
  2387) <a name="l2387" style="background-color: #ffcccc">               DO 90 II = 1, IERR</a>
  2388) <a name="l2388" style="background-color: #ffcccc">                  WR( I-NS+II ) = S( II, II )</a>
  2389) <a name="l2389" style="background-color: #ffcccc">                  WI( I-NS+II ) = ZERO</a>
  2390) <a name="l2390" style="background-color: #ffcccc">   90          CONTINUE</a>
  2391) <a name="l2391" style="background-color: #ffcccc">            END IF</a>
  2392) <a name="l2392" style="background-color: #ffcccc">         END IF</a>
  2393) <a name="l2393" style="background-color: #ffcccc">!</a>
  2394) <a name="l2394" style="background-color: #ffcccc">!        Form the first column of (G-w(1)) (G-w(2)) . . . (G-w(ns))</a>
  2395) <a name="l2395" style="background-color: #ffcccc">!        where G is the Hessenberg submatrix H(L:I,L:I) and w is</a>
  2396) <a name="l2396" style="background-color: #ffcccc">!        the vector of shifts (stored in WR and WI). The result is</a>
  2397) <a name="l2397" style="background-color: #ffcccc">!        stored in the local array V.</a>
  2398) <a name="l2398" style="background-color: #ffcccc">!</a>
  2399) <a name="l2399" style="background-color: #ffcccc">         V( 1 ) = ONE</a>
  2400) <a name="l2400" style="background-color: #ffcccc">         DO 100 II = 2, NS + 1</a>
  2401) <a name="l2401" style="background-color: #ffcccc">            V( II ) = ZERO</a>
  2402) <a name="l2402" style="background-color: #ffcccc">  100    CONTINUE</a>
  2403) <a name="l2403" style="background-color: #ffcccc">         NV = 1</a>
  2404) <a name="l2404" style="background-color: #ffcccc">         DO 120 J = I - NS + 1, I</a>
  2405) <a name="l2405" style="background-color: #ffcccc">            IF( WI( J ).GE.ZERO ) THEN</a>
  2406) <a name="l2406" style="background-color: #ffcccc">               IF( WI( J ).EQ.ZERO ) THEN</a>
  2407) <a name="l2407" style="background-color: #ffcccc">!</a>
  2408) <a name="l2408" style="background-color: #ffcccc">!                 real shift</a>
  2409) <a name="l2409" style="background-color: #ffcccc">!</a>
  2410) <a name="l2410" style="background-color: #ffcccc">                  CALL SCOPY( NV+1, V, 1, VV, 1 )</a>
  2411) <a name="l2411" style="background-color: #ffcccc">                  CALL SGEMV( 'No transpose', NV+1, NV, ONE, H( L, L ), &amp;</a>
  2412) <a name="l2412" style="background-color: #ffcccc">                              LDH, VV, 1, -WR( J ), V, 1 )</a>
  2413) <a name="l2413" style="background-color: #ffcccc">                  NV = NV + 1</a>
  2414) <a name="l2414" style="background-color: #ffcccc">               ELSE IF( WI( J ).GT.ZERO ) THEN</a>
  2415) <a name="l2415" style="background-color: #ffcccc">!</a>
  2416) <a name="l2416" style="background-color: #ffcccc">!                 complex conjugate pair of shifts</a>
  2417) <a name="l2417" style="background-color: #ffcccc">!</a>
  2418) <a name="l2418" style="background-color: #ffcccc">                  CALL SCOPY( NV+1, V, 1, VV, 1 )</a>
  2419) <a name="l2419" style="background-color: #ffcccc">                  CALL SGEMV( 'No transpose', NV+1, NV, ONE, H( L, L ), &amp;</a>
  2420) <a name="l2420" style="background-color: #ffcccc">                              LDH, V, 1, -TWO*WR( J ), VV, 1 )</a>
  2421) <a name="l2421" style="background-color: #ffcccc">                  ITEMP = ISAMAX( NV+1, VV, 1 )</a>
  2422) <a name="l2422" style="background-color: #ffcccc">                  TEMP = ONE / MAX( ABS( VV( ITEMP ) ), SMLNUM )</a>
  2423) <a name="l2423" style="background-color: #ffcccc">                  CALL SSCAL( NV+1, TEMP, VV, 1 )</a>
  2424) <a name="l2424" style="background-color: #ffcccc">                  ABSW = SLAPY2( WR( J ), WI( J ) )</a>
  2425) <a name="l2425" style="background-color: #ffcccc">                  TEMP = ( TEMP*ABSW )*ABSW</a>
  2426) <a name="l2426" style="background-color: #ffcccc">                  CALL SGEMV( 'No transpose', NV+2, NV+1, ONE, &amp;</a>
  2427) <a name="l2427" style="background-color: #ffcccc">                              H( L, L ), LDH, VV, 1, TEMP, V, 1 )</a>
  2428) <a name="l2428" style="background-color: #ffcccc">                  NV = NV + 2</a>
  2429) <a name="l2429" style="background-color: #ffcccc">               END IF</a>
  2430) <a name="l2430" style="background-color: #ffcccc">!</a>
  2431) <a name="l2431" style="background-color: #ffcccc">!              Scale V(1:NV) so that max(abs(V(i))) = 1. If V is zero,</a>
  2432) <a name="l2432" style="background-color: #ffcccc">!              reset it to the unit vector.</a>
  2433) <a name="l2433" style="background-color: #ffcccc">!</a>
  2434) <a name="l2434" style="background-color: #ffcccc">               ITEMP = ISAMAX( NV, V, 1 )</a>
  2435) <a name="l2435" style="background-color: #ffcccc">               TEMP = ABS( V( ITEMP ) )</a>
  2436) <a name="l2436" style="background-color: #ffcccc">               IF( TEMP.EQ.ZERO ) THEN</a>
  2437) <a name="l2437" style="background-color: #ffcccc">                  V( 1 ) = ONE</a>
  2438) <a name="l2438" style="background-color: #ffcccc">                  DO 110 II = 2, NV</a>
  2439) <a name="l2439" style="background-color: #ffcccc">                     V( II ) = ZERO</a>
  2440) <a name="l2440" style="background-color: #ffcccc">  110             CONTINUE</a>
  2441) <a name="l2441" style="background-color: #ffcccc">               ELSE</a>
  2442) <a name="l2442" style="background-color: #ffcccc">                  TEMP = MAX( TEMP, SMLNUM )</a>
  2443) <a name="l2443" style="background-color: #ffcccc">                  CALL SSCAL( NV, ONE / TEMP, V, 1 )</a>
  2444) <a name="l2444" style="background-color: #ffcccc">               END IF</a>
  2445) <a name="l2445" style="background-color: #ffcccc">            END IF</a>
  2446) <a name="l2446" style="background-color: #ffcccc">  120    CONTINUE</a>
  2447) <a name="l2447" style="background-color: #ffcccc">!</a>
  2448) <a name="l2448" style="background-color: #ffcccc">!        Multiple-shift QR step</a>
  2449) <a name="l2449" style="background-color: #ffcccc">!</a>
  2450) <a name="l2450" style="background-color: #ffcccc">         DO 140 K = L, I - 1</a>
  2451) <a name="l2451" style="background-color: #ffcccc">!</a>
  2452) <a name="l2452" style="background-color: #ffcccc">!           The first iteration of this loop determines a reflection G</a>
  2453) <a name="l2453" style="background-color: #ffcccc">!           from the vector V and applies it from left and right to H,</a>
  2454) <a name="l2454" style="background-color: #ffcccc">!           thus creating a nonzero bulge below the subdiagonal.</a>
  2455) <a name="l2455" style="background-color: #ffcccc">!</a>
  2456) <a name="l2456" style="background-color: #ffcccc">!           Each subsequent iteration determines a reflection G to</a>
  2457) <a name="l2457" style="background-color: #ffcccc">!           restore the Hessenberg form in the (K-1)th column, and thus</a>
  2458) <a name="l2458" style="background-color: #ffcccc">!           chases the bulge one step toward the bottom of the active</a>
  2459) <a name="l2459" style="background-color: #ffcccc">!           submatrix. NR is the order of G.</a>
  2460) <a name="l2460" style="background-color: #ffcccc">!</a>
  2461) <a name="l2461" style="background-color: #ffcccc">            NR = MIN( NS+1, I-K+1 )</a>
  2462) <a name="l2462" style="background-color: #ffcccc">            IF( K.GT.L ) &amp;</a>
  2463) <a name="l2463" style="background-color: #ffcccc">               CALL SCOPY( NR, H( K, K-1 ), 1, V, 1 )</a>
  2464) <a name="l2464" style="background-color: #ffcccc">            CALL SLARFG( NR, V( 1 ), V( 2 ), 1, TAU )</a>
  2465) <a name="l2465" style="background-color: #ffcccc">            IF( K.GT.L ) THEN</a>
  2466) <a name="l2466" style="background-color: #ffcccc">               H( K, K-1 ) = V( 1 )</a>
  2467) <a name="l2467" style="background-color: #ffcccc">               DO 130 II = K + 1, I</a>
  2468) <a name="l2468" style="background-color: #ffcccc">                  H( II, K-1 ) = ZERO</a>
  2469) <a name="l2469" style="background-color: #ffcccc">  130          CONTINUE</a>
  2470) <a name="l2470" style="background-color: #ffcccc">            END IF</a>
  2471) <a name="l2471" style="background-color: #ffcccc">            V( 1 ) = ONE</a>
  2472) <a name="l2472" style="background-color: #ffcccc">!</a>
  2473) <a name="l2473" style="background-color: #ffcccc">!           Apply G from the left to transform the rows of the matrix in</a>
  2474) <a name="l2474" style="background-color: #ffcccc">!           columns K to I2.</a>
  2475) <a name="l2475" style="background-color: #ffcccc">!</a>
  2476) <a name="l2476" style="background-color: #ffcccc">            CALL SLARFX( 'Left', NR, I2-K+1, V, TAU, H( K, K ), LDH, &amp;</a>
  2477) <a name="l2477" style="background-color: #ffcccc">                         WORK )</a>
  2478) <a name="l2478" style="background-color: #ffcccc">!</a>
  2479) <a name="l2479" style="background-color: #ffcccc">!           Apply G from the right to transform the columns of the</a>
  2480) <a name="l2480" style="background-color: #ffcccc">!           matrix in rows I1 to min(K+NR,I).</a>
  2481) <a name="l2481" style="background-color: #ffcccc">!</a>
  2482) <a name="l2482" style="background-color: #ffcccc">            CALL SLARFX( 'Right', MIN( K+NR, I )-I1+1, NR, V, TAU, &amp;</a>
  2483) <a name="l2483" style="background-color: #ffcccc">                         H( I1, K ), LDH, WORK )</a>
  2484) <a name="l2484" style="background-color: #ffcccc">!</a>
  2485) <a name="l2485" style="background-color: #ffcccc">            IF( WANTZ ) THEN</a>
  2486) <a name="l2486" style="background-color: #ffcccc">!</a>
  2487) <a name="l2487" style="background-color: #ffcccc">!              Accumulate transformations in the matrix Z</a>
  2488) <a name="l2488" style="background-color: #ffcccc">!</a>
  2489) <a name="l2489" style="background-color: #ffcccc">               CALL SLARFX( 'Right', NH, NR, V, TAU, Z( ILO, K ), LDZ, &amp;</a>
  2490) <a name="l2490" style="background-color: #ffcccc">                            WORK )</a>
  2491) <a name="l2491" style="background-color: #ffcccc">            END IF</a>
  2492) <a name="l2492" style="background-color: #ffcccc">  140    CONTINUE</a>
  2493) <a name="l2493" style="background-color: #ffcccc">!</a>
  2494) <a name="l2494" style="background-color: #ffcccc">  150 CONTINUE</a>
  2495) <a name="l2495" style="background-color: #ffcccc">!</a>
  2496) <a name="l2496" style="background-color: #ffcccc">!     Failure to converge in remaining number of iterations</a>
  2497) <a name="l2497" style="background-color: #ffcccc">!</a>
  2498) <a name="l2498" style="background-color: #ffcccc">      INFO = I</a>
  2499) <a name="l2499" style="background-color: #ffcccc">      RETURN</a>
  2500) <a name="l2500" style="background-color: #ffcccc">!</a>
  2501) <a name="l2501" style="background-color: #ffcccc">  160 CONTINUE</a>
  2502) <a name="l2502" style="background-color: #ffcccc">!</a>
  2503) <a name="l2503" style="background-color: #ffcccc">!     A submatrix of order &lt;= MAXB in rows and columns L to I has split</a>
  2504) <a name="l2504" style="background-color: #ffcccc">!     off. Use the double-shift QR algorithm to handle it.</a>
  2505) <a name="l2505" style="background-color: #ffcccc">!</a>
  2506) <a name="l2506" style="background-color: #ffcccc">      CALL SLAHQR( WANTT, WANTZ, N, L, I, H, LDH, WR, WI, ILO, IHI, Z, &amp;</a>
  2507) <a name="l2507" style="background-color: #ffcccc">                   LDZ, INFO )</a>
  2508) <a name="l2508" style="background-color: #ffcccc">      IF( INFO.GT.0 ) &amp;</a>
  2509) <a name="l2509" style="background-color: #ffcccc">         RETURN</a>
  2510) <a name="l2510" style="background-color: #ffcccc">!</a>
  2511) <a name="l2511" style="background-color: #ffcccc">!     Decrement number of remaining iterations, and return to start of</a>
  2512) <a name="l2512" style="background-color: #ffcccc">!     the main loop with a new value of I.</a>
  2513) <a name="l2513" style="background-color: #ffcccc">!</a>
  2514) <a name="l2514" style="background-color: #ffcccc">      ITN = ITN - ITS</a>
  2515) <a name="l2515" style="background-color: #ffcccc">      I = L - 1</a>
  2516) <a name="l2516" style="background-color: #ffcccc">      GO TO 50</a>
  2517) <a name="l2517" style="background-color: #ffcccc">!</a>
  2518) <a name="l2518" style="background-color: #ffcccc">  170 CONTINUE</a>
  2519) <a name="l2519" style="background-color: #ffcccc">      RETURN</a>
  2520) <a name="l2520" style="background-color: #ffcccc">!</a>
  2521) <a name="l2521" style="background-color: #ffcccc">!     End of SHSEQR</a>
  2522) <a name="l2522" style="background-color: #ffcccc">!</a>
  2523) <a name="l2523" style="background-color: #ffcccc">      END SUBROUTINE SHSEQR</a>
  2524) <a name="l2524" style="background-color: #ffffff"></a>
  2525) <a name="l2525" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  2526) <a name="l2526" style="background-color: #ffffff"></a>
  2527) <a name="l2527" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLABAD( SMALL, LARGE )</a>
  2528) <a name="l2528" style="background-color: #ffcccc"></a>
  2529) <a name="l2529" style="background-color: #ffcccc">!</a>
  2530) <a name="l2530" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  2531) <a name="l2531" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  2532) <a name="l2532" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  2533) <a name="l2533" style="background-color: #ffcccc">!     October 31, 1992</a>
  2534) <a name="l2534" style="background-color: #ffcccc">!</a>
  2535) <a name="l2535" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  2536) <a name="l2536" style="background-color: #ffcccc">      REAL(r8)               LARGE, SMALL</a>
  2537) <a name="l2537" style="background-color: #ffcccc">!     ..</a>
  2538) <a name="l2538" style="background-color: #ffcccc">!</a>
  2539) <a name="l2539" style="background-color: #ffcccc">!  Purpose</a>
  2540) <a name="l2540" style="background-color: #ffcccc">!  =======</a>
  2541) <a name="l2541" style="background-color: #ffcccc">!</a>
  2542) <a name="l2542" style="background-color: #ffcccc">!  SLABAD takes as input the values computed by SLAMCH for underflow and</a>
  2543) <a name="l2543" style="background-color: #ffcccc">!  overflow, and returns the square root of each of these values if the</a>
  2544) <a name="l2544" style="background-color: #ffcccc">!  log of LARGE is sufficiently large.  This subroutine is intended to</a>
  2545) <a name="l2545" style="background-color: #ffcccc">!  identify machines with a large exponent range, such as the Crays, and</a>
  2546) <a name="l2546" style="background-color: #ffcccc">!  redefine the underflow and overflow limits to be the square roots of</a>
  2547) <a name="l2547" style="background-color: #ffcccc">!  the values computed by SLAMCH.  This subroutine is needed because</a>
  2548) <a name="l2548" style="background-color: #ffcccc">!  SLAMCH does not compensate for poor arithmetic in the upper half of</a>
  2549) <a name="l2549" style="background-color: #ffcccc">!  the exponent range, as is found on a Cray.</a>
  2550) <a name="l2550" style="background-color: #ffcccc">!</a>
  2551) <a name="l2551" style="background-color: #ffcccc">!  Arguments</a>
  2552) <a name="l2552" style="background-color: #ffcccc">!  =========</a>
  2553) <a name="l2553" style="background-color: #ffcccc">!</a>
  2554) <a name="l2554" style="background-color: #ffcccc">!  SMALL   (input/output) REAL</a>
  2555) <a name="l2555" style="background-color: #ffcccc">!          On entry, the underflow threshold as computed by SLAMCH.</a>
  2556) <a name="l2556" style="background-color: #ffcccc">!          On exit, if LOG10(LARGE) is sufficiently large, the square</a>
  2557) <a name="l2557" style="background-color: #ffcccc">!          root of SMALL, otherwise unchanged.</a>
  2558) <a name="l2558" style="background-color: #ffcccc">!</a>
  2559) <a name="l2559" style="background-color: #ffcccc">!  LARGE   (input/output) REAL</a>
  2560) <a name="l2560" style="background-color: #ffcccc">!          On entry, the overflow threshold as computed by SLAMCH.</a>
  2561) <a name="l2561" style="background-color: #ffcccc">!          On exit, if LOG10(LARGE) is sufficiently large, the square</a>
  2562) <a name="l2562" style="background-color: #ffcccc">!          root of LARGE, otherwise unchanged.</a>
  2563) <a name="l2563" style="background-color: #ffcccc">!</a>
  2564) <a name="l2564" style="background-color: #ffcccc">!  =====================================================================</a>
  2565) <a name="l2565" style="background-color: #ffcccc">!</a>
  2566) <a name="l2566" style="background-color: #ffcccc">!     ..</a>
  2567) <a name="l2567" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  2568) <a name="l2568" style="background-color: #ffcccc">!</a>
  2569) <a name="l2569" style="background-color: #ffcccc">!     If it looks like we're on a Cray, take the square root of</a>
  2570) <a name="l2570" style="background-color: #ffcccc">!     SMALL and LARGE to avoid overflow and underflow problems.</a>
  2571) <a name="l2571" style="background-color: #ffcccc">!</a>
  2572) <a name="l2572" style="background-color: #ffcccc">      IF( LOG10( LARGE ).GT.2000._r8 ) THEN</a>
  2573) <a name="l2573" style="background-color: #ffcccc">         SMALL = SQRT( SMALL )</a>
  2574) <a name="l2574" style="background-color: #ffcccc">         LARGE = SQRT( LARGE )</a>
  2575) <a name="l2575" style="background-color: #ffcccc">      END IF</a>
  2576) <a name="l2576" style="background-color: #ffcccc">!</a>
  2577) <a name="l2577" style="background-color: #ffcccc">      RETURN</a>
  2578) <a name="l2578" style="background-color: #ffcccc">!</a>
  2579) <a name="l2579" style="background-color: #ffcccc">!     End of SLABAD</a>
  2580) <a name="l2580" style="background-color: #ffcccc">!</a>
  2581) <a name="l2581" style="background-color: #ffcccc">      END SUBROUTINE SLABAD</a>
  2582) <a name="l2582" style="background-color: #ffffff"></a>
  2583) <a name="l2583" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  2584) <a name="l2584" style="background-color: #ffffff"></a>
  2585) <a name="l2585" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLACPY( UPLO, M, N, A, LDA, B, LDB )</a>
  2586) <a name="l2586" style="background-color: #ffcccc"></a>
  2587) <a name="l2587" style="background-color: #ffcccc">!</a>
  2588) <a name="l2588" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  2589) <a name="l2589" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  2590) <a name="l2590" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  2591) <a name="l2591" style="background-color: #ffcccc">!     February 29, 1992</a>
  2592) <a name="l2592" style="background-color: #ffcccc">!</a>
  2593) <a name="l2593" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  2594) <a name="l2594" style="background-color: #ffcccc">      CHARACTER          UPLO</a>
  2595) <a name="l2595" style="background-color: #ffcccc">      INTEGER            LDA, LDB, M, N</a>
  2596) <a name="l2596" style="background-color: #ffcccc">!     ..</a>
  2597) <a name="l2597" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  2598) <a name="l2598" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), B( LDB, * )</a>
  2599) <a name="l2599" style="background-color: #ffcccc">!     ..</a>
  2600) <a name="l2600" style="background-color: #ffcccc">!</a>
  2601) <a name="l2601" style="background-color: #ffcccc">!  Purpose</a>
  2602) <a name="l2602" style="background-color: #ffcccc">!  =======</a>
  2603) <a name="l2603" style="background-color: #ffcccc">!</a>
  2604) <a name="l2604" style="background-color: #ffcccc">!  SLACPY copies all or part of a two-dimensional matrix A to another</a>
  2605) <a name="l2605" style="background-color: #ffcccc">!  matrix B.</a>
  2606) <a name="l2606" style="background-color: #ffcccc">!</a>
  2607) <a name="l2607" style="background-color: #ffcccc">!  Arguments</a>
  2608) <a name="l2608" style="background-color: #ffcccc">!  =========</a>
  2609) <a name="l2609" style="background-color: #ffcccc">!</a>
  2610) <a name="l2610" style="background-color: #ffcccc">!  UPLO    (input) CHARACTER*1</a>
  2611) <a name="l2611" style="background-color: #ffcccc">!          Specifies the part of the matrix A to be copied to B.</a>
  2612) <a name="l2612" style="background-color: #ffcccc">!          = 'U':      Upper triangular part</a>
  2613) <a name="l2613" style="background-color: #ffcccc">!          = 'L':      Lower triangular part</a>
  2614) <a name="l2614" style="background-color: #ffcccc">!          Otherwise:  All of the matrix A</a>
  2615) <a name="l2615" style="background-color: #ffcccc">!</a>
  2616) <a name="l2616" style="background-color: #ffcccc">!  M       (input) INTEGER</a>
  2617) <a name="l2617" style="background-color: #ffcccc">!          The number of rows of the matrix A.  M &gt;= 0.</a>
  2618) <a name="l2618" style="background-color: #ffcccc">!</a>
  2619) <a name="l2619" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  2620) <a name="l2620" style="background-color: #ffcccc">!          The number of columns of the matrix A.  N &gt;= 0.</a>
  2621) <a name="l2621" style="background-color: #ffcccc">!</a>
  2622) <a name="l2622" style="background-color: #ffcccc">!  A       (input) REAL array, dimension (LDA,N)</a>
  2623) <a name="l2623" style="background-color: #ffcccc">!          The m by n matrix A.  If UPLO = 'U', only the upper triangle</a>
  2624) <a name="l2624" style="background-color: #ffcccc">!          or trapezoid is accessed; if UPLO = 'L', only the lower</a>
  2625) <a name="l2625" style="background-color: #ffcccc">!          triangle or trapezoid is accessed.</a>
  2626) <a name="l2626" style="background-color: #ffcccc">!</a>
  2627) <a name="l2627" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  2628) <a name="l2628" style="background-color: #ffcccc">!          The leading dimension of the array A.  LDA &gt;= max(1,M).</a>
  2629) <a name="l2629" style="background-color: #ffcccc">!</a>
  2630) <a name="l2630" style="background-color: #ffcccc">!  B       (output) REAL array, dimension (LDB,N)</a>
  2631) <a name="l2631" style="background-color: #ffcccc">!          On exit, B = A in the locations specified by UPLO.</a>
  2632) <a name="l2632" style="background-color: #ffcccc">!</a>
  2633) <a name="l2633" style="background-color: #ffcccc">!  LDB     (input) INTEGER</a>
  2634) <a name="l2634" style="background-color: #ffcccc">!          The leading dimension of the array B.  LDB &gt;= max(1,M).</a>
  2635) <a name="l2635" style="background-color: #ffcccc">!</a>
  2636) <a name="l2636" style="background-color: #ffcccc">!  =====================================================================</a>
  2637) <a name="l2637" style="background-color: #ffcccc">!</a>
  2638) <a name="l2638" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  2639) <a name="l2639" style="background-color: #ffcccc">      INTEGER            I, J</a>
  2640) <a name="l2640" style="background-color: #ffcccc">!     ..</a>
  2641) <a name="l2641" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  2642) <a name="l2642" style="background-color: #ffcccc">!</a>
  2643) <a name="l2643" style="background-color: #ffcccc">      IF( LSAME( UPLO, 'U' ) ) THEN</a>
  2644) <a name="l2644" style="background-color: #ffcccc">         DO 20 J = 1, N</a>
  2645) <a name="l2645" style="background-color: #ffcccc">            DO 10 I = 1, MIN( J, M )</a>
  2646) <a name="l2646" style="background-color: #ffcccc">               B( I, J ) = A( I, J )</a>
  2647) <a name="l2647" style="background-color: #ffcccc">   10       CONTINUE</a>
  2648) <a name="l2648" style="background-color: #ffcccc">   20    CONTINUE</a>
  2649) <a name="l2649" style="background-color: #ffcccc">      ELSE IF( LSAME( UPLO, 'L' ) ) THEN</a>
  2650) <a name="l2650" style="background-color: #ffcccc">         DO 40 J = 1, N</a>
  2651) <a name="l2651" style="background-color: #ffcccc">            DO 30 I = J, M</a>
  2652) <a name="l2652" style="background-color: #ffcccc">               B( I, J ) = A( I, J )</a>
  2653) <a name="l2653" style="background-color: #ffcccc">   30       CONTINUE</a>
  2654) <a name="l2654" style="background-color: #ffcccc">   40    CONTINUE</a>
  2655) <a name="l2655" style="background-color: #ffcccc">      ELSE</a>
  2656) <a name="l2656" style="background-color: #ffcccc">         DO 60 J = 1, N</a>
  2657) <a name="l2657" style="background-color: #ffcccc">            DO 50 I = 1, M</a>
  2658) <a name="l2658" style="background-color: #ffcccc">               B( I, J ) = A( I, J )</a>
  2659) <a name="l2659" style="background-color: #ffcccc">   50       CONTINUE</a>
  2660) <a name="l2660" style="background-color: #ffcccc">   60    CONTINUE</a>
  2661) <a name="l2661" style="background-color: #ffcccc">      END IF</a>
  2662) <a name="l2662" style="background-color: #ffcccc">      RETURN</a>
  2663) <a name="l2663" style="background-color: #ffcccc">!</a>
  2664) <a name="l2664" style="background-color: #ffcccc">!     End of SLACPY</a>
  2665) <a name="l2665" style="background-color: #ffcccc">!</a>
  2666) <a name="l2666" style="background-color: #ffcccc">      END SUBROUTINE SLACPY</a>
  2667) <a name="l2667" style="background-color: #ffffff"></a>
  2668) <a name="l2668" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  2669) <a name="l2669" style="background-color: #ffffff"></a>
  2670) <a name="l2670" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLADIV( A, B, C, D, P, Q )</a>
  2671) <a name="l2671" style="background-color: #ffcccc"></a>
  2672) <a name="l2672" style="background-color: #ffcccc">!</a>
  2673) <a name="l2673" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  2674) <a name="l2674" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  2675) <a name="l2675" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  2676) <a name="l2676" style="background-color: #ffcccc">!     October 31, 1992</a>
  2677) <a name="l2677" style="background-color: #ffcccc">!</a>
  2678) <a name="l2678" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  2679) <a name="l2679" style="background-color: #ffcccc">      REAL(r8)               A, B, C, D, P, Q</a>
  2680) <a name="l2680" style="background-color: #ffcccc">!     ..</a>
  2681) <a name="l2681" style="background-color: #ffcccc">!</a>
  2682) <a name="l2682" style="background-color: #ffcccc">!  Purpose</a>
  2683) <a name="l2683" style="background-color: #ffcccc">!  =======</a>
  2684) <a name="l2684" style="background-color: #ffcccc">!</a>
  2685) <a name="l2685" style="background-color: #ffcccc">!  SLADIV performs complex division in  real arithmetic</a>
  2686) <a name="l2686" style="background-color: #ffcccc">!</a>
  2687) <a name="l2687" style="background-color: #ffcccc">!                        a + i*b</a>
  2688) <a name="l2688" style="background-color: #ffcccc">!             p + i*q = ---------</a>
  2689) <a name="l2689" style="background-color: #ffcccc">!                        c + i*d</a>
  2690) <a name="l2690" style="background-color: #ffcccc">!</a>
  2691) <a name="l2691" style="background-color: #ffcccc">!  The algorithm is due to Robert L. Smith and can be found</a>
  2692) <a name="l2692" style="background-color: #ffcccc">!  in D. Knuth, The art of Computer Programming, Vol.2, p.195</a>
  2693) <a name="l2693" style="background-color: #ffcccc">!</a>
  2694) <a name="l2694" style="background-color: #ffcccc">!  Arguments</a>
  2695) <a name="l2695" style="background-color: #ffcccc">!  =========</a>
  2696) <a name="l2696" style="background-color: #ffcccc">!</a>
  2697) <a name="l2697" style="background-color: #ffcccc">!  A       (input) REAL</a>
  2698) <a name="l2698" style="background-color: #ffcccc">!  B       (input) REAL</a>
  2699) <a name="l2699" style="background-color: #ffcccc">!  C       (input) REAL</a>
  2700) <a name="l2700" style="background-color: #ffcccc">!  D       (input) REAL</a>
  2701) <a name="l2701" style="background-color: #ffcccc">!          The scalars a, b, c, and d in the above expression.</a>
  2702) <a name="l2702" style="background-color: #ffcccc">!</a>
  2703) <a name="l2703" style="background-color: #ffcccc">!  P       (output) REAL</a>
  2704) <a name="l2704" style="background-color: #ffcccc">!  Q       (output) REAL</a>
  2705) <a name="l2705" style="background-color: #ffcccc">!          The scalars p and q in the above expression.</a>
  2706) <a name="l2706" style="background-color: #ffcccc">!</a>
  2707) <a name="l2707" style="background-color: #ffcccc">!  =====================================================================</a>
  2708) <a name="l2708" style="background-color: #ffcccc">!</a>
  2709) <a name="l2709" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  2710) <a name="l2710" style="background-color: #ffcccc">      REAL(r8)               E, F</a>
  2711) <a name="l2711" style="background-color: #ffcccc">!     ..</a>
  2712) <a name="l2712" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  2713) <a name="l2713" style="background-color: #ffcccc">!</a>
  2714) <a name="l2714" style="background-color: #ffcccc">      IF( ABS( D ).LT.ABS( C ) ) THEN</a>
  2715) <a name="l2715" style="background-color: #ffcccc">         E = D / C</a>
  2716) <a name="l2716" style="background-color: #ffcccc">         F = C + D*E</a>
  2717) <a name="l2717" style="background-color: #ffcccc">         P = ( A+B*E ) / F</a>
  2718) <a name="l2718" style="background-color: #ffcccc">         Q = ( B-A*E ) / F</a>
  2719) <a name="l2719" style="background-color: #ffcccc">      ELSE</a>
  2720) <a name="l2720" style="background-color: #ffcccc">         E = C / D</a>
  2721) <a name="l2721" style="background-color: #ffcccc">         F = D + C*E</a>
  2722) <a name="l2722" style="background-color: #ffcccc">         P = ( B+A*E ) / F</a>
  2723) <a name="l2723" style="background-color: #ffcccc">         Q = ( -A+B*E ) / F</a>
  2724) <a name="l2724" style="background-color: #ffcccc">      END IF</a>
  2725) <a name="l2725" style="background-color: #ffcccc">!</a>
  2726) <a name="l2726" style="background-color: #ffcccc">      RETURN</a>
  2727) <a name="l2727" style="background-color: #ffcccc">!</a>
  2728) <a name="l2728" style="background-color: #ffcccc">!     End of SLADIV</a>
  2729) <a name="l2729" style="background-color: #ffcccc">!</a>
  2730) <a name="l2730" style="background-color: #ffcccc">      END SUBROUTINE SLADIV</a>
  2731) <a name="l2731" style="background-color: #ffffff"></a>
  2732) <a name="l2732" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  2733) <a name="l2733" style="background-color: #ffffff"></a>
  2734) <a name="l2734" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLAHQR( WANTT, WANTZ, N, ILO, IHI, H, LDH, WR, WI, &amp;</a>
  2735) <a name="l2735" style="background-color: #ffcccc">                         ILOZ, IHIZ, Z, LDZ, INFO )</a>
  2736) <a name="l2736" style="background-color: #ffcccc"></a>
  2737) <a name="l2737" style="background-color: #ffcccc">!</a>
  2738) <a name="l2738" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  2739) <a name="l2739" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  2740) <a name="l2740" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  2741) <a name="l2741" style="background-color: #ffcccc">!     October 31, 1992</a>
  2742) <a name="l2742" style="background-color: #ffcccc">!</a>
  2743) <a name="l2743" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  2744) <a name="l2744" style="background-color: #ffcccc">      LOGICAL            WANTT, WANTZ</a>
  2745) <a name="l2745" style="background-color: #ffcccc">      INTEGER            IHI, IHIZ, ILO, ILOZ, INFO, LDH, LDZ, N</a>
  2746) <a name="l2746" style="background-color: #ffcccc">!     ..</a>
  2747) <a name="l2747" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  2748) <a name="l2748" style="background-color: #ffcccc">      REAL(r8)               H( LDH, * ), WI( * ), WR( * ), Z( LDZ, * )</a>
  2749) <a name="l2749" style="background-color: #ffcccc">!     ..</a>
  2750) <a name="l2750" style="background-color: #ffcccc">!</a>
  2751) <a name="l2751" style="background-color: #ffcccc">!  Purpose</a>
  2752) <a name="l2752" style="background-color: #ffcccc">!  =======</a>
  2753) <a name="l2753" style="background-color: #ffcccc">!</a>
  2754) <a name="l2754" style="background-color: #ffcccc">!  SLAHQR is an auxiliary routine called by SHSEQR to update the</a>
  2755) <a name="l2755" style="background-color: #ffcccc">!  eigenvalues and Schur decomposition already computed by SHSEQR, by</a>
  2756) <a name="l2756" style="background-color: #ffcccc">!  dealing with the Hessenberg submatrix in rows and columns ILO to IHI.</a>
  2757) <a name="l2757" style="background-color: #ffcccc">!</a>
  2758) <a name="l2758" style="background-color: #ffcccc">!  Arguments</a>
  2759) <a name="l2759" style="background-color: #ffcccc">!  =========</a>
  2760) <a name="l2760" style="background-color: #ffcccc">!</a>
  2761) <a name="l2761" style="background-color: #ffcccc">!  WANTT   (input) LOGICAL</a>
  2762) <a name="l2762" style="background-color: #ffcccc">!          = .TRUE. : the full Schur form T is required;</a>
  2763) <a name="l2763" style="background-color: #ffcccc">!          = .FALSE.: only eigenvalues are required.</a>
  2764) <a name="l2764" style="background-color: #ffcccc">!</a>
  2765) <a name="l2765" style="background-color: #ffcccc">!  WANTZ   (input) LOGICAL</a>
  2766) <a name="l2766" style="background-color: #ffcccc">!          = .TRUE. : the matrix of Schur vectors Z is required;</a>
  2767) <a name="l2767" style="background-color: #ffcccc">!          = .FALSE.: Schur vectors are not required.</a>
  2768) <a name="l2768" style="background-color: #ffcccc">!</a>
  2769) <a name="l2769" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  2770) <a name="l2770" style="background-color: #ffcccc">!          The order of the matrix H.  N &gt;= 0.</a>
  2771) <a name="l2771" style="background-color: #ffcccc">!</a>
  2772) <a name="l2772" style="background-color: #ffcccc">!  ILO     (input) INTEGER</a>
  2773) <a name="l2773" style="background-color: #ffcccc">!  IHI     (input) INTEGER</a>
  2774) <a name="l2774" style="background-color: #ffcccc">!          It is assumed that H is already upper quasi-triangular in</a>
  2775) <a name="l2775" style="background-color: #ffcccc">!          rows and columns IHI+1:N, and that H(ILO,ILO-1) = 0 (unless</a>
  2776) <a name="l2776" style="background-color: #ffcccc">!          ILO = 1). SLAHQR works primarily with the Hessenberg</a>
  2777) <a name="l2777" style="background-color: #ffcccc">!          submatrix in rows and columns ILO to IHI, but applies</a>
  2778) <a name="l2778" style="background-color: #ffcccc">!          transformations to all of H if WANTT is .TRUE..</a>
  2779) <a name="l2779" style="background-color: #ffcccc">!          1 &lt;= ILO &lt;= max(1,IHI); IHI &lt;= N.</a>
  2780) <a name="l2780" style="background-color: #ffcccc">!</a>
  2781) <a name="l2781" style="background-color: #ffcccc">!  H       (input/output) REAL array, dimension (LDH,N)</a>
  2782) <a name="l2782" style="background-color: #ffcccc">!          On entry, the upper Hessenberg matrix H.</a>
  2783) <a name="l2783" style="background-color: #ffcccc">!          On exit, if WANTT is .TRUE., H is upper quasi-triangular in</a>
  2784) <a name="l2784" style="background-color: #ffcccc">!          rows and columns ILO:IHI, with any 2-by-2 diagonal blocks in</a>
  2785) <a name="l2785" style="background-color: #ffcccc">!          standard form. If WANTT is .FALSE., the contents of H are</a>
  2786) <a name="l2786" style="background-color: #ffcccc">!          unspecified on exit.</a>
  2787) <a name="l2787" style="background-color: #ffcccc">!</a>
  2788) <a name="l2788" style="background-color: #ffcccc">!  LDH     (input) INTEGER</a>
  2789) <a name="l2789" style="background-color: #ffcccc">!          The leading dimension of the array H. LDH &gt;= max(1,N).</a>
  2790) <a name="l2790" style="background-color: #ffcccc">!</a>
  2791) <a name="l2791" style="background-color: #ffcccc">!  WR      (output) REAL array, dimension (N)</a>
  2792) <a name="l2792" style="background-color: #ffcccc">!  WI      (output) REAL array, dimension (N)</a>
  2793) <a name="l2793" style="background-color: #ffcccc">!          The real and imaginary parts, respectively, of the computed</a>
  2794) <a name="l2794" style="background-color: #ffcccc">!          eigenvalues ILO to IHI are stored in the corresponding</a>
  2795) <a name="l2795" style="background-color: #ffcccc">!          elements of WR and WI. If two eigenvalues are computed as a</a>
  2796) <a name="l2796" style="background-color: #ffcccc">!          complex conjugate pair, they are stored in consecutive</a>
  2797) <a name="l2797" style="background-color: #ffcccc">!          elements of WR and WI, say the i-th and (i+1)th, with</a>
  2798) <a name="l2798" style="background-color: #ffcccc">!          WI(i) &gt; 0 and WI(i+1) &lt; 0. If WANTT is .TRUE., the</a>
  2799) <a name="l2799" style="background-color: #ffcccc">!          eigenvalues are stored in the same order as on the diagonal</a>
  2800) <a name="l2800" style="background-color: #ffcccc">!          of the Schur form returned in H, with WR(i) = H(i,i), and, if</a>
  2801) <a name="l2801" style="background-color: #ffcccc">!          H(i:i+1,i:i+1) is a 2-by-2 diagonal block,</a>
  2802) <a name="l2802" style="background-color: #ffcccc">!          WI(i) = sqrt(H(i+1,i)*H(i,i+1)) and WI(i+1) = -WI(i).</a>
  2803) <a name="l2803" style="background-color: #ffcccc">!</a>
  2804) <a name="l2804" style="background-color: #ffcccc">!  ILOZ    (input) INTEGER</a>
  2805) <a name="l2805" style="background-color: #ffcccc">!  IHIZ    (input) INTEGER</a>
  2806) <a name="l2806" style="background-color: #ffcccc">!          Specify the rows of Z to which transformations must be</a>
  2807) <a name="l2807" style="background-color: #ffcccc">!          applied if WANTZ is .TRUE..</a>
  2808) <a name="l2808" style="background-color: #ffcccc">!          1 &lt;= ILOZ &lt;= ILO; IHI &lt;= IHIZ &lt;= N.</a>
  2809) <a name="l2809" style="background-color: #ffcccc">!</a>
  2810) <a name="l2810" style="background-color: #ffcccc">!  Z       (input/output) REAL array, dimension (LDZ,N)</a>
  2811) <a name="l2811" style="background-color: #ffcccc">!          If WANTZ is .TRUE., on entry Z must contain the current</a>
  2812) <a name="l2812" style="background-color: #ffcccc">!          matrix Z of transformations accumulated by SHSEQR, and on</a>
  2813) <a name="l2813" style="background-color: #ffcccc">!          exit Z has been updated; transformations are applied only to</a>
  2814) <a name="l2814" style="background-color: #ffcccc">!          the submatrix Z(ILOZ:IHIZ,ILO:IHI).</a>
  2815) <a name="l2815" style="background-color: #ffcccc">!          If WANTZ is .FALSE., Z is not referenced.</a>
  2816) <a name="l2816" style="background-color: #ffcccc">!</a>
  2817) <a name="l2817" style="background-color: #ffcccc">!  LDZ     (input) INTEGER</a>
  2818) <a name="l2818" style="background-color: #ffcccc">!          The leading dimension of the array Z. LDZ &gt;= max(1,N).</a>
  2819) <a name="l2819" style="background-color: #ffcccc">!</a>
  2820) <a name="l2820" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  2821) <a name="l2821" style="background-color: #ffcccc">!          = 0: successful exit</a>
  2822) <a name="l2822" style="background-color: #ffcccc">!          &gt; 0: SLAHQR failed to compute all the eigenvalues ILO to IHI</a>
  2823) <a name="l2823" style="background-color: #ffcccc">!               in a total of 30*(IHI-ILO+1) iterations; if INFO = i,</a>
  2824) <a name="l2824" style="background-color: #ffcccc">!               elements i+1:ihi of WR and WI contain those eigenvalues</a>
  2825) <a name="l2825" style="background-color: #ffcccc">!               which have been successfully computed.</a>
  2826) <a name="l2826" style="background-color: #ffcccc">!</a>
  2827) <a name="l2827" style="background-color: #ffcccc">!  =====================================================================</a>
  2828) <a name="l2828" style="background-color: #ffcccc">!</a>
  2829) <a name="l2829" style="background-color: #ffcccc">!     .. Parameters ..</a>
  2830) <a name="l2830" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
  2831) <a name="l2831" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8, ONE = 1.0E+0_r8 )</a>
  2832) <a name="l2832" style="background-color: #ffcccc">      REAL(r8)               DAT1, DAT2</a>
  2833) <a name="l2833" style="background-color: #ffcccc">      PARAMETER          ( DAT1 = 0.75E+0_r8, DAT2 = -0.4375E+0_r8 )</a>
  2834) <a name="l2834" style="background-color: #ffcccc">!     ..</a>
  2835) <a name="l2835" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  2836) <a name="l2836" style="background-color: #ffcccc">      INTEGER            I, I1, I2, ITN, ITS, J, K, L, M, NH, NR, NZ</a>
  2837) <a name="l2837" style="background-color: #ffcccc">      REAL(r8)               CS, H00, H10, H11, H12, H21, H22, H33, H33S, &amp;</a>
  2838) <a name="l2838" style="background-color: #ffcccc">                         H43H34, H44, H44S, OVFL, S, SMLNUM, SN, SUM, &amp;</a>
  2839) <a name="l2839" style="background-color: #ffcccc">                         T1, T2, T3, TST1, ULP, UNFL, V1, V2, V3</a>
  2840) <a name="l2840" style="background-color: #ffcccc">!     ..</a>
  2841) <a name="l2841" style="background-color: #ffcccc">!     .. Local Arrays ..</a>
  2842) <a name="l2842" style="background-color: #ffcccc">      REAL(r8)               V( 3 ), WORK( 1 )</a>
  2843) <a name="l2843" style="background-color: #ffcccc">!     ..</a>
  2844) <a name="l2844" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  2845) <a name="l2845" style="background-color: #ffcccc">!</a>
  2846) <a name="l2846" style="background-color: #ffcccc">      INFO = 0</a>
  2847) <a name="l2847" style="background-color: #ffcccc">!</a>
  2848) <a name="l2848" style="background-color: #ffcccc">!     Quick return if possible</a>
  2849) <a name="l2849" style="background-color: #ffcccc">!</a>
  2850) <a name="l2850" style="background-color: #ffcccc">      IF( N.EQ.0 ) &amp;</a>
  2851) <a name="l2851" style="background-color: #ffcccc">         RETURN</a>
  2852) <a name="l2852" style="background-color: #ffcccc">      IF( ILO.EQ.IHI ) THEN</a>
  2853) <a name="l2853" style="background-color: #ffcccc">         WR( ILO ) = H( ILO, ILO )</a>
  2854) <a name="l2854" style="background-color: #ffcccc">         WI( ILO ) = ZERO</a>
  2855) <a name="l2855" style="background-color: #ffcccc">         RETURN</a>
  2856) <a name="l2856" style="background-color: #ffcccc">      END IF</a>
  2857) <a name="l2857" style="background-color: #ffcccc">!</a>
  2858) <a name="l2858" style="background-color: #ffcccc">      NH = IHI - ILO + 1</a>
  2859) <a name="l2859" style="background-color: #ffcccc">      NZ = IHIZ - ILOZ + 1</a>
  2860) <a name="l2860" style="background-color: #ffcccc">!</a>
  2861) <a name="l2861" style="background-color: #ffcccc">!     Set machine-dependent constants for the stopping criterion.</a>
  2862) <a name="l2862" style="background-color: #ffcccc">!     If norm(H) &lt;= sqrt(OVFL), overflow should not occur.</a>
  2863) <a name="l2863" style="background-color: #ffcccc">!</a>
  2864) <a name="l2864" style="background-color: #ffcccc">      UNFL = SLAMCH( 'Safe minimum' )</a>
  2865) <a name="l2865" style="background-color: #ffcccc">      OVFL = ONE / UNFL</a>
  2866) <a name="l2866" style="background-color: #ffcccc">      CALL SLABAD( UNFL, OVFL )</a>
  2867) <a name="l2867" style="background-color: #ffcccc">      ULP = SLAMCH( 'Precision' )</a>
  2868) <a name="l2868" style="background-color: #ffcccc">      SMLNUM = UNFL*( NH / ULP )</a>
  2869) <a name="l2869" style="background-color: #ffcccc">!</a>
  2870) <a name="l2870" style="background-color: #ffcccc">!     I1 and I2 are the indices of the first row and last column of H</a>
  2871) <a name="l2871" style="background-color: #ffcccc">!     to which transformations must be applied. If eigenvalues only are</a>
  2872) <a name="l2872" style="background-color: #ffcccc">!     being computed, I1 and I2 are set inside the main loop.</a>
  2873) <a name="l2873" style="background-color: #ffcccc">!</a>
  2874) <a name="l2874" style="background-color: #ffcccc">      IF( WANTT ) THEN</a>
  2875) <a name="l2875" style="background-color: #ffcccc">         I1 = 1</a>
  2876) <a name="l2876" style="background-color: #ffcccc">         I2 = N</a>
  2877) <a name="l2877" style="background-color: #ffcccc">      END IF</a>
  2878) <a name="l2878" style="background-color: #ffcccc">!</a>
  2879) <a name="l2879" style="background-color: #ffcccc">!     ITN is the total number of QR iterations allowed.</a>
  2880) <a name="l2880" style="background-color: #ffcccc">!</a>
  2881) <a name="l2881" style="background-color: #ffcccc">      ITN = 30*NH</a>
  2882) <a name="l2882" style="background-color: #ffcccc">!</a>
  2883) <a name="l2883" style="background-color: #ffcccc">!     The main loop begins here. I is the loop index and decreases from</a>
  2884) <a name="l2884" style="background-color: #ffcccc">!     IHI to ILO in steps of 1 or 2. Each iteration of the loop works</a>
  2885) <a name="l2885" style="background-color: #ffcccc">!     with the active submatrix in rows and columns L to I.</a>
  2886) <a name="l2886" style="background-color: #ffcccc">!     Eigenvalues I+1 to IHI have already converged. Either L = ILO or</a>
  2887) <a name="l2887" style="background-color: #ffcccc">!     H(L,L-1) is negligible so that the matrix splits.</a>
  2888) <a name="l2888" style="background-color: #ffcccc">!</a>
  2889) <a name="l2889" style="background-color: #ffcccc">      I = IHI</a>
  2890) <a name="l2890" style="background-color: #ffcccc">   10 CONTINUE</a>
  2891) <a name="l2891" style="background-color: #ffcccc">      L = ILO</a>
  2892) <a name="l2892" style="background-color: #ffcccc">      IF( I.LT.ILO ) &amp;</a>
  2893) <a name="l2893" style="background-color: #ffcccc">         GO TO 150</a>
  2894) <a name="l2894" style="background-color: #ffcccc">!</a>
  2895) <a name="l2895" style="background-color: #ffcccc">!     Perform QR iterations on rows and columns ILO to I until a</a>
  2896) <a name="l2896" style="background-color: #ffcccc">!     submatrix of order 1 or 2 splits off at the bottom because a</a>
  2897) <a name="l2897" style="background-color: #ffcccc">!     subdiagonal element has become negligible.</a>
  2898) <a name="l2898" style="background-color: #ffcccc">!</a>
  2899) <a name="l2899" style="background-color: #ffcccc">      DO 130 ITS = 0, ITN</a>
  2900) <a name="l2900" style="background-color: #ffcccc">!</a>
  2901) <a name="l2901" style="background-color: #ffcccc">!        Look for a single small subdiagonal element.</a>
  2902) <a name="l2902" style="background-color: #ffcccc">!</a>
  2903) <a name="l2903" style="background-color: #ffcccc">         DO 20 K = I, L + 1, -1</a>
  2904) <a name="l2904" style="background-color: #ffcccc">            TST1 = ABS( H( K-1, K-1 ) ) + ABS( H( K, K ) )</a>
  2905) <a name="l2905" style="background-color: #ffcccc">            IF( TST1.EQ.ZERO ) &amp;</a>
  2906) <a name="l2906" style="background-color: #ffcccc">               TST1 = SLANHS( '1', I-L+1, H( L, L ), LDH, WORK )</a>
  2907) <a name="l2907" style="background-color: #ffcccc">            IF( ABS( H( K, K-1 ) ).LE.MAX( ULP*TST1, SMLNUM ) ) &amp;</a>
  2908) <a name="l2908" style="background-color: #ffcccc">               GO TO 30</a>
  2909) <a name="l2909" style="background-color: #ffcccc">   20    CONTINUE</a>
  2910) <a name="l2910" style="background-color: #ffcccc">   30    CONTINUE</a>
  2911) <a name="l2911" style="background-color: #ffcccc">         L = K</a>
  2912) <a name="l2912" style="background-color: #ffcccc">         IF( L.GT.ILO ) THEN</a>
  2913) <a name="l2913" style="background-color: #ffcccc">!</a>
  2914) <a name="l2914" style="background-color: #ffcccc">!           H(L,L-1) is negligible</a>
  2915) <a name="l2915" style="background-color: #ffcccc">!</a>
  2916) <a name="l2916" style="background-color: #ffcccc">            H( L, L-1 ) = ZERO</a>
  2917) <a name="l2917" style="background-color: #ffcccc">         END IF</a>
  2918) <a name="l2918" style="background-color: #ffcccc">!</a>
  2919) <a name="l2919" style="background-color: #ffcccc">!        Exit from loop if a submatrix of order 1 or 2 has split off.</a>
  2920) <a name="l2920" style="background-color: #ffcccc">!</a>
  2921) <a name="l2921" style="background-color: #ffcccc">         IF( L.GE.I-1 ) &amp;</a>
  2922) <a name="l2922" style="background-color: #ffcccc">            GO TO 140</a>
  2923) <a name="l2923" style="background-color: #ffcccc">!</a>
  2924) <a name="l2924" style="background-color: #ffcccc">!        Now the active submatrix is in rows and columns L to I. If</a>
  2925) <a name="l2925" style="background-color: #ffcccc">!        eigenvalues only are being computed, only the active submatrix</a>
  2926) <a name="l2926" style="background-color: #ffcccc">!        need be transformed.</a>
  2927) <a name="l2927" style="background-color: #ffcccc">!</a>
  2928) <a name="l2928" style="background-color: #ffcccc">         IF( .NOT.WANTT ) THEN</a>
  2929) <a name="l2929" style="background-color: #ffcccc">            I1 = L</a>
  2930) <a name="l2930" style="background-color: #ffcccc">            I2 = I</a>
  2931) <a name="l2931" style="background-color: #ffcccc">         END IF</a>
  2932) <a name="l2932" style="background-color: #ffcccc">!</a>
  2933) <a name="l2933" style="background-color: #ffcccc">         IF( ITS.EQ.10 .OR. ITS.EQ.20 ) THEN</a>
  2934) <a name="l2934" style="background-color: #ffcccc">!</a>
  2935) <a name="l2935" style="background-color: #ffcccc">!           Exceptional shift.</a>
  2936) <a name="l2936" style="background-color: #ffcccc">!</a>
  2937) <a name="l2937" style="background-color: #ffcccc">            S = ABS( H( I, I-1 ) ) + ABS( H( I-1, I-2 ) )</a>
  2938) <a name="l2938" style="background-color: #ffcccc">            H44 = DAT1*S</a>
  2939) <a name="l2939" style="background-color: #ffcccc">            H33 = H44</a>
  2940) <a name="l2940" style="background-color: #ffcccc">            H43H34 = DAT2*S*S</a>
  2941) <a name="l2941" style="background-color: #ffcccc">         ELSE</a>
  2942) <a name="l2942" style="background-color: #ffcccc">!</a>
  2943) <a name="l2943" style="background-color: #ffcccc">!           Prepare to use Wilkinson's double shift</a>
  2944) <a name="l2944" style="background-color: #ffcccc">!</a>
  2945) <a name="l2945" style="background-color: #ffcccc">            H44 = H( I, I )</a>
  2946) <a name="l2946" style="background-color: #ffcccc">            H33 = H( I-1, I-1 )</a>
  2947) <a name="l2947" style="background-color: #ffcccc">            H43H34 = H( I, I-1 )*H( I-1, I )</a>
  2948) <a name="l2948" style="background-color: #ffcccc">         END IF</a>
  2949) <a name="l2949" style="background-color: #ffcccc">!</a>
  2950) <a name="l2950" style="background-color: #ffcccc">!        Look for two consecutive small subdiagonal elements.</a>
  2951) <a name="l2951" style="background-color: #ffcccc">!</a>
  2952) <a name="l2952" style="background-color: #ffcccc">         DO 40 M = I - 2, L, -1</a>
  2953) <a name="l2953" style="background-color: #ffcccc">!</a>
  2954) <a name="l2954" style="background-color: #ffcccc">!           Determine the effect of starting the double-shift QR</a>
  2955) <a name="l2955" style="background-color: #ffcccc">!           iteration at row M, and see if this would make H(M,M-1)</a>
  2956) <a name="l2956" style="background-color: #ffcccc">!           negligible.</a>
  2957) <a name="l2957" style="background-color: #ffcccc">!</a>
  2958) <a name="l2958" style="background-color: #ffcccc">            H11 = H( M, M )</a>
  2959) <a name="l2959" style="background-color: #ffcccc">            H22 = H( M+1, M+1 )</a>
  2960) <a name="l2960" style="background-color: #ffcccc">            H21 = H( M+1, M )</a>
  2961) <a name="l2961" style="background-color: #ffcccc">            H12 = H( M, M+1 )</a>
  2962) <a name="l2962" style="background-color: #ffcccc">            H44S = H44 - H11</a>
  2963) <a name="l2963" style="background-color: #ffcccc">            H33S = H33 - H11</a>
  2964) <a name="l2964" style="background-color: #ffcccc">            V1 = ( H33S*H44S-H43H34 ) / H21 + H12</a>
  2965) <a name="l2965" style="background-color: #ffcccc">            V2 = H22 - H11 - H33S - H44S</a>
  2966) <a name="l2966" style="background-color: #ffcccc">            V3 = H( M+2, M+1 )</a>
  2967) <a name="l2967" style="background-color: #ffcccc">            S = ABS( V1 ) + ABS( V2 ) + ABS( V3 )</a>
  2968) <a name="l2968" style="background-color: #ffcccc">            V1 = V1 / S</a>
  2969) <a name="l2969" style="background-color: #ffcccc">            V2 = V2 / S</a>
  2970) <a name="l2970" style="background-color: #ffcccc">            V3 = V3 / S</a>
  2971) <a name="l2971" style="background-color: #ffcccc">            V( 1 ) = V1</a>
  2972) <a name="l2972" style="background-color: #ffcccc">            V( 2 ) = V2</a>
  2973) <a name="l2973" style="background-color: #ffcccc">            V( 3 ) = V3</a>
  2974) <a name="l2974" style="background-color: #ffcccc">            IF( M.EQ.L ) &amp;</a>
  2975) <a name="l2975" style="background-color: #ffcccc">               GO TO 50</a>
  2976) <a name="l2976" style="background-color: #ffcccc">            H00 = H( M-1, M-1 )</a>
  2977) <a name="l2977" style="background-color: #ffcccc">            H10 = H( M, M-1 )</a>
  2978) <a name="l2978" style="background-color: #ffcccc">            TST1 = ABS( V1 )*( ABS( H00 )+ABS( H11 )+ABS( H22 ) )</a>
  2979) <a name="l2979" style="background-color: #ffcccc">            IF( ABS( H10 )*( ABS( V2 )+ABS( V3 ) ).LE.ULP*TST1 ) &amp;</a>
  2980) <a name="l2980" style="background-color: #ffcccc">               GO TO 50</a>
  2981) <a name="l2981" style="background-color: #ffcccc">   40    CONTINUE</a>
  2982) <a name="l2982" style="background-color: #ffcccc">   50    CONTINUE</a>
  2983) <a name="l2983" style="background-color: #ffcccc">!</a>
  2984) <a name="l2984" style="background-color: #ffcccc">!        Double-shift QR step</a>
  2985) <a name="l2985" style="background-color: #ffcccc">!</a>
  2986) <a name="l2986" style="background-color: #ffcccc">         DO 120 K = M, I - 1</a>
  2987) <a name="l2987" style="background-color: #ffcccc">!</a>
  2988) <a name="l2988" style="background-color: #ffcccc">!           The first iteration of this loop determines a reflection G</a>
  2989) <a name="l2989" style="background-color: #ffcccc">!           from the vector V and applies it from left and right to H,</a>
  2990) <a name="l2990" style="background-color: #ffcccc">!           thus creating a nonzero bulge below the subdiagonal.</a>
  2991) <a name="l2991" style="background-color: #ffcccc">!</a>
  2992) <a name="l2992" style="background-color: #ffcccc">!           Each subsequent iteration determines a reflection G to</a>
  2993) <a name="l2993" style="background-color: #ffcccc">!           restore the Hessenberg form in the (K-1)th column, and thus</a>
  2994) <a name="l2994" style="background-color: #ffcccc">!           chases the bulge one step toward the bottom of the active</a>
  2995) <a name="l2995" style="background-color: #ffcccc">!           submatrix. NR is the order of G.</a>
  2996) <a name="l2996" style="background-color: #ffcccc">!</a>
  2997) <a name="l2997" style="background-color: #ffcccc">            NR = MIN( 3, I-K+1 )</a>
  2998) <a name="l2998" style="background-color: #ffcccc">            IF( K.GT.M ) &amp;</a>
  2999) <a name="l2999" style="background-color: #ffcccc">               CALL SCOPY( NR, H( K, K-1 ), 1, V, 1 )</a>
  3000) <a name="l3000" style="background-color: #ffcccc">            CALL SLARFG( NR, V( 1 ), V( 2 ), 1, T1 )</a>
  3001) <a name="l3001" style="background-color: #ffcccc">            IF( K.GT.M ) THEN</a>
  3002) <a name="l3002" style="background-color: #ffcccc">               H( K, K-1 ) = V( 1 )</a>
  3003) <a name="l3003" style="background-color: #ffcccc">               H( K+1, K-1 ) = ZERO</a>
  3004) <a name="l3004" style="background-color: #ffcccc">               IF( K.LT.I-1 ) &amp;</a>
  3005) <a name="l3005" style="background-color: #ffcccc">                  H( K+2, K-1 ) = ZERO</a>
  3006) <a name="l3006" style="background-color: #ffcccc">            ELSE IF( M.GT.L ) THEN</a>
  3007) <a name="l3007" style="background-color: #ffcccc">               H( K, K-1 ) = -H( K, K-1 )</a>
  3008) <a name="l3008" style="background-color: #ffcccc">            END IF</a>
  3009) <a name="l3009" style="background-color: #ffcccc">            V2 = V( 2 )</a>
  3010) <a name="l3010" style="background-color: #ffcccc">            T2 = T1*V2</a>
  3011) <a name="l3011" style="background-color: #ffcccc">            IF( NR.EQ.3 ) THEN</a>
  3012) <a name="l3012" style="background-color: #ffcccc">               V3 = V( 3 )</a>
  3013) <a name="l3013" style="background-color: #ffcccc">               T3 = T1*V3</a>
  3014) <a name="l3014" style="background-color: #ffcccc">!</a>
  3015) <a name="l3015" style="background-color: #ffcccc">!              Apply G from the left to transform the rows of the matrix</a>
  3016) <a name="l3016" style="background-color: #ffcccc">!              in columns K to I2.</a>
  3017) <a name="l3017" style="background-color: #ffcccc">!</a>
  3018) <a name="l3018" style="background-color: #ffcccc">               DO 60 J = K, I2</a>
  3019) <a name="l3019" style="background-color: #ffcccc">                  SUM = H( K, J ) + V2*H( K+1, J ) + V3*H( K+2, J )</a>
  3020) <a name="l3020" style="background-color: #ffcccc">                  H( K, J ) = H( K, J ) - SUM*T1</a>
  3021) <a name="l3021" style="background-color: #ffcccc">                  H( K+1, J ) = H( K+1, J ) - SUM*T2</a>
  3022) <a name="l3022" style="background-color: #ffcccc">                  H( K+2, J ) = H( K+2, J ) - SUM*T3</a>
  3023) <a name="l3023" style="background-color: #ffcccc">   60          CONTINUE</a>
  3024) <a name="l3024" style="background-color: #ffcccc">!</a>
  3025) <a name="l3025" style="background-color: #ffcccc">!              Apply G from the right to transform the columns of the</a>
  3026) <a name="l3026" style="background-color: #ffcccc">!              matrix in rows I1 to min(K+3,I).</a>
  3027) <a name="l3027" style="background-color: #ffcccc">!</a>
  3028) <a name="l3028" style="background-color: #ffcccc">               DO 70 J = I1, MIN( K+3, I )</a>
  3029) <a name="l3029" style="background-color: #ffcccc">                  SUM = H( J, K ) + V2*H( J, K+1 ) + V3*H( J, K+2 )</a>
  3030) <a name="l3030" style="background-color: #ffcccc">                  H( J, K ) = H( J, K ) - SUM*T1</a>
  3031) <a name="l3031" style="background-color: #ffcccc">                  H( J, K+1 ) = H( J, K+1 ) - SUM*T2</a>
  3032) <a name="l3032" style="background-color: #ffcccc">                  H( J, K+2 ) = H( J, K+2 ) - SUM*T3</a>
  3033) <a name="l3033" style="background-color: #ffcccc">   70          CONTINUE</a>
  3034) <a name="l3034" style="background-color: #ffcccc">!</a>
  3035) <a name="l3035" style="background-color: #ffcccc">               IF( WANTZ ) THEN</a>
  3036) <a name="l3036" style="background-color: #ffcccc">!</a>
  3037) <a name="l3037" style="background-color: #ffcccc">!                 Accumulate transformations in the matrix Z</a>
  3038) <a name="l3038" style="background-color: #ffcccc">!</a>
  3039) <a name="l3039" style="background-color: #ffcccc">                  DO 80 J = ILOZ, IHIZ</a>
  3040) <a name="l3040" style="background-color: #ffcccc">                     SUM = Z( J, K ) + V2*Z( J, K+1 ) + V3*Z( J, K+2 )</a>
  3041) <a name="l3041" style="background-color: #ffcccc">                     Z( J, K ) = Z( J, K ) - SUM*T1</a>
  3042) <a name="l3042" style="background-color: #ffcccc">                     Z( J, K+1 ) = Z( J, K+1 ) - SUM*T2</a>
  3043) <a name="l3043" style="background-color: #ffcccc">                     Z( J, K+2 ) = Z( J, K+2 ) - SUM*T3</a>
  3044) <a name="l3044" style="background-color: #ffcccc">   80             CONTINUE</a>
  3045) <a name="l3045" style="background-color: #ffcccc">               END IF</a>
  3046) <a name="l3046" style="background-color: #ffcccc">            ELSE IF( NR.EQ.2 ) THEN</a>
  3047) <a name="l3047" style="background-color: #ffcccc">!</a>
  3048) <a name="l3048" style="background-color: #ffcccc">!              Apply G from the left to transform the rows of the matrix</a>
  3049) <a name="l3049" style="background-color: #ffcccc">!              in columns K to I2.</a>
  3050) <a name="l3050" style="background-color: #ffcccc">!</a>
  3051) <a name="l3051" style="background-color: #ffcccc">               DO 90 J = K, I2</a>
  3052) <a name="l3052" style="background-color: #ffcccc">                  SUM = H( K, J ) + V2*H( K+1, J )</a>
  3053) <a name="l3053" style="background-color: #ffcccc">                  H( K, J ) = H( K, J ) - SUM*T1</a>
  3054) <a name="l3054" style="background-color: #ffcccc">                  H( K+1, J ) = H( K+1, J ) - SUM*T2</a>
  3055) <a name="l3055" style="background-color: #ffcccc">   90          CONTINUE</a>
  3056) <a name="l3056" style="background-color: #ffcccc">!</a>
  3057) <a name="l3057" style="background-color: #ffcccc">!              Apply G from the right to transform the columns of the</a>
  3058) <a name="l3058" style="background-color: #ffcccc">!              matrix in rows I1 to min(K+3,I).</a>
  3059) <a name="l3059" style="background-color: #ffcccc">!</a>
  3060) <a name="l3060" style="background-color: #ffcccc">               DO 100 J = I1, I</a>
  3061) <a name="l3061" style="background-color: #ffcccc">                  SUM = H( J, K ) + V2*H( J, K+1 )</a>
  3062) <a name="l3062" style="background-color: #ffcccc">                  H( J, K ) = H( J, K ) - SUM*T1</a>
  3063) <a name="l3063" style="background-color: #ffcccc">                  H( J, K+1 ) = H( J, K+1 ) - SUM*T2</a>
  3064) <a name="l3064" style="background-color: #ffcccc">  100          CONTINUE</a>
  3065) <a name="l3065" style="background-color: #ffcccc">!</a>
  3066) <a name="l3066" style="background-color: #ffcccc">               IF( WANTZ ) THEN</a>
  3067) <a name="l3067" style="background-color: #ffcccc">!</a>
  3068) <a name="l3068" style="background-color: #ffcccc">!                 Accumulate transformations in the matrix Z</a>
  3069) <a name="l3069" style="background-color: #ffcccc">!</a>
  3070) <a name="l3070" style="background-color: #ffcccc">                  DO 110 J = ILOZ, IHIZ</a>
  3071) <a name="l3071" style="background-color: #ffcccc">                     SUM = Z( J, K ) + V2*Z( J, K+1 )</a>
  3072) <a name="l3072" style="background-color: #ffcccc">                     Z( J, K ) = Z( J, K ) - SUM*T1</a>
  3073) <a name="l3073" style="background-color: #ffcccc">                     Z( J, K+1 ) = Z( J, K+1 ) - SUM*T2</a>
  3074) <a name="l3074" style="background-color: #ffcccc">  110             CONTINUE</a>
  3075) <a name="l3075" style="background-color: #ffcccc">               END IF</a>
  3076) <a name="l3076" style="background-color: #ffcccc">            END IF</a>
  3077) <a name="l3077" style="background-color: #ffcccc">  120    CONTINUE</a>
  3078) <a name="l3078" style="background-color: #ffcccc">!</a>
  3079) <a name="l3079" style="background-color: #ffcccc">  130 CONTINUE</a>
  3080) <a name="l3080" style="background-color: #ffcccc">!</a>
  3081) <a name="l3081" style="background-color: #ffcccc">!     Failure to converge in remaining number of iterations</a>
  3082) <a name="l3082" style="background-color: #ffcccc">!</a>
  3083) <a name="l3083" style="background-color: #ffcccc">      INFO = I</a>
  3084) <a name="l3084" style="background-color: #ffcccc">      RETURN</a>
  3085) <a name="l3085" style="background-color: #ffcccc">!</a>
  3086) <a name="l3086" style="background-color: #ffcccc">  140 CONTINUE</a>
  3087) <a name="l3087" style="background-color: #ffcccc">!</a>
  3088) <a name="l3088" style="background-color: #ffcccc">      IF( L.EQ.I ) THEN</a>
  3089) <a name="l3089" style="background-color: #ffcccc">!</a>
  3090) <a name="l3090" style="background-color: #ffcccc">!        H(I,I-1) is negligible: one eigenvalue has converged.</a>
  3091) <a name="l3091" style="background-color: #ffcccc">!</a>
  3092) <a name="l3092" style="background-color: #ffcccc">         WR( I ) = H( I, I )</a>
  3093) <a name="l3093" style="background-color: #ffcccc">         WI( I ) = ZERO</a>
  3094) <a name="l3094" style="background-color: #ffcccc">      ELSE IF( L.EQ.I-1 ) THEN</a>
  3095) <a name="l3095" style="background-color: #ffcccc">!</a>
  3096) <a name="l3096" style="background-color: #ffcccc">!        H(I-1,I-2) is negligible: a pair of eigenvalues have converged.</a>
  3097) <a name="l3097" style="background-color: #ffcccc">!</a>
  3098) <a name="l3098" style="background-color: #ffcccc">!        Transform the 2-by-2 submatrix to standard Schur form,</a>
  3099) <a name="l3099" style="background-color: #ffcccc">!        and compute and store the eigenvalues.</a>
  3100) <a name="l3100" style="background-color: #ffcccc">!</a>
  3101) <a name="l3101" style="background-color: #ffcccc">         CALL SLANV2( H( I-1, I-1 ), H( I-1, I ), H( I, I-1 ), &amp;</a>
  3102) <a name="l3102" style="background-color: #ffcccc">                      H( I, I ), WR( I-1 ), WI( I-1 ), WR( I ), WI( I ), &amp;</a>
  3103) <a name="l3103" style="background-color: #ffcccc">                      CS, SN )</a>
  3104) <a name="l3104" style="background-color: #ffcccc">!</a>
  3105) <a name="l3105" style="background-color: #ffcccc">         IF( WANTT ) THEN</a>
  3106) <a name="l3106" style="background-color: #ffcccc">!</a>
  3107) <a name="l3107" style="background-color: #ffcccc">!           Apply the transformation to the rest of H.</a>
  3108) <a name="l3108" style="background-color: #ffcccc">!</a>
  3109) <a name="l3109" style="background-color: #ffcccc">            IF( I2.GT.I ) &amp;</a>
  3110) <a name="l3110" style="background-color: #ffcccc">               CALL SROT( I2-I, H( I-1, I+1 ), LDH, H( I, I+1 ), LDH, &amp;</a>
  3111) <a name="l3111" style="background-color: #ffcccc">                          CS, SN )</a>
  3112) <a name="l3112" style="background-color: #ffcccc">            CALL SROT( I-I1-1, H( I1, I-1 ), 1, H( I1, I ), 1, CS, SN )</a>
  3113) <a name="l3113" style="background-color: #ffcccc">         END IF</a>
  3114) <a name="l3114" style="background-color: #ffcccc">         IF( WANTZ ) THEN</a>
  3115) <a name="l3115" style="background-color: #ffcccc">!</a>
  3116) <a name="l3116" style="background-color: #ffcccc">!           Apply the transformation to Z.</a>
  3117) <a name="l3117" style="background-color: #ffcccc">!</a>
  3118) <a name="l3118" style="background-color: #ffcccc">            CALL SROT( NZ, Z( ILOZ, I-1 ), 1, Z( ILOZ, I ), 1, CS, SN )</a>
  3119) <a name="l3119" style="background-color: #ffcccc">         END IF</a>
  3120) <a name="l3120" style="background-color: #ffcccc">      END IF</a>
  3121) <a name="l3121" style="background-color: #ffcccc">!</a>
  3122) <a name="l3122" style="background-color: #ffcccc">!     Decrement number of remaining iterations, and return to start of</a>
  3123) <a name="l3123" style="background-color: #ffcccc">!     the main loop with new value of I.</a>
  3124) <a name="l3124" style="background-color: #ffcccc">!</a>
  3125) <a name="l3125" style="background-color: #ffcccc">      ITN = ITN - ITS</a>
  3126) <a name="l3126" style="background-color: #ffcccc">      I = L - 1</a>
  3127) <a name="l3127" style="background-color: #ffcccc">      GO TO 10</a>
  3128) <a name="l3128" style="background-color: #ffcccc">!</a>
  3129) <a name="l3129" style="background-color: #ffcccc">  150 CONTINUE</a>
  3130) <a name="l3130" style="background-color: #ffcccc">      RETURN</a>
  3131) <a name="l3131" style="background-color: #ffcccc">!</a>
  3132) <a name="l3132" style="background-color: #ffcccc">!     End of SLAHQR</a>
  3133) <a name="l3133" style="background-color: #ffcccc">!</a>
  3134) <a name="l3134" style="background-color: #ffcccc">      END SUBROUTINE SLAHQR</a>
  3135) <a name="l3135" style="background-color: #ffffff"></a>
  3136) <a name="l3136" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  3137) <a name="l3137" style="background-color: #ffffff"></a>
  3138) <a name="l3138" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLAHRD( N, K, NB, A, LDA, TAU, T, LDT, Y, LDY )</a>
  3139) <a name="l3139" style="background-color: #ffcccc"></a>
  3140) <a name="l3140" style="background-color: #ffcccc">!</a>
  3141) <a name="l3141" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  3142) <a name="l3142" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  3143) <a name="l3143" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  3144) <a name="l3144" style="background-color: #ffcccc">!     February 29, 1992</a>
  3145) <a name="l3145" style="background-color: #ffcccc">!</a>
  3146) <a name="l3146" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  3147) <a name="l3147" style="background-color: #ffcccc">      INTEGER            K, LDA, LDT, LDY, N, NB</a>
  3148) <a name="l3148" style="background-color: #ffcccc">!     ..</a>
  3149) <a name="l3149" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  3150) <a name="l3150" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), T( LDT, NB ), TAU( NB ), &amp;</a>
  3151) <a name="l3151" style="background-color: #ffcccc">                         Y( LDY, NB )</a>
  3152) <a name="l3152" style="background-color: #ffcccc">!     ..</a>
  3153) <a name="l3153" style="background-color: #ffcccc">!</a>
  3154) <a name="l3154" style="background-color: #ffcccc">!  Purpose</a>
  3155) <a name="l3155" style="background-color: #ffcccc">!  =======</a>
  3156) <a name="l3156" style="background-color: #ffcccc">!</a>
  3157) <a name="l3157" style="background-color: #ffcccc">!  SLAHRD reduces the first NB columns of a real general n-by-(n-k+1)</a>
  3158) <a name="l3158" style="background-color: #ffcccc">!  matrix A so that elements below the k-th subdiagonal are zero. The</a>
  3159) <a name="l3159" style="background-color: #ffcccc">!  reduction is performed by an orthogonal similarity transformation</a>
  3160) <a name="l3160" style="background-color: #ffcccc">!  Q' * A * Q. The routine returns the matrices V and T which determine</a>
  3161) <a name="l3161" style="background-color: #ffcccc">!  Q as a block reflector I - V*T*V', and also the matrix Y = A * V * T.</a>
  3162) <a name="l3162" style="background-color: #ffcccc">!</a>
  3163) <a name="l3163" style="background-color: #ffcccc">!  This is an auxiliary routine called by SGEHRD.</a>
  3164) <a name="l3164" style="background-color: #ffcccc">!</a>
  3165) <a name="l3165" style="background-color: #ffcccc">!  Arguments</a>
  3166) <a name="l3166" style="background-color: #ffcccc">!  =========</a>
  3167) <a name="l3167" style="background-color: #ffcccc">!</a>
  3168) <a name="l3168" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  3169) <a name="l3169" style="background-color: #ffcccc">!          The order of the matrix A.</a>
  3170) <a name="l3170" style="background-color: #ffcccc">!</a>
  3171) <a name="l3171" style="background-color: #ffcccc">!  K       (input) INTEGER</a>
  3172) <a name="l3172" style="background-color: #ffcccc">!          The offset for the reduction. Elements below the k-th</a>
  3173) <a name="l3173" style="background-color: #ffcccc">!          subdiagonal in the first NB columns are reduced to zero.</a>
  3174) <a name="l3174" style="background-color: #ffcccc">!</a>
  3175) <a name="l3175" style="background-color: #ffcccc">!  NB      (input) INTEGER</a>
  3176) <a name="l3176" style="background-color: #ffcccc">!          The number of columns to be reduced.</a>
  3177) <a name="l3177" style="background-color: #ffcccc">!</a>
  3178) <a name="l3178" style="background-color: #ffcccc">!  A       (input/output) REAL array, dimension (LDA,N-K+1)</a>
  3179) <a name="l3179" style="background-color: #ffcccc">!          On entry, the n-by-(n-k+1) general matrix A.</a>
  3180) <a name="l3180" style="background-color: #ffcccc">!          On exit, the elements on and above the k-th subdiagonal in</a>
  3181) <a name="l3181" style="background-color: #ffcccc">!          the first NB columns are overwritten with the corresponding</a>
  3182) <a name="l3182" style="background-color: #ffcccc">!          elements of the reduced matrix; the elements below the k-th</a>
  3183) <a name="l3183" style="background-color: #ffcccc">!          subdiagonal, with the array TAU, represent the matrix Q as a</a>
  3184) <a name="l3184" style="background-color: #ffcccc">!          product of elementary reflectors. The other columns of A are</a>
  3185) <a name="l3185" style="background-color: #ffcccc">!          unchanged. See Further Details.</a>
  3186) <a name="l3186" style="background-color: #ffcccc">!</a>
  3187) <a name="l3187" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  3188) <a name="l3188" style="background-color: #ffcccc">!          The leading dimension of the array A.  LDA &gt;= max(1,N).</a>
  3189) <a name="l3189" style="background-color: #ffcccc">!</a>
  3190) <a name="l3190" style="background-color: #ffcccc">!  TAU     (output) REAL array, dimension (NB)</a>
  3191) <a name="l3191" style="background-color: #ffcccc">!          The scalar factors of the elementary reflectors. See Further</a>
  3192) <a name="l3192" style="background-color: #ffcccc">!          Details.</a>
  3193) <a name="l3193" style="background-color: #ffcccc">!</a>
  3194) <a name="l3194" style="background-color: #ffcccc">!  T       (output) REAL array, dimension (NB,NB)</a>
  3195) <a name="l3195" style="background-color: #ffcccc">!          The upper triangular matrix T.</a>
  3196) <a name="l3196" style="background-color: #ffcccc">!</a>
  3197) <a name="l3197" style="background-color: #ffcccc">!  LDT     (input) INTEGER</a>
  3198) <a name="l3198" style="background-color: #ffcccc">!          The leading dimension of the array T.  LDT &gt;= NB.</a>
  3199) <a name="l3199" style="background-color: #ffcccc">!</a>
  3200) <a name="l3200" style="background-color: #ffcccc">!  Y       (output) REAL array, dimension (LDY,NB)</a>
  3201) <a name="l3201" style="background-color: #ffcccc">!          The n-by-nb matrix Y.</a>
  3202) <a name="l3202" style="background-color: #ffcccc">!</a>
  3203) <a name="l3203" style="background-color: #ffcccc">!  LDY     (input) INTEGER</a>
  3204) <a name="l3204" style="background-color: #ffcccc">!          The leading dimension of the array Y. LDY &gt;= N.</a>
  3205) <a name="l3205" style="background-color: #ffcccc">!</a>
  3206) <a name="l3206" style="background-color: #ffcccc">!  Further Details</a>
  3207) <a name="l3207" style="background-color: #ffcccc">!  ===============</a>
  3208) <a name="l3208" style="background-color: #ffcccc">!</a>
  3209) <a name="l3209" style="background-color: #ffcccc">!  The matrix Q is represented as a product of nb elementary reflectors</a>
  3210) <a name="l3210" style="background-color: #ffcccc">!</a>
  3211) <a name="l3211" style="background-color: #ffcccc">!     Q = H(1) H(2) . . . H(nb).</a>
  3212) <a name="l3212" style="background-color: #ffcccc">!</a>
  3213) <a name="l3213" style="background-color: #ffcccc">!  Each H(i) has the form</a>
  3214) <a name="l3214" style="background-color: #ffcccc">!</a>
  3215) <a name="l3215" style="background-color: #ffcccc">!     H(i) = I - tau * v * v'</a>
  3216) <a name="l3216" style="background-color: #ffcccc">!</a>
  3217) <a name="l3217" style="background-color: #ffcccc">!  where tau is a real scalar, and v is a real vector with</a>
  3218) <a name="l3218" style="background-color: #ffcccc">!  v(1:i+k-1) = 0, v(i+k) = 1; v(i+k+1:n) is stored on exit in</a>
  3219) <a name="l3219" style="background-color: #ffcccc">!  A(i+k+1:n,i), and tau in TAU(i).</a>
  3220) <a name="l3220" style="background-color: #ffcccc">!</a>
  3221) <a name="l3221" style="background-color: #ffcccc">!  The elements of the vectors v together form the (n-k+1)-by-nb matrix</a>
  3222) <a name="l3222" style="background-color: #ffcccc">!  V which is needed, with T and Y, to apply the transformation to the</a>
  3223) <a name="l3223" style="background-color: #ffcccc">!  unreduced part of the matrix, using an update of the form:</a>
  3224) <a name="l3224" style="background-color: #ffcccc">!  A := (I - V*T*V') * (A - Y*V').</a>
  3225) <a name="l3225" style="background-color: #ffcccc">!</a>
  3226) <a name="l3226" style="background-color: #ffcccc">!  The contents of A on exit are illustrated by the following example</a>
  3227) <a name="l3227" style="background-color: #ffcccc">!  with n = 7, k = 3 and nb = 2:</a>
  3228) <a name="l3228" style="background-color: #ffcccc">!</a>
  3229) <a name="l3229" style="background-color: #ffcccc">!     ( a   h   a   a   a )</a>
  3230) <a name="l3230" style="background-color: #ffcccc">!     ( a   h   a   a   a )</a>
  3231) <a name="l3231" style="background-color: #ffcccc">!     ( a   h   a   a   a )</a>
  3232) <a name="l3232" style="background-color: #ffcccc">!     ( h   h   a   a   a )</a>
  3233) <a name="l3233" style="background-color: #ffcccc">!     ( v1  h   a   a   a )</a>
  3234) <a name="l3234" style="background-color: #ffcccc">!     ( v1  v2  a   a   a )</a>
  3235) <a name="l3235" style="background-color: #ffcccc">!     ( v1  v2  a   a   a )</a>
  3236) <a name="l3236" style="background-color: #ffcccc">!</a>
  3237) <a name="l3237" style="background-color: #ffcccc">!  where a denotes an element of the original matrix A, h denotes a</a>
  3238) <a name="l3238" style="background-color: #ffcccc">!  modified element of the upper Hessenberg matrix H, and vi denotes an</a>
  3239) <a name="l3239" style="background-color: #ffcccc">!  element of the vector defining H(i).</a>
  3240) <a name="l3240" style="background-color: #ffcccc">!</a>
  3241) <a name="l3241" style="background-color: #ffcccc">!  =====================================================================</a>
  3242) <a name="l3242" style="background-color: #ffcccc">!</a>
  3243) <a name="l3243" style="background-color: #ffcccc">!     .. Parameters ..</a>
  3244) <a name="l3244" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
  3245) <a name="l3245" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8, ONE = 1.0E+0_r8 )</a>
  3246) <a name="l3246" style="background-color: #ffcccc">!     ..</a>
  3247) <a name="l3247" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  3248) <a name="l3248" style="background-color: #ffcccc">      INTEGER            I</a>
  3249) <a name="l3249" style="background-color: #ffcccc">      REAL(r8)               EI</a>
  3250) <a name="l3250" style="background-color: #ffcccc">!     ..</a>
  3251) <a name="l3251" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  3252) <a name="l3252" style="background-color: #ffcccc">!</a>
  3253) <a name="l3253" style="background-color: #ffcccc">!     Quick return if possible</a>
  3254) <a name="l3254" style="background-color: #ffcccc">!</a>
  3255) <a name="l3255" style="background-color: #ffcccc">      IF( N.LE.1 ) &amp;</a>
  3256) <a name="l3256" style="background-color: #ffcccc">         RETURN</a>
  3257) <a name="l3257" style="background-color: #ffcccc">!</a>
  3258) <a name="l3258" style="background-color: #ffcccc">      DO 10 I = 1, NB</a>
  3259) <a name="l3259" style="background-color: #ffcccc">         IF( I.GT.1 ) THEN</a>
  3260) <a name="l3260" style="background-color: #ffcccc">!</a>
  3261) <a name="l3261" style="background-color: #ffcccc">!           Update A(1:n,i)</a>
  3262) <a name="l3262" style="background-color: #ffcccc">!</a>
  3263) <a name="l3263" style="background-color: #ffcccc">!           Compute i-th column of A - Y * V'</a>
  3264) <a name="l3264" style="background-color: #ffcccc">!</a>
  3265) <a name="l3265" style="background-color: #ffcccc">            CALL SGEMV( 'No transpose', N, I-1, -ONE, Y, LDY, &amp;</a>
  3266) <a name="l3266" style="background-color: #ffcccc">                        A( K+I-1, 1 ), LDA, ONE, A( 1, I ), 1 )</a>
  3267) <a name="l3267" style="background-color: #ffcccc">!</a>
  3268) <a name="l3268" style="background-color: #ffcccc">!           Apply I - V * T' * V' to this column (call it b) from the</a>
  3269) <a name="l3269" style="background-color: #ffcccc">!           left, using the last column of T as workspace</a>
  3270) <a name="l3270" style="background-color: #ffcccc">!</a>
  3271) <a name="l3271" style="background-color: #ffcccc">!           Let  V = ( V1 )   and   b = ( b1 )   (first I-1 rows)</a>
  3272) <a name="l3272" style="background-color: #ffcccc">!                    ( V2 )             ( b2 )</a>
  3273) <a name="l3273" style="background-color: #ffcccc">!</a>
  3274) <a name="l3274" style="background-color: #ffcccc">!           where V1 is unit lower triangular</a>
  3275) <a name="l3275" style="background-color: #ffcccc">!</a>
  3276) <a name="l3276" style="background-color: #ffcccc">!           w := V1' * b1</a>
  3277) <a name="l3277" style="background-color: #ffcccc">!</a>
  3278) <a name="l3278" style="background-color: #ffcccc">            CALL SCOPY( I-1, A( K+1, I ), 1, T( 1, NB ), 1 )</a>
  3279) <a name="l3279" style="background-color: #ffcccc">            CALL STRMV( 'Lower', 'Transpose', 'Unit', I-1, A( K+1, 1 ), &amp;</a>
  3280) <a name="l3280" style="background-color: #ffcccc">                        LDA, T( 1, NB ), 1 )</a>
  3281) <a name="l3281" style="background-color: #ffcccc">!</a>
  3282) <a name="l3282" style="background-color: #ffcccc">!           w := w + V2'*b2</a>
  3283) <a name="l3283" style="background-color: #ffcccc">!</a>
  3284) <a name="l3284" style="background-color: #ffcccc">            CALL SGEMV( 'Transpose', N-K-I+1, I-1, ONE, A( K+I, 1 ), &amp;</a>
  3285) <a name="l3285" style="background-color: #ffcccc">                        LDA, A( K+I, I ), 1, ONE, T( 1, NB ), 1 )</a>
  3286) <a name="l3286" style="background-color: #ffcccc">!</a>
  3287) <a name="l3287" style="background-color: #ffcccc">!           w := T'*w</a>
  3288) <a name="l3288" style="background-color: #ffcccc">!</a>
  3289) <a name="l3289" style="background-color: #ffcccc">            CALL STRMV( 'Upper', 'Transpose', 'Non-unit', I-1, T, LDT, &amp;</a>
  3290) <a name="l3290" style="background-color: #ffcccc">                        T( 1, NB ), 1 )</a>
  3291) <a name="l3291" style="background-color: #ffcccc">!</a>
  3292) <a name="l3292" style="background-color: #ffcccc">!           b2 := b2 - V2*w</a>
  3293) <a name="l3293" style="background-color: #ffcccc">!</a>
  3294) <a name="l3294" style="background-color: #ffcccc">            CALL SGEMV( 'No transpose', N-K-I+1, I-1, -ONE, A( K+I, 1 ), &amp;</a>
  3295) <a name="l3295" style="background-color: #ffcccc">                        LDA, T( 1, NB ), 1, ONE, A( K+I, I ), 1 )</a>
  3296) <a name="l3296" style="background-color: #ffcccc">!</a>
  3297) <a name="l3297" style="background-color: #ffcccc">!           b1 := b1 - V1*w</a>
  3298) <a name="l3298" style="background-color: #ffcccc">!</a>
  3299) <a name="l3299" style="background-color: #ffcccc">            CALL STRMV( 'Lower', 'No transpose', 'Unit', I-1, &amp;</a>
  3300) <a name="l3300" style="background-color: #ffcccc">                        A( K+1, 1 ), LDA, T( 1, NB ), 1 )</a>
  3301) <a name="l3301" style="background-color: #ffcccc">            CALL SAXPY( I-1, -ONE, T( 1, NB ), 1, A( K+1, I ), 1 )</a>
  3302) <a name="l3302" style="background-color: #ffcccc">!</a>
  3303) <a name="l3303" style="background-color: #ffcccc">            A( K+I-1, I-1 ) = EI</a>
  3304) <a name="l3304" style="background-color: #ffcccc">         END IF</a>
  3305) <a name="l3305" style="background-color: #ffcccc">!</a>
  3306) <a name="l3306" style="background-color: #ffcccc">!        Generate the elementary reflector H(i) to annihilate</a>
  3307) <a name="l3307" style="background-color: #ffcccc">!        A(k+i+1:n,i)</a>
  3308) <a name="l3308" style="background-color: #ffcccc">!</a>
  3309) <a name="l3309" style="background-color: #ffcccc">         CALL SLARFG( N-K-I+1, A( K+I, I ), A( MIN( K+I+1, N ), I ), 1, &amp;</a>
  3310) <a name="l3310" style="background-color: #ffcccc">                      TAU( I ) )</a>
  3311) <a name="l3311" style="background-color: #ffcccc">         EI = A( K+I, I )</a>
  3312) <a name="l3312" style="background-color: #ffcccc">         A( K+I, I ) = ONE</a>
  3313) <a name="l3313" style="background-color: #ffcccc">!</a>
  3314) <a name="l3314" style="background-color: #ffcccc">!        Compute  Y(1:n,i)</a>
  3315) <a name="l3315" style="background-color: #ffcccc">!</a>
  3316) <a name="l3316" style="background-color: #ffcccc">         CALL SGEMV( 'No transpose', N, N-K-I+1, ONE, A( 1, I+1 ), LDA, &amp;</a>
  3317) <a name="l3317" style="background-color: #ffcccc">                     A( K+I, I ), 1, ZERO, Y( 1, I ), 1 )</a>
  3318) <a name="l3318" style="background-color: #ffcccc">         CALL SGEMV( 'Transpose', N-K-I+1, I-1, ONE, A( K+I, 1 ), LDA, &amp;</a>
  3319) <a name="l3319" style="background-color: #ffcccc">                     A( K+I, I ), 1, ZERO, T( 1, I ), 1 )</a>
  3320) <a name="l3320" style="background-color: #ffcccc">         CALL SGEMV( 'No transpose', N, I-1, -ONE, Y, LDY, T( 1, I ), 1, &amp;</a>
  3321) <a name="l3321" style="background-color: #ffcccc">                     ONE, Y( 1, I ), 1 )</a>
  3322) <a name="l3322" style="background-color: #ffcccc">         CALL SSCAL( N, TAU( I ), Y( 1, I ), 1 )</a>
  3323) <a name="l3323" style="background-color: #ffcccc">!</a>
  3324) <a name="l3324" style="background-color: #ffcccc">!        Compute T(1:i,i)</a>
  3325) <a name="l3325" style="background-color: #ffcccc">!</a>
  3326) <a name="l3326" style="background-color: #ffcccc">         CALL SSCAL( I-1, -TAU( I ), T( 1, I ), 1 )</a>
  3327) <a name="l3327" style="background-color: #ffcccc">         CALL STRMV( 'Upper', 'No transpose', 'Non-unit', I-1, T, LDT, &amp;</a>
  3328) <a name="l3328" style="background-color: #ffcccc">                     T( 1, I ), 1 )</a>
  3329) <a name="l3329" style="background-color: #ffcccc">         T( I, I ) = TAU( I )</a>
  3330) <a name="l3330" style="background-color: #ffcccc">!</a>
  3331) <a name="l3331" style="background-color: #ffcccc">   10 CONTINUE</a>
  3332) <a name="l3332" style="background-color: #ffcccc">      A( K+NB, NB ) = EI</a>
  3333) <a name="l3333" style="background-color: #ffcccc">!</a>
  3334) <a name="l3334" style="background-color: #ffcccc">      RETURN</a>
  3335) <a name="l3335" style="background-color: #ffcccc">!</a>
  3336) <a name="l3336" style="background-color: #ffcccc">!     End of SLAHRD</a>
  3337) <a name="l3337" style="background-color: #ffcccc">!</a>
  3338) <a name="l3338" style="background-color: #ffcccc">      END SUBROUTINE SLAHRD</a>
  3339) <a name="l3339" style="background-color: #ffffff"></a>
  3340) <a name="l3340" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  3341) <a name="l3341" style="background-color: #ffffff"></a>
  3342) <a name="l3342" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLALN2( LTRANS, NA, NW, SMIN, CA, A, LDA, D1, D2, B, &amp;</a>
  3343) <a name="l3343" style="background-color: #ffcccc">                         LDB, WR, WI, X, LDX, SCALE, XNORM, INFO )</a>
  3344) <a name="l3344" style="background-color: #ffcccc"></a>
  3345) <a name="l3345" style="background-color: #ffcccc">!</a>
  3346) <a name="l3346" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  3347) <a name="l3347" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  3348) <a name="l3348" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  3349) <a name="l3349" style="background-color: #ffcccc">!     October 31, 1992</a>
  3350) <a name="l3350" style="background-color: #ffcccc">!</a>
  3351) <a name="l3351" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  3352) <a name="l3352" style="background-color: #ffcccc">      LOGICAL            LTRANS</a>
  3353) <a name="l3353" style="background-color: #ffcccc">      INTEGER            INFO, LDA, LDB, LDX, NA, NW</a>
  3354) <a name="l3354" style="background-color: #ffcccc">      REAL(r8)               CA, D1, D2, SCALE, SMIN, WI, WR, XNORM</a>
  3355) <a name="l3355" style="background-color: #ffcccc">!     ..</a>
  3356) <a name="l3356" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  3357) <a name="l3357" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), B( LDB, * ), X( LDX, * )</a>
  3358) <a name="l3358" style="background-color: #ffcccc">!     ..</a>
  3359) <a name="l3359" style="background-color: #ffcccc">!</a>
  3360) <a name="l3360" style="background-color: #ffcccc">!  Purpose</a>
  3361) <a name="l3361" style="background-color: #ffcccc">!  =======</a>
  3362) <a name="l3362" style="background-color: #ffcccc">!</a>
  3363) <a name="l3363" style="background-color: #ffcccc">!  SLALN2 solves a system of the form  (ca A - w D ) X = s B</a>
  3364) <a name="l3364" style="background-color: #ffcccc">!  or (ca A' - w D) X = s B   with possible scaling (&quot;s&quot;) and</a>
  3365) <a name="l3365" style="background-color: #ffcccc">!  perturbation of A.  (A' means A-transpose.)</a>
  3366) <a name="l3366" style="background-color: #ffcccc">!</a>
  3367) <a name="l3367" style="background-color: #ffcccc">!  A is an NA x NA real matrix, ca is a real scalar, D is an NA x NA</a>
  3368) <a name="l3368" style="background-color: #ffcccc">!  real diagonal matrix, w is a real or complex value, and X and B are</a>
  3369) <a name="l3369" style="background-color: #ffcccc">!  NA x 1 matrices -- real if w is real, complex if w is complex.  NA</a>
  3370) <a name="l3370" style="background-color: #ffcccc">!  may be 1 or 2.</a>
  3371) <a name="l3371" style="background-color: #ffcccc">!</a>
  3372) <a name="l3372" style="background-color: #ffcccc">!  If w is complex, X and B are represented as NA x 2 matrices,</a>
  3373) <a name="l3373" style="background-color: #ffcccc">!  the first column of each being the real part and the second</a>
  3374) <a name="l3374" style="background-color: #ffcccc">!  being the imaginary part.</a>
  3375) <a name="l3375" style="background-color: #ffcccc">!</a>
  3376) <a name="l3376" style="background-color: #ffcccc">!  &quot;s&quot; is a scaling factor (.LE. 1), computed by SLALN2, which is</a>
  3377) <a name="l3377" style="background-color: #ffcccc">!  so chosen that X can be computed without overflow.  X is further</a>
  3378) <a name="l3378" style="background-color: #ffcccc">!  scaled if necessary to assure that norm(ca A - w D)*norm(X) is less</a>
  3379) <a name="l3379" style="background-color: #ffcccc">!  than overflow.</a>
  3380) <a name="l3380" style="background-color: #ffcccc">!</a>
  3381) <a name="l3381" style="background-color: #ffcccc">!  If both singular values of (ca A - w D) are less than SMIN,</a>
  3382) <a name="l3382" style="background-color: #ffcccc">!  SMIN*identity will be used instead of (ca A - w D).  If only one</a>
  3383) <a name="l3383" style="background-color: #ffcccc">!  singular value is less than SMIN, one element of (ca A - w D) will be</a>
  3384) <a name="l3384" style="background-color: #ffcccc">!  perturbed enough to make the smallest singular value roughly SMIN.</a>
  3385) <a name="l3385" style="background-color: #ffcccc">!  If both singular values are at least SMIN, (ca A - w D) will not be</a>
  3386) <a name="l3386" style="background-color: #ffcccc">!  perturbed.  In any case, the perturbation will be at most some small</a>
  3387) <a name="l3387" style="background-color: #ffcccc">!  multiple of max( SMIN, ulp*norm(ca A - w D) ).  The singular values</a>
  3388) <a name="l3388" style="background-color: #ffcccc">!  are computed by infinity-norm approximations, and thus will only be</a>
  3389) <a name="l3389" style="background-color: #ffcccc">!  correct to a factor of 2 or so.</a>
  3390) <a name="l3390" style="background-color: #ffcccc">!</a>
  3391) <a name="l3391" style="background-color: #ffcccc">!  Note: all input quantities are assumed to be smaller than overflow</a>
  3392) <a name="l3392" style="background-color: #ffcccc">!  by a reasonable factor.  (See BIGNUM.)</a>
  3393) <a name="l3393" style="background-color: #ffcccc">!</a>
  3394) <a name="l3394" style="background-color: #ffcccc">!  Arguments</a>
  3395) <a name="l3395" style="background-color: #ffcccc">!  ==========</a>
  3396) <a name="l3396" style="background-color: #ffcccc">!</a>
  3397) <a name="l3397" style="background-color: #ffcccc">!  LTRANS  (input) LOGICAL</a>
  3398) <a name="l3398" style="background-color: #ffcccc">!          =.TRUE.:  A-transpose will be used.</a>
  3399) <a name="l3399" style="background-color: #ffcccc">!          =.FALSE.: A will be used (not transposed.)</a>
  3400) <a name="l3400" style="background-color: #ffcccc">!</a>
  3401) <a name="l3401" style="background-color: #ffcccc">!  NA      (input) INTEGER</a>
  3402) <a name="l3402" style="background-color: #ffcccc">!          The size of the matrix A.  It may (only) be 1 or 2.</a>
  3403) <a name="l3403" style="background-color: #ffcccc">!</a>
  3404) <a name="l3404" style="background-color: #ffcccc">!  NW      (input) INTEGER</a>
  3405) <a name="l3405" style="background-color: #ffcccc">!          1 if &quot;w&quot; is real, 2 if &quot;w&quot; is complex.  It may only be 1</a>
  3406) <a name="l3406" style="background-color: #ffcccc">!          or 2.</a>
  3407) <a name="l3407" style="background-color: #ffcccc">!</a>
  3408) <a name="l3408" style="background-color: #ffcccc">!  SMIN    (input) REAL</a>
  3409) <a name="l3409" style="background-color: #ffcccc">!          The desired lower bound on the singular values of A.  This</a>
  3410) <a name="l3410" style="background-color: #ffcccc">!          should be a safe distance away from underflow or overflow,</a>
  3411) <a name="l3411" style="background-color: #ffcccc">!          say, between (underflow/machine precision) and  (machine</a>
  3412) <a name="l3412" style="background-color: #ffcccc">!          precision * overflow ).  (See BIGNUM and ULP.)</a>
  3413) <a name="l3413" style="background-color: #ffcccc">!</a>
  3414) <a name="l3414" style="background-color: #ffcccc">!  CA      (input) REAL</a>
  3415) <a name="l3415" style="background-color: #ffcccc">!          The coefficient c, which A is multiplied by.</a>
  3416) <a name="l3416" style="background-color: #ffcccc">!</a>
  3417) <a name="l3417" style="background-color: #ffcccc">!  A       (input) REAL array, dimension (LDA,NA)</a>
  3418) <a name="l3418" style="background-color: #ffcccc">!          The NA x NA matrix A.</a>
  3419) <a name="l3419" style="background-color: #ffcccc">!</a>
  3420) <a name="l3420" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  3421) <a name="l3421" style="background-color: #ffcccc">!          The leading dimension of A.  It must be at least NA.</a>
  3422) <a name="l3422" style="background-color: #ffcccc">!</a>
  3423) <a name="l3423" style="background-color: #ffcccc">!  D1      (input) REAL</a>
  3424) <a name="l3424" style="background-color: #ffcccc">!          The 1,1 element in the diagonal matrix D.</a>
  3425) <a name="l3425" style="background-color: #ffcccc">!</a>
  3426) <a name="l3426" style="background-color: #ffcccc">!  D2      (input) REAL</a>
  3427) <a name="l3427" style="background-color: #ffcccc">!          The 2,2 element in the diagonal matrix D.  Not used if NW=1.</a>
  3428) <a name="l3428" style="background-color: #ffcccc">!</a>
  3429) <a name="l3429" style="background-color: #ffcccc">!  B       (input) REAL array, dimension (LDB,NW)</a>
  3430) <a name="l3430" style="background-color: #ffcccc">!          The NA x NW matrix B (right-hand side).  If NW=2 (&quot;w&quot; is</a>
  3431) <a name="l3431" style="background-color: #ffcccc">!          complex), column 1 contains the real part of B and column 2</a>
  3432) <a name="l3432" style="background-color: #ffcccc">!          contains the imaginary part.</a>
  3433) <a name="l3433" style="background-color: #ffcccc">!</a>
  3434) <a name="l3434" style="background-color: #ffcccc">!  LDB     (input) INTEGER</a>
  3435) <a name="l3435" style="background-color: #ffcccc">!          The leading dimension of B.  It must be at least NA.</a>
  3436) <a name="l3436" style="background-color: #ffcccc">!</a>
  3437) <a name="l3437" style="background-color: #ffcccc">!  WR      (input) REAL</a>
  3438) <a name="l3438" style="background-color: #ffcccc">!          The real part of the scalar &quot;w&quot;.</a>
  3439) <a name="l3439" style="background-color: #ffcccc">!</a>
  3440) <a name="l3440" style="background-color: #ffcccc">!  WI      (input) REAL</a>
  3441) <a name="l3441" style="background-color: #ffcccc">!          The imaginary part of the scalar &quot;w&quot;.  Not used if NW=1.</a>
  3442) <a name="l3442" style="background-color: #ffcccc">!</a>
  3443) <a name="l3443" style="background-color: #ffcccc">!  X       (output) REAL array, dimension (LDX,NW)</a>
  3444) <a name="l3444" style="background-color: #ffcccc">!          The NA x NW matrix X (unknowns), as computed by SLALN2.</a>
  3445) <a name="l3445" style="background-color: #ffcccc">!          If NW=2 (&quot;w&quot; is complex), on exit, column 1 will contain</a>
  3446) <a name="l3446" style="background-color: #ffcccc">!          the real part of X and column 2 will contain the imaginary</a>
  3447) <a name="l3447" style="background-color: #ffcccc">!          part.</a>
  3448) <a name="l3448" style="background-color: #ffcccc">!</a>
  3449) <a name="l3449" style="background-color: #ffcccc">!  LDX     (input) INTEGER</a>
  3450) <a name="l3450" style="background-color: #ffcccc">!          The leading dimension of X.  It must be at least NA.</a>
  3451) <a name="l3451" style="background-color: #ffcccc">!</a>
  3452) <a name="l3452" style="background-color: #ffcccc">!  SCALE   (output) REAL</a>
  3453) <a name="l3453" style="background-color: #ffcccc">!          The scale factor that B must be multiplied by to insure</a>
  3454) <a name="l3454" style="background-color: #ffcccc">!          that overflow does not occur when computing X.  Thus,</a>
  3455) <a name="l3455" style="background-color: #ffcccc">!          (ca A - w D) X  will be SCALE*B, not B (ignoring</a>
  3456) <a name="l3456" style="background-color: #ffcccc">!          perturbations of A.)  It will be at most 1.</a>
  3457) <a name="l3457" style="background-color: #ffcccc">!</a>
  3458) <a name="l3458" style="background-color: #ffcccc">!  XNORM   (output) REAL</a>
  3459) <a name="l3459" style="background-color: #ffcccc">!          The infinity-norm of X, when X is regarded as an NA x NW</a>
  3460) <a name="l3460" style="background-color: #ffcccc">!          real matrix.</a>
  3461) <a name="l3461" style="background-color: #ffcccc">!</a>
  3462) <a name="l3462" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  3463) <a name="l3463" style="background-color: #ffcccc">!          An error flag.  It will be set to zero if no error occurs,</a>
  3464) <a name="l3464" style="background-color: #ffcccc">!          a negative number if an argument is in error, or a positive</a>
  3465) <a name="l3465" style="background-color: #ffcccc">!          number if  ca A - w D  had to be perturbed.</a>
  3466) <a name="l3466" style="background-color: #ffcccc">!          The possible values are:</a>
  3467) <a name="l3467" style="background-color: #ffcccc">!          = 0: No error occurred, and (ca A - w D) did not have to be</a>
  3468) <a name="l3468" style="background-color: #ffcccc">!                 perturbed.</a>
  3469) <a name="l3469" style="background-color: #ffcccc">!          = 1: (ca A - w D) had to be perturbed to make its smallest</a>
  3470) <a name="l3470" style="background-color: #ffcccc">!               (or only) singular value greater than SMIN.</a>
  3471) <a name="l3471" style="background-color: #ffcccc">!          NOTE: In the interests of speed, this routine does not</a>
  3472) <a name="l3472" style="background-color: #ffcccc">!                check the inputs for errors.</a>
  3473) <a name="l3473" style="background-color: #ffcccc">!</a>
  3474) <a name="l3474" style="background-color: #ffcccc">! =====================================================================</a>
  3475) <a name="l3475" style="background-color: #ffcccc">!</a>
  3476) <a name="l3476" style="background-color: #ffcccc">!     .. Parameters ..</a>
  3477) <a name="l3477" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
  3478) <a name="l3478" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E0_r8, ONE = 1.0E0_r8 )</a>
  3479) <a name="l3479" style="background-color: #ffcccc">      REAL(r8)               TWO</a>
  3480) <a name="l3480" style="background-color: #ffcccc">      PARAMETER          ( TWO = 2.0E0_r8 )</a>
  3481) <a name="l3481" style="background-color: #ffcccc">!     ..</a>
  3482) <a name="l3482" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  3483) <a name="l3483" style="background-color: #ffcccc">      INTEGER            ICMAX, J</a>
  3484) <a name="l3484" style="background-color: #ffcccc">      REAL(r8)               BBND, BI1, BI2, BIGNUM, BNORM, BR1, BR2, CI21, &amp;</a>
  3485) <a name="l3485" style="background-color: #ffcccc">                         CI22, CMAX, CNORM, CR21, CR22, CSI, CSR, LI21, &amp;</a>
  3486) <a name="l3486" style="background-color: #ffcccc">                         LR21, SMINI, SMLNUM, TEMP, U22ABS, UI11, UI11R, &amp;</a>
  3487) <a name="l3487" style="background-color: #ffcccc">                         UI12, UI12S, UI22, UR11, UR11R, UR12, UR12S, &amp;</a>
  3488) <a name="l3488" style="background-color: #ffcccc">                         UR22, XI1, XI2, XR1, XR2</a>
  3489) <a name="l3489" style="background-color: #ffcccc">!     ..</a>
  3490) <a name="l3490" style="background-color: #ffcccc">!     .. Local Arrays ..</a>
  3491) <a name="l3491" style="background-color: #ffcccc">      LOGICAL            CSWAP( 4 ), RSWAP( 4 )</a>
  3492) <a name="l3492" style="background-color: #ffcccc">      INTEGER            IPIVOT( 4, 4 )</a>
  3493) <a name="l3493" style="background-color: #ffcccc">      REAL(r8)               CI( 2, 2 ), CIV( 4 ), CR( 2, 2 ), CRV( 4 )</a>
  3494) <a name="l3494" style="background-color: #ffcccc">!     ..</a>
  3495) <a name="l3495" style="background-color: #ffcccc">!     .. Equivalences ..</a>
  3496) <a name="l3496" style="background-color: #ffcccc">      EQUIVALENCE        ( CI( 1, 1 ), CIV( 1 ) ), &amp;</a>
  3497) <a name="l3497" style="background-color: #ffcccc">                         ( CR( 1, 1 ), CRV( 1 ) )</a>
  3498) <a name="l3498" style="background-color: #ffcccc">!     ..</a>
  3499) <a name="l3499" style="background-color: #ffcccc">!     .. Data statements ..</a>
  3500) <a name="l3500" style="background-color: #ffcccc">      DATA               CSWAP / .FALSE., .FALSE., .TRUE., .TRUE. /</a>
  3501) <a name="l3501" style="background-color: #ffcccc">      DATA               RSWAP / .FALSE., .TRUE., .FALSE., .TRUE. /</a>
  3502) <a name="l3502" style="background-color: #ffcccc">      DATA               IPIVOT / 1, 2, 3, 4, 2, 1, 4, 3, 3, 4, 1, 2, 4, &amp;</a>
  3503) <a name="l3503" style="background-color: #ffcccc">                         3, 2, 1 /</a>
  3504) <a name="l3504" style="background-color: #ffcccc">!     ..</a>
  3505) <a name="l3505" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  3506) <a name="l3506" style="background-color: #ffcccc">!</a>
  3507) <a name="l3507" style="background-color: #ffcccc">!     Compute BIGNUM</a>
  3508) <a name="l3508" style="background-color: #ffcccc">!</a>
  3509) <a name="l3509" style="background-color: #ffcccc">      SMLNUM = TWO*SLAMCH( 'Safe minimum' )</a>
  3510) <a name="l3510" style="background-color: #ffcccc">      BIGNUM = ONE / SMLNUM</a>
  3511) <a name="l3511" style="background-color: #ffcccc">      SMINI = MAX( SMIN, SMLNUM )</a>
  3512) <a name="l3512" style="background-color: #ffcccc">!</a>
  3513) <a name="l3513" style="background-color: #ffcccc">!     Don't check for input errors</a>
  3514) <a name="l3514" style="background-color: #ffcccc">!</a>
  3515) <a name="l3515" style="background-color: #ffcccc">      INFO = 0</a>
  3516) <a name="l3516" style="background-color: #ffcccc">!</a>
  3517) <a name="l3517" style="background-color: #ffcccc">!     Standard Initializations</a>
  3518) <a name="l3518" style="background-color: #ffcccc">!</a>
  3519) <a name="l3519" style="background-color: #ffcccc">      SCALE = ONE</a>
  3520) <a name="l3520" style="background-color: #ffcccc">!</a>
  3521) <a name="l3521" style="background-color: #ffcccc">      IF( NA.EQ.1 ) THEN</a>
  3522) <a name="l3522" style="background-color: #ffcccc">!</a>
  3523) <a name="l3523" style="background-color: #ffcccc">!        1 x 1  (i.e., scalar) system   C X = B</a>
  3524) <a name="l3524" style="background-color: #ffcccc">!</a>
  3525) <a name="l3525" style="background-color: #ffcccc">         IF( NW.EQ.1 ) THEN</a>
  3526) <a name="l3526" style="background-color: #ffcccc">!</a>
  3527) <a name="l3527" style="background-color: #ffcccc">!           Real 1x1 system.</a>
  3528) <a name="l3528" style="background-color: #ffcccc">!</a>
  3529) <a name="l3529" style="background-color: #ffcccc">!           C = ca A - w D</a>
  3530) <a name="l3530" style="background-color: #ffcccc">!</a>
  3531) <a name="l3531" style="background-color: #ffcccc">            CSR = CA*A( 1, 1 ) - WR*D1</a>
  3532) <a name="l3532" style="background-color: #ffcccc">            CNORM = ABS( CSR )</a>
  3533) <a name="l3533" style="background-color: #ffcccc">!</a>
  3534) <a name="l3534" style="background-color: #ffcccc">!           If | C | &lt; SMINI, use C = SMINI</a>
  3535) <a name="l3535" style="background-color: #ffcccc">!</a>
  3536) <a name="l3536" style="background-color: #ffcccc">            IF( CNORM.LT.SMINI ) THEN</a>
  3537) <a name="l3537" style="background-color: #ffcccc">               CSR = SMINI</a>
  3538) <a name="l3538" style="background-color: #ffcccc">               CNORM = SMINI</a>
  3539) <a name="l3539" style="background-color: #ffcccc">               INFO = 1</a>
  3540) <a name="l3540" style="background-color: #ffcccc">            END IF</a>
  3541) <a name="l3541" style="background-color: #ffcccc">!</a>
  3542) <a name="l3542" style="background-color: #ffcccc">!           Check scaling for  X = B / C</a>
  3543) <a name="l3543" style="background-color: #ffcccc">!</a>
  3544) <a name="l3544" style="background-color: #ffcccc">            BNORM = ABS( B( 1, 1 ) )</a>
  3545) <a name="l3545" style="background-color: #ffcccc">            IF( CNORM.LT.ONE .AND. BNORM.GT.ONE ) THEN</a>
  3546) <a name="l3546" style="background-color: #ffcccc">               IF( BNORM.GT.BIGNUM*CNORM ) &amp;</a>
  3547) <a name="l3547" style="background-color: #ffcccc">                  SCALE = ONE / BNORM</a>
  3548) <a name="l3548" style="background-color: #ffcccc">            END IF</a>
  3549) <a name="l3549" style="background-color: #ffcccc">!</a>
  3550) <a name="l3550" style="background-color: #ffcccc">!           Compute X</a>
  3551) <a name="l3551" style="background-color: #ffcccc">!</a>
  3552) <a name="l3552" style="background-color: #ffcccc">            X( 1, 1 ) = ( B( 1, 1 )*SCALE ) / CSR</a>
  3553) <a name="l3553" style="background-color: #ffcccc">            XNORM = ABS( X( 1, 1 ) )</a>
  3554) <a name="l3554" style="background-color: #ffcccc">         ELSE</a>
  3555) <a name="l3555" style="background-color: #ffcccc">!</a>
  3556) <a name="l3556" style="background-color: #ffcccc">!           Complex 1x1 system (w is complex)</a>
  3557) <a name="l3557" style="background-color: #ffcccc">!</a>
  3558) <a name="l3558" style="background-color: #ffcccc">!           C = ca A - w D</a>
  3559) <a name="l3559" style="background-color: #ffcccc">!</a>
  3560) <a name="l3560" style="background-color: #ffcccc">            CSR = CA*A( 1, 1 ) - WR*D1</a>
  3561) <a name="l3561" style="background-color: #ffcccc">            CSI = -WI*D1</a>
  3562) <a name="l3562" style="background-color: #ffcccc">            CNORM = ABS( CSR ) + ABS( CSI )</a>
  3563) <a name="l3563" style="background-color: #ffcccc">!</a>
  3564) <a name="l3564" style="background-color: #ffcccc">!           If | C | &lt; SMINI, use C = SMINI</a>
  3565) <a name="l3565" style="background-color: #ffcccc">!</a>
  3566) <a name="l3566" style="background-color: #ffcccc">            IF( CNORM.LT.SMINI ) THEN</a>
  3567) <a name="l3567" style="background-color: #ffcccc">               CSR = SMINI</a>
  3568) <a name="l3568" style="background-color: #ffcccc">               CSI = ZERO</a>
  3569) <a name="l3569" style="background-color: #ffcccc">               CNORM = SMINI</a>
  3570) <a name="l3570" style="background-color: #ffcccc">               INFO = 1</a>
  3571) <a name="l3571" style="background-color: #ffcccc">            END IF</a>
  3572) <a name="l3572" style="background-color: #ffcccc">!</a>
  3573) <a name="l3573" style="background-color: #ffcccc">!           Check scaling for  X = B / C</a>
  3574) <a name="l3574" style="background-color: #ffcccc">!</a>
  3575) <a name="l3575" style="background-color: #ffcccc">            BNORM = ABS( B( 1, 1 ) ) + ABS( B( 1, 2 ) )</a>
  3576) <a name="l3576" style="background-color: #ffcccc">            IF( CNORM.LT.ONE .AND. BNORM.GT.ONE ) THEN</a>
  3577) <a name="l3577" style="background-color: #ffcccc">               IF( BNORM.GT.BIGNUM*CNORM ) &amp;</a>
  3578) <a name="l3578" style="background-color: #ffcccc">                  SCALE = ONE / BNORM</a>
  3579) <a name="l3579" style="background-color: #ffcccc">            END IF</a>
  3580) <a name="l3580" style="background-color: #ffcccc">!</a>
  3581) <a name="l3581" style="background-color: #ffcccc">!           Compute X</a>
  3582) <a name="l3582" style="background-color: #ffcccc">!</a>
  3583) <a name="l3583" style="background-color: #ffcccc">            CALL SLADIV( SCALE*B( 1, 1 ), SCALE*B( 1, 2 ), CSR, CSI, &amp;</a>
  3584) <a name="l3584" style="background-color: #ffcccc">                         X( 1, 1 ), X( 1, 2 ) )</a>
  3585) <a name="l3585" style="background-color: #ffcccc">            XNORM = ABS( X( 1, 1 ) ) + ABS( X( 1, 2 ) )</a>
  3586) <a name="l3586" style="background-color: #ffcccc">         END IF</a>
  3587) <a name="l3587" style="background-color: #ffcccc">!</a>
  3588) <a name="l3588" style="background-color: #ffcccc">      ELSE</a>
  3589) <a name="l3589" style="background-color: #ffcccc">!</a>
  3590) <a name="l3590" style="background-color: #ffcccc">!        2x2 System</a>
  3591) <a name="l3591" style="background-color: #ffcccc">!</a>
  3592) <a name="l3592" style="background-color: #ffcccc">!        Compute the real part of  C = ca A - w D  (or  ca A' - w D )</a>
  3593) <a name="l3593" style="background-color: #ffcccc">!</a>
  3594) <a name="l3594" style="background-color: #ffcccc">         CR( 1, 1 ) = CA*A( 1, 1 ) - WR*D1</a>
  3595) <a name="l3595" style="background-color: #ffcccc">         CR( 2, 2 ) = CA*A( 2, 2 ) - WR*D2</a>
  3596) <a name="l3596" style="background-color: #ffcccc">         IF( LTRANS ) THEN</a>
  3597) <a name="l3597" style="background-color: #ffcccc">            CR( 1, 2 ) = CA*A( 2, 1 )</a>
  3598) <a name="l3598" style="background-color: #ffcccc">            CR( 2, 1 ) = CA*A( 1, 2 )</a>
  3599) <a name="l3599" style="background-color: #ffcccc">         ELSE</a>
  3600) <a name="l3600" style="background-color: #ffcccc">            CR( 2, 1 ) = CA*A( 2, 1 )</a>
  3601) <a name="l3601" style="background-color: #ffcccc">            CR( 1, 2 ) = CA*A( 1, 2 )</a>
  3602) <a name="l3602" style="background-color: #ffcccc">         END IF</a>
  3603) <a name="l3603" style="background-color: #ffcccc">!</a>
  3604) <a name="l3604" style="background-color: #ffcccc">         IF( NW.EQ.1 ) THEN</a>
  3605) <a name="l3605" style="background-color: #ffcccc">!</a>
  3606) <a name="l3606" style="background-color: #ffcccc">!           Real 2x2 system  (w is real)</a>
  3607) <a name="l3607" style="background-color: #ffcccc">!</a>
  3608) <a name="l3608" style="background-color: #ffcccc">!           Find the largest element in C</a>
  3609) <a name="l3609" style="background-color: #ffcccc">!</a>
  3610) <a name="l3610" style="background-color: #ffcccc">            CMAX = ZERO</a>
  3611) <a name="l3611" style="background-color: #ffcccc">            ICMAX = 0</a>
  3612) <a name="l3612" style="background-color: #ffcccc">!</a>
  3613) <a name="l3613" style="background-color: #ffcccc">            DO 10 J = 1, 4</a>
  3614) <a name="l3614" style="background-color: #ffcccc">               IF( ABS( CRV( J ) ).GT.CMAX ) THEN</a>
  3615) <a name="l3615" style="background-color: #ffcccc">                  CMAX = ABS( CRV( J ) )</a>
  3616) <a name="l3616" style="background-color: #ffcccc">                  ICMAX = J</a>
  3617) <a name="l3617" style="background-color: #ffcccc">               END IF</a>
  3618) <a name="l3618" style="background-color: #ffcccc">   10       CONTINUE</a>
  3619) <a name="l3619" style="background-color: #ffcccc">!</a>
  3620) <a name="l3620" style="background-color: #ffcccc">!           If norm(C) &lt; SMINI, use SMINI*identity.</a>
  3621) <a name="l3621" style="background-color: #ffcccc">!</a>
  3622) <a name="l3622" style="background-color: #ffcccc">            IF( CMAX.LT.SMINI ) THEN</a>
  3623) <a name="l3623" style="background-color: #ffcccc">               BNORM = MAX( ABS( B( 1, 1 ) ), ABS( B( 2, 1 ) ) )</a>
  3624) <a name="l3624" style="background-color: #ffcccc">               IF( SMINI.LT.ONE .AND. BNORM.GT.ONE ) THEN</a>
  3625) <a name="l3625" style="background-color: #ffcccc">                  IF( BNORM.GT.BIGNUM*SMINI ) &amp;</a>
  3626) <a name="l3626" style="background-color: #ffcccc">                     SCALE = ONE / BNORM</a>
  3627) <a name="l3627" style="background-color: #ffcccc">               END IF</a>
  3628) <a name="l3628" style="background-color: #ffcccc">               TEMP = SCALE / SMINI</a>
  3629) <a name="l3629" style="background-color: #ffcccc">               X( 1, 1 ) = TEMP*B( 1, 1 )</a>
  3630) <a name="l3630" style="background-color: #ffcccc">               X( 2, 1 ) = TEMP*B( 2, 1 )</a>
  3631) <a name="l3631" style="background-color: #ffcccc">               XNORM = TEMP*BNORM</a>
  3632) <a name="l3632" style="background-color: #ffcccc">               INFO = 1</a>
  3633) <a name="l3633" style="background-color: #ffcccc">               RETURN</a>
  3634) <a name="l3634" style="background-color: #ffcccc">            END IF</a>
  3635) <a name="l3635" style="background-color: #ffcccc">!</a>
  3636) <a name="l3636" style="background-color: #ffcccc">!           Gaussian elimination with complete pivoting.</a>
  3637) <a name="l3637" style="background-color: #ffcccc">!</a>
  3638) <a name="l3638" style="background-color: #ffcccc">            UR11 = CRV( ICMAX )</a>
  3639) <a name="l3639" style="background-color: #ffcccc">            CR21 = CRV( IPIVOT( 2, ICMAX ) )</a>
  3640) <a name="l3640" style="background-color: #ffcccc">            UR12 = CRV( IPIVOT( 3, ICMAX ) )</a>
  3641) <a name="l3641" style="background-color: #ffcccc">            CR22 = CRV( IPIVOT( 4, ICMAX ) )</a>
  3642) <a name="l3642" style="background-color: #ffcccc">            UR11R = ONE / UR11</a>
  3643) <a name="l3643" style="background-color: #ffcccc">            LR21 = UR11R*CR21</a>
  3644) <a name="l3644" style="background-color: #ffcccc">            UR22 = CR22 - UR12*LR21</a>
  3645) <a name="l3645" style="background-color: #ffcccc">!</a>
  3646) <a name="l3646" style="background-color: #ffcccc">!           If smaller pivot &lt; SMINI, use SMINI</a>
  3647) <a name="l3647" style="background-color: #ffcccc">!</a>
  3648) <a name="l3648" style="background-color: #ffcccc">            IF( ABS( UR22 ).LT.SMINI ) THEN</a>
  3649) <a name="l3649" style="background-color: #ffcccc">               UR22 = SMINI</a>
  3650) <a name="l3650" style="background-color: #ffcccc">               INFO = 1</a>
  3651) <a name="l3651" style="background-color: #ffcccc">            END IF</a>
  3652) <a name="l3652" style="background-color: #ffcccc">            IF( RSWAP( ICMAX ) ) THEN</a>
  3653) <a name="l3653" style="background-color: #ffcccc">               BR1 = B( 2, 1 )</a>
  3654) <a name="l3654" style="background-color: #ffcccc">               BR2 = B( 1, 1 )</a>
  3655) <a name="l3655" style="background-color: #ffcccc">            ELSE</a>
  3656) <a name="l3656" style="background-color: #ffcccc">               BR1 = B( 1, 1 )</a>
  3657) <a name="l3657" style="background-color: #ffcccc">               BR2 = B( 2, 1 )</a>
  3658) <a name="l3658" style="background-color: #ffcccc">            END IF</a>
  3659) <a name="l3659" style="background-color: #ffcccc">            BR2 = BR2 - LR21*BR1</a>
  3660) <a name="l3660" style="background-color: #ffcccc">            BBND = MAX( ABS( BR1*( UR22*UR11R ) ), ABS( BR2 ) )</a>
  3661) <a name="l3661" style="background-color: #ffcccc">            IF( BBND.GT.ONE .AND. ABS( UR22 ).LT.ONE ) THEN</a>
  3662) <a name="l3662" style="background-color: #ffcccc">               IF( BBND.GE.BIGNUM*ABS( UR22 ) ) &amp;</a>
  3663) <a name="l3663" style="background-color: #ffcccc">                  SCALE = ONE / BBND</a>
  3664) <a name="l3664" style="background-color: #ffcccc">            END IF</a>
  3665) <a name="l3665" style="background-color: #ffcccc">!</a>
  3666) <a name="l3666" style="background-color: #ffcccc">            XR2 = ( BR2*SCALE ) / UR22</a>
  3667) <a name="l3667" style="background-color: #ffcccc">            XR1 = ( SCALE*BR1 )*UR11R - XR2*( UR11R*UR12 )</a>
  3668) <a name="l3668" style="background-color: #ffcccc">            IF( CSWAP( ICMAX ) ) THEN</a>
  3669) <a name="l3669" style="background-color: #ffcccc">               X( 1, 1 ) = XR2</a>
  3670) <a name="l3670" style="background-color: #ffcccc">               X( 2, 1 ) = XR1</a>
  3671) <a name="l3671" style="background-color: #ffcccc">            ELSE</a>
  3672) <a name="l3672" style="background-color: #ffcccc">               X( 1, 1 ) = XR1</a>
  3673) <a name="l3673" style="background-color: #ffcccc">               X( 2, 1 ) = XR2</a>
  3674) <a name="l3674" style="background-color: #ffcccc">            END IF</a>
  3675) <a name="l3675" style="background-color: #ffcccc">            XNORM = MAX( ABS( XR1 ), ABS( XR2 ) )</a>
  3676) <a name="l3676" style="background-color: #ffcccc">!</a>
  3677) <a name="l3677" style="background-color: #ffcccc">!           Further scaling if  norm(A) norm(X) &gt; overflow</a>
  3678) <a name="l3678" style="background-color: #ffcccc">!</a>
  3679) <a name="l3679" style="background-color: #ffcccc">            IF( XNORM.GT.ONE .AND. CMAX.GT.ONE ) THEN</a>
  3680) <a name="l3680" style="background-color: #ffcccc">               IF( XNORM.GT.BIGNUM / CMAX ) THEN</a>
  3681) <a name="l3681" style="background-color: #ffcccc">                  TEMP = CMAX / BIGNUM</a>
  3682) <a name="l3682" style="background-color: #ffcccc">                  X( 1, 1 ) = TEMP*X( 1, 1 )</a>
  3683) <a name="l3683" style="background-color: #ffcccc">                  X( 2, 1 ) = TEMP*X( 2, 1 )</a>
  3684) <a name="l3684" style="background-color: #ffcccc">                  XNORM = TEMP*XNORM</a>
  3685) <a name="l3685" style="background-color: #ffcccc">                  SCALE = TEMP*SCALE</a>
  3686) <a name="l3686" style="background-color: #ffcccc">               END IF</a>
  3687) <a name="l3687" style="background-color: #ffcccc">            END IF</a>
  3688) <a name="l3688" style="background-color: #ffcccc">         ELSE</a>
  3689) <a name="l3689" style="background-color: #ffcccc">!</a>
  3690) <a name="l3690" style="background-color: #ffcccc">!           Complex 2x2 system  (w is complex)</a>
  3691) <a name="l3691" style="background-color: #ffcccc">!</a>
  3692) <a name="l3692" style="background-color: #ffcccc">!           Find the largest element in C</a>
  3693) <a name="l3693" style="background-color: #ffcccc">!</a>
  3694) <a name="l3694" style="background-color: #ffcccc">            CI( 1, 1 ) = -WI*D1</a>
  3695) <a name="l3695" style="background-color: #ffcccc">            CI( 2, 1 ) = ZERO</a>
  3696) <a name="l3696" style="background-color: #ffcccc">            CI( 1, 2 ) = ZERO</a>
  3697) <a name="l3697" style="background-color: #ffcccc">            CI( 2, 2 ) = -WI*D2</a>
  3698) <a name="l3698" style="background-color: #ffcccc">            CMAX = ZERO</a>
  3699) <a name="l3699" style="background-color: #ffcccc">            ICMAX = 0</a>
  3700) <a name="l3700" style="background-color: #ffcccc">!</a>
  3701) <a name="l3701" style="background-color: #ffcccc">            DO 20 J = 1, 4</a>
  3702) <a name="l3702" style="background-color: #ffcccc">               IF( ABS( CRV( J ) )+ABS( CIV( J ) ).GT.CMAX ) THEN</a>
  3703) <a name="l3703" style="background-color: #ffcccc">                  CMAX = ABS( CRV( J ) ) + ABS( CIV( J ) )</a>
  3704) <a name="l3704" style="background-color: #ffcccc">                  ICMAX = J</a>
  3705) <a name="l3705" style="background-color: #ffcccc">               END IF</a>
  3706) <a name="l3706" style="background-color: #ffcccc">   20       CONTINUE</a>
  3707) <a name="l3707" style="background-color: #ffcccc">!</a>
  3708) <a name="l3708" style="background-color: #ffcccc">!           If norm(C) &lt; SMINI, use SMINI*identity.</a>
  3709) <a name="l3709" style="background-color: #ffcccc">!</a>
  3710) <a name="l3710" style="background-color: #ffcccc">            IF( CMAX.LT.SMINI ) THEN</a>
  3711) <a name="l3711" style="background-color: #ffcccc">               BNORM = MAX( ABS( B( 1, 1 ) )+ABS( B( 1, 2 ) ), &amp;</a>
  3712) <a name="l3712" style="background-color: #ffcccc">                       ABS( B( 2, 1 ) )+ABS( B( 2, 2 ) ) )</a>
  3713) <a name="l3713" style="background-color: #ffcccc">               IF( SMINI.LT.ONE .AND. BNORM.GT.ONE ) THEN</a>
  3714) <a name="l3714" style="background-color: #ffcccc">                  IF( BNORM.GT.BIGNUM*SMINI ) &amp;</a>
  3715) <a name="l3715" style="background-color: #ffcccc">                     SCALE = ONE / BNORM</a>
  3716) <a name="l3716" style="background-color: #ffcccc">               END IF</a>
  3717) <a name="l3717" style="background-color: #ffcccc">               TEMP = SCALE / SMINI</a>
  3718) <a name="l3718" style="background-color: #ffcccc">               X( 1, 1 ) = TEMP*B( 1, 1 )</a>
  3719) <a name="l3719" style="background-color: #ffcccc">               X( 2, 1 ) = TEMP*B( 2, 1 )</a>
  3720) <a name="l3720" style="background-color: #ffcccc">               X( 1, 2 ) = TEMP*B( 1, 2 )</a>
  3721) <a name="l3721" style="background-color: #ffcccc">               X( 2, 2 ) = TEMP*B( 2, 2 )</a>
  3722) <a name="l3722" style="background-color: #ffcccc">               XNORM = TEMP*BNORM</a>
  3723) <a name="l3723" style="background-color: #ffcccc">               INFO = 1</a>
  3724) <a name="l3724" style="background-color: #ffcccc">               RETURN</a>
  3725) <a name="l3725" style="background-color: #ffcccc">            END IF</a>
  3726) <a name="l3726" style="background-color: #ffcccc">!</a>
  3727) <a name="l3727" style="background-color: #ffcccc">!           Gaussian elimination with complete pivoting.</a>
  3728) <a name="l3728" style="background-color: #ffcccc">!</a>
  3729) <a name="l3729" style="background-color: #ffcccc">            UR11 = CRV( ICMAX )</a>
  3730) <a name="l3730" style="background-color: #ffcccc">            UI11 = CIV( ICMAX )</a>
  3731) <a name="l3731" style="background-color: #ffcccc">            CR21 = CRV( IPIVOT( 2, ICMAX ) )</a>
  3732) <a name="l3732" style="background-color: #ffcccc">            CI21 = CIV( IPIVOT( 2, ICMAX ) )</a>
  3733) <a name="l3733" style="background-color: #ffcccc">            UR12 = CRV( IPIVOT( 3, ICMAX ) )</a>
  3734) <a name="l3734" style="background-color: #ffcccc">            UI12 = CIV( IPIVOT( 3, ICMAX ) )</a>
  3735) <a name="l3735" style="background-color: #ffcccc">            CR22 = CRV( IPIVOT( 4, ICMAX ) )</a>
  3736) <a name="l3736" style="background-color: #ffcccc">            CI22 = CIV( IPIVOT( 4, ICMAX ) )</a>
  3737) <a name="l3737" style="background-color: #ffcccc">            IF( ICMAX.EQ.1 .OR. ICMAX.EQ.4 ) THEN</a>
  3738) <a name="l3738" style="background-color: #ffcccc">!</a>
  3739) <a name="l3739" style="background-color: #ffcccc">!              Code when off-diagonals of pivoted C are real</a>
  3740) <a name="l3740" style="background-color: #ffcccc">!</a>
  3741) <a name="l3741" style="background-color: #ffcccc">               IF( ABS( UR11 ).GT.ABS( UI11 ) ) THEN</a>
  3742) <a name="l3742" style="background-color: #ffcccc">                  TEMP = UI11 / UR11</a>
  3743) <a name="l3743" style="background-color: #ffcccc">                  UR11R = ONE / ( UR11*( ONE+TEMP**2 ) )</a>
  3744) <a name="l3744" style="background-color: #ffcccc">                  UI11R = -TEMP*UR11R</a>
  3745) <a name="l3745" style="background-color: #ffcccc">               ELSE</a>
  3746) <a name="l3746" style="background-color: #ffcccc">                  TEMP = UR11 / UI11</a>
  3747) <a name="l3747" style="background-color: #ffcccc">                  UI11R = -ONE / ( UI11*( ONE+TEMP**2 ) )</a>
  3748) <a name="l3748" style="background-color: #ffcccc">                  UR11R = -TEMP*UI11R</a>
  3749) <a name="l3749" style="background-color: #ffcccc">               END IF</a>
  3750) <a name="l3750" style="background-color: #ffcccc">               LR21 = CR21*UR11R</a>
  3751) <a name="l3751" style="background-color: #ffcccc">               LI21 = CR21*UI11R</a>
  3752) <a name="l3752" style="background-color: #ffcccc">               UR12S = UR12*UR11R</a>
  3753) <a name="l3753" style="background-color: #ffcccc">               UI12S = UR12*UI11R</a>
  3754) <a name="l3754" style="background-color: #ffcccc">               UR22 = CR22 - UR12*LR21</a>
  3755) <a name="l3755" style="background-color: #ffcccc">               UI22 = CI22 - UR12*LI21</a>
  3756) <a name="l3756" style="background-color: #ffcccc">            ELSE</a>
  3757) <a name="l3757" style="background-color: #ffcccc">!</a>
  3758) <a name="l3758" style="background-color: #ffcccc">!              Code when diagonals of pivoted C are real</a>
  3759) <a name="l3759" style="background-color: #ffcccc">!</a>
  3760) <a name="l3760" style="background-color: #ffcccc">               UR11R = ONE / UR11</a>
  3761) <a name="l3761" style="background-color: #ffcccc">               UI11R = ZERO</a>
  3762) <a name="l3762" style="background-color: #ffcccc">               LR21 = CR21*UR11R</a>
  3763) <a name="l3763" style="background-color: #ffcccc">               LI21 = CI21*UR11R</a>
  3764) <a name="l3764" style="background-color: #ffcccc">               UR12S = UR12*UR11R</a>
  3765) <a name="l3765" style="background-color: #ffcccc">               UI12S = UI12*UR11R</a>
  3766) <a name="l3766" style="background-color: #ffcccc">               UR22 = CR22 - UR12*LR21 + UI12*LI21</a>
  3767) <a name="l3767" style="background-color: #ffcccc">               UI22 = -UR12*LI21 - UI12*LR21</a>
  3768) <a name="l3768" style="background-color: #ffcccc">            END IF</a>
  3769) <a name="l3769" style="background-color: #ffcccc">            U22ABS = ABS( UR22 ) + ABS( UI22 )</a>
  3770) <a name="l3770" style="background-color: #ffcccc">!</a>
  3771) <a name="l3771" style="background-color: #ffcccc">!           If smaller pivot &lt; SMINI, use SMINI</a>
  3772) <a name="l3772" style="background-color: #ffcccc">!</a>
  3773) <a name="l3773" style="background-color: #ffcccc">            IF( U22ABS.LT.SMINI ) THEN</a>
  3774) <a name="l3774" style="background-color: #ffcccc">               UR22 = SMINI</a>
  3775) <a name="l3775" style="background-color: #ffcccc">               UI22 = ZERO</a>
  3776) <a name="l3776" style="background-color: #ffcccc">               INFO = 1</a>
  3777) <a name="l3777" style="background-color: #ffcccc">            END IF</a>
  3778) <a name="l3778" style="background-color: #ffcccc">            IF( RSWAP( ICMAX ) ) THEN</a>
  3779) <a name="l3779" style="background-color: #ffcccc">               BR2 = B( 1, 1 )</a>
  3780) <a name="l3780" style="background-color: #ffcccc">               BR1 = B( 2, 1 )</a>
  3781) <a name="l3781" style="background-color: #ffcccc">               BI2 = B( 1, 2 )</a>
  3782) <a name="l3782" style="background-color: #ffcccc">               BI1 = B( 2, 2 )</a>
  3783) <a name="l3783" style="background-color: #ffcccc">            ELSE</a>
  3784) <a name="l3784" style="background-color: #ffcccc">               BR1 = B( 1, 1 )</a>
  3785) <a name="l3785" style="background-color: #ffcccc">               BR2 = B( 2, 1 )</a>
  3786) <a name="l3786" style="background-color: #ffcccc">               BI1 = B( 1, 2 )</a>
  3787) <a name="l3787" style="background-color: #ffcccc">               BI2 = B( 2, 2 )</a>
  3788) <a name="l3788" style="background-color: #ffcccc">            END IF</a>
  3789) <a name="l3789" style="background-color: #ffcccc">            BR2 = BR2 - LR21*BR1 + LI21*BI1</a>
  3790) <a name="l3790" style="background-color: #ffcccc">            BI2 = BI2 - LI21*BR1 - LR21*BI1</a>
  3791) <a name="l3791" style="background-color: #ffcccc">            BBND = MAX( ( ABS( BR1 )+ABS( BI1 ) )* &amp;</a>
  3792) <a name="l3792" style="background-color: #ffcccc">                   ( U22ABS*( ABS( UR11R )+ABS( UI11R ) ) ), &amp;</a>
  3793) <a name="l3793" style="background-color: #ffcccc">                   ABS( BR2 )+ABS( BI2 ) )</a>
  3794) <a name="l3794" style="background-color: #ffcccc">            IF( BBND.GT.ONE .AND. U22ABS.LT.ONE ) THEN</a>
  3795) <a name="l3795" style="background-color: #ffcccc">               IF( BBND.GE.BIGNUM*U22ABS ) THEN</a>
  3796) <a name="l3796" style="background-color: #ffcccc">                  SCALE = ONE / BBND</a>
  3797) <a name="l3797" style="background-color: #ffcccc">                  BR1 = SCALE*BR1</a>
  3798) <a name="l3798" style="background-color: #ffcccc">                  BI1 = SCALE*BI1</a>
  3799) <a name="l3799" style="background-color: #ffcccc">                  BR2 = SCALE*BR2</a>
  3800) <a name="l3800" style="background-color: #ffcccc">                  BI2 = SCALE*BI2</a>
  3801) <a name="l3801" style="background-color: #ffcccc">               END IF</a>
  3802) <a name="l3802" style="background-color: #ffcccc">            END IF</a>
  3803) <a name="l3803" style="background-color: #ffcccc">!</a>
  3804) <a name="l3804" style="background-color: #ffcccc">            CALL SLADIV( BR2, BI2, UR22, UI22, XR2, XI2 )</a>
  3805) <a name="l3805" style="background-color: #ffcccc">            XR1 = UR11R*BR1 - UI11R*BI1 - UR12S*XR2 + UI12S*XI2</a>
  3806) <a name="l3806" style="background-color: #ffcccc">            XI1 = UI11R*BR1 + UR11R*BI1 - UI12S*XR2 - UR12S*XI2</a>
  3807) <a name="l3807" style="background-color: #ffcccc">            IF( CSWAP( ICMAX ) ) THEN</a>
  3808) <a name="l3808" style="background-color: #ffcccc">               X( 1, 1 ) = XR2</a>
  3809) <a name="l3809" style="background-color: #ffcccc">               X( 2, 1 ) = XR1</a>
  3810) <a name="l3810" style="background-color: #ffcccc">               X( 1, 2 ) = XI2</a>
  3811) <a name="l3811" style="background-color: #ffcccc">               X( 2, 2 ) = XI1</a>
  3812) <a name="l3812" style="background-color: #ffcccc">            ELSE</a>
  3813) <a name="l3813" style="background-color: #ffcccc">               X( 1, 1 ) = XR1</a>
  3814) <a name="l3814" style="background-color: #ffcccc">               X( 2, 1 ) = XR2</a>
  3815) <a name="l3815" style="background-color: #ffcccc">               X( 1, 2 ) = XI1</a>
  3816) <a name="l3816" style="background-color: #ffcccc">               X( 2, 2 ) = XI2</a>
  3817) <a name="l3817" style="background-color: #ffcccc">            END IF</a>
  3818) <a name="l3818" style="background-color: #ffcccc">            XNORM = MAX( ABS( XR1 )+ABS( XI1 ), ABS( XR2 )+ABS( XI2 ) )</a>
  3819) <a name="l3819" style="background-color: #ffcccc">!</a>
  3820) <a name="l3820" style="background-color: #ffcccc">!           Further scaling if  norm(A) norm(X) &gt; overflow</a>
  3821) <a name="l3821" style="background-color: #ffcccc">!</a>
  3822) <a name="l3822" style="background-color: #ffcccc">            IF( XNORM.GT.ONE .AND. CMAX.GT.ONE ) THEN</a>
  3823) <a name="l3823" style="background-color: #ffcccc">               IF( XNORM.GT.BIGNUM / CMAX ) THEN</a>
  3824) <a name="l3824" style="background-color: #ffcccc">                  TEMP = CMAX / BIGNUM</a>
  3825) <a name="l3825" style="background-color: #ffcccc">                  X( 1, 1 ) = TEMP*X( 1, 1 )</a>
  3826) <a name="l3826" style="background-color: #ffcccc">                  X( 2, 1 ) = TEMP*X( 2, 1 )</a>
  3827) <a name="l3827" style="background-color: #ffcccc">                  X( 1, 2 ) = TEMP*X( 1, 2 )</a>
  3828) <a name="l3828" style="background-color: #ffcccc">                  X( 2, 2 ) = TEMP*X( 2, 2 )</a>
  3829) <a name="l3829" style="background-color: #ffcccc">                  XNORM = TEMP*XNORM</a>
  3830) <a name="l3830" style="background-color: #ffcccc">                  SCALE = TEMP*SCALE</a>
  3831) <a name="l3831" style="background-color: #ffcccc">               END IF</a>
  3832) <a name="l3832" style="background-color: #ffcccc">            END IF</a>
  3833) <a name="l3833" style="background-color: #ffcccc">         END IF</a>
  3834) <a name="l3834" style="background-color: #ffcccc">      END IF</a>
  3835) <a name="l3835" style="background-color: #ffcccc">!</a>
  3836) <a name="l3836" style="background-color: #ffcccc">      RETURN</a>
  3837) <a name="l3837" style="background-color: #ffcccc">!</a>
  3838) <a name="l3838" style="background-color: #ffcccc">!     End of SLALN2</a>
  3839) <a name="l3839" style="background-color: #ffcccc">!</a>
  3840) <a name="l3840" style="background-color: #ffcccc">      END SUBROUTINE SLALN2</a>
  3841) <a name="l3841" style="background-color: #ffffff"></a>
  3842) <a name="l3842" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  3843) <a name="l3843" style="background-color: #ffffff"></a>
  3844) <a name="l3844" style="background-color: #ffffff">      FUNCTION </a><a style="background-color: #ffcccc">SLANGE( NORM, M, N, A, LDA, WORK )</a>
  3845) <a name="l3845" style="background-color: #ffcccc"></a>
  3846) <a name="l3846" style="background-color: #ffcccc">      real(r8) slange</a>
  3847) <a name="l3847" style="background-color: #ffcccc">!</a>
  3848) <a name="l3848" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  3849) <a name="l3849" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  3850) <a name="l3850" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  3851) <a name="l3851" style="background-color: #ffcccc">!     October 31, 1992</a>
  3852) <a name="l3852" style="background-color: #ffcccc">!</a>
  3853) <a name="l3853" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  3854) <a name="l3854" style="background-color: #ffcccc">      CHARACTER          NORM</a>
  3855) <a name="l3855" style="background-color: #ffcccc">      INTEGER            LDA, M, N</a>
  3856) <a name="l3856" style="background-color: #ffcccc">!     ..</a>
  3857) <a name="l3857" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  3858) <a name="l3858" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), WORK( * )</a>
  3859) <a name="l3859" style="background-color: #ffcccc">!     ..</a>
  3860) <a name="l3860" style="background-color: #ffcccc">!</a>
  3861) <a name="l3861" style="background-color: #ffcccc">!  Purpose</a>
  3862) <a name="l3862" style="background-color: #ffcccc">!  =======</a>
  3863) <a name="l3863" style="background-color: #ffcccc">!</a>
  3864) <a name="l3864" style="background-color: #ffcccc">!  SLANGE  returns the value of the one norm,  or the Frobenius norm, or</a>
  3865) <a name="l3865" style="background-color: #ffcccc">!  the  infinity norm,  or the  element of  largest absolute value  of a</a>
  3866) <a name="l3866" style="background-color: #ffcccc">!  real matrix A.</a>
  3867) <a name="l3867" style="background-color: #ffcccc">!</a>
  3868) <a name="l3868" style="background-color: #ffcccc">!  Description</a>
  3869) <a name="l3869" style="background-color: #ffcccc">!  ===========</a>
  3870) <a name="l3870" style="background-color: #ffcccc">!</a>
  3871) <a name="l3871" style="background-color: #ffcccc">!  SLANGE returns the value</a>
  3872) <a name="l3872" style="background-color: #ffcccc">!</a>
  3873) <a name="l3873" style="background-color: #ffcccc">!     SLANGE = ( max(abs(A(i,j))), NORM = 'M' or 'm'</a>
  3874) <a name="l3874" style="background-color: #ffcccc">!              (</a>
  3875) <a name="l3875" style="background-color: #ffcccc">!              ( norm1(A),         NORM = '1', 'O' or 'o'</a>
  3876) <a name="l3876" style="background-color: #ffcccc">!              (</a>
  3877) <a name="l3877" style="background-color: #ffcccc">!              ( normI(A),         NORM = 'I' or 'i'</a>
  3878) <a name="l3878" style="background-color: #ffcccc">!              (</a>
  3879) <a name="l3879" style="background-color: #ffcccc">!              ( normF(A),         NORM = 'F', 'f', 'E' or 'e'</a>
  3880) <a name="l3880" style="background-color: #ffcccc">!</a>
  3881) <a name="l3881" style="background-color: #ffcccc">!  where  norm1  denotes the  one norm of a matrix (maximum column sum),</a>
  3882) <a name="l3882" style="background-color: #ffcccc">!  normI  denotes the  infinity norm  of a matrix  (maximum row sum) and</a>
  3883) <a name="l3883" style="background-color: #ffcccc">!  normF  denotes the  Frobenius norm of a matrix (square root of sum of</a>
  3884) <a name="l3884" style="background-color: #ffcccc">!  squares).  Note that  max(abs(A(i,j)))  is not a  matrix norm.</a>
  3885) <a name="l3885" style="background-color: #ffcccc">!</a>
  3886) <a name="l3886" style="background-color: #ffcccc">!  Arguments</a>
  3887) <a name="l3887" style="background-color: #ffcccc">!  =========</a>
  3888) <a name="l3888" style="background-color: #ffcccc">!</a>
  3889) <a name="l3889" style="background-color: #ffcccc">!  NORM    (input) CHARACTER*1</a>
  3890) <a name="l3890" style="background-color: #ffcccc">!          Specifies the value to be returned in SLANGE as described</a>
  3891) <a name="l3891" style="background-color: #ffcccc">!          above.</a>
  3892) <a name="l3892" style="background-color: #ffcccc">!</a>
  3893) <a name="l3893" style="background-color: #ffcccc">!  M       (input) INTEGER</a>
  3894) <a name="l3894" style="background-color: #ffcccc">!          The number of rows of the matrix A.  M &gt;= 0.  When M = 0,</a>
  3895) <a name="l3895" style="background-color: #ffcccc">!          SLANGE is set to zero.</a>
  3896) <a name="l3896" style="background-color: #ffcccc">!</a>
  3897) <a name="l3897" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  3898) <a name="l3898" style="background-color: #ffcccc">!          The number of columns of the matrix A.  N &gt;= 0.  When N = 0,</a>
  3899) <a name="l3899" style="background-color: #ffcccc">!          SLANGE is set to zero.</a>
  3900) <a name="l3900" style="background-color: #ffcccc">!</a>
  3901) <a name="l3901" style="background-color: #ffcccc">!  A       (input) REAL array, dimension (LDA,N)</a>
  3902) <a name="l3902" style="background-color: #ffcccc">!          The m by n matrix A.</a>
  3903) <a name="l3903" style="background-color: #ffcccc">!</a>
  3904) <a name="l3904" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  3905) <a name="l3905" style="background-color: #ffcccc">!          The leading dimension of the array A.  LDA &gt;= max(M,1).</a>
  3906) <a name="l3906" style="background-color: #ffcccc">!</a>
  3907) <a name="l3907" style="background-color: #ffcccc">!  WORK    (workspace) REAL array, dimension (LWORK),</a>
  3908) <a name="l3908" style="background-color: #ffcccc">!          where LWORK &gt;= M when NORM = 'I'; otherwise, WORK is not</a>
  3909) <a name="l3909" style="background-color: #ffcccc">!          referenced.</a>
  3910) <a name="l3910" style="background-color: #ffcccc">!</a>
  3911) <a name="l3911" style="background-color: #ffcccc">! =====================================================================</a>
  3912) <a name="l3912" style="background-color: #ffcccc">!</a>
  3913) <a name="l3913" style="background-color: #ffcccc">!     .. Parameters ..</a>
  3914) <a name="l3914" style="background-color: #ffcccc">      REAL(r8)               ONE, ZERO</a>
  3915) <a name="l3915" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
  3916) <a name="l3916" style="background-color: #ffcccc">!     ..</a>
  3917) <a name="l3917" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  3918) <a name="l3918" style="background-color: #ffcccc">      INTEGER            I, J</a>
  3919) <a name="l3919" style="background-color: #ffcccc">      REAL(r8)               SCALE, SUM, VALUE</a>
  3920) <a name="l3920" style="background-color: #ffcccc">!     ..</a>
  3921) <a name="l3921" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  3922) <a name="l3922" style="background-color: #ffcccc">!</a>
  3923) <a name="l3923" style="background-color: #ffcccc">      IF( MIN( M, N ).EQ.0 ) THEN</a>
  3924) <a name="l3924" style="background-color: #ffcccc">         VALUE = ZERO</a>
  3925) <a name="l3925" style="background-color: #ffcccc">      ELSE IF( LSAME( NORM, 'M' ) ) THEN</a>
  3926) <a name="l3926" style="background-color: #ffcccc">!</a>
  3927) <a name="l3927" style="background-color: #ffcccc">!        Find max(abs(A(i,j))).</a>
  3928) <a name="l3928" style="background-color: #ffcccc">!</a>
  3929) <a name="l3929" style="background-color: #ffcccc">         VALUE = ZERO</a>
  3930) <a name="l3930" style="background-color: #ffcccc">         DO 20 J = 1, N</a>
  3931) <a name="l3931" style="background-color: #ffcccc">            DO 10 I = 1, M</a>
  3932) <a name="l3932" style="background-color: #ffcccc">               VALUE = MAX( VALUE, ABS( A( I, J ) ) )</a>
  3933) <a name="l3933" style="background-color: #ffcccc">   10       CONTINUE</a>
  3934) <a name="l3934" style="background-color: #ffcccc">   20    CONTINUE</a>
  3935) <a name="l3935" style="background-color: #ffcccc">      ELSE IF( ( LSAME( NORM, 'O' ) ) .OR. ( NORM.EQ.'1' ) ) THEN</a>
  3936) <a name="l3936" style="background-color: #ffcccc">!</a>
  3937) <a name="l3937" style="background-color: #ffcccc">!        Find norm1(A).</a>
  3938) <a name="l3938" style="background-color: #ffcccc">!</a>
  3939) <a name="l3939" style="background-color: #ffcccc">         VALUE = ZERO</a>
  3940) <a name="l3940" style="background-color: #ffcccc">         DO 40 J = 1, N</a>
  3941) <a name="l3941" style="background-color: #ffcccc">            SUM = ZERO</a>
  3942) <a name="l3942" style="background-color: #ffcccc">            DO 30 I = 1, M</a>
  3943) <a name="l3943" style="background-color: #ffcccc">               SUM = SUM + ABS( A( I, J ) )</a>
  3944) <a name="l3944" style="background-color: #ffcccc">   30       CONTINUE</a>
  3945) <a name="l3945" style="background-color: #ffcccc">            VALUE = MAX( VALUE, SUM )</a>
  3946) <a name="l3946" style="background-color: #ffcccc">   40    CONTINUE</a>
  3947) <a name="l3947" style="background-color: #ffcccc">      ELSE IF( LSAME( NORM, 'I' ) ) THEN</a>
  3948) <a name="l3948" style="background-color: #ffcccc">!</a>
  3949) <a name="l3949" style="background-color: #ffcccc">!        Find normI(A).</a>
  3950) <a name="l3950" style="background-color: #ffcccc">!</a>
  3951) <a name="l3951" style="background-color: #ffcccc">         DO 50 I = 1, M</a>
  3952) <a name="l3952" style="background-color: #ffcccc">            WORK( I ) = ZERO</a>
  3953) <a name="l3953" style="background-color: #ffcccc">   50    CONTINUE</a>
  3954) <a name="l3954" style="background-color: #ffcccc">         DO 70 J = 1, N</a>
  3955) <a name="l3955" style="background-color: #ffcccc">            DO 60 I = 1, M</a>
  3956) <a name="l3956" style="background-color: #ffcccc">               WORK( I ) = WORK( I ) + ABS( A( I, J ) )</a>
  3957) <a name="l3957" style="background-color: #ffcccc">   60       CONTINUE</a>
  3958) <a name="l3958" style="background-color: #ffcccc">   70    CONTINUE</a>
  3959) <a name="l3959" style="background-color: #ffcccc">         VALUE = ZERO</a>
  3960) <a name="l3960" style="background-color: #ffcccc">         DO 80 I = 1, M</a>
  3961) <a name="l3961" style="background-color: #ffcccc">            VALUE = MAX( VALUE, WORK( I ) )</a>
  3962) <a name="l3962" style="background-color: #ffcccc">   80    CONTINUE</a>
  3963) <a name="l3963" style="background-color: #ffcccc">      ELSE IF( ( LSAME( NORM, 'F' ) ) .OR. ( LSAME( NORM, 'E' ) ) ) THEN</a>
  3964) <a name="l3964" style="background-color: #ffcccc">!</a>
  3965) <a name="l3965" style="background-color: #ffcccc">!        Find normF(A).</a>
  3966) <a name="l3966" style="background-color: #ffcccc">!</a>
  3967) <a name="l3967" style="background-color: #ffcccc">         SCALE = ZERO</a>
  3968) <a name="l3968" style="background-color: #ffcccc">         SUM = ONE</a>
  3969) <a name="l3969" style="background-color: #ffcccc">         DO 90 J = 1, N</a>
  3970) <a name="l3970" style="background-color: #ffcccc">            CALL SLASSQ( M, A( 1, J ), 1, SCALE, SUM )</a>
  3971) <a name="l3971" style="background-color: #ffcccc">   90    CONTINUE</a>
  3972) <a name="l3972" style="background-color: #ffcccc">         VALUE = SCALE*SQRT( SUM )</a>
  3973) <a name="l3973" style="background-color: #ffcccc">      END IF</a>
  3974) <a name="l3974" style="background-color: #ffcccc">!</a>
  3975) <a name="l3975" style="background-color: #ffcccc">      SLANGE = VALUE</a>
  3976) <a name="l3976" style="background-color: #ffcccc">      RETURN</a>
  3977) <a name="l3977" style="background-color: #ffcccc">!</a>
  3978) <a name="l3978" style="background-color: #ffcccc">!     End of SLANGE</a>
  3979) <a name="l3979" style="background-color: #ffcccc">!</a>
  3980) <a name="l3980" style="background-color: #ffcccc">      END FUNCTION SLANGE</a>
  3981) <a name="l3981" style="background-color: #ffffff"></a>
  3982) <a name="l3982" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  3983) <a name="l3983" style="background-color: #ffffff"></a>
  3984) <a name="l3984" style="background-color: #ffffff">      FUNCTION </a><a style="background-color: #ffcccc">SLANHS( NORM, N, A, LDA, WORK )</a>
  3985) <a name="l3985" style="background-color: #ffcccc"></a>
  3986) <a name="l3986" style="background-color: #ffcccc">      real(r8) slanhs</a>
  3987) <a name="l3987" style="background-color: #ffcccc"></a>
  3988) <a name="l3988" style="background-color: #ffcccc">!</a>
  3989) <a name="l3989" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  3990) <a name="l3990" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  3991) <a name="l3991" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  3992) <a name="l3992" style="background-color: #ffcccc">!     October 31, 1992</a>
  3993) <a name="l3993" style="background-color: #ffcccc">!</a>
  3994) <a name="l3994" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  3995) <a name="l3995" style="background-color: #ffcccc">      CHARACTER          NORM</a>
  3996) <a name="l3996" style="background-color: #ffcccc">      INTEGER            LDA, N</a>
  3997) <a name="l3997" style="background-color: #ffcccc">!     ..</a>
  3998) <a name="l3998" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  3999) <a name="l3999" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), WORK( * )</a>
  4000) <a name="l4000" style="background-color: #ffcccc">!     ..</a>
  4001) <a name="l4001" style="background-color: #ffcccc">!</a>
  4002) <a name="l4002" style="background-color: #ffcccc">!  Purpose</a>
  4003) <a name="l4003" style="background-color: #ffcccc">!  =======</a>
  4004) <a name="l4004" style="background-color: #ffcccc">!</a>
  4005) <a name="l4005" style="background-color: #ffcccc">!  SLANHS  returns the value of the one norm,  or the Frobenius norm, or</a>
  4006) <a name="l4006" style="background-color: #ffcccc">!  the  infinity norm,  or the  element of  largest absolute value  of a</a>
  4007) <a name="l4007" style="background-color: #ffcccc">!  Hessenberg matrix A.</a>
  4008) <a name="l4008" style="background-color: #ffcccc">!</a>
  4009) <a name="l4009" style="background-color: #ffcccc">!  Description</a>
  4010) <a name="l4010" style="background-color: #ffcccc">!  ===========</a>
  4011) <a name="l4011" style="background-color: #ffcccc">!</a>
  4012) <a name="l4012" style="background-color: #ffcccc">!  SLANHS returns the value</a>
  4013) <a name="l4013" style="background-color: #ffcccc">!</a>
  4014) <a name="l4014" style="background-color: #ffcccc">!     SLANHS = ( max(abs(A(i,j))), NORM = 'M' or 'm'</a>
  4015) <a name="l4015" style="background-color: #ffcccc">!              (</a>
  4016) <a name="l4016" style="background-color: #ffcccc">!              ( norm1(A),         NORM = '1', 'O' or 'o'</a>
  4017) <a name="l4017" style="background-color: #ffcccc">!              (</a>
  4018) <a name="l4018" style="background-color: #ffcccc">!              ( normI(A),         NORM = 'I' or 'i'</a>
  4019) <a name="l4019" style="background-color: #ffcccc">!              (</a>
  4020) <a name="l4020" style="background-color: #ffcccc">!              ( normF(A),         NORM = 'F', 'f', 'E' or 'e'</a>
  4021) <a name="l4021" style="background-color: #ffcccc">!</a>
  4022) <a name="l4022" style="background-color: #ffcccc">!  where  norm1  denotes the  one norm of a matrix (maximum column sum),</a>
  4023) <a name="l4023" style="background-color: #ffcccc">!  normI  denotes the  infinity norm  of a matrix  (maximum row sum) and</a>
  4024) <a name="l4024" style="background-color: #ffcccc">!  normF  denotes the  Frobenius norm of a matrix (square root of sum of</a>
  4025) <a name="l4025" style="background-color: #ffcccc">!  squares).  Note that  max(abs(A(i,j)))  is not a  matrix norm.</a>
  4026) <a name="l4026" style="background-color: #ffcccc">!</a>
  4027) <a name="l4027" style="background-color: #ffcccc">!  Arguments</a>
  4028) <a name="l4028" style="background-color: #ffcccc">!  =========</a>
  4029) <a name="l4029" style="background-color: #ffcccc">!</a>
  4030) <a name="l4030" style="background-color: #ffcccc">!  NORM    (input) CHARACTER*1</a>
  4031) <a name="l4031" style="background-color: #ffcccc">!          Specifies the value to be returned in SLANHS as described</a>
  4032) <a name="l4032" style="background-color: #ffcccc">!          above.</a>
  4033) <a name="l4033" style="background-color: #ffcccc">!</a>
  4034) <a name="l4034" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  4035) <a name="l4035" style="background-color: #ffcccc">!          The order of the matrix A.  N &gt;= 0.  When N = 0, SLANHS is</a>
  4036) <a name="l4036" style="background-color: #ffcccc">!          set to zero.</a>
  4037) <a name="l4037" style="background-color: #ffcccc">!</a>
  4038) <a name="l4038" style="background-color: #ffcccc">!  A       (input) REAL array, dimension (LDA,N)</a>
  4039) <a name="l4039" style="background-color: #ffcccc">!          The n by n upper Hessenberg matrix A; the part of A below the</a>
  4040) <a name="l4040" style="background-color: #ffcccc">!          first sub-diagonal is not referenced.</a>
  4041) <a name="l4041" style="background-color: #ffcccc">!</a>
  4042) <a name="l4042" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  4043) <a name="l4043" style="background-color: #ffcccc">!          The leading dimension of the array A.  LDA &gt;= max(N,1).</a>
  4044) <a name="l4044" style="background-color: #ffcccc">!</a>
  4045) <a name="l4045" style="background-color: #ffcccc">!  WORK    (workspace) REAL array, dimension (LWORK),</a>
  4046) <a name="l4046" style="background-color: #ffcccc">!          where LWORK &gt;= N when NORM = 'I'; otherwise, WORK is not</a>
  4047) <a name="l4047" style="background-color: #ffcccc">!          referenced.</a>
  4048) <a name="l4048" style="background-color: #ffcccc">!</a>
  4049) <a name="l4049" style="background-color: #ffcccc">! =====================================================================</a>
  4050) <a name="l4050" style="background-color: #ffcccc">!</a>
  4051) <a name="l4051" style="background-color: #ffcccc">!     .. Parameters ..</a>
  4052) <a name="l4052" style="background-color: #ffcccc">      REAL(r8)               ONE, ZERO</a>
  4053) <a name="l4053" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
  4054) <a name="l4054" style="background-color: #ffcccc">!     ..</a>
  4055) <a name="l4055" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  4056) <a name="l4056" style="background-color: #ffcccc">      INTEGER            I, J</a>
  4057) <a name="l4057" style="background-color: #ffcccc">      REAL(r8)               SCALE, SUM, VALUE</a>
  4058) <a name="l4058" style="background-color: #ffcccc">!     ..</a>
  4059) <a name="l4059" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  4060) <a name="l4060" style="background-color: #ffcccc">!</a>
  4061) <a name="l4061" style="background-color: #ffcccc">      IF( N.EQ.0 ) THEN</a>
  4062) <a name="l4062" style="background-color: #ffcccc">         VALUE = ZERO</a>
  4063) <a name="l4063" style="background-color: #ffcccc">      ELSE IF( LSAME( NORM, 'M' ) ) THEN</a>
  4064) <a name="l4064" style="background-color: #ffcccc">!</a>
  4065) <a name="l4065" style="background-color: #ffcccc">!        Find max(abs(A(i,j))).</a>
  4066) <a name="l4066" style="background-color: #ffcccc">!</a>
  4067) <a name="l4067" style="background-color: #ffcccc">         VALUE = ZERO</a>
  4068) <a name="l4068" style="background-color: #ffcccc">         DO 20 J = 1, N</a>
  4069) <a name="l4069" style="background-color: #ffcccc">            DO 10 I = 1, MIN( N, J+1 )</a>
  4070) <a name="l4070" style="background-color: #ffcccc">               VALUE = MAX( VALUE, ABS( A( I, J ) ) )</a>
  4071) <a name="l4071" style="background-color: #ffcccc">   10       CONTINUE</a>
  4072) <a name="l4072" style="background-color: #ffcccc">   20    CONTINUE</a>
  4073) <a name="l4073" style="background-color: #ffcccc">      ELSE IF( ( LSAME( NORM, 'O' ) ) .OR. ( NORM.EQ.'1' ) ) THEN</a>
  4074) <a name="l4074" style="background-color: #ffcccc">!</a>
  4075) <a name="l4075" style="background-color: #ffcccc">!        Find norm1(A).</a>
  4076) <a name="l4076" style="background-color: #ffcccc">!</a>
  4077) <a name="l4077" style="background-color: #ffcccc">         VALUE = ZERO</a>
  4078) <a name="l4078" style="background-color: #ffcccc">         DO 40 J = 1, N</a>
  4079) <a name="l4079" style="background-color: #ffcccc">            SUM = ZERO</a>
  4080) <a name="l4080" style="background-color: #ffcccc">            DO 30 I = 1, MIN( N, J+1 )</a>
  4081) <a name="l4081" style="background-color: #ffcccc">               SUM = SUM + ABS( A( I, J ) )</a>
  4082) <a name="l4082" style="background-color: #ffcccc">   30       CONTINUE</a>
  4083) <a name="l4083" style="background-color: #ffcccc">            VALUE = MAX( VALUE, SUM )</a>
  4084) <a name="l4084" style="background-color: #ffcccc">   40    CONTINUE</a>
  4085) <a name="l4085" style="background-color: #ffcccc">      ELSE IF( LSAME( NORM, 'I' ) ) THEN</a>
  4086) <a name="l4086" style="background-color: #ffcccc">!</a>
  4087) <a name="l4087" style="background-color: #ffcccc">!        Find normI(A).</a>
  4088) <a name="l4088" style="background-color: #ffcccc">!</a>
  4089) <a name="l4089" style="background-color: #ffcccc">         DO 50 I = 1, N</a>
  4090) <a name="l4090" style="background-color: #ffcccc">            WORK( I ) = ZERO</a>
  4091) <a name="l4091" style="background-color: #ffcccc">   50    CONTINUE</a>
  4092) <a name="l4092" style="background-color: #ffcccc">         DO 70 J = 1, N</a>
  4093) <a name="l4093" style="background-color: #ffcccc">            DO 60 I = 1, MIN( N, J+1 )</a>
  4094) <a name="l4094" style="background-color: #ffcccc">               WORK( I ) = WORK( I ) + ABS( A( I, J ) )</a>
  4095) <a name="l4095" style="background-color: #ffcccc">   60       CONTINUE</a>
  4096) <a name="l4096" style="background-color: #ffcccc">   70    CONTINUE</a>
  4097) <a name="l4097" style="background-color: #ffcccc">         VALUE = ZERO</a>
  4098) <a name="l4098" style="background-color: #ffcccc">         DO 80 I = 1, N</a>
  4099) <a name="l4099" style="background-color: #ffcccc">            VALUE = MAX( VALUE, WORK( I ) )</a>
  4100) <a name="l4100" style="background-color: #ffcccc">   80    CONTINUE</a>
  4101) <a name="l4101" style="background-color: #ffcccc">      ELSE IF( ( LSAME( NORM, 'F' ) ) .OR. ( LSAME( NORM, 'E' ) ) ) THEN</a>
  4102) <a name="l4102" style="background-color: #ffcccc">!</a>
  4103) <a name="l4103" style="background-color: #ffcccc">!        Find normF(A).</a>
  4104) <a name="l4104" style="background-color: #ffcccc">!</a>
  4105) <a name="l4105" style="background-color: #ffcccc">         SCALE = ZERO</a>
  4106) <a name="l4106" style="background-color: #ffcccc">         SUM = ONE</a>
  4107) <a name="l4107" style="background-color: #ffcccc">         DO 90 J = 1, N</a>
  4108) <a name="l4108" style="background-color: #ffcccc">            CALL SLASSQ( MIN( N, J+1 ), A( 1, J ), 1, SCALE, SUM )</a>
  4109) <a name="l4109" style="background-color: #ffcccc">   90    CONTINUE</a>
  4110) <a name="l4110" style="background-color: #ffcccc">         VALUE = SCALE*SQRT( SUM )</a>
  4111) <a name="l4111" style="background-color: #ffcccc">      END IF </a>
  4112) <a name="l4112" style="background-color: #ffcccc">!</a>
  4113) <a name="l4113" style="background-color: #ffcccc">      SLANHS = VALUE</a>
  4114) <a name="l4114" style="background-color: #ffcccc">      RETURN</a>
  4115) <a name="l4115" style="background-color: #ffcccc">!</a>
  4116) <a name="l4116" style="background-color: #ffcccc">!     End of SLANHS</a>
  4117) <a name="l4117" style="background-color: #ffcccc">!</a>
  4118) <a name="l4118" style="background-color: #ffcccc">      END FUNCTION SLANHS</a>
  4119) <a name="l4119" style="background-color: #ffffff"></a>
  4120) <a name="l4120" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  4121) <a name="l4121" style="background-color: #ffffff"></a>
  4122) <a name="l4122" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLANV2( A, B, C, D, RT1R, RT1I, RT2R, RT2I, CS, SN )</a>
  4123) <a name="l4123" style="background-color: #ffcccc"></a>
  4124) <a name="l4124" style="background-color: #ffcccc">!</a>
  4125) <a name="l4125" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  4126) <a name="l4126" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  4127) <a name="l4127" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  4128) <a name="l4128" style="background-color: #ffcccc">!     September 30, 1994</a>
  4129) <a name="l4129" style="background-color: #ffcccc">!</a>
  4130) <a name="l4130" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  4131) <a name="l4131" style="background-color: #ffcccc">      REAL(r8)               A, B, C, CS, D, RT1I, RT1R, RT2I, RT2R, SN</a>
  4132) <a name="l4132" style="background-color: #ffcccc">!     ..</a>
  4133) <a name="l4133" style="background-color: #ffcccc">!</a>
  4134) <a name="l4134" style="background-color: #ffcccc">!  Purpose</a>
  4135) <a name="l4135" style="background-color: #ffcccc">!  =======</a>
  4136) <a name="l4136" style="background-color: #ffcccc">!</a>
  4137) <a name="l4137" style="background-color: #ffcccc">!  SLANV2 computes the Schur factorization of a real 2-by-2 nonsymmetric</a>
  4138) <a name="l4138" style="background-color: #ffcccc">!  matrix in standard form:</a>
  4139) <a name="l4139" style="background-color: #ffcccc">!</a>
  4140) <a name="l4140" style="background-color: #ffcccc">!       [ A  B ] = [ CS -SN ] [ AA  BB ] [ CS  SN ]</a>
  4141) <a name="l4141" style="background-color: #ffcccc">!       [ C  D ]   [ SN  CS ] [ CC  DD ] [-SN  CS ]</a>
  4142) <a name="l4142" style="background-color: #ffcccc">!</a>
  4143) <a name="l4143" style="background-color: #ffcccc">!  where either</a>
  4144) <a name="l4144" style="background-color: #ffcccc">!  1) CC = 0 so that AA and DD are real eigenvalues of the matrix, or</a>
  4145) <a name="l4145" style="background-color: #ffcccc">!  2) AA = DD and BB*CC &lt; 0, so that AA + or - sqrt(BB*CC) are complex</a>
  4146) <a name="l4146" style="background-color: #ffcccc">!  conjugate eigenvalues.</a>
  4147) <a name="l4147" style="background-color: #ffcccc">!</a>
  4148) <a name="l4148" style="background-color: #ffcccc">!  Arguments</a>
  4149) <a name="l4149" style="background-color: #ffcccc">!  =========</a>
  4150) <a name="l4150" style="background-color: #ffcccc">!</a>
  4151) <a name="l4151" style="background-color: #ffcccc">!  A       (input/output) REAL</a>
  4152) <a name="l4152" style="background-color: #ffcccc">!  B       (input/output) REAL</a>
  4153) <a name="l4153" style="background-color: #ffcccc">!  C       (input/output) REAL</a>
  4154) <a name="l4154" style="background-color: #ffcccc">!  D       (input/output) REAL</a>
  4155) <a name="l4155" style="background-color: #ffcccc">!          On entry, the elements of the input matrix.</a>
  4156) <a name="l4156" style="background-color: #ffcccc">!          On exit, they are overwritten by the elements of the</a>
  4157) <a name="l4157" style="background-color: #ffcccc">!          standardised Schur form.</a>
  4158) <a name="l4158" style="background-color: #ffcccc">!</a>
  4159) <a name="l4159" style="background-color: #ffcccc">!  RT1R    (output) REAL</a>
  4160) <a name="l4160" style="background-color: #ffcccc">!  RT1I    (output) REAL</a>
  4161) <a name="l4161" style="background-color: #ffcccc">!  RT2R    (output) REAL</a>
  4162) <a name="l4162" style="background-color: #ffcccc">!  RT2I    (output) REAL</a>
  4163) <a name="l4163" style="background-color: #ffcccc">!          The real and imaginary parts of the eigenvalues. If the</a>
  4164) <a name="l4164" style="background-color: #ffcccc">!          eigenvalues are both real, abs(RT1R) &gt;= abs(RT2R); if the</a>
  4165) <a name="l4165" style="background-color: #ffcccc">!          eigenvalues are a complex conjugate pair, RT1I &gt; 0.</a>
  4166) <a name="l4166" style="background-color: #ffcccc">!</a>
  4167) <a name="l4167" style="background-color: #ffcccc">!  CS      (output) REAL</a>
  4168) <a name="l4168" style="background-color: #ffcccc">!  SN      (output) REAL</a>
  4169) <a name="l4169" style="background-color: #ffcccc">!          Parameters of the rotation matrix.</a>
  4170) <a name="l4170" style="background-color: #ffcccc">!</a>
  4171) <a name="l4171" style="background-color: #ffcccc">!  =====================================================================</a>
  4172) <a name="l4172" style="background-color: #ffcccc">!</a>
  4173) <a name="l4173" style="background-color: #ffcccc">!     .. Parameters ..</a>
  4174) <a name="l4174" style="background-color: #ffcccc">      REAL(r8)               ZERO, HALF, ONE</a>
  4175) <a name="l4175" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8, HALF = 0.5E+0_r8, ONE = 1.0E+0_r8 )</a>
  4176) <a name="l4176" style="background-color: #ffcccc">!     ..</a>
  4177) <a name="l4177" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  4178) <a name="l4178" style="background-color: #ffcccc">      REAL(r8)               AA, BB, CC, CS1, DD, P, SAB, SAC, SIGMA, SN1, &amp;</a>
  4179) <a name="l4179" style="background-color: #ffcccc">                         TAU, TEMP</a>
  4180) <a name="l4180" style="background-color: #ffcccc">!     ..</a>
  4181) <a name="l4181" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  4182) <a name="l4182" style="background-color: #ffcccc">!</a>
  4183) <a name="l4183" style="background-color: #ffcccc">!     Initialize CS and SN</a>
  4184) <a name="l4184" style="background-color: #ffcccc">!</a>
  4185) <a name="l4185" style="background-color: #ffcccc">      CS = ONE</a>
  4186) <a name="l4186" style="background-color: #ffcccc">      SN = ZERO</a>
  4187) <a name="l4187" style="background-color: #ffcccc">!</a>
  4188) <a name="l4188" style="background-color: #ffcccc">      IF( C.EQ.ZERO ) THEN</a>
  4189) <a name="l4189" style="background-color: #ffcccc">         GO TO 10</a>
  4190) <a name="l4190" style="background-color: #ffcccc">!</a>
  4191) <a name="l4191" style="background-color: #ffcccc">      ELSE IF( B.EQ.ZERO ) THEN</a>
  4192) <a name="l4192" style="background-color: #ffcccc">!</a>
  4193) <a name="l4193" style="background-color: #ffcccc">!        Swap rows and columns</a>
  4194) <a name="l4194" style="background-color: #ffcccc">!</a>
  4195) <a name="l4195" style="background-color: #ffcccc">         CS = ZERO</a>
  4196) <a name="l4196" style="background-color: #ffcccc">         SN = ONE</a>
  4197) <a name="l4197" style="background-color: #ffcccc">         TEMP = D</a>
  4198) <a name="l4198" style="background-color: #ffcccc">         D = A</a>
  4199) <a name="l4199" style="background-color: #ffcccc">         A = TEMP</a>
  4200) <a name="l4200" style="background-color: #ffcccc">         B = -C</a>
  4201) <a name="l4201" style="background-color: #ffcccc">         C = ZERO</a>
  4202) <a name="l4202" style="background-color: #ffcccc">         GO TO 10</a>
  4203) <a name="l4203" style="background-color: #ffcccc">      ELSE IF( (A-D).EQ.ZERO .AND. SIGN( ONE, B ).NE. &amp;</a>
  4204) <a name="l4204" style="background-color: #ffcccc">         SIGN( ONE, C ) ) THEN</a>
  4205) <a name="l4205" style="background-color: #ffcccc">         GO TO 10</a>
  4206) <a name="l4206" style="background-color: #ffcccc">      ELSE</a>
  4207) <a name="l4207" style="background-color: #ffcccc">!</a>
  4208) <a name="l4208" style="background-color: #ffcccc">!        Make diagonal elements equal</a>
  4209) <a name="l4209" style="background-color: #ffcccc">!</a>
  4210) <a name="l4210" style="background-color: #ffcccc">         TEMP = A - D</a>
  4211) <a name="l4211" style="background-color: #ffcccc">         P = HALF*TEMP</a>
  4212) <a name="l4212" style="background-color: #ffcccc">         SIGMA = B + C</a>
  4213) <a name="l4213" style="background-color: #ffcccc">         TAU = SLAPY2( SIGMA, TEMP )</a>
  4214) <a name="l4214" style="background-color: #ffcccc">         CS1 = SQRT( HALF*( ONE+ABS( SIGMA ) / TAU ) )</a>
  4215) <a name="l4215" style="background-color: #ffcccc">         SN1 = -( P / ( TAU*CS1 ) )*SIGN( ONE, SIGMA )</a>
  4216) <a name="l4216" style="background-color: #ffcccc">!</a>
  4217) <a name="l4217" style="background-color: #ffcccc">!        Compute [ AA  BB ] = [ A  B ] [ CS1 -SN1 ]</a>
  4218) <a name="l4218" style="background-color: #ffcccc">!                [ CC  DD ]   [ C  D ] [ SN1  CS1 ]</a>
  4219) <a name="l4219" style="background-color: #ffcccc">!</a>
  4220) <a name="l4220" style="background-color: #ffcccc">         AA = A*CS1 + B*SN1</a>
  4221) <a name="l4221" style="background-color: #ffcccc">         BB = -A*SN1 + B*CS1</a>
  4222) <a name="l4222" style="background-color: #ffcccc">         CC = C*CS1 + D*SN1</a>
  4223) <a name="l4223" style="background-color: #ffcccc">         DD = -C*SN1 + D*CS1</a>
  4224) <a name="l4224" style="background-color: #ffcccc">!</a>
  4225) <a name="l4225" style="background-color: #ffcccc">!        Compute [ A  B ] = [ CS1  SN1 ] [ AA  BB ]</a>
  4226) <a name="l4226" style="background-color: #ffcccc">!                [ C  D ]   [-SN1  CS1 ] [ CC  DD ]</a>
  4227) <a name="l4227" style="background-color: #ffcccc">!</a>
  4228) <a name="l4228" style="background-color: #ffcccc">         A = AA*CS1 + CC*SN1</a>
  4229) <a name="l4229" style="background-color: #ffcccc">         B = BB*CS1 + DD*SN1</a>
  4230) <a name="l4230" style="background-color: #ffcccc">         C = -AA*SN1 + CC*CS1</a>
  4231) <a name="l4231" style="background-color: #ffcccc">         D = -BB*SN1 + DD*CS1</a>
  4232) <a name="l4232" style="background-color: #ffcccc">!</a>
  4233) <a name="l4233" style="background-color: #ffcccc">!        Accumulate transformation</a>
  4234) <a name="l4234" style="background-color: #ffcccc">!</a>
  4235) <a name="l4235" style="background-color: #ffcccc">         TEMP = CS*CS1 - SN*SN1</a>
  4236) <a name="l4236" style="background-color: #ffcccc">         SN = CS*SN1 + SN*CS1</a>
  4237) <a name="l4237" style="background-color: #ffcccc">         CS = TEMP</a>
  4238) <a name="l4238" style="background-color: #ffcccc">!</a>
  4239) <a name="l4239" style="background-color: #ffcccc">         TEMP = HALF*( A+D )</a>
  4240) <a name="l4240" style="background-color: #ffcccc">         A = TEMP</a>
  4241) <a name="l4241" style="background-color: #ffcccc">         D = TEMP</a>
  4242) <a name="l4242" style="background-color: #ffcccc">!</a>
  4243) <a name="l4243" style="background-color: #ffcccc">         IF( C.NE.ZERO ) THEN</a>
  4244) <a name="l4244" style="background-color: #ffcccc">            IF ( B.NE.ZERO ) THEN</a>
  4245) <a name="l4245" style="background-color: #ffcccc">               IF( SIGN( ONE, B ).EQ.SIGN( ONE, C ) ) THEN</a>
  4246) <a name="l4246" style="background-color: #ffcccc">!</a>
  4247) <a name="l4247" style="background-color: #ffcccc">!                 Real eigenvalues: reduce to upper triangular form</a>
  4248) <a name="l4248" style="background-color: #ffcccc">!</a>
  4249) <a name="l4249" style="background-color: #ffcccc">                  SAB = SQRT( ABS( B ) )</a>
  4250) <a name="l4250" style="background-color: #ffcccc">                  SAC = SQRT( ABS( C ) )</a>
  4251) <a name="l4251" style="background-color: #ffcccc">                  P = SIGN( SAB*SAC, C )</a>
  4252) <a name="l4252" style="background-color: #ffcccc">                  TAU = ONE / SQRT( ABS( B+C ) )</a>
  4253) <a name="l4253" style="background-color: #ffcccc">                  A = TEMP + P</a>
  4254) <a name="l4254" style="background-color: #ffcccc">                  D = TEMP - P</a>
  4255) <a name="l4255" style="background-color: #ffcccc">                  B = B - C</a>
  4256) <a name="l4256" style="background-color: #ffcccc">                  C = ZERO</a>
  4257) <a name="l4257" style="background-color: #ffcccc">                  CS1 = SAB*TAU</a>
  4258) <a name="l4258" style="background-color: #ffcccc">                  SN1 = SAC*TAU</a>
  4259) <a name="l4259" style="background-color: #ffcccc">                  TEMP = CS*CS1 - SN*SN1</a>
  4260) <a name="l4260" style="background-color: #ffcccc">                  SN = CS*SN1 + SN*CS1</a>
  4261) <a name="l4261" style="background-color: #ffcccc">                  CS = TEMP</a>
  4262) <a name="l4262" style="background-color: #ffcccc">               END IF</a>
  4263) <a name="l4263" style="background-color: #ffcccc">            ELSE</a>
  4264) <a name="l4264" style="background-color: #ffcccc">               B = -C</a>
  4265) <a name="l4265" style="background-color: #ffcccc">               C = ZERO</a>
  4266) <a name="l4266" style="background-color: #ffcccc">               TEMP = CS</a>
  4267) <a name="l4267" style="background-color: #ffcccc">               CS = -SN</a>
  4268) <a name="l4268" style="background-color: #ffcccc">               SN = TEMP</a>
  4269) <a name="l4269" style="background-color: #ffcccc">            ENDIF</a>
  4270) <a name="l4270" style="background-color: #ffcccc">         ENDIF</a>
  4271) <a name="l4271" style="background-color: #ffcccc">      END IF</a>
  4272) <a name="l4272" style="background-color: #ffcccc">!</a>
  4273) <a name="l4273" style="background-color: #ffcccc">   10 CONTINUE</a>
  4274) <a name="l4274" style="background-color: #ffcccc">!</a>
  4275) <a name="l4275" style="background-color: #ffcccc">!     Store eigenvalues in (RT1R,RT1I) and (RT2R,RT2I).</a>
  4276) <a name="l4276" style="background-color: #ffcccc">!</a>
  4277) <a name="l4277" style="background-color: #ffcccc">      RT1R = A</a>
  4278) <a name="l4278" style="background-color: #ffcccc">      RT2R = D</a>
  4279) <a name="l4279" style="background-color: #ffcccc">      IF( C.EQ.ZERO ) THEN</a>
  4280) <a name="l4280" style="background-color: #ffcccc">         RT1I = ZERO</a>
  4281) <a name="l4281" style="background-color: #ffcccc">         RT2I = ZERO</a>
  4282) <a name="l4282" style="background-color: #ffcccc">      ELSE</a>
  4283) <a name="l4283" style="background-color: #ffcccc">         RT1I = SQRT( ABS( B ) )*SQRT( ABS( C ) )</a>
  4284) <a name="l4284" style="background-color: #ffcccc">         RT2I = -RT1I</a>
  4285) <a name="l4285" style="background-color: #ffcccc">      END IF</a>
  4286) <a name="l4286" style="background-color: #ffcccc">      RETURN</a>
  4287) <a name="l4287" style="background-color: #ffcccc">!</a>
  4288) <a name="l4288" style="background-color: #ffcccc">!     End of SLANV2</a>
  4289) <a name="l4289" style="background-color: #ffcccc">!</a>
  4290) <a name="l4290" style="background-color: #ffcccc">      END SUBROUTINE SLANV2</a>
  4291) <a name="l4291" style="background-color: #ffffff"></a>
  4292) <a name="l4292" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  4293) <a name="l4293" style="background-color: #ffffff"></a>
  4294) <a name="l4294" style="background-color: #ffffff">      FUNCTION </a><a style="background-color: #ffcccc">SLAPY2( X, Y )</a>
  4295) <a name="l4295" style="background-color: #ffcccc"></a>
  4296) <a name="l4296" style="background-color: #ffcccc">      real(r8) slapy2</a>
  4297) <a name="l4297" style="background-color: #ffcccc"></a>
  4298) <a name="l4298" style="background-color: #ffcccc">!</a>
  4299) <a name="l4299" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  4300) <a name="l4300" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  4301) <a name="l4301" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  4302) <a name="l4302" style="background-color: #ffcccc">!     October 31, 1992</a>
  4303) <a name="l4303" style="background-color: #ffcccc">!</a>
  4304) <a name="l4304" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  4305) <a name="l4305" style="background-color: #ffcccc">      REAL(r8)               X, Y</a>
  4306) <a name="l4306" style="background-color: #ffcccc">!     ..</a>
  4307) <a name="l4307" style="background-color: #ffcccc">!</a>
  4308) <a name="l4308" style="background-color: #ffcccc">!  Purpose</a>
  4309) <a name="l4309" style="background-color: #ffcccc">!  =======</a>
  4310) <a name="l4310" style="background-color: #ffcccc">!</a>
  4311) <a name="l4311" style="background-color: #ffcccc">!  SLAPY2 returns sqrt(x**2+y**2), taking care not to cause unnecessary</a>
  4312) <a name="l4312" style="background-color: #ffcccc">!  overflow.</a>
  4313) <a name="l4313" style="background-color: #ffcccc">!</a>
  4314) <a name="l4314" style="background-color: #ffcccc">!  Arguments</a>
  4315) <a name="l4315" style="background-color: #ffcccc">!  =========</a>
  4316) <a name="l4316" style="background-color: #ffcccc">!</a>
  4317) <a name="l4317" style="background-color: #ffcccc">!  X       (input) REAL</a>
  4318) <a name="l4318" style="background-color: #ffcccc">!  Y       (input) REAL</a>
  4319) <a name="l4319" style="background-color: #ffcccc">!          X and Y specify the values x and y.</a>
  4320) <a name="l4320" style="background-color: #ffcccc">!</a>
  4321) <a name="l4321" style="background-color: #ffcccc">!  =====================================================================</a>
  4322) <a name="l4322" style="background-color: #ffcccc">!</a>
  4323) <a name="l4323" style="background-color: #ffcccc">!     .. Parameters ..</a>
  4324) <a name="l4324" style="background-color: #ffcccc">      REAL(r8)               ZERO</a>
  4325) <a name="l4325" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E0_r8 )</a>
  4326) <a name="l4326" style="background-color: #ffcccc">      REAL(r8)               ONE</a>
  4327) <a name="l4327" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E0_r8 )</a>
  4328) <a name="l4328" style="background-color: #ffcccc">!     ..</a>
  4329) <a name="l4329" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  4330) <a name="l4330" style="background-color: #ffcccc">      REAL(r8)               W, XABS, YABS, Z</a>
  4331) <a name="l4331" style="background-color: #ffcccc">!     ..</a>
  4332) <a name="l4332" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  4333) <a name="l4333" style="background-color: #ffcccc">!</a>
  4334) <a name="l4334" style="background-color: #ffcccc">      XABS = ABS( X )</a>
  4335) <a name="l4335" style="background-color: #ffcccc">      YABS = ABS( Y )</a>
  4336) <a name="l4336" style="background-color: #ffcccc">      W = MAX( XABS, YABS )</a>
  4337) <a name="l4337" style="background-color: #ffcccc">      Z = MIN( XABS, YABS )</a>
  4338) <a name="l4338" style="background-color: #ffcccc">      IF( Z.EQ.ZERO ) THEN</a>
  4339) <a name="l4339" style="background-color: #ffcccc">         SLAPY2 = W</a>
  4340) <a name="l4340" style="background-color: #ffcccc">      ELSE</a>
  4341) <a name="l4341" style="background-color: #ffcccc">         SLAPY2 = W*SQRT( ONE+( Z / W )**2 )</a>
  4342) <a name="l4342" style="background-color: #ffcccc">      END IF</a>
  4343) <a name="l4343" style="background-color: #ffcccc">      RETURN</a>
  4344) <a name="l4344" style="background-color: #ffcccc">!</a>
  4345) <a name="l4345" style="background-color: #ffcccc">!     End of SLAPY2</a>
  4346) <a name="l4346" style="background-color: #ffcccc">!</a>
  4347) <a name="l4347" style="background-color: #ffcccc">      END FUNCTION SLAPY2</a>
  4348) <a name="l4348" style="background-color: #ffffff"></a>
  4349) <a name="l4349" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  4350) <a name="l4350" style="background-color: #ffffff"></a>
  4351) <a name="l4351" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLARF( SIDE, M, N, V, INCV, TAU, C, LDC, WORK )</a>
  4352) <a name="l4352" style="background-color: #ffcccc"></a>
  4353) <a name="l4353" style="background-color: #ffcccc">!</a>
  4354) <a name="l4354" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  4355) <a name="l4355" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  4356) <a name="l4356" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  4357) <a name="l4357" style="background-color: #ffcccc">!     February 29, 1992</a>
  4358) <a name="l4358" style="background-color: #ffcccc">!</a>
  4359) <a name="l4359" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  4360) <a name="l4360" style="background-color: #ffcccc">      CHARACTER          SIDE</a>
  4361) <a name="l4361" style="background-color: #ffcccc">      INTEGER            INCV, LDC, M, N</a>
  4362) <a name="l4362" style="background-color: #ffcccc">      REAL(r8)               TAU</a>
  4363) <a name="l4363" style="background-color: #ffcccc">!     ..</a>
  4364) <a name="l4364" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  4365) <a name="l4365" style="background-color: #ffcccc">      REAL(r8)               C( LDC, * ), V( * ), WORK( * )</a>
  4366) <a name="l4366" style="background-color: #ffcccc">!     ..</a>
  4367) <a name="l4367" style="background-color: #ffcccc">!</a>
  4368) <a name="l4368" style="background-color: #ffcccc">!  Purpose</a>
  4369) <a name="l4369" style="background-color: #ffcccc">!  =======</a>
  4370) <a name="l4370" style="background-color: #ffcccc">!</a>
  4371) <a name="l4371" style="background-color: #ffcccc">!  SLARF applies a real elementary reflector H to a real m by n matrix</a>
  4372) <a name="l4372" style="background-color: #ffcccc">!  C, from either the left or the right. H is represented in the form</a>
  4373) <a name="l4373" style="background-color: #ffcccc">!</a>
  4374) <a name="l4374" style="background-color: #ffcccc">!        H = I - tau * v * v'</a>
  4375) <a name="l4375" style="background-color: #ffcccc">!</a>
  4376) <a name="l4376" style="background-color: #ffcccc">!  where tau is a real scalar and v is a real vector.</a>
  4377) <a name="l4377" style="background-color: #ffcccc">!</a>
  4378) <a name="l4378" style="background-color: #ffcccc">!  If tau = 0, then H is taken to be the unit matrix.</a>
  4379) <a name="l4379" style="background-color: #ffcccc">!</a>
  4380) <a name="l4380" style="background-color: #ffcccc">!  Arguments</a>
  4381) <a name="l4381" style="background-color: #ffcccc">!  =========</a>
  4382) <a name="l4382" style="background-color: #ffcccc">!</a>
  4383) <a name="l4383" style="background-color: #ffcccc">!  SIDE    (input) CHARACTER*1</a>
  4384) <a name="l4384" style="background-color: #ffcccc">!          = 'L': form  H * C</a>
  4385) <a name="l4385" style="background-color: #ffcccc">!          = 'R': form  C * H</a>
  4386) <a name="l4386" style="background-color: #ffcccc">!</a>
  4387) <a name="l4387" style="background-color: #ffcccc">!  M       (input) INTEGER</a>
  4388) <a name="l4388" style="background-color: #ffcccc">!          The number of rows of the matrix C.</a>
  4389) <a name="l4389" style="background-color: #ffcccc">!</a>
  4390) <a name="l4390" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  4391) <a name="l4391" style="background-color: #ffcccc">!          The number of columns of the matrix C.</a>
  4392) <a name="l4392" style="background-color: #ffcccc">!</a>
  4393) <a name="l4393" style="background-color: #ffcccc">!  V       (input) REAL array, dimension</a>
  4394) <a name="l4394" style="background-color: #ffcccc">!                     (1 + (M-1)*abs(INCV)) if SIDE = 'L'</a>
  4395) <a name="l4395" style="background-color: #ffcccc">!                  or (1 + (N-1)*abs(INCV)) if SIDE = 'R'</a>
  4396) <a name="l4396" style="background-color: #ffcccc">!          The vector v in the representation of H. V is not used if</a>
  4397) <a name="l4397" style="background-color: #ffcccc">!          TAU = 0.</a>
  4398) <a name="l4398" style="background-color: #ffcccc">!</a>
  4399) <a name="l4399" style="background-color: #ffcccc">!  INCV    (input) INTEGER</a>
  4400) <a name="l4400" style="background-color: #ffcccc">!          The increment between elements of v. INCV &lt;&gt; 0.</a>
  4401) <a name="l4401" style="background-color: #ffcccc">!</a>
  4402) <a name="l4402" style="background-color: #ffcccc">!  TAU     (input) REAL</a>
  4403) <a name="l4403" style="background-color: #ffcccc">!          The value tau in the representation of H.</a>
  4404) <a name="l4404" style="background-color: #ffcccc">!</a>
  4405) <a name="l4405" style="background-color: #ffcccc">!  C       (input/output) REAL array, dimension (LDC,N)</a>
  4406) <a name="l4406" style="background-color: #ffcccc">!          On entry, the m by n matrix C.</a>
  4407) <a name="l4407" style="background-color: #ffcccc">!          On exit, C is overwritten by the matrix H * C if SIDE = 'L',</a>
  4408) <a name="l4408" style="background-color: #ffcccc">!          or C * H if SIDE = 'R'.</a>
  4409) <a name="l4409" style="background-color: #ffcccc">!</a>
  4410) <a name="l4410" style="background-color: #ffcccc">!  LDC     (input) INTEGER</a>
  4411) <a name="l4411" style="background-color: #ffcccc">!          The leading dimension of the array C. LDC &gt;= max(1,M).</a>
  4412) <a name="l4412" style="background-color: #ffcccc">!</a>
  4413) <a name="l4413" style="background-color: #ffcccc">!  WORK    (workspace) REAL array, dimension</a>
  4414) <a name="l4414" style="background-color: #ffcccc">!                         (N) if SIDE = 'L'</a>
  4415) <a name="l4415" style="background-color: #ffcccc">!                      or (M) if SIDE = 'R'</a>
  4416) <a name="l4416" style="background-color: #ffcccc">!</a>
  4417) <a name="l4417" style="background-color: #ffcccc">!  =====================================================================</a>
  4418) <a name="l4418" style="background-color: #ffcccc">!</a>
  4419) <a name="l4419" style="background-color: #ffcccc">!     .. Parameters ..</a>
  4420) <a name="l4420" style="background-color: #ffcccc">      REAL(r8)               ONE, ZERO</a>
  4421) <a name="l4421" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
  4422) <a name="l4422" style="background-color: #ffcccc">!     ..</a>
  4423) <a name="l4423" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  4424) <a name="l4424" style="background-color: #ffcccc">!</a>
  4425) <a name="l4425" style="background-color: #ffcccc">      IF( LSAME( SIDE, 'L' ) ) THEN</a>
  4426) <a name="l4426" style="background-color: #ffcccc">!</a>
  4427) <a name="l4427" style="background-color: #ffcccc">!        Form  H * C</a>
  4428) <a name="l4428" style="background-color: #ffcccc">!</a>
  4429) <a name="l4429" style="background-color: #ffcccc">         IF( TAU.NE.ZERO ) THEN</a>
  4430) <a name="l4430" style="background-color: #ffcccc">!</a>
  4431) <a name="l4431" style="background-color: #ffcccc">!           w := C' * v</a>
  4432) <a name="l4432" style="background-color: #ffcccc">!</a>
  4433) <a name="l4433" style="background-color: #ffcccc">            CALL SGEMV( 'Transpose', M, N, ONE, C, LDC, V, INCV, ZERO, &amp;</a>
  4434) <a name="l4434" style="background-color: #ffcccc">                        WORK, 1 )</a>
  4435) <a name="l4435" style="background-color: #ffcccc">!</a>
  4436) <a name="l4436" style="background-color: #ffcccc">!           C := C - v * w'</a>
  4437) <a name="l4437" style="background-color: #ffcccc">!</a>
  4438) <a name="l4438" style="background-color: #ffcccc">            CALL SGER( M, N, -TAU, V, INCV, WORK, 1, C, LDC )</a>
  4439) <a name="l4439" style="background-color: #ffcccc">         END IF</a>
  4440) <a name="l4440" style="background-color: #ffcccc">      ELSE</a>
  4441) <a name="l4441" style="background-color: #ffcccc">!</a>
  4442) <a name="l4442" style="background-color: #ffcccc">!        Form  C * H</a>
  4443) <a name="l4443" style="background-color: #ffcccc">!</a>
  4444) <a name="l4444" style="background-color: #ffcccc">         IF( TAU.NE.ZERO ) THEN</a>
  4445) <a name="l4445" style="background-color: #ffcccc">!</a>
  4446) <a name="l4446" style="background-color: #ffcccc">!           w := C * v</a>
  4447) <a name="l4447" style="background-color: #ffcccc">!</a>
  4448) <a name="l4448" style="background-color: #ffcccc">            CALL SGEMV( 'No transpose', M, N, ONE, C, LDC, V, INCV, &amp;</a>
  4449) <a name="l4449" style="background-color: #ffcccc">                        ZERO, WORK, 1 )</a>
  4450) <a name="l4450" style="background-color: #ffcccc">!</a>
  4451) <a name="l4451" style="background-color: #ffcccc">!           C := C - w * v'</a>
  4452) <a name="l4452" style="background-color: #ffcccc">!</a>
  4453) <a name="l4453" style="background-color: #ffcccc">            CALL SGER( M, N, -TAU, WORK, 1, V, INCV, C, LDC )</a>
  4454) <a name="l4454" style="background-color: #ffcccc">         END IF</a>
  4455) <a name="l4455" style="background-color: #ffcccc">      END IF</a>
  4456) <a name="l4456" style="background-color: #ffcccc">      RETURN</a>
  4457) <a name="l4457" style="background-color: #ffcccc">!</a>
  4458) <a name="l4458" style="background-color: #ffcccc">!     End of SLARF</a>
  4459) <a name="l4459" style="background-color: #ffcccc">!</a>
  4460) <a name="l4460" style="background-color: #ffcccc">      END SUBROUTINE SLARF</a>
  4461) <a name="l4461" style="background-color: #ffffff"></a>
  4462) <a name="l4462" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  4463) <a name="l4463" style="background-color: #ffffff"></a>
  4464) <a name="l4464" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLARFB( SIDE, TRANS, DIRECT, STOREV, M, N, K, V, LDV, &amp;</a>
  4465) <a name="l4465" style="background-color: #ffcccc">                         T, LDT, C, LDC, WORK, LDWORK )</a>
  4466) <a name="l4466" style="background-color: #ffcccc"></a>
  4467) <a name="l4467" style="background-color: #ffcccc">!</a>
  4468) <a name="l4468" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  4469) <a name="l4469" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  4470) <a name="l4470" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  4471) <a name="l4471" style="background-color: #ffcccc">!     February 29, 1992</a>
  4472) <a name="l4472" style="background-color: #ffcccc">!</a>
  4473) <a name="l4473" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  4474) <a name="l4474" style="background-color: #ffcccc">      CHARACTER          DIRECT, SIDE, STOREV, TRANS</a>
  4475) <a name="l4475" style="background-color: #ffcccc">      INTEGER            K, LDC, LDT, LDV, LDWORK, M, N</a>
  4476) <a name="l4476" style="background-color: #ffcccc">!     ..</a>
  4477) <a name="l4477" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  4478) <a name="l4478" style="background-color: #ffcccc">      REAL(r8)               C( LDC, * ), T( LDT, * ), V( LDV, * ), &amp;</a>
  4479) <a name="l4479" style="background-color: #ffcccc">                         WORK( LDWORK, * )</a>
  4480) <a name="l4480" style="background-color: #ffcccc">!     ..</a>
  4481) <a name="l4481" style="background-color: #ffcccc">!</a>
  4482) <a name="l4482" style="background-color: #ffcccc">!  Purpose</a>
  4483) <a name="l4483" style="background-color: #ffcccc">!  =======</a>
  4484) <a name="l4484" style="background-color: #ffcccc">!</a>
  4485) <a name="l4485" style="background-color: #ffcccc">!  SLARFB applies a real block reflector H or its transpose H' to a</a>
  4486) <a name="l4486" style="background-color: #ffcccc">!  real m by n matrix C, from either the left or the right.</a>
  4487) <a name="l4487" style="background-color: #ffcccc">!</a>
  4488) <a name="l4488" style="background-color: #ffcccc">!  Arguments</a>
  4489) <a name="l4489" style="background-color: #ffcccc">!  =========</a>
  4490) <a name="l4490" style="background-color: #ffcccc">!</a>
  4491) <a name="l4491" style="background-color: #ffcccc">!  SIDE    (input) CHARACTER*1</a>
  4492) <a name="l4492" style="background-color: #ffcccc">!          = 'L': apply H or H' from the Left</a>
  4493) <a name="l4493" style="background-color: #ffcccc">!          = 'R': apply H or H' from the Right</a>
  4494) <a name="l4494" style="background-color: #ffcccc">!</a>
  4495) <a name="l4495" style="background-color: #ffcccc">!  TRANS   (input) CHARACTER*1</a>
  4496) <a name="l4496" style="background-color: #ffcccc">!          = 'N': apply H (No transpose)</a>
  4497) <a name="l4497" style="background-color: #ffcccc">!          = 'T': apply H' (Transpose)</a>
  4498) <a name="l4498" style="background-color: #ffcccc">!</a>
  4499) <a name="l4499" style="background-color: #ffcccc">!  DIRECT  (input) CHARACTER*1</a>
  4500) <a name="l4500" style="background-color: #ffcccc">!          Indicates how H is formed from a product of elementary</a>
  4501) <a name="l4501" style="background-color: #ffcccc">!          reflectors</a>
  4502) <a name="l4502" style="background-color: #ffcccc">!          = 'F': H = H(1) H(2) . . . H(k) (Forward)</a>
  4503) <a name="l4503" style="background-color: #ffcccc">!          = 'B': H = H(k) . . . H(2) H(1) (Backward)</a>
  4504) <a name="l4504" style="background-color: #ffcccc">!</a>
  4505) <a name="l4505" style="background-color: #ffcccc">!  STOREV  (input) CHARACTER*1</a>
  4506) <a name="l4506" style="background-color: #ffcccc">!          Indicates how the vectors which define the elementary</a>
  4507) <a name="l4507" style="background-color: #ffcccc">!          reflectors are stored:</a>
  4508) <a name="l4508" style="background-color: #ffcccc">!          = 'C': Columnwise</a>
  4509) <a name="l4509" style="background-color: #ffcccc">!          = 'R': Rowwise</a>
  4510) <a name="l4510" style="background-color: #ffcccc">!</a>
  4511) <a name="l4511" style="background-color: #ffcccc">!  M       (input) INTEGER</a>
  4512) <a name="l4512" style="background-color: #ffcccc">!          The number of rows of the matrix C.</a>
  4513) <a name="l4513" style="background-color: #ffcccc">!</a>
  4514) <a name="l4514" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  4515) <a name="l4515" style="background-color: #ffcccc">!          The number of columns of the matrix C.</a>
  4516) <a name="l4516" style="background-color: #ffcccc">!</a>
  4517) <a name="l4517" style="background-color: #ffcccc">!  K       (input) INTEGER</a>
  4518) <a name="l4518" style="background-color: #ffcccc">!          The order of the matrix T (= the number of elementary</a>
  4519) <a name="l4519" style="background-color: #ffcccc">!          reflectors whose product defines the block reflector).</a>
  4520) <a name="l4520" style="background-color: #ffcccc">!</a>
  4521) <a name="l4521" style="background-color: #ffcccc">!  V       (input) REAL array, dimension</a>
  4522) <a name="l4522" style="background-color: #ffcccc">!                                (LDV,K) if STOREV = 'C'</a>
  4523) <a name="l4523" style="background-color: #ffcccc">!                                (LDV,M) if STOREV = 'R' and SIDE = 'L'</a>
  4524) <a name="l4524" style="background-color: #ffcccc">!                                (LDV,N) if STOREV = 'R' and SIDE = 'R'</a>
  4525) <a name="l4525" style="background-color: #ffcccc">!          The matrix V. See further details.</a>
  4526) <a name="l4526" style="background-color: #ffcccc">!</a>
  4527) <a name="l4527" style="background-color: #ffcccc">!  LDV     (input) INTEGER</a>
  4528) <a name="l4528" style="background-color: #ffcccc">!          The leading dimension of the array V.</a>
  4529) <a name="l4529" style="background-color: #ffcccc">!          If STOREV = 'C' and SIDE = 'L', LDV &gt;= max(1,M);</a>
  4530) <a name="l4530" style="background-color: #ffcccc">!          if STOREV = 'C' and SIDE = 'R', LDV &gt;= max(1,N);</a>
  4531) <a name="l4531" style="background-color: #ffcccc">!          if STOREV = 'R', LDV &gt;= K.</a>
  4532) <a name="l4532" style="background-color: #ffcccc">!</a>
  4533) <a name="l4533" style="background-color: #ffcccc">!  T       (input) REAL array, dimension (LDT,K)</a>
  4534) <a name="l4534" style="background-color: #ffcccc">!          The triangular k by k matrix T in the representation of the</a>
  4535) <a name="l4535" style="background-color: #ffcccc">!          block reflector.</a>
  4536) <a name="l4536" style="background-color: #ffcccc">!</a>
  4537) <a name="l4537" style="background-color: #ffcccc">!  LDT     (input) INTEGER</a>
  4538) <a name="l4538" style="background-color: #ffcccc">!          The leading dimension of the array T. LDT &gt;= K.</a>
  4539) <a name="l4539" style="background-color: #ffcccc">!</a>
  4540) <a name="l4540" style="background-color: #ffcccc">!  C       (input/output) REAL array, dimension (LDC,N)</a>
  4541) <a name="l4541" style="background-color: #ffcccc">!          On entry, the m by n matrix C.</a>
  4542) <a name="l4542" style="background-color: #ffcccc">!          On exit, C is overwritten by H*C or H'*C or C*H or C*H'.</a>
  4543) <a name="l4543" style="background-color: #ffcccc">!</a>
  4544) <a name="l4544" style="background-color: #ffcccc">!  LDC     (input) INTEGER</a>
  4545) <a name="l4545" style="background-color: #ffcccc">!          The leading dimension of the array C. LDA &gt;= max(1,M).</a>
  4546) <a name="l4546" style="background-color: #ffcccc">!</a>
  4547) <a name="l4547" style="background-color: #ffcccc">!  WORK    (workspace) REAL array, dimension (LDWORK,K)</a>
  4548) <a name="l4548" style="background-color: #ffcccc">!</a>
  4549) <a name="l4549" style="background-color: #ffcccc">!  LDWORK  (input) INTEGER</a>
  4550) <a name="l4550" style="background-color: #ffcccc">!          The leading dimension of the array WORK.</a>
  4551) <a name="l4551" style="background-color: #ffcccc">!          If SIDE = 'L', LDWORK &gt;= max(1,N);</a>
  4552) <a name="l4552" style="background-color: #ffcccc">!          if SIDE = 'R', LDWORK &gt;= max(1,M).</a>
  4553) <a name="l4553" style="background-color: #ffcccc">!</a>
  4554) <a name="l4554" style="background-color: #ffcccc">!  =====================================================================</a>
  4555) <a name="l4555" style="background-color: #ffcccc">!</a>
  4556) <a name="l4556" style="background-color: #ffcccc">!     .. Parameters ..</a>
  4557) <a name="l4557" style="background-color: #ffcccc">      REAL(r8)               ONE</a>
  4558) <a name="l4558" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E+0_r8 )</a>
  4559) <a name="l4559" style="background-color: #ffcccc">!     ..</a>
  4560) <a name="l4560" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  4561) <a name="l4561" style="background-color: #ffcccc">      CHARACTER          TRANST</a>
  4562) <a name="l4562" style="background-color: #ffcccc">      INTEGER            I, J</a>
  4563) <a name="l4563" style="background-color: #ffcccc">!     ..</a>
  4564) <a name="l4564" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  4565) <a name="l4565" style="background-color: #ffcccc">!</a>
  4566) <a name="l4566" style="background-color: #ffcccc">!     Quick return if possible</a>
  4567) <a name="l4567" style="background-color: #ffcccc">!</a>
  4568) <a name="l4568" style="background-color: #ffcccc">      IF( M.LE.0 .OR. N.LE.0 ) &amp;</a>
  4569) <a name="l4569" style="background-color: #ffcccc">         RETURN</a>
  4570) <a name="l4570" style="background-color: #ffcccc">!</a>
  4571) <a name="l4571" style="background-color: #ffcccc">      IF( LSAME( TRANS, 'N' ) ) THEN</a>
  4572) <a name="l4572" style="background-color: #ffcccc">         TRANST = 'T'</a>
  4573) <a name="l4573" style="background-color: #ffcccc">      ELSE</a>
  4574) <a name="l4574" style="background-color: #ffcccc">         TRANST = 'N'</a>
  4575) <a name="l4575" style="background-color: #ffcccc">      END IF</a>
  4576) <a name="l4576" style="background-color: #ffcccc">!</a>
  4577) <a name="l4577" style="background-color: #ffcccc">      IF( LSAME( STOREV, 'C' ) ) THEN</a>
  4578) <a name="l4578" style="background-color: #ffcccc">!</a>
  4579) <a name="l4579" style="background-color: #ffcccc">         IF( LSAME( DIRECT, 'F' ) ) THEN</a>
  4580) <a name="l4580" style="background-color: #ffcccc">!</a>
  4581) <a name="l4581" style="background-color: #ffcccc">!           Let  V =  ( V1 )    (first K rows)</a>
  4582) <a name="l4582" style="background-color: #ffcccc">!                     ( V2 )</a>
  4583) <a name="l4583" style="background-color: #ffcccc">!           where  V1  is unit lower triangular.</a>
  4584) <a name="l4584" style="background-color: #ffcccc">!</a>
  4585) <a name="l4585" style="background-color: #ffcccc">            IF( LSAME( SIDE, 'L' ) ) THEN</a>
  4586) <a name="l4586" style="background-color: #ffcccc">!</a>
  4587) <a name="l4587" style="background-color: #ffcccc">!              Form  H * C  or  H' * C  where  C = ( C1 )</a>
  4588) <a name="l4588" style="background-color: #ffcccc">!                                                  ( C2 )</a>
  4589) <a name="l4589" style="background-color: #ffcccc">!</a>
  4590) <a name="l4590" style="background-color: #ffcccc">!              W := C' * V  =  (C1'*V1 + C2'*V2)  (stored in WORK)</a>
  4591) <a name="l4591" style="background-color: #ffcccc">!</a>
  4592) <a name="l4592" style="background-color: #ffcccc">!              W := C1'</a>
  4593) <a name="l4593" style="background-color: #ffcccc">!</a>
  4594) <a name="l4594" style="background-color: #ffcccc">               DO 10 J = 1, K</a>
  4595) <a name="l4595" style="background-color: #ffcccc">                  CALL SCOPY( N, C( J, 1 ), LDC, WORK( 1, J ), 1 )</a>
  4596) <a name="l4596" style="background-color: #ffcccc">   10          CONTINUE</a>
  4597) <a name="l4597" style="background-color: #ffcccc">!</a>
  4598) <a name="l4598" style="background-color: #ffcccc">!              W := W * V1</a>
  4599) <a name="l4599" style="background-color: #ffcccc">!</a>
  4600) <a name="l4600" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', 'No transpose', 'Unit', N, &amp;</a>
  4601) <a name="l4601" style="background-color: #ffcccc">                           K, ONE, V, LDV, WORK, LDWORK )</a>
  4602) <a name="l4602" style="background-color: #ffcccc">               IF( M.GT.K ) THEN</a>
  4603) <a name="l4603" style="background-color: #ffcccc">!</a>
  4604) <a name="l4604" style="background-color: #ffcccc">!                 W := W + C2'*V2</a>
  4605) <a name="l4605" style="background-color: #ffcccc">!</a>
  4606) <a name="l4606" style="background-color: #ffcccc">                  CALL SGEMM( 'Transpose', 'No transpose', N, K, M-K, &amp;</a>
  4607) <a name="l4607" style="background-color: #ffcccc">                              ONE, C( K+1, 1 ), LDC, V( K+1, 1 ), LDV, &amp;</a>
  4608) <a name="l4608" style="background-color: #ffcccc">                              ONE, WORK, LDWORK )</a>
  4609) <a name="l4609" style="background-color: #ffcccc">               END IF</a>
  4610) <a name="l4610" style="background-color: #ffcccc">!</a>
  4611) <a name="l4611" style="background-color: #ffcccc">!              W := W * T'  or  W * T</a>
  4612) <a name="l4612" style="background-color: #ffcccc">!</a>
  4613) <a name="l4613" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', TRANST, 'Non-unit', N, K, &amp;</a>
  4614) <a name="l4614" style="background-color: #ffcccc">                           ONE, T, LDT, WORK, LDWORK )</a>
  4615) <a name="l4615" style="background-color: #ffcccc">!</a>
  4616) <a name="l4616" style="background-color: #ffcccc">!              C := C - V * W'</a>
  4617) <a name="l4617" style="background-color: #ffcccc">!</a>
  4618) <a name="l4618" style="background-color: #ffcccc">               IF( M.GT.K ) THEN</a>
  4619) <a name="l4619" style="background-color: #ffcccc">!</a>
  4620) <a name="l4620" style="background-color: #ffcccc">!                 C2 := C2 - V2 * W'</a>
  4621) <a name="l4621" style="background-color: #ffcccc">!</a>
  4622) <a name="l4622" style="background-color: #ffcccc">                  CALL SGEMM( 'No transpose', 'Transpose', M-K, N, K, &amp;</a>
  4623) <a name="l4623" style="background-color: #ffcccc">                              -ONE, V( K+1, 1 ), LDV, WORK, LDWORK, ONE, &amp;</a>
  4624) <a name="l4624" style="background-color: #ffcccc">                              C( K+1, 1 ), LDC )</a>
  4625) <a name="l4625" style="background-color: #ffcccc">               END IF</a>
  4626) <a name="l4626" style="background-color: #ffcccc">!</a>
  4627) <a name="l4627" style="background-color: #ffcccc">!              W := W * V1'</a>
  4628) <a name="l4628" style="background-color: #ffcccc">!</a>
  4629) <a name="l4629" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', 'Transpose', 'Unit', N, K, &amp;</a>
  4630) <a name="l4630" style="background-color: #ffcccc">                           ONE, V, LDV, WORK, LDWORK )</a>
  4631) <a name="l4631" style="background-color: #ffcccc">!</a>
  4632) <a name="l4632" style="background-color: #ffcccc">!              C1 := C1 - W'</a>
  4633) <a name="l4633" style="background-color: #ffcccc">!</a>
  4634) <a name="l4634" style="background-color: #ffcccc">               DO 30 J = 1, K</a>
  4635) <a name="l4635" style="background-color: #ffcccc">                  DO 20 I = 1, N</a>
  4636) <a name="l4636" style="background-color: #ffcccc">                     C( J, I ) = C( J, I ) - WORK( I, J )</a>
  4637) <a name="l4637" style="background-color: #ffcccc">   20             CONTINUE</a>
  4638) <a name="l4638" style="background-color: #ffcccc">   30          CONTINUE</a>
  4639) <a name="l4639" style="background-color: #ffcccc">!</a>
  4640) <a name="l4640" style="background-color: #ffcccc">            ELSE IF( LSAME( SIDE, 'R' ) ) THEN</a>
  4641) <a name="l4641" style="background-color: #ffcccc">!</a>
  4642) <a name="l4642" style="background-color: #ffcccc">!              Form  C * H  or  C * H'  where  C = ( C1  C2 )</a>
  4643) <a name="l4643" style="background-color: #ffcccc">!</a>
  4644) <a name="l4644" style="background-color: #ffcccc">!              W := C * V  =  (C1*V1 + C2*V2)  (stored in WORK)</a>
  4645) <a name="l4645" style="background-color: #ffcccc">!</a>
  4646) <a name="l4646" style="background-color: #ffcccc">!              W := C1</a>
  4647) <a name="l4647" style="background-color: #ffcccc">!</a>
  4648) <a name="l4648" style="background-color: #ffcccc">               DO 40 J = 1, K</a>
  4649) <a name="l4649" style="background-color: #ffcccc">                  CALL SCOPY( M, C( 1, J ), 1, WORK( 1, J ), 1 )</a>
  4650) <a name="l4650" style="background-color: #ffcccc">   40          CONTINUE</a>
  4651) <a name="l4651" style="background-color: #ffcccc">!</a>
  4652) <a name="l4652" style="background-color: #ffcccc">!              W := W * V1</a>
  4653) <a name="l4653" style="background-color: #ffcccc">!</a>
  4654) <a name="l4654" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', 'No transpose', 'Unit', M, &amp;</a>
  4655) <a name="l4655" style="background-color: #ffcccc">                           K, ONE, V, LDV, WORK, LDWORK )</a>
  4656) <a name="l4656" style="background-color: #ffcccc">               IF( N.GT.K ) THEN</a>
  4657) <a name="l4657" style="background-color: #ffcccc">!</a>
  4658) <a name="l4658" style="background-color: #ffcccc">!                 W := W + C2 * V2</a>
  4659) <a name="l4659" style="background-color: #ffcccc">!</a>
  4660) <a name="l4660" style="background-color: #ffcccc">                  CALL SGEMM( 'No transpose', 'No transpose', M, K, N-K, &amp;</a>
  4661) <a name="l4661" style="background-color: #ffcccc">                              ONE, C( 1, K+1 ), LDC, V( K+1, 1 ), LDV, &amp;</a>
  4662) <a name="l4662" style="background-color: #ffcccc">                              ONE, WORK, LDWORK )</a>
  4663) <a name="l4663" style="background-color: #ffcccc">               END IF</a>
  4664) <a name="l4664" style="background-color: #ffcccc">!</a>
  4665) <a name="l4665" style="background-color: #ffcccc">!              W := W * T  or  W * T'</a>
  4666) <a name="l4666" style="background-color: #ffcccc">!</a>
  4667) <a name="l4667" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', TRANS, 'Non-unit', M, K, &amp;</a>
  4668) <a name="l4668" style="background-color: #ffcccc">                           ONE, T, LDT, WORK, LDWORK )</a>
  4669) <a name="l4669" style="background-color: #ffcccc">!</a>
  4670) <a name="l4670" style="background-color: #ffcccc">!              C := C - W * V'</a>
  4671) <a name="l4671" style="background-color: #ffcccc">!</a>
  4672) <a name="l4672" style="background-color: #ffcccc">               IF( N.GT.K ) THEN</a>
  4673) <a name="l4673" style="background-color: #ffcccc">!</a>
  4674) <a name="l4674" style="background-color: #ffcccc">!                 C2 := C2 - W * V2'</a>
  4675) <a name="l4675" style="background-color: #ffcccc">!</a>
  4676) <a name="l4676" style="background-color: #ffcccc">                  CALL SGEMM( 'No transpose', 'Transpose', M, N-K, K, &amp;</a>
  4677) <a name="l4677" style="background-color: #ffcccc">                              -ONE, WORK, LDWORK, V( K+1, 1 ), LDV, ONE, &amp;</a>
  4678) <a name="l4678" style="background-color: #ffcccc">                              C( 1, K+1 ), LDC )</a>
  4679) <a name="l4679" style="background-color: #ffcccc">               END IF</a>
  4680) <a name="l4680" style="background-color: #ffcccc">!</a>
  4681) <a name="l4681" style="background-color: #ffcccc">!              W := W * V1'</a>
  4682) <a name="l4682" style="background-color: #ffcccc">!</a>
  4683) <a name="l4683" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', 'Transpose', 'Unit', M, K, &amp;</a>
  4684) <a name="l4684" style="background-color: #ffcccc">                           ONE, V, LDV, WORK, LDWORK )</a>
  4685) <a name="l4685" style="background-color: #ffcccc">!</a>
  4686) <a name="l4686" style="background-color: #ffcccc">!              C1 := C1 - W</a>
  4687) <a name="l4687" style="background-color: #ffcccc">!</a>
  4688) <a name="l4688" style="background-color: #ffcccc">               DO 60 J = 1, K</a>
  4689) <a name="l4689" style="background-color: #ffcccc">                  DO 50 I = 1, M</a>
  4690) <a name="l4690" style="background-color: #ffcccc">                     C( I, J ) = C( I, J ) - WORK( I, J )</a>
  4691) <a name="l4691" style="background-color: #ffcccc">   50             CONTINUE</a>
  4692) <a name="l4692" style="background-color: #ffcccc">   60          CONTINUE</a>
  4693) <a name="l4693" style="background-color: #ffcccc">            END IF</a>
  4694) <a name="l4694" style="background-color: #ffcccc">!</a>
  4695) <a name="l4695" style="background-color: #ffcccc">         ELSE</a>
  4696) <a name="l4696" style="background-color: #ffcccc">!</a>
  4697) <a name="l4697" style="background-color: #ffcccc">!           Let  V =  ( V1 )</a>
  4698) <a name="l4698" style="background-color: #ffcccc">!                     ( V2 )    (last K rows)</a>
  4699) <a name="l4699" style="background-color: #ffcccc">!           where  V2  is unit upper triangular.</a>
  4700) <a name="l4700" style="background-color: #ffcccc">!</a>
  4701) <a name="l4701" style="background-color: #ffcccc">            IF( LSAME( SIDE, 'L' ) ) THEN</a>
  4702) <a name="l4702" style="background-color: #ffcccc">!</a>
  4703) <a name="l4703" style="background-color: #ffcccc">!              Form  H * C  or  H' * C  where  C = ( C1 )</a>
  4704) <a name="l4704" style="background-color: #ffcccc">!                                                  ( C2 )</a>
  4705) <a name="l4705" style="background-color: #ffcccc">!</a>
  4706) <a name="l4706" style="background-color: #ffcccc">!              W := C' * V  =  (C1'*V1 + C2'*V2)  (stored in WORK)</a>
  4707) <a name="l4707" style="background-color: #ffcccc">!</a>
  4708) <a name="l4708" style="background-color: #ffcccc">!              W := C2'</a>
  4709) <a name="l4709" style="background-color: #ffcccc">!</a>
  4710) <a name="l4710" style="background-color: #ffcccc">               DO 70 J = 1, K</a>
  4711) <a name="l4711" style="background-color: #ffcccc">                  CALL SCOPY( N, C( M-K+J, 1 ), LDC, WORK( 1, J ), 1 )</a>
  4712) <a name="l4712" style="background-color: #ffcccc">   70          CONTINUE</a>
  4713) <a name="l4713" style="background-color: #ffcccc">!</a>
  4714) <a name="l4714" style="background-color: #ffcccc">!              W := W * V2</a>
  4715) <a name="l4715" style="background-color: #ffcccc">!</a>
  4716) <a name="l4716" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', 'No transpose', 'Unit', N, &amp;</a>
  4717) <a name="l4717" style="background-color: #ffcccc">                           K, ONE, V( M-K+1, 1 ), LDV, WORK, LDWORK )</a>
  4718) <a name="l4718" style="background-color: #ffcccc">               IF( M.GT.K ) THEN</a>
  4719) <a name="l4719" style="background-color: #ffcccc">!</a>
  4720) <a name="l4720" style="background-color: #ffcccc">!                 W := W + C1'*V1</a>
  4721) <a name="l4721" style="background-color: #ffcccc">!</a>
  4722) <a name="l4722" style="background-color: #ffcccc">                  CALL SGEMM( 'Transpose', 'No transpose', N, K, M-K, &amp;</a>
  4723) <a name="l4723" style="background-color: #ffcccc">                              ONE, C, LDC, V, LDV, ONE, WORK, LDWORK )</a>
  4724) <a name="l4724" style="background-color: #ffcccc">               END IF</a>
  4725) <a name="l4725" style="background-color: #ffcccc">!</a>
  4726) <a name="l4726" style="background-color: #ffcccc">!              W := W * T'  or  W * T</a>
  4727) <a name="l4727" style="background-color: #ffcccc">!</a>
  4728) <a name="l4728" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', TRANST, 'Non-unit', N, K, &amp;</a>
  4729) <a name="l4729" style="background-color: #ffcccc">                           ONE, T, LDT, WORK, LDWORK )</a>
  4730) <a name="l4730" style="background-color: #ffcccc">!</a>
  4731) <a name="l4731" style="background-color: #ffcccc">!              C := C - V * W'</a>
  4732) <a name="l4732" style="background-color: #ffcccc">!</a>
  4733) <a name="l4733" style="background-color: #ffcccc">               IF( M.GT.K ) THEN</a>
  4734) <a name="l4734" style="background-color: #ffcccc">!</a>
  4735) <a name="l4735" style="background-color: #ffcccc">!                 C1 := C1 - V1 * W'</a>
  4736) <a name="l4736" style="background-color: #ffcccc">!</a>
  4737) <a name="l4737" style="background-color: #ffcccc">                  CALL SGEMM( 'No transpose', 'Transpose', M-K, N, K, &amp;</a>
  4738) <a name="l4738" style="background-color: #ffcccc">                              -ONE, V, LDV, WORK, LDWORK, ONE, C, LDC )</a>
  4739) <a name="l4739" style="background-color: #ffcccc">               END IF</a>
  4740) <a name="l4740" style="background-color: #ffcccc">!</a>
  4741) <a name="l4741" style="background-color: #ffcccc">!              W := W * V2'</a>
  4742) <a name="l4742" style="background-color: #ffcccc">!</a>
  4743) <a name="l4743" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', 'Transpose', 'Unit', N, K, &amp;</a>
  4744) <a name="l4744" style="background-color: #ffcccc">                           ONE, V( M-K+1, 1 ), LDV, WORK, LDWORK )</a>
  4745) <a name="l4745" style="background-color: #ffcccc">!</a>
  4746) <a name="l4746" style="background-color: #ffcccc">!              C2 := C2 - W'</a>
  4747) <a name="l4747" style="background-color: #ffcccc">!</a>
  4748) <a name="l4748" style="background-color: #ffcccc">               DO 90 J = 1, K</a>
  4749) <a name="l4749" style="background-color: #ffcccc">                  DO 80 I = 1, N</a>
  4750) <a name="l4750" style="background-color: #ffcccc">                     C( M-K+J, I ) = C( M-K+J, I ) - WORK( I, J )</a>
  4751) <a name="l4751" style="background-color: #ffcccc">   80             CONTINUE</a>
  4752) <a name="l4752" style="background-color: #ffcccc">   90          CONTINUE</a>
  4753) <a name="l4753" style="background-color: #ffcccc">!</a>
  4754) <a name="l4754" style="background-color: #ffcccc">            ELSE IF( LSAME( SIDE, 'R' ) ) THEN</a>
  4755) <a name="l4755" style="background-color: #ffcccc">!</a>
  4756) <a name="l4756" style="background-color: #ffcccc">!              Form  C * H  or  C * H'  where  C = ( C1  C2 )</a>
  4757) <a name="l4757" style="background-color: #ffcccc">!</a>
  4758) <a name="l4758" style="background-color: #ffcccc">!              W := C * V  =  (C1*V1 + C2*V2)  (stored in WORK)</a>
  4759) <a name="l4759" style="background-color: #ffcccc">!</a>
  4760) <a name="l4760" style="background-color: #ffcccc">!              W := C2</a>
  4761) <a name="l4761" style="background-color: #ffcccc">!</a>
  4762) <a name="l4762" style="background-color: #ffcccc">               DO 100 J = 1, K</a>
  4763) <a name="l4763" style="background-color: #ffcccc">                  CALL SCOPY( M, C( 1, N-K+J ), 1, WORK( 1, J ), 1 )</a>
  4764) <a name="l4764" style="background-color: #ffcccc">  100          CONTINUE</a>
  4765) <a name="l4765" style="background-color: #ffcccc">!</a>
  4766) <a name="l4766" style="background-color: #ffcccc">!              W := W * V2</a>
  4767) <a name="l4767" style="background-color: #ffcccc">!</a>
  4768) <a name="l4768" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', 'No transpose', 'Unit', M, &amp;</a>
  4769) <a name="l4769" style="background-color: #ffcccc">                           K, ONE, V( N-K+1, 1 ), LDV, WORK, LDWORK )</a>
  4770) <a name="l4770" style="background-color: #ffcccc">               IF( N.GT.K ) THEN</a>
  4771) <a name="l4771" style="background-color: #ffcccc">!</a>
  4772) <a name="l4772" style="background-color: #ffcccc">!                 W := W + C1 * V1</a>
  4773) <a name="l4773" style="background-color: #ffcccc">!</a>
  4774) <a name="l4774" style="background-color: #ffcccc">                  CALL SGEMM( 'No transpose', 'No transpose', M, K, N-K, &amp;</a>
  4775) <a name="l4775" style="background-color: #ffcccc">                              ONE, C, LDC, V, LDV, ONE, WORK, LDWORK )</a>
  4776) <a name="l4776" style="background-color: #ffcccc">               END IF</a>
  4777) <a name="l4777" style="background-color: #ffcccc">!</a>
  4778) <a name="l4778" style="background-color: #ffcccc">!              W := W * T  or  W * T'</a>
  4779) <a name="l4779" style="background-color: #ffcccc">!</a>
  4780) <a name="l4780" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', TRANS, 'Non-unit', M, K, &amp;</a>
  4781) <a name="l4781" style="background-color: #ffcccc">                           ONE, T, LDT, WORK, LDWORK )</a>
  4782) <a name="l4782" style="background-color: #ffcccc">!</a>
  4783) <a name="l4783" style="background-color: #ffcccc">!              C := C - W * V'</a>
  4784) <a name="l4784" style="background-color: #ffcccc">!</a>
  4785) <a name="l4785" style="background-color: #ffcccc">               IF( N.GT.K ) THEN</a>
  4786) <a name="l4786" style="background-color: #ffcccc">!</a>
  4787) <a name="l4787" style="background-color: #ffcccc">!                 C1 := C1 - W * V1'</a>
  4788) <a name="l4788" style="background-color: #ffcccc">!</a>
  4789) <a name="l4789" style="background-color: #ffcccc">                  CALL SGEMM( 'No transpose', 'Transpose', M, N-K, K, &amp;</a>
  4790) <a name="l4790" style="background-color: #ffcccc">                              -ONE, WORK, LDWORK, V, LDV, ONE, C, LDC )</a>
  4791) <a name="l4791" style="background-color: #ffcccc">               END IF</a>
  4792) <a name="l4792" style="background-color: #ffcccc">!</a>
  4793) <a name="l4793" style="background-color: #ffcccc">!              W := W * V2'</a>
  4794) <a name="l4794" style="background-color: #ffcccc">!</a>
  4795) <a name="l4795" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', 'Transpose', 'Unit', M, K, &amp;</a>
  4796) <a name="l4796" style="background-color: #ffcccc">                           ONE, V( N-K+1, 1 ), LDV, WORK, LDWORK )</a>
  4797) <a name="l4797" style="background-color: #ffcccc">!</a>
  4798) <a name="l4798" style="background-color: #ffcccc">!              C2 := C2 - W</a>
  4799) <a name="l4799" style="background-color: #ffcccc">!</a>
  4800) <a name="l4800" style="background-color: #ffcccc">               DO 120 J = 1, K</a>
  4801) <a name="l4801" style="background-color: #ffcccc">                  DO 110 I = 1, M</a>
  4802) <a name="l4802" style="background-color: #ffcccc">                     C( I, N-K+J ) = C( I, N-K+J ) - WORK( I, J )</a>
  4803) <a name="l4803" style="background-color: #ffcccc">  110             CONTINUE</a>
  4804) <a name="l4804" style="background-color: #ffcccc">  120          CONTINUE</a>
  4805) <a name="l4805" style="background-color: #ffcccc">            END IF</a>
  4806) <a name="l4806" style="background-color: #ffcccc">         END IF</a>
  4807) <a name="l4807" style="background-color: #ffcccc">!</a>
  4808) <a name="l4808" style="background-color: #ffcccc">      ELSE IF( LSAME( STOREV, 'R' ) ) THEN</a>
  4809) <a name="l4809" style="background-color: #ffcccc">!</a>
  4810) <a name="l4810" style="background-color: #ffcccc">         IF( LSAME( DIRECT, 'F' ) ) THEN</a>
  4811) <a name="l4811" style="background-color: #ffcccc">!</a>
  4812) <a name="l4812" style="background-color: #ffcccc">!           Let  V =  ( V1  V2 )    (V1: first K columns)</a>
  4813) <a name="l4813" style="background-color: #ffcccc">!           where  V1  is unit upper triangular.</a>
  4814) <a name="l4814" style="background-color: #ffcccc">!</a>
  4815) <a name="l4815" style="background-color: #ffcccc">            IF( LSAME( SIDE, 'L' ) ) THEN</a>
  4816) <a name="l4816" style="background-color: #ffcccc">!</a>
  4817) <a name="l4817" style="background-color: #ffcccc">!              Form  H * C  or  H' * C  where  C = ( C1 )</a>
  4818) <a name="l4818" style="background-color: #ffcccc">!                                                  ( C2 )</a>
  4819) <a name="l4819" style="background-color: #ffcccc">!</a>
  4820) <a name="l4820" style="background-color: #ffcccc">!              W := C' * V'  =  (C1'*V1' + C2'*V2') (stored in WORK)</a>
  4821) <a name="l4821" style="background-color: #ffcccc">!</a>
  4822) <a name="l4822" style="background-color: #ffcccc">!              W := C1'</a>
  4823) <a name="l4823" style="background-color: #ffcccc">!</a>
  4824) <a name="l4824" style="background-color: #ffcccc">               DO 130 J = 1, K</a>
  4825) <a name="l4825" style="background-color: #ffcccc">                  CALL SCOPY( N, C( J, 1 ), LDC, WORK( 1, J ), 1 )</a>
  4826) <a name="l4826" style="background-color: #ffcccc">  130          CONTINUE</a>
  4827) <a name="l4827" style="background-color: #ffcccc">!</a>
  4828) <a name="l4828" style="background-color: #ffcccc">!              W := W * V1'</a>
  4829) <a name="l4829" style="background-color: #ffcccc">!</a>
  4830) <a name="l4830" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', 'Transpose', 'Unit', N, K, &amp;</a>
  4831) <a name="l4831" style="background-color: #ffcccc">                           ONE, V, LDV, WORK, LDWORK )</a>
  4832) <a name="l4832" style="background-color: #ffcccc">               IF( M.GT.K ) THEN</a>
  4833) <a name="l4833" style="background-color: #ffcccc">!</a>
  4834) <a name="l4834" style="background-color: #ffcccc">!                 W := W + C2'*V2'</a>
  4835) <a name="l4835" style="background-color: #ffcccc">!</a>
  4836) <a name="l4836" style="background-color: #ffcccc">                  CALL SGEMM( 'Transpose', 'Transpose', N, K, M-K, ONE, &amp;</a>
  4837) <a name="l4837" style="background-color: #ffcccc">                              C( K+1, 1 ), LDC, V( 1, K+1 ), LDV, ONE, &amp;</a>
  4838) <a name="l4838" style="background-color: #ffcccc">                              WORK, LDWORK )</a>
  4839) <a name="l4839" style="background-color: #ffcccc">               END IF</a>
  4840) <a name="l4840" style="background-color: #ffcccc">!</a>
  4841) <a name="l4841" style="background-color: #ffcccc">!              W := W * T'  or  W * T</a>
  4842) <a name="l4842" style="background-color: #ffcccc">!</a>
  4843) <a name="l4843" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', TRANST, 'Non-unit', N, K, &amp;</a>
  4844) <a name="l4844" style="background-color: #ffcccc">                           ONE, T, LDT, WORK, LDWORK )</a>
  4845) <a name="l4845" style="background-color: #ffcccc">!</a>
  4846) <a name="l4846" style="background-color: #ffcccc">!              C := C - V' * W'</a>
  4847) <a name="l4847" style="background-color: #ffcccc">!</a>
  4848) <a name="l4848" style="background-color: #ffcccc">               IF( M.GT.K ) THEN</a>
  4849) <a name="l4849" style="background-color: #ffcccc">!</a>
  4850) <a name="l4850" style="background-color: #ffcccc">!                 C2 := C2 - V2' * W'</a>
  4851) <a name="l4851" style="background-color: #ffcccc">!</a>
  4852) <a name="l4852" style="background-color: #ffcccc">                  CALL SGEMM( 'Transpose', 'Transpose', M-K, N, K, -ONE, &amp;</a>
  4853) <a name="l4853" style="background-color: #ffcccc">                              V( 1, K+1 ), LDV, WORK, LDWORK, ONE, &amp;</a>
  4854) <a name="l4854" style="background-color: #ffcccc">                              C( K+1, 1 ), LDC )</a>
  4855) <a name="l4855" style="background-color: #ffcccc">               END IF</a>
  4856) <a name="l4856" style="background-color: #ffcccc">!</a>
  4857) <a name="l4857" style="background-color: #ffcccc">!              W := W * V1</a>
  4858) <a name="l4858" style="background-color: #ffcccc">!</a>
  4859) <a name="l4859" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', 'No transpose', 'Unit', N, &amp;</a>
  4860) <a name="l4860" style="background-color: #ffcccc">                           K, ONE, V, LDV, WORK, LDWORK )</a>
  4861) <a name="l4861" style="background-color: #ffcccc">!</a>
  4862) <a name="l4862" style="background-color: #ffcccc">!              C1 := C1 - W'</a>
  4863) <a name="l4863" style="background-color: #ffcccc">!</a>
  4864) <a name="l4864" style="background-color: #ffcccc">               DO 150 J = 1, K</a>
  4865) <a name="l4865" style="background-color: #ffcccc">                  DO 140 I = 1, N</a>
  4866) <a name="l4866" style="background-color: #ffcccc">                     C( J, I ) = C( J, I ) - WORK( I, J )</a>
  4867) <a name="l4867" style="background-color: #ffcccc">  140             CONTINUE</a>
  4868) <a name="l4868" style="background-color: #ffcccc">  150          CONTINUE</a>
  4869) <a name="l4869" style="background-color: #ffcccc">!</a>
  4870) <a name="l4870" style="background-color: #ffcccc">            ELSE IF( LSAME( SIDE, 'R' ) ) THEN</a>
  4871) <a name="l4871" style="background-color: #ffcccc">!</a>
  4872) <a name="l4872" style="background-color: #ffcccc">!              Form  C * H  or  C * H'  where  C = ( C1  C2 )</a>
  4873) <a name="l4873" style="background-color: #ffcccc">!</a>
  4874) <a name="l4874" style="background-color: #ffcccc">!              W := C * V'  =  (C1*V1' + C2*V2')  (stored in WORK)</a>
  4875) <a name="l4875" style="background-color: #ffcccc">!</a>
  4876) <a name="l4876" style="background-color: #ffcccc">!              W := C1</a>
  4877) <a name="l4877" style="background-color: #ffcccc">!</a>
  4878) <a name="l4878" style="background-color: #ffcccc">               DO 160 J = 1, K</a>
  4879) <a name="l4879" style="background-color: #ffcccc">                  CALL SCOPY( M, C( 1, J ), 1, WORK( 1, J ), 1 )</a>
  4880) <a name="l4880" style="background-color: #ffcccc">  160          CONTINUE</a>
  4881) <a name="l4881" style="background-color: #ffcccc">!</a>
  4882) <a name="l4882" style="background-color: #ffcccc">!              W := W * V1'</a>
  4883) <a name="l4883" style="background-color: #ffcccc">!</a>
  4884) <a name="l4884" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', 'Transpose', 'Unit', M, K, &amp;</a>
  4885) <a name="l4885" style="background-color: #ffcccc">                           ONE, V, LDV, WORK, LDWORK )</a>
  4886) <a name="l4886" style="background-color: #ffcccc">               IF( N.GT.K ) THEN</a>
  4887) <a name="l4887" style="background-color: #ffcccc">!</a>
  4888) <a name="l4888" style="background-color: #ffcccc">!                 W := W + C2 * V2'</a>
  4889) <a name="l4889" style="background-color: #ffcccc">!</a>
  4890) <a name="l4890" style="background-color: #ffcccc">                  CALL SGEMM( 'No transpose', 'Transpose', M, K, N-K, &amp;</a>
  4891) <a name="l4891" style="background-color: #ffcccc">                              ONE, C( 1, K+1 ), LDC, V( 1, K+1 ), LDV, &amp;</a>
  4892) <a name="l4892" style="background-color: #ffcccc">                              ONE, WORK, LDWORK )</a>
  4893) <a name="l4893" style="background-color: #ffcccc">               END IF</a>
  4894) <a name="l4894" style="background-color: #ffcccc">!</a>
  4895) <a name="l4895" style="background-color: #ffcccc">!              W := W * T  or  W * T'</a>
  4896) <a name="l4896" style="background-color: #ffcccc">!</a>
  4897) <a name="l4897" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', TRANS, 'Non-unit', M, K, &amp;</a>
  4898) <a name="l4898" style="background-color: #ffcccc">                           ONE, T, LDT, WORK, LDWORK )</a>
  4899) <a name="l4899" style="background-color: #ffcccc">!</a>
  4900) <a name="l4900" style="background-color: #ffcccc">!              C := C - W * V</a>
  4901) <a name="l4901" style="background-color: #ffcccc">!</a>
  4902) <a name="l4902" style="background-color: #ffcccc">               IF( N.GT.K ) THEN</a>
  4903) <a name="l4903" style="background-color: #ffcccc">!</a>
  4904) <a name="l4904" style="background-color: #ffcccc">!                 C2 := C2 - W * V2</a>
  4905) <a name="l4905" style="background-color: #ffcccc">!</a>
  4906) <a name="l4906" style="background-color: #ffcccc">                  CALL SGEMM( 'No transpose', 'No transpose', M, N-K, K, &amp;</a>
  4907) <a name="l4907" style="background-color: #ffcccc">                              -ONE, WORK, LDWORK, V( 1, K+1 ), LDV, ONE, &amp;</a>
  4908) <a name="l4908" style="background-color: #ffcccc">                              C( 1, K+1 ), LDC )</a>
  4909) <a name="l4909" style="background-color: #ffcccc">               END IF</a>
  4910) <a name="l4910" style="background-color: #ffcccc">!</a>
  4911) <a name="l4911" style="background-color: #ffcccc">!              W := W * V1</a>
  4912) <a name="l4912" style="background-color: #ffcccc">!</a>
  4913) <a name="l4913" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Upper', 'No transpose', 'Unit', M, &amp;</a>
  4914) <a name="l4914" style="background-color: #ffcccc">                           K, ONE, V, LDV, WORK, LDWORK )</a>
  4915) <a name="l4915" style="background-color: #ffcccc">!</a>
  4916) <a name="l4916" style="background-color: #ffcccc">!              C1 := C1 - W</a>
  4917) <a name="l4917" style="background-color: #ffcccc">!</a>
  4918) <a name="l4918" style="background-color: #ffcccc">               DO 180 J = 1, K</a>
  4919) <a name="l4919" style="background-color: #ffcccc">                  DO 170 I = 1, M</a>
  4920) <a name="l4920" style="background-color: #ffcccc">                     C( I, J ) = C( I, J ) - WORK( I, J )</a>
  4921) <a name="l4921" style="background-color: #ffcccc">  170             CONTINUE</a>
  4922) <a name="l4922" style="background-color: #ffcccc">  180          CONTINUE</a>
  4923) <a name="l4923" style="background-color: #ffcccc">!</a>
  4924) <a name="l4924" style="background-color: #ffcccc">            END IF</a>
  4925) <a name="l4925" style="background-color: #ffcccc">!</a>
  4926) <a name="l4926" style="background-color: #ffcccc">         ELSE</a>
  4927) <a name="l4927" style="background-color: #ffcccc">!</a>
  4928) <a name="l4928" style="background-color: #ffcccc">!           Let  V =  ( V1  V2 )    (V2: last K columns)</a>
  4929) <a name="l4929" style="background-color: #ffcccc">!           where  V2  is unit lower triangular.</a>
  4930) <a name="l4930" style="background-color: #ffcccc">!</a>
  4931) <a name="l4931" style="background-color: #ffcccc">            IF( LSAME( SIDE, 'L' ) ) THEN</a>
  4932) <a name="l4932" style="background-color: #ffcccc">!</a>
  4933) <a name="l4933" style="background-color: #ffcccc">!              Form  H * C  or  H' * C  where  C = ( C1 )</a>
  4934) <a name="l4934" style="background-color: #ffcccc">!                                                  ( C2 )</a>
  4935) <a name="l4935" style="background-color: #ffcccc">!</a>
  4936) <a name="l4936" style="background-color: #ffcccc">!              W := C' * V'  =  (C1'*V1' + C2'*V2') (stored in WORK)</a>
  4937) <a name="l4937" style="background-color: #ffcccc">!</a>
  4938) <a name="l4938" style="background-color: #ffcccc">!              W := C2'</a>
  4939) <a name="l4939" style="background-color: #ffcccc">!</a>
  4940) <a name="l4940" style="background-color: #ffcccc">               DO 190 J = 1, K</a>
  4941) <a name="l4941" style="background-color: #ffcccc">                  CALL SCOPY( N, C( M-K+J, 1 ), LDC, WORK( 1, J ), 1 )</a>
  4942) <a name="l4942" style="background-color: #ffcccc">  190          CONTINUE</a>
  4943) <a name="l4943" style="background-color: #ffcccc">!</a>
  4944) <a name="l4944" style="background-color: #ffcccc">!              W := W * V2'</a>
  4945) <a name="l4945" style="background-color: #ffcccc">!</a>
  4946) <a name="l4946" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', 'Transpose', 'Unit', N, K, &amp;</a>
  4947) <a name="l4947" style="background-color: #ffcccc">                           ONE, V( 1, M-K+1 ), LDV, WORK, LDWORK )</a>
  4948) <a name="l4948" style="background-color: #ffcccc">               IF( M.GT.K ) THEN</a>
  4949) <a name="l4949" style="background-color: #ffcccc">!</a>
  4950) <a name="l4950" style="background-color: #ffcccc">!                 W := W + C1'*V1'</a>
  4951) <a name="l4951" style="background-color: #ffcccc">!</a>
  4952) <a name="l4952" style="background-color: #ffcccc">                  CALL SGEMM( 'Transpose', 'Transpose', N, K, M-K, ONE, &amp;</a>
  4953) <a name="l4953" style="background-color: #ffcccc">                              C, LDC, V, LDV, ONE, WORK, LDWORK )</a>
  4954) <a name="l4954" style="background-color: #ffcccc">               END IF</a>
  4955) <a name="l4955" style="background-color: #ffcccc">!</a>
  4956) <a name="l4956" style="background-color: #ffcccc">!              W := W * T'  or  W * T</a>
  4957) <a name="l4957" style="background-color: #ffcccc">!</a>
  4958) <a name="l4958" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', TRANST, 'Non-unit', N, K, &amp;</a>
  4959) <a name="l4959" style="background-color: #ffcccc">                           ONE, T, LDT, WORK, LDWORK )</a>
  4960) <a name="l4960" style="background-color: #ffcccc">!</a>
  4961) <a name="l4961" style="background-color: #ffcccc">!              C := C - V' * W'</a>
  4962) <a name="l4962" style="background-color: #ffcccc">!</a>
  4963) <a name="l4963" style="background-color: #ffcccc">               IF( M.GT.K ) THEN</a>
  4964) <a name="l4964" style="background-color: #ffcccc">!</a>
  4965) <a name="l4965" style="background-color: #ffcccc">!                 C1 := C1 - V1' * W'</a>
  4966) <a name="l4966" style="background-color: #ffcccc">!</a>
  4967) <a name="l4967" style="background-color: #ffcccc">                  CALL SGEMM( 'Transpose', 'Transpose', M-K, N, K, -ONE, &amp;</a>
  4968) <a name="l4968" style="background-color: #ffcccc">                              V, LDV, WORK, LDWORK, ONE, C, LDC )</a>
  4969) <a name="l4969" style="background-color: #ffcccc">               END IF</a>
  4970) <a name="l4970" style="background-color: #ffcccc">!</a>
  4971) <a name="l4971" style="background-color: #ffcccc">!              W := W * V2</a>
  4972) <a name="l4972" style="background-color: #ffcccc">!</a>
  4973) <a name="l4973" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', 'No transpose', 'Unit', N, &amp;</a>
  4974) <a name="l4974" style="background-color: #ffcccc">                           K, ONE, V( 1, M-K+1 ), LDV, WORK, LDWORK )</a>
  4975) <a name="l4975" style="background-color: #ffcccc">!</a>
  4976) <a name="l4976" style="background-color: #ffcccc">!              C2 := C2 - W'</a>
  4977) <a name="l4977" style="background-color: #ffcccc">!</a>
  4978) <a name="l4978" style="background-color: #ffcccc">               DO 210 J = 1, K</a>
  4979) <a name="l4979" style="background-color: #ffcccc">                  DO 200 I = 1, N</a>
  4980) <a name="l4980" style="background-color: #ffcccc">                     C( M-K+J, I ) = C( M-K+J, I ) - WORK( I, J )</a>
  4981) <a name="l4981" style="background-color: #ffcccc">  200             CONTINUE</a>
  4982) <a name="l4982" style="background-color: #ffcccc">  210          CONTINUE</a>
  4983) <a name="l4983" style="background-color: #ffcccc">!</a>
  4984) <a name="l4984" style="background-color: #ffcccc">            ELSE IF( LSAME( SIDE, 'R' ) ) THEN</a>
  4985) <a name="l4985" style="background-color: #ffcccc">!</a>
  4986) <a name="l4986" style="background-color: #ffcccc">!              Form  C * H  or  C * H'  where  C = ( C1  C2 )</a>
  4987) <a name="l4987" style="background-color: #ffcccc">!</a>
  4988) <a name="l4988" style="background-color: #ffcccc">!              W := C * V'  =  (C1*V1' + C2*V2')  (stored in WORK)</a>
  4989) <a name="l4989" style="background-color: #ffcccc">!</a>
  4990) <a name="l4990" style="background-color: #ffcccc">!              W := C2</a>
  4991) <a name="l4991" style="background-color: #ffcccc">!</a>
  4992) <a name="l4992" style="background-color: #ffcccc">               DO 220 J = 1, K</a>
  4993) <a name="l4993" style="background-color: #ffcccc">                  CALL SCOPY( M, C( 1, N-K+J ), 1, WORK( 1, J ), 1 )</a>
  4994) <a name="l4994" style="background-color: #ffcccc">  220          CONTINUE</a>
  4995) <a name="l4995" style="background-color: #ffcccc">!</a>
  4996) <a name="l4996" style="background-color: #ffcccc">!              W := W * V2'</a>
  4997) <a name="l4997" style="background-color: #ffcccc">!</a>
  4998) <a name="l4998" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', 'Transpose', 'Unit', M, K, &amp;</a>
  4999) <a name="l4999" style="background-color: #ffcccc">                           ONE, V( 1, N-K+1 ), LDV, WORK, LDWORK )</a>
  5000) <a name="l5000" style="background-color: #ffcccc">               IF( N.GT.K ) THEN</a>
  5001) <a name="l5001" style="background-color: #ffcccc">!</a>
  5002) <a name="l5002" style="background-color: #ffcccc">!                 W := W + C1 * V1'</a>
  5003) <a name="l5003" style="background-color: #ffcccc">!</a>
  5004) <a name="l5004" style="background-color: #ffcccc">                  CALL SGEMM( 'No transpose', 'Transpose', M, K, N-K, &amp;</a>
  5005) <a name="l5005" style="background-color: #ffcccc">                              ONE, C, LDC, V, LDV, ONE, WORK, LDWORK )</a>
  5006) <a name="l5006" style="background-color: #ffcccc">               END IF</a>
  5007) <a name="l5007" style="background-color: #ffcccc">!</a>
  5008) <a name="l5008" style="background-color: #ffcccc">!              W := W * T  or  W * T'</a>
  5009) <a name="l5009" style="background-color: #ffcccc">!</a>
  5010) <a name="l5010" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', TRANS, 'Non-unit', M, K, &amp;</a>
  5011) <a name="l5011" style="background-color: #ffcccc">                           ONE, T, LDT, WORK, LDWORK )</a>
  5012) <a name="l5012" style="background-color: #ffcccc">!</a>
  5013) <a name="l5013" style="background-color: #ffcccc">!              C := C - W * V</a>
  5014) <a name="l5014" style="background-color: #ffcccc">!</a>
  5015) <a name="l5015" style="background-color: #ffcccc">               IF( N.GT.K ) THEN</a>
  5016) <a name="l5016" style="background-color: #ffcccc">!</a>
  5017) <a name="l5017" style="background-color: #ffcccc">!                 C1 := C1 - W * V1</a>
  5018) <a name="l5018" style="background-color: #ffcccc">!</a>
  5019) <a name="l5019" style="background-color: #ffcccc">                  CALL SGEMM( 'No transpose', 'No transpose', M, N-K, K, &amp;</a>
  5020) <a name="l5020" style="background-color: #ffcccc">                              -ONE, WORK, LDWORK, V, LDV, ONE, C, LDC )</a>
  5021) <a name="l5021" style="background-color: #ffcccc">               END IF</a>
  5022) <a name="l5022" style="background-color: #ffcccc">!</a>
  5023) <a name="l5023" style="background-color: #ffcccc">!              W := W * V2</a>
  5024) <a name="l5024" style="background-color: #ffcccc">!</a>
  5025) <a name="l5025" style="background-color: #ffcccc">               CALL STRMM( 'Right', 'Lower', 'No transpose', 'Unit', M, &amp;</a>
  5026) <a name="l5026" style="background-color: #ffcccc">                           K, ONE, V( 1, N-K+1 ), LDV, WORK, LDWORK )</a>
  5027) <a name="l5027" style="background-color: #ffcccc">!</a>
  5028) <a name="l5028" style="background-color: #ffcccc">!              C1 := C1 - W</a>
  5029) <a name="l5029" style="background-color: #ffcccc">!</a>
  5030) <a name="l5030" style="background-color: #ffcccc">               DO 240 J = 1, K</a>
  5031) <a name="l5031" style="background-color: #ffcccc">                  DO 230 I = 1, M</a>
  5032) <a name="l5032" style="background-color: #ffcccc">                     C( I, N-K+J ) = C( I, N-K+J ) - WORK( I, J )</a>
  5033) <a name="l5033" style="background-color: #ffcccc">  230             CONTINUE</a>
  5034) <a name="l5034" style="background-color: #ffcccc">  240          CONTINUE</a>
  5035) <a name="l5035" style="background-color: #ffcccc">!</a>
  5036) <a name="l5036" style="background-color: #ffcccc">            END IF</a>
  5037) <a name="l5037" style="background-color: #ffcccc">!</a>
  5038) <a name="l5038" style="background-color: #ffcccc">         END IF</a>
  5039) <a name="l5039" style="background-color: #ffcccc">      END IF</a>
  5040) <a name="l5040" style="background-color: #ffcccc">!</a>
  5041) <a name="l5041" style="background-color: #ffcccc">      RETURN</a>
  5042) <a name="l5042" style="background-color: #ffcccc">!</a>
  5043) <a name="l5043" style="background-color: #ffcccc">!     End of SLARFB</a>
  5044) <a name="l5044" style="background-color: #ffcccc">!</a>
  5045) <a name="l5045" style="background-color: #ffcccc">      END SUBROUTINE SLARFB</a>
  5046) <a name="l5046" style="background-color: #ffffff"></a>
  5047) <a name="l5047" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  5048) <a name="l5048" style="background-color: #ffffff"></a>
  5049) <a name="l5049" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLARFG( N, ALPHA, X, INCX, TAU )</a>
  5050) <a name="l5050" style="background-color: #ffcccc"></a>
  5051) <a name="l5051" style="background-color: #ffcccc">!</a>
  5052) <a name="l5052" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  5053) <a name="l5053" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  5054) <a name="l5054" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  5055) <a name="l5055" style="background-color: #ffcccc">!     September 30, 1994</a>
  5056) <a name="l5056" style="background-color: #ffcccc">!</a>
  5057) <a name="l5057" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  5058) <a name="l5058" style="background-color: #ffcccc">      INTEGER            INCX, N</a>
  5059) <a name="l5059" style="background-color: #ffcccc">      REAL(r8)               ALPHA, TAU</a>
  5060) <a name="l5060" style="background-color: #ffcccc">!     ..</a>
  5061) <a name="l5061" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  5062) <a name="l5062" style="background-color: #ffcccc">      REAL(r8)               X( * )</a>
  5063) <a name="l5063" style="background-color: #ffcccc">!     ..</a>
  5064) <a name="l5064" style="background-color: #ffcccc">!</a>
  5065) <a name="l5065" style="background-color: #ffcccc">!  Purpose</a>
  5066) <a name="l5066" style="background-color: #ffcccc">!  =======</a>
  5067) <a name="l5067" style="background-color: #ffcccc">!</a>
  5068) <a name="l5068" style="background-color: #ffcccc">!  SLARFG generates a real elementary reflector H of order n, such</a>
  5069) <a name="l5069" style="background-color: #ffcccc">!  that</a>
  5070) <a name="l5070" style="background-color: #ffcccc">!</a>
  5071) <a name="l5071" style="background-color: #ffcccc">!        H * ( alpha ) = ( beta ),   H' * H = I.</a>
  5072) <a name="l5072" style="background-color: #ffcccc">!            (   x   )   (   0  )</a>
  5073) <a name="l5073" style="background-color: #ffcccc">!</a>
  5074) <a name="l5074" style="background-color: #ffcccc">!  where alpha and beta are scalars, and x is an (n-1)-element real</a>
  5075) <a name="l5075" style="background-color: #ffcccc">!  vector. H is represented in the form</a>
  5076) <a name="l5076" style="background-color: #ffcccc">!</a>
  5077) <a name="l5077" style="background-color: #ffcccc">!        H = I - tau * ( 1 ) * ( 1 v' ) ,</a>
  5078) <a name="l5078" style="background-color: #ffcccc">!                      ( v )</a>
  5079) <a name="l5079" style="background-color: #ffcccc">!</a>
  5080) <a name="l5080" style="background-color: #ffcccc">!  where tau is a real scalar and v is a real (n-1)-element</a>
  5081) <a name="l5081" style="background-color: #ffcccc">!  vector.</a>
  5082) <a name="l5082" style="background-color: #ffcccc">!</a>
  5083) <a name="l5083" style="background-color: #ffcccc">!  If the elements of x are all zero, then tau = 0 and H is taken to be</a>
  5084) <a name="l5084" style="background-color: #ffcccc">!  the unit matrix.</a>
  5085) <a name="l5085" style="background-color: #ffcccc">!</a>
  5086) <a name="l5086" style="background-color: #ffcccc">!  Otherwise  1 &lt;= tau &lt;= 2.</a>
  5087) <a name="l5087" style="background-color: #ffcccc">!</a>
  5088) <a name="l5088" style="background-color: #ffcccc">!  Arguments</a>
  5089) <a name="l5089" style="background-color: #ffcccc">!  =========</a>
  5090) <a name="l5090" style="background-color: #ffcccc">!</a>
  5091) <a name="l5091" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  5092) <a name="l5092" style="background-color: #ffcccc">!          The order of the elementary reflector.</a>
  5093) <a name="l5093" style="background-color: #ffcccc">!</a>
  5094) <a name="l5094" style="background-color: #ffcccc">!  ALPHA   (input/output) REAL</a>
  5095) <a name="l5095" style="background-color: #ffcccc">!          On entry, the value alpha.</a>
  5096) <a name="l5096" style="background-color: #ffcccc">!          On exit, it is overwritten with the value beta.</a>
  5097) <a name="l5097" style="background-color: #ffcccc">!</a>
  5098) <a name="l5098" style="background-color: #ffcccc">!  X       (input/output) REAL array, dimension</a>
  5099) <a name="l5099" style="background-color: #ffcccc">!                         (1+(N-2)*abs(INCX))</a>
  5100) <a name="l5100" style="background-color: #ffcccc">!          On entry, the vector x.</a>
  5101) <a name="l5101" style="background-color: #ffcccc">!          On exit, it is overwritten with the vector v.</a>
  5102) <a name="l5102" style="background-color: #ffcccc">!</a>
  5103) <a name="l5103" style="background-color: #ffcccc">!  INCX    (input) INTEGER</a>
  5104) <a name="l5104" style="background-color: #ffcccc">!          The increment between elements of X. INCX &gt; 0.</a>
  5105) <a name="l5105" style="background-color: #ffcccc">!</a>
  5106) <a name="l5106" style="background-color: #ffcccc">!  TAU     (output) REAL</a>
  5107) <a name="l5107" style="background-color: #ffcccc">!          The value tau.</a>
  5108) <a name="l5108" style="background-color: #ffcccc">!</a>
  5109) <a name="l5109" style="background-color: #ffcccc">!  =====================================================================</a>
  5110) <a name="l5110" style="background-color: #ffcccc">!</a>
  5111) <a name="l5111" style="background-color: #ffcccc">!     .. Parameters ..</a>
  5112) <a name="l5112" style="background-color: #ffcccc">      REAL(r8)               ONE, ZERO</a>
  5113) <a name="l5113" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
  5114) <a name="l5114" style="background-color: #ffcccc">!     ..</a>
  5115) <a name="l5115" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  5116) <a name="l5116" style="background-color: #ffcccc">      INTEGER            J, KNT</a>
  5117) <a name="l5117" style="background-color: #ffcccc">      REAL(r8)               BETA, RSAFMN, SAFMIN, XNORM</a>
  5118) <a name="l5118" style="background-color: #ffcccc">!     ..</a>
  5119) <a name="l5119" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  5120) <a name="l5120" style="background-color: #ffcccc">!</a>
  5121) <a name="l5121" style="background-color: #ffcccc">      IF( N.LE.1 ) THEN</a>
  5122) <a name="l5122" style="background-color: #ffcccc">         TAU = ZERO</a>
  5123) <a name="l5123" style="background-color: #ffcccc">         RETURN</a>
  5124) <a name="l5124" style="background-color: #ffcccc">      END IF</a>
  5125) <a name="l5125" style="background-color: #ffcccc">!</a>
  5126) <a name="l5126" style="background-color: #ffcccc">      XNORM = SNRM2( N-1, X, INCX )</a>
  5127) <a name="l5127" style="background-color: #ffcccc">!</a>
  5128) <a name="l5128" style="background-color: #ffcccc">      IF( XNORM.EQ.ZERO ) THEN</a>
  5129) <a name="l5129" style="background-color: #ffcccc">!</a>
  5130) <a name="l5130" style="background-color: #ffcccc">!        H  =  I</a>
  5131) <a name="l5131" style="background-color: #ffcccc">!</a>
  5132) <a name="l5132" style="background-color: #ffcccc">         TAU = ZERO</a>
  5133) <a name="l5133" style="background-color: #ffcccc">      ELSE</a>
  5134) <a name="l5134" style="background-color: #ffcccc">!</a>
  5135) <a name="l5135" style="background-color: #ffcccc">!        general case</a>
  5136) <a name="l5136" style="background-color: #ffcccc">!</a>
  5137) <a name="l5137" style="background-color: #ffcccc">         BETA = -SIGN( SLAPY2( ALPHA, XNORM ), ALPHA )</a>
  5138) <a name="l5138" style="background-color: #ffcccc">         SAFMIN = SLAMCH( 'S' ) / SLAMCH( 'E' )</a>
  5139) <a name="l5139" style="background-color: #ffcccc">         IF( ABS( BETA ).LT.SAFMIN ) THEN</a>
  5140) <a name="l5140" style="background-color: #ffcccc">!</a>
  5141) <a name="l5141" style="background-color: #ffcccc">!           XNORM, BETA may be inaccurate; scale X and recompute them</a>
  5142) <a name="l5142" style="background-color: #ffcccc">!</a>
  5143) <a name="l5143" style="background-color: #ffcccc">            RSAFMN = ONE / SAFMIN</a>
  5144) <a name="l5144" style="background-color: #ffcccc">            KNT = 0</a>
  5145) <a name="l5145" style="background-color: #ffcccc">   10       CONTINUE</a>
  5146) <a name="l5146" style="background-color: #ffcccc">            KNT = KNT + 1</a>
  5147) <a name="l5147" style="background-color: #ffcccc">            CALL SSCAL( N-1, RSAFMN, X, INCX )</a>
  5148) <a name="l5148" style="background-color: #ffcccc">            BETA = BETA*RSAFMN</a>
  5149) <a name="l5149" style="background-color: #ffcccc">            ALPHA = ALPHA*RSAFMN</a>
  5150) <a name="l5150" style="background-color: #ffcccc">            IF( ABS( BETA ).LT.SAFMIN ) &amp;</a>
  5151) <a name="l5151" style="background-color: #ffcccc">               GO TO 10</a>
  5152) <a name="l5152" style="background-color: #ffcccc">!</a>
  5153) <a name="l5153" style="background-color: #ffcccc">!           New BETA is at most 1, at least SAFMIN</a>
  5154) <a name="l5154" style="background-color: #ffcccc">!</a>
  5155) <a name="l5155" style="background-color: #ffcccc">            XNORM = SNRM2( N-1, X, INCX )</a>
  5156) <a name="l5156" style="background-color: #ffcccc">            BETA = -SIGN( SLAPY2( ALPHA, XNORM ), ALPHA )</a>
  5157) <a name="l5157" style="background-color: #ffcccc">            TAU = ( BETA-ALPHA ) / BETA</a>
  5158) <a name="l5158" style="background-color: #ffcccc">            CALL SSCAL( N-1, ONE / ( ALPHA-BETA ), X, INCX )</a>
  5159) <a name="l5159" style="background-color: #ffcccc">!</a>
  5160) <a name="l5160" style="background-color: #ffcccc">!           If ALPHA is subnormal, it may lose relative accuracy</a>
  5161) <a name="l5161" style="background-color: #ffcccc">!</a>
  5162) <a name="l5162" style="background-color: #ffcccc">            ALPHA = BETA</a>
  5163) <a name="l5163" style="background-color: #ffcccc">            DO 20 J = 1, KNT</a>
  5164) <a name="l5164" style="background-color: #ffcccc">               ALPHA = ALPHA*SAFMIN</a>
  5165) <a name="l5165" style="background-color: #ffcccc">   20       CONTINUE</a>
  5166) <a name="l5166" style="background-color: #ffcccc">         ELSE</a>
  5167) <a name="l5167" style="background-color: #ffcccc">            TAU = ( BETA-ALPHA ) / BETA</a>
  5168) <a name="l5168" style="background-color: #ffcccc">            CALL SSCAL( N-1, ONE / ( ALPHA-BETA ), X, INCX )</a>
  5169) <a name="l5169" style="background-color: #ffcccc">            ALPHA = BETA</a>
  5170) <a name="l5170" style="background-color: #ffcccc">         END IF</a>
  5171) <a name="l5171" style="background-color: #ffcccc">      END IF</a>
  5172) <a name="l5172" style="background-color: #ffcccc">!</a>
  5173) <a name="l5173" style="background-color: #ffcccc">      RETURN</a>
  5174) <a name="l5174" style="background-color: #ffcccc">!</a>
  5175) <a name="l5175" style="background-color: #ffcccc">!     End of SLARFG</a>
  5176) <a name="l5176" style="background-color: #ffcccc">!</a>
  5177) <a name="l5177" style="background-color: #ffcccc">      END SUBROUTINE SLARFG</a>
  5178) <a name="l5178" style="background-color: #ffffff"></a>
  5179) <a name="l5179" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  5180) <a name="l5180" style="background-color: #ffffff"></a>
  5181) <a name="l5181" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLARFT( DIRECT, STOREV, N, K, V, LDV, TAU, T, LDT )</a>
  5182) <a name="l5182" style="background-color: #ffcccc"></a>
  5183) <a name="l5183" style="background-color: #ffcccc">!</a>
  5184) <a name="l5184" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  5185) <a name="l5185" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  5186) <a name="l5186" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  5187) <a name="l5187" style="background-color: #ffcccc">!     February 29, 1992</a>
  5188) <a name="l5188" style="background-color: #ffcccc">!</a>
  5189) <a name="l5189" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  5190) <a name="l5190" style="background-color: #ffcccc">      CHARACTER          DIRECT, STOREV</a>
  5191) <a name="l5191" style="background-color: #ffcccc">      INTEGER            K, LDT, LDV, N</a>
  5192) <a name="l5192" style="background-color: #ffcccc">!     ..</a>
  5193) <a name="l5193" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  5194) <a name="l5194" style="background-color: #ffcccc">      REAL(r8)               T( LDT, * ), TAU( * ), V( LDV, * )</a>
  5195) <a name="l5195" style="background-color: #ffcccc">!     ..</a>
  5196) <a name="l5196" style="background-color: #ffcccc">!</a>
  5197) <a name="l5197" style="background-color: #ffcccc">!  Purpose</a>
  5198) <a name="l5198" style="background-color: #ffcccc">!  =======</a>
  5199) <a name="l5199" style="background-color: #ffcccc">!</a>
  5200) <a name="l5200" style="background-color: #ffcccc">!  SLARFT forms the triangular factor T of a real block reflector H</a>
  5201) <a name="l5201" style="background-color: #ffcccc">!  of order n, which is defined as a product of k elementary reflectors.</a>
  5202) <a name="l5202" style="background-color: #ffcccc">!</a>
  5203) <a name="l5203" style="background-color: #ffcccc">!  If DIRECT = 'F', H = H(1) H(2) . . . H(k) and T is upper triangular;</a>
  5204) <a name="l5204" style="background-color: #ffcccc">!</a>
  5205) <a name="l5205" style="background-color: #ffcccc">!  If DIRECT = 'B', H = H(k) . . . H(2) H(1) and T is lower triangular.</a>
  5206) <a name="l5206" style="background-color: #ffcccc">!</a>
  5207) <a name="l5207" style="background-color: #ffcccc">!  If STOREV = 'C', the vector which defines the elementary reflector</a>
  5208) <a name="l5208" style="background-color: #ffcccc">!  H(i) is stored in the i-th column of the array V, and</a>
  5209) <a name="l5209" style="background-color: #ffcccc">!</a>
  5210) <a name="l5210" style="background-color: #ffcccc">!     H  =  I - V * T * V'</a>
  5211) <a name="l5211" style="background-color: #ffcccc">!</a>
  5212) <a name="l5212" style="background-color: #ffcccc">!  If STOREV = 'R', the vector which defines the elementary reflector</a>
  5213) <a name="l5213" style="background-color: #ffcccc">!  H(i) is stored in the i-th row of the array V, and</a>
  5214) <a name="l5214" style="background-color: #ffcccc">!</a>
  5215) <a name="l5215" style="background-color: #ffcccc">!     H  =  I - V' * T * V</a>
  5216) <a name="l5216" style="background-color: #ffcccc">!</a>
  5217) <a name="l5217" style="background-color: #ffcccc">!  Arguments</a>
  5218) <a name="l5218" style="background-color: #ffcccc">!  =========</a>
  5219) <a name="l5219" style="background-color: #ffcccc">!</a>
  5220) <a name="l5220" style="background-color: #ffcccc">!  DIRECT  (input) CHARACTER*1</a>
  5221) <a name="l5221" style="background-color: #ffcccc">!          Specifies the order in which the elementary reflectors are</a>
  5222) <a name="l5222" style="background-color: #ffcccc">!          multiplied to form the block reflector:</a>
  5223) <a name="l5223" style="background-color: #ffcccc">!          = 'F': H = H(1) H(2) . . . H(k) (Forward)</a>
  5224) <a name="l5224" style="background-color: #ffcccc">!          = 'B': H = H(k) . . . H(2) H(1) (Backward)</a>
  5225) <a name="l5225" style="background-color: #ffcccc">!</a>
  5226) <a name="l5226" style="background-color: #ffcccc">!  STOREV  (input) CHARACTER*1</a>
  5227) <a name="l5227" style="background-color: #ffcccc">!          Specifies how the vectors which define the elementary</a>
  5228) <a name="l5228" style="background-color: #ffcccc">!          reflectors are stored (see also Further Details):</a>
  5229) <a name="l5229" style="background-color: #ffcccc">!          = 'C': columnwise</a>
  5230) <a name="l5230" style="background-color: #ffcccc">!          = 'R': rowwise</a>
  5231) <a name="l5231" style="background-color: #ffcccc">!</a>
  5232) <a name="l5232" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  5233) <a name="l5233" style="background-color: #ffcccc">!          The order of the block reflector H. N &gt;= 0.</a>
  5234) <a name="l5234" style="background-color: #ffcccc">!</a>
  5235) <a name="l5235" style="background-color: #ffcccc">!  K       (input) INTEGER</a>
  5236) <a name="l5236" style="background-color: #ffcccc">!          The order of the triangular factor T (= the number of</a>
  5237) <a name="l5237" style="background-color: #ffcccc">!          elementary reflectors). K &gt;= 1.</a>
  5238) <a name="l5238" style="background-color: #ffcccc">!</a>
  5239) <a name="l5239" style="background-color: #ffcccc">!  V       (input/output) REAL array, dimension</a>
  5240) <a name="l5240" style="background-color: #ffcccc">!                               (LDV,K) if STOREV = 'C'</a>
  5241) <a name="l5241" style="background-color: #ffcccc">!                               (LDV,N) if STOREV = 'R'</a>
  5242) <a name="l5242" style="background-color: #ffcccc">!          The matrix V. See further details.</a>
  5243) <a name="l5243" style="background-color: #ffcccc">!</a>
  5244) <a name="l5244" style="background-color: #ffcccc">!  LDV     (input) INTEGER</a>
  5245) <a name="l5245" style="background-color: #ffcccc">!          The leading dimension of the array V.</a>
  5246) <a name="l5246" style="background-color: #ffcccc">!          If STOREV = 'C', LDV &gt;= max(1,N); if STOREV = 'R', LDV &gt;= K.</a>
  5247) <a name="l5247" style="background-color: #ffcccc">!</a>
  5248) <a name="l5248" style="background-color: #ffcccc">!  TAU     (input) REAL array, dimension (K)</a>
  5249) <a name="l5249" style="background-color: #ffcccc">!          TAU(i) must contain the scalar factor of the elementary</a>
  5250) <a name="l5250" style="background-color: #ffcccc">!          reflector H(i).</a>
  5251) <a name="l5251" style="background-color: #ffcccc">!</a>
  5252) <a name="l5252" style="background-color: #ffcccc">!  T       (output) REAL array, dimension (LDT,K)</a>
  5253) <a name="l5253" style="background-color: #ffcccc">!          The k by k triangular factor T of the block reflector.</a>
  5254) <a name="l5254" style="background-color: #ffcccc">!          If DIRECT = 'F', T is upper triangular; if DIRECT = 'B', T is</a>
  5255) <a name="l5255" style="background-color: #ffcccc">!          lower triangular. The rest of the array is not used.</a>
  5256) <a name="l5256" style="background-color: #ffcccc">!</a>
  5257) <a name="l5257" style="background-color: #ffcccc">!  LDT     (input) INTEGER</a>
  5258) <a name="l5258" style="background-color: #ffcccc">!          The leading dimension of the array T. LDT &gt;= K.</a>
  5259) <a name="l5259" style="background-color: #ffcccc">!</a>
  5260) <a name="l5260" style="background-color: #ffcccc">!  Further Details</a>
  5261) <a name="l5261" style="background-color: #ffcccc">!  ===============</a>
  5262) <a name="l5262" style="background-color: #ffcccc">!</a>
  5263) <a name="l5263" style="background-color: #ffcccc">!  The shape of the matrix V and the storage of the vectors which define</a>
  5264) <a name="l5264" style="background-color: #ffcccc">!  the H(i) is best illustrated by the following example with n = 5 and</a>
  5265) <a name="l5265" style="background-color: #ffcccc">!  k = 3. The elements equal to 1 are not stored; the corresponding</a>
  5266) <a name="l5266" style="background-color: #ffcccc">!  array elements are modified but restored on exit. The rest of the</a>
  5267) <a name="l5267" style="background-color: #ffcccc">!  array is not used.</a>
  5268) <a name="l5268" style="background-color: #ffcccc">!</a>
  5269) <a name="l5269" style="background-color: #ffcccc">!  DIRECT = 'F' and STOREV = 'C':         DIRECT = 'F' and STOREV = 'R':</a>
  5270) <a name="l5270" style="background-color: #ffcccc">!</a>
  5271) <a name="l5271" style="background-color: #ffcccc">!               V = (  1       )                 V = (  1 v1 v1 v1 v1 )</a>
  5272) <a name="l5272" style="background-color: #ffcccc">!                   ( v1  1    )                     (     1 v2 v2 v2 )</a>
  5273) <a name="l5273" style="background-color: #ffcccc">!                   ( v1 v2  1 )                     (        1 v3 v3 )</a>
  5274) <a name="l5274" style="background-color: #ffcccc">!                   ( v1 v2 v3 )</a>
  5275) <a name="l5275" style="background-color: #ffcccc">!                   ( v1 v2 v3 )</a>
  5276) <a name="l5276" style="background-color: #ffcccc">!</a>
  5277) <a name="l5277" style="background-color: #ffcccc">!  DIRECT = 'B' and STOREV = 'C':         DIRECT = 'B' and STOREV = 'R':</a>
  5278) <a name="l5278" style="background-color: #ffcccc">!</a>
  5279) <a name="l5279" style="background-color: #ffcccc">!               V = ( v1 v2 v3 )                 V = ( v1 v1  1       )</a>
  5280) <a name="l5280" style="background-color: #ffcccc">!                   ( v1 v2 v3 )                     ( v2 v2 v2  1    )</a>
  5281) <a name="l5281" style="background-color: #ffcccc">!                   (  1 v2 v3 )                     ( v3 v3 v3 v3  1 )</a>
  5282) <a name="l5282" style="background-color: #ffcccc">!                   (     1 v3 )</a>
  5283) <a name="l5283" style="background-color: #ffcccc">!                   (        1 )</a>
  5284) <a name="l5284" style="background-color: #ffcccc">!</a>
  5285) <a name="l5285" style="background-color: #ffcccc">!  =====================================================================</a>
  5286) <a name="l5286" style="background-color: #ffcccc">!</a>
  5287) <a name="l5287" style="background-color: #ffcccc">!     .. Parameters ..</a>
  5288) <a name="l5288" style="background-color: #ffcccc">      REAL(r8)               ONE, ZERO</a>
  5289) <a name="l5289" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
  5290) <a name="l5290" style="background-color: #ffcccc">!     ..</a>
  5291) <a name="l5291" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  5292) <a name="l5292" style="background-color: #ffcccc">      INTEGER            I, J</a>
  5293) <a name="l5293" style="background-color: #ffcccc">      REAL(r8)               VII</a>
  5294) <a name="l5294" style="background-color: #ffcccc">!     ..</a>
  5295) <a name="l5295" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  5296) <a name="l5296" style="background-color: #ffcccc">!</a>
  5297) <a name="l5297" style="background-color: #ffcccc">!     Quick return if possible</a>
  5298) <a name="l5298" style="background-color: #ffcccc">!</a>
  5299) <a name="l5299" style="background-color: #ffcccc">      IF( N.EQ.0 ) &amp;</a>
  5300) <a name="l5300" style="background-color: #ffcccc">         RETURN</a>
  5301) <a name="l5301" style="background-color: #ffcccc">!</a>
  5302) <a name="l5302" style="background-color: #ffcccc">      IF( LSAME( DIRECT, 'F' ) ) THEN</a>
  5303) <a name="l5303" style="background-color: #ffcccc">         DO 20 I = 1, K</a>
  5304) <a name="l5304" style="background-color: #ffcccc">            IF( TAU( I ).EQ.ZERO ) THEN</a>
  5305) <a name="l5305" style="background-color: #ffcccc">!</a>
  5306) <a name="l5306" style="background-color: #ffcccc">!              H(i)  =  I</a>
  5307) <a name="l5307" style="background-color: #ffcccc">!</a>
  5308) <a name="l5308" style="background-color: #ffcccc">               DO 10 J = 1, I</a>
  5309) <a name="l5309" style="background-color: #ffcccc">                  T( J, I ) = ZERO</a>
  5310) <a name="l5310" style="background-color: #ffcccc">   10          CONTINUE</a>
  5311) <a name="l5311" style="background-color: #ffcccc">            ELSE</a>
  5312) <a name="l5312" style="background-color: #ffcccc">!</a>
  5313) <a name="l5313" style="background-color: #ffcccc">!              general case</a>
  5314) <a name="l5314" style="background-color: #ffcccc">!</a>
  5315) <a name="l5315" style="background-color: #ffcccc">               VII = V( I, I )</a>
  5316) <a name="l5316" style="background-color: #ffcccc">               V( I, I ) = ONE</a>
  5317) <a name="l5317" style="background-color: #ffcccc">               IF( LSAME( STOREV, 'C' ) ) THEN</a>
  5318) <a name="l5318" style="background-color: #ffcccc">!</a>
  5319) <a name="l5319" style="background-color: #ffcccc">!                 T(1:i-1,i) := - tau(i) * V(i:n,1:i-1)' * V(i:n,i)</a>
  5320) <a name="l5320" style="background-color: #ffcccc">!</a>
  5321) <a name="l5321" style="background-color: #ffcccc">                  CALL SGEMV( 'Transpose', N-I+1, I-1, -TAU( I ), &amp;</a>
  5322) <a name="l5322" style="background-color: #ffcccc">                              V( I, 1 ), LDV, V( I, I ), 1, ZERO, &amp;</a>
  5323) <a name="l5323" style="background-color: #ffcccc">                              T( 1, I ), 1 )</a>
  5324) <a name="l5324" style="background-color: #ffcccc">               ELSE</a>
  5325) <a name="l5325" style="background-color: #ffcccc">!</a>
  5326) <a name="l5326" style="background-color: #ffcccc">!                 T(1:i-1,i) := - tau(i) * V(1:i-1,i:n) * V(i,i:n)'</a>
  5327) <a name="l5327" style="background-color: #ffcccc">!</a>
  5328) <a name="l5328" style="background-color: #ffcccc">                  CALL SGEMV( 'No transpose', I-1, N-I+1, -TAU( I ), &amp;</a>
  5329) <a name="l5329" style="background-color: #ffcccc">                              V( 1, I ), LDV, V( I, I ), LDV, ZERO, &amp;</a>
  5330) <a name="l5330" style="background-color: #ffcccc">                              T( 1, I ), 1 )</a>
  5331) <a name="l5331" style="background-color: #ffcccc">               END IF</a>
  5332) <a name="l5332" style="background-color: #ffcccc">               V( I, I ) = VII</a>
  5333) <a name="l5333" style="background-color: #ffcccc">!</a>
  5334) <a name="l5334" style="background-color: #ffcccc">!              T(1:i-1,i) := T(1:i-1,1:i-1) * T(1:i-1,i)</a>
  5335) <a name="l5335" style="background-color: #ffcccc">!</a>
  5336) <a name="l5336" style="background-color: #ffcccc">               CALL STRMV( 'Upper', 'No transpose', 'Non-unit', I-1, T, &amp;</a>
  5337) <a name="l5337" style="background-color: #ffcccc">                           LDT, T( 1, I ), 1 )</a>
  5338) <a name="l5338" style="background-color: #ffcccc">               T( I, I ) = TAU( I )</a>
  5339) <a name="l5339" style="background-color: #ffcccc">            END IF</a>
  5340) <a name="l5340" style="background-color: #ffcccc">   20    CONTINUE</a>
  5341) <a name="l5341" style="background-color: #ffcccc">      ELSE</a>
  5342) <a name="l5342" style="background-color: #ffcccc">         DO 40 I = K, 1, -1</a>
  5343) <a name="l5343" style="background-color: #ffcccc">            IF( TAU( I ).EQ.ZERO ) THEN</a>
  5344) <a name="l5344" style="background-color: #ffcccc">!</a>
  5345) <a name="l5345" style="background-color: #ffcccc">!              H(i)  =  I</a>
  5346) <a name="l5346" style="background-color: #ffcccc">!</a>
  5347) <a name="l5347" style="background-color: #ffcccc">               DO 30 J = I, K</a>
  5348) <a name="l5348" style="background-color: #ffcccc">                  T( J, I ) = ZERO</a>
  5349) <a name="l5349" style="background-color: #ffcccc">   30          CONTINUE</a>
  5350) <a name="l5350" style="background-color: #ffcccc">            ELSE</a>
  5351) <a name="l5351" style="background-color: #ffcccc">!</a>
  5352) <a name="l5352" style="background-color: #ffcccc">!              general case</a>
  5353) <a name="l5353" style="background-color: #ffcccc">!</a>
  5354) <a name="l5354" style="background-color: #ffcccc">               IF( I.LT.K ) THEN</a>
  5355) <a name="l5355" style="background-color: #ffcccc">                  IF( LSAME( STOREV, 'C' ) ) THEN</a>
  5356) <a name="l5356" style="background-color: #ffcccc">                     VII = V( N-K+I, I )</a>
  5357) <a name="l5357" style="background-color: #ffcccc">                     V( N-K+I, I ) = ONE</a>
  5358) <a name="l5358" style="background-color: #ffcccc">!</a>
  5359) <a name="l5359" style="background-color: #ffcccc">!                    T(i+1:k,i) :=</a>
  5360) <a name="l5360" style="background-color: #ffcccc">!                            - tau(i) * V(1:n-k+i,i+1:k)' * V(1:n-k+i,i)</a>
  5361) <a name="l5361" style="background-color: #ffcccc">!</a>
  5362) <a name="l5362" style="background-color: #ffcccc">                     CALL SGEMV( 'Transpose', N-K+I, K-I, -TAU( I ), &amp;</a>
  5363) <a name="l5363" style="background-color: #ffcccc">                                 V( 1, I+1 ), LDV, V( 1, I ), 1, ZERO, &amp;</a>
  5364) <a name="l5364" style="background-color: #ffcccc">                                 T( I+1, I ), 1 )</a>
  5365) <a name="l5365" style="background-color: #ffcccc">                     V( N-K+I, I ) = VII</a>
  5366) <a name="l5366" style="background-color: #ffcccc">                  ELSE</a>
  5367) <a name="l5367" style="background-color: #ffcccc">                     VII = V( I, N-K+I )</a>
  5368) <a name="l5368" style="background-color: #ffcccc">                     V( I, N-K+I ) = ONE</a>
  5369) <a name="l5369" style="background-color: #ffcccc">!</a>
  5370) <a name="l5370" style="background-color: #ffcccc">!                    T(i+1:k,i) :=</a>
  5371) <a name="l5371" style="background-color: #ffcccc">!                            - tau(i) * V(i+1:k,1:n-k+i) * V(i,1:n-k+i)'</a>
  5372) <a name="l5372" style="background-color: #ffcccc">!</a>
  5373) <a name="l5373" style="background-color: #ffcccc">                     CALL SGEMV( 'No transpose', K-I, N-K+I, -TAU( I ), &amp;</a>
  5374) <a name="l5374" style="background-color: #ffcccc">                                 V( I+1, 1 ), LDV, V( I, 1 ), LDV, ZERO, &amp;</a>
  5375) <a name="l5375" style="background-color: #ffcccc">                                 T( I+1, I ), 1 )</a>
  5376) <a name="l5376" style="background-color: #ffcccc">                     V( I, N-K+I ) = VII</a>
  5377) <a name="l5377" style="background-color: #ffcccc">                  END IF</a>
  5378) <a name="l5378" style="background-color: #ffcccc">!</a>
  5379) <a name="l5379" style="background-color: #ffcccc">!                 T(i+1:k,i) := T(i+1:k,i+1:k) * T(i+1:k,i)</a>
  5380) <a name="l5380" style="background-color: #ffcccc">!</a>
  5381) <a name="l5381" style="background-color: #ffcccc">                  CALL STRMV( 'Lower', 'No transpose', 'Non-unit', K-I, &amp;</a>
  5382) <a name="l5382" style="background-color: #ffcccc">                              T( I+1, I+1 ), LDT, T( I+1, I ), 1 )</a>
  5383) <a name="l5383" style="background-color: #ffcccc">               END IF</a>
  5384) <a name="l5384" style="background-color: #ffcccc">               T( I, I ) = TAU( I )</a>
  5385) <a name="l5385" style="background-color: #ffcccc">            END IF</a>
  5386) <a name="l5386" style="background-color: #ffcccc">   40    CONTINUE</a>
  5387) <a name="l5387" style="background-color: #ffcccc">      END IF</a>
  5388) <a name="l5388" style="background-color: #ffcccc">      RETURN</a>
  5389) <a name="l5389" style="background-color: #ffcccc">!</a>
  5390) <a name="l5390" style="background-color: #ffcccc">!     End of SLARFT</a>
  5391) <a name="l5391" style="background-color: #ffcccc">!</a>
  5392) <a name="l5392" style="background-color: #ffcccc">      END SUBROUTINE SLARFT</a>
  5393) <a name="l5393" style="background-color: #ffffff"></a>
  5394) <a name="l5394" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  5395) <a name="l5395" style="background-color: #ffffff"></a>
  5396) <a name="l5396" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLARFX( SIDE, M, N, V, TAU, C, LDC, WORK )</a>
  5397) <a name="l5397" style="background-color: #ffcccc"></a>
  5398) <a name="l5398" style="background-color: #ffcccc">!</a>
  5399) <a name="l5399" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  5400) <a name="l5400" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  5401) <a name="l5401" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  5402) <a name="l5402" style="background-color: #ffcccc">!     February 29, 1992</a>
  5403) <a name="l5403" style="background-color: #ffcccc">!</a>
  5404) <a name="l5404" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  5405) <a name="l5405" style="background-color: #ffcccc">      CHARACTER          SIDE</a>
  5406) <a name="l5406" style="background-color: #ffcccc">      INTEGER            LDC, M, N</a>
  5407) <a name="l5407" style="background-color: #ffcccc">      REAL(r8)               TAU</a>
  5408) <a name="l5408" style="background-color: #ffcccc">!     ..</a>
  5409) <a name="l5409" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  5410) <a name="l5410" style="background-color: #ffcccc">      REAL(r8)               C( LDC, * ), V( * ), WORK( * )</a>
  5411) <a name="l5411" style="background-color: #ffcccc">!     ..</a>
  5412) <a name="l5412" style="background-color: #ffcccc">!</a>
  5413) <a name="l5413" style="background-color: #ffcccc">!  Purpose</a>
  5414) <a name="l5414" style="background-color: #ffcccc">!  =======</a>
  5415) <a name="l5415" style="background-color: #ffcccc">!</a>
  5416) <a name="l5416" style="background-color: #ffcccc">!  SLARFX applies a real elementary reflector H to a real m by n</a>
  5417) <a name="l5417" style="background-color: #ffcccc">!  matrix C, from either the left or the right. H is represented in the</a>
  5418) <a name="l5418" style="background-color: #ffcccc">!  form</a>
  5419) <a name="l5419" style="background-color: #ffcccc">!</a>
  5420) <a name="l5420" style="background-color: #ffcccc">!        H = I - tau * v * v'</a>
  5421) <a name="l5421" style="background-color: #ffcccc">!</a>
  5422) <a name="l5422" style="background-color: #ffcccc">!  where tau is a real scalar and v is a real vector.</a>
  5423) <a name="l5423" style="background-color: #ffcccc">!</a>
  5424) <a name="l5424" style="background-color: #ffcccc">!  If tau = 0, then H is taken to be the unit matrix</a>
  5425) <a name="l5425" style="background-color: #ffcccc">!</a>
  5426) <a name="l5426" style="background-color: #ffcccc">!  This version uses inline code if H has order &lt; 11.</a>
  5427) <a name="l5427" style="background-color: #ffcccc">!</a>
  5428) <a name="l5428" style="background-color: #ffcccc">!  Arguments</a>
  5429) <a name="l5429" style="background-color: #ffcccc">!  =========</a>
  5430) <a name="l5430" style="background-color: #ffcccc">!</a>
  5431) <a name="l5431" style="background-color: #ffcccc">!  SIDE    (input) CHARACTER*1</a>
  5432) <a name="l5432" style="background-color: #ffcccc">!          = 'L': form  H * C</a>
  5433) <a name="l5433" style="background-color: #ffcccc">!          = 'R': form  C * H</a>
  5434) <a name="l5434" style="background-color: #ffcccc">!</a>
  5435) <a name="l5435" style="background-color: #ffcccc">!  M       (input) INTEGER</a>
  5436) <a name="l5436" style="background-color: #ffcccc">!          The number of rows of the matrix C.</a>
  5437) <a name="l5437" style="background-color: #ffcccc">!</a>
  5438) <a name="l5438" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  5439) <a name="l5439" style="background-color: #ffcccc">!          The number of columns of the matrix C.</a>
  5440) <a name="l5440" style="background-color: #ffcccc">!</a>
  5441) <a name="l5441" style="background-color: #ffcccc">!  V       (input) REAL array, dimension (M) if SIDE = 'L'</a>
  5442) <a name="l5442" style="background-color: #ffcccc">!                                     or (N) if SIDE = 'R'</a>
  5443) <a name="l5443" style="background-color: #ffcccc">!          The vector v in the representation of H.</a>
  5444) <a name="l5444" style="background-color: #ffcccc">!</a>
  5445) <a name="l5445" style="background-color: #ffcccc">!  TAU     (input) REAL</a>
  5446) <a name="l5446" style="background-color: #ffcccc">!          The value tau in the representation of H.</a>
  5447) <a name="l5447" style="background-color: #ffcccc">!</a>
  5448) <a name="l5448" style="background-color: #ffcccc">!  C       (input/output) REAL array, dimension (LDC,N)</a>
  5449) <a name="l5449" style="background-color: #ffcccc">!          On entry, the m by n matrix C.</a>
  5450) <a name="l5450" style="background-color: #ffcccc">!          On exit, C is overwritten by the matrix H * C if SIDE = 'L',</a>
  5451) <a name="l5451" style="background-color: #ffcccc">!          or C * H if SIDE = 'R'.</a>
  5452) <a name="l5452" style="background-color: #ffcccc">!</a>
  5453) <a name="l5453" style="background-color: #ffcccc">!  LDC     (input) INTEGER</a>
  5454) <a name="l5454" style="background-color: #ffcccc">!          The leading dimension of the array C. LDA &gt;= (1,M).</a>
  5455) <a name="l5455" style="background-color: #ffcccc">!</a>
  5456) <a name="l5456" style="background-color: #ffcccc">!  WORK    (workspace) REAL array, dimension</a>
  5457) <a name="l5457" style="background-color: #ffcccc">!                      (N) if SIDE = 'L'</a>
  5458) <a name="l5458" style="background-color: #ffcccc">!                      or (M) if SIDE = 'R'</a>
  5459) <a name="l5459" style="background-color: #ffcccc">!          WORK is not referenced if H has order &lt; 11.</a>
  5460) <a name="l5460" style="background-color: #ffcccc">!</a>
  5461) <a name="l5461" style="background-color: #ffcccc">!  =====================================================================</a>
  5462) <a name="l5462" style="background-color: #ffcccc">!</a>
  5463) <a name="l5463" style="background-color: #ffcccc">!     .. Parameters ..</a>
  5464) <a name="l5464" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
  5465) <a name="l5465" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8, ONE = 1.0E+0_r8 )</a>
  5466) <a name="l5466" style="background-color: #ffcccc">!     ..</a>
  5467) <a name="l5467" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  5468) <a name="l5468" style="background-color: #ffcccc">      INTEGER            J</a>
  5469) <a name="l5469" style="background-color: #ffcccc">      REAL(r8)               SUM, T1, T10, T2, T3, T4, T5, T6, T7, T8, T9, &amp;</a>
  5470) <a name="l5470" style="background-color: #ffcccc">                         V1, V10, V2, V3, V4, V5, V6, V7, V8, V9</a>
  5471) <a name="l5471" style="background-color: #ffcccc">!     ..</a>
  5472) <a name="l5472" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  5473) <a name="l5473" style="background-color: #ffcccc">!</a>
  5474) <a name="l5474" style="background-color: #ffcccc">      IF( TAU.EQ.ZERO ) &amp;</a>
  5475) <a name="l5475" style="background-color: #ffcccc">         RETURN</a>
  5476) <a name="l5476" style="background-color: #ffcccc">      IF( LSAME( SIDE, 'L' ) ) THEN</a>
  5477) <a name="l5477" style="background-color: #ffcccc">!</a>
  5478) <a name="l5478" style="background-color: #ffcccc">!        Form  H * C, where H has order m.</a>
  5479) <a name="l5479" style="background-color: #ffcccc">!</a>
  5480) <a name="l5480" style="background-color: #ffcccc">         GO TO ( 10, 30, 50, 70, 90, 110, 130, 150, &amp;</a>
  5481) <a name="l5481" style="background-color: #ffcccc">                 170, 190 )M</a>
  5482) <a name="l5482" style="background-color: #ffcccc">!</a>
  5483) <a name="l5483" style="background-color: #ffcccc">!        Code for general M</a>
  5484) <a name="l5484" style="background-color: #ffcccc">!</a>
  5485) <a name="l5485" style="background-color: #ffcccc">!        w := C'*v</a>
  5486) <a name="l5486" style="background-color: #ffcccc">!</a>
  5487) <a name="l5487" style="background-color: #ffcccc">         CALL SGEMV( 'Transpose', M, N, ONE, C, LDC, V, 1, ZERO, WORK, &amp;</a>
  5488) <a name="l5488" style="background-color: #ffcccc">                     1 )</a>
  5489) <a name="l5489" style="background-color: #ffcccc">!</a>
  5490) <a name="l5490" style="background-color: #ffcccc">!        C := C - tau * v * w'</a>
  5491) <a name="l5491" style="background-color: #ffcccc">!</a>
  5492) <a name="l5492" style="background-color: #ffcccc">         CALL SGER( M, N, -TAU, V, 1, WORK, 1, C, LDC )</a>
  5493) <a name="l5493" style="background-color: #ffcccc">         GO TO 410</a>
  5494) <a name="l5494" style="background-color: #ffcccc">   10    CONTINUE</a>
  5495) <a name="l5495" style="background-color: #ffcccc">!</a>
  5496) <a name="l5496" style="background-color: #ffcccc">!        Special code for 1 x 1 Householder</a>
  5497) <a name="l5497" style="background-color: #ffcccc">!</a>
  5498) <a name="l5498" style="background-color: #ffcccc">         T1 = ONE - TAU*V( 1 )*V( 1 )</a>
  5499) <a name="l5499" style="background-color: #ffcccc">         DO 20 J = 1, N</a>
  5500) <a name="l5500" style="background-color: #ffcccc">            C( 1, J ) = T1*C( 1, J )</a>
  5501) <a name="l5501" style="background-color: #ffcccc">   20    CONTINUE</a>
  5502) <a name="l5502" style="background-color: #ffcccc">         GO TO 410</a>
  5503) <a name="l5503" style="background-color: #ffcccc">   30    CONTINUE</a>
  5504) <a name="l5504" style="background-color: #ffcccc">!</a>
  5505) <a name="l5505" style="background-color: #ffcccc">!        Special code for 2 x 2 Householder</a>
  5506) <a name="l5506" style="background-color: #ffcccc">!</a>
  5507) <a name="l5507" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5508) <a name="l5508" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5509) <a name="l5509" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5510) <a name="l5510" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5511) <a name="l5511" style="background-color: #ffcccc">         DO 40 J = 1, N</a>
  5512) <a name="l5512" style="background-color: #ffcccc">            SUM = V1*C( 1, J ) + V2*C( 2, J )</a>
  5513) <a name="l5513" style="background-color: #ffcccc">            C( 1, J ) = C( 1, J ) - SUM*T1</a>
  5514) <a name="l5514" style="background-color: #ffcccc">            C( 2, J ) = C( 2, J ) - SUM*T2</a>
  5515) <a name="l5515" style="background-color: #ffcccc">   40    CONTINUE</a>
  5516) <a name="l5516" style="background-color: #ffcccc">         GO TO 410</a>
  5517) <a name="l5517" style="background-color: #ffcccc">   50    CONTINUE</a>
  5518) <a name="l5518" style="background-color: #ffcccc">!</a>
  5519) <a name="l5519" style="background-color: #ffcccc">!        Special code for 3 x 3 Householder</a>
  5520) <a name="l5520" style="background-color: #ffcccc">!</a>
  5521) <a name="l5521" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5522) <a name="l5522" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5523) <a name="l5523" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5524) <a name="l5524" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5525) <a name="l5525" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5526) <a name="l5526" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5527) <a name="l5527" style="background-color: #ffcccc">         DO 60 J = 1, N</a>
  5528) <a name="l5528" style="background-color: #ffcccc">            SUM = V1*C( 1, J ) + V2*C( 2, J ) + V3*C( 3, J )</a>
  5529) <a name="l5529" style="background-color: #ffcccc">            C( 1, J ) = C( 1, J ) - SUM*T1</a>
  5530) <a name="l5530" style="background-color: #ffcccc">            C( 2, J ) = C( 2, J ) - SUM*T2</a>
  5531) <a name="l5531" style="background-color: #ffcccc">            C( 3, J ) = C( 3, J ) - SUM*T3</a>
  5532) <a name="l5532" style="background-color: #ffcccc">   60    CONTINUE</a>
  5533) <a name="l5533" style="background-color: #ffcccc">         GO TO 410</a>
  5534) <a name="l5534" style="background-color: #ffcccc">   70    CONTINUE</a>
  5535) <a name="l5535" style="background-color: #ffcccc">!</a>
  5536) <a name="l5536" style="background-color: #ffcccc">!        Special code for 4 x 4 Householder</a>
  5537) <a name="l5537" style="background-color: #ffcccc">!</a>
  5538) <a name="l5538" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5539) <a name="l5539" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5540) <a name="l5540" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5541) <a name="l5541" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5542) <a name="l5542" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5543) <a name="l5543" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5544) <a name="l5544" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5545) <a name="l5545" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5546) <a name="l5546" style="background-color: #ffcccc">         DO 80 J = 1, N</a>
  5547) <a name="l5547" style="background-color: #ffcccc">            SUM = V1*C( 1, J ) + V2*C( 2, J ) + V3*C( 3, J ) + &amp;</a>
  5548) <a name="l5548" style="background-color: #ffcccc">                  V4*C( 4, J )</a>
  5549) <a name="l5549" style="background-color: #ffcccc">            C( 1, J ) = C( 1, J ) - SUM*T1</a>
  5550) <a name="l5550" style="background-color: #ffcccc">            C( 2, J ) = C( 2, J ) - SUM*T2</a>
  5551) <a name="l5551" style="background-color: #ffcccc">            C( 3, J ) = C( 3, J ) - SUM*T3</a>
  5552) <a name="l5552" style="background-color: #ffcccc">            C( 4, J ) = C( 4, J ) - SUM*T4</a>
  5553) <a name="l5553" style="background-color: #ffcccc">   80    CONTINUE</a>
  5554) <a name="l5554" style="background-color: #ffcccc">         GO TO 410</a>
  5555) <a name="l5555" style="background-color: #ffcccc">   90    CONTINUE</a>
  5556) <a name="l5556" style="background-color: #ffcccc">!</a>
  5557) <a name="l5557" style="background-color: #ffcccc">!        Special code for 5 x 5 Householder</a>
  5558) <a name="l5558" style="background-color: #ffcccc">!</a>
  5559) <a name="l5559" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5560) <a name="l5560" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5561) <a name="l5561" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5562) <a name="l5562" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5563) <a name="l5563" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5564) <a name="l5564" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5565) <a name="l5565" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5566) <a name="l5566" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5567) <a name="l5567" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5568) <a name="l5568" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5569) <a name="l5569" style="background-color: #ffcccc">         DO 100 J = 1, N</a>
  5570) <a name="l5570" style="background-color: #ffcccc">            SUM = V1*C( 1, J ) + V2*C( 2, J ) + V3*C( 3, J ) + &amp;</a>
  5571) <a name="l5571" style="background-color: #ffcccc">                  V4*C( 4, J ) + V5*C( 5, J )</a>
  5572) <a name="l5572" style="background-color: #ffcccc">            C( 1, J ) = C( 1, J ) - SUM*T1</a>
  5573) <a name="l5573" style="background-color: #ffcccc">            C( 2, J ) = C( 2, J ) - SUM*T2</a>
  5574) <a name="l5574" style="background-color: #ffcccc">            C( 3, J ) = C( 3, J ) - SUM*T3</a>
  5575) <a name="l5575" style="background-color: #ffcccc">            C( 4, J ) = C( 4, J ) - SUM*T4</a>
  5576) <a name="l5576" style="background-color: #ffcccc">            C( 5, J ) = C( 5, J ) - SUM*T5</a>
  5577) <a name="l5577" style="background-color: #ffcccc">  100    CONTINUE</a>
  5578) <a name="l5578" style="background-color: #ffcccc">         GO TO 410</a>
  5579) <a name="l5579" style="background-color: #ffcccc">  110    CONTINUE</a>
  5580) <a name="l5580" style="background-color: #ffcccc">!</a>
  5581) <a name="l5581" style="background-color: #ffcccc">!        Special code for 6 x 6 Householder</a>
  5582) <a name="l5582" style="background-color: #ffcccc">!</a>
  5583) <a name="l5583" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5584) <a name="l5584" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5585) <a name="l5585" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5586) <a name="l5586" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5587) <a name="l5587" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5588) <a name="l5588" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5589) <a name="l5589" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5590) <a name="l5590" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5591) <a name="l5591" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5592) <a name="l5592" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5593) <a name="l5593" style="background-color: #ffcccc">         V6 = V( 6 )</a>
  5594) <a name="l5594" style="background-color: #ffcccc">         T6 = TAU*V6</a>
  5595) <a name="l5595" style="background-color: #ffcccc">         DO 120 J = 1, N</a>
  5596) <a name="l5596" style="background-color: #ffcccc">            SUM = V1*C( 1, J ) + V2*C( 2, J ) + V3*C( 3, J ) + &amp;</a>
  5597) <a name="l5597" style="background-color: #ffcccc">                  V4*C( 4, J ) + V5*C( 5, J ) + V6*C( 6, J )</a>
  5598) <a name="l5598" style="background-color: #ffcccc">            C( 1, J ) = C( 1, J ) - SUM*T1</a>
  5599) <a name="l5599" style="background-color: #ffcccc">            C( 2, J ) = C( 2, J ) - SUM*T2</a>
  5600) <a name="l5600" style="background-color: #ffcccc">            C( 3, J ) = C( 3, J ) - SUM*T3</a>
  5601) <a name="l5601" style="background-color: #ffcccc">            C( 4, J ) = C( 4, J ) - SUM*T4</a>
  5602) <a name="l5602" style="background-color: #ffcccc">            C( 5, J ) = C( 5, J ) - SUM*T5</a>
  5603) <a name="l5603" style="background-color: #ffcccc">            C( 6, J ) = C( 6, J ) - SUM*T6</a>
  5604) <a name="l5604" style="background-color: #ffcccc">  120    CONTINUE</a>
  5605) <a name="l5605" style="background-color: #ffcccc">         GO TO 410</a>
  5606) <a name="l5606" style="background-color: #ffcccc">  130    CONTINUE</a>
  5607) <a name="l5607" style="background-color: #ffcccc">!</a>
  5608) <a name="l5608" style="background-color: #ffcccc">!        Special code for 7 x 7 Householder</a>
  5609) <a name="l5609" style="background-color: #ffcccc">!</a>
  5610) <a name="l5610" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5611) <a name="l5611" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5612) <a name="l5612" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5613) <a name="l5613" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5614) <a name="l5614" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5615) <a name="l5615" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5616) <a name="l5616" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5617) <a name="l5617" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5618) <a name="l5618" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5619) <a name="l5619" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5620) <a name="l5620" style="background-color: #ffcccc">         V6 = V( 6 )</a>
  5621) <a name="l5621" style="background-color: #ffcccc">         T6 = TAU*V6</a>
  5622) <a name="l5622" style="background-color: #ffcccc">         V7 = V( 7 )</a>
  5623) <a name="l5623" style="background-color: #ffcccc">         T7 = TAU*V7</a>
  5624) <a name="l5624" style="background-color: #ffcccc">         DO 140 J = 1, N</a>
  5625) <a name="l5625" style="background-color: #ffcccc">            SUM = V1*C( 1, J ) + V2*C( 2, J ) + V3*C( 3, J ) + &amp;</a>
  5626) <a name="l5626" style="background-color: #ffcccc">                  V4*C( 4, J ) + V5*C( 5, J ) + V6*C( 6, J ) + &amp;</a>
  5627) <a name="l5627" style="background-color: #ffcccc">                  V7*C( 7, J )</a>
  5628) <a name="l5628" style="background-color: #ffcccc">            C( 1, J ) = C( 1, J ) - SUM*T1</a>
  5629) <a name="l5629" style="background-color: #ffcccc">            C( 2, J ) = C( 2, J ) - SUM*T2</a>
  5630) <a name="l5630" style="background-color: #ffcccc">            C( 3, J ) = C( 3, J ) - SUM*T3</a>
  5631) <a name="l5631" style="background-color: #ffcccc">            C( 4, J ) = C( 4, J ) - SUM*T4</a>
  5632) <a name="l5632" style="background-color: #ffcccc">            C( 5, J ) = C( 5, J ) - SUM*T5</a>
  5633) <a name="l5633" style="background-color: #ffcccc">            C( 6, J ) = C( 6, J ) - SUM*T6</a>
  5634) <a name="l5634" style="background-color: #ffcccc">            C( 7, J ) = C( 7, J ) - SUM*T7</a>
  5635) <a name="l5635" style="background-color: #ffcccc">  140    CONTINUE</a>
  5636) <a name="l5636" style="background-color: #ffcccc">         GO TO 410</a>
  5637) <a name="l5637" style="background-color: #ffcccc">  150    CONTINUE</a>
  5638) <a name="l5638" style="background-color: #ffcccc">!</a>
  5639) <a name="l5639" style="background-color: #ffcccc">!        Special code for 8 x 8 Householder</a>
  5640) <a name="l5640" style="background-color: #ffcccc">!</a>
  5641) <a name="l5641" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5642) <a name="l5642" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5643) <a name="l5643" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5644) <a name="l5644" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5645) <a name="l5645" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5646) <a name="l5646" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5647) <a name="l5647" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5648) <a name="l5648" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5649) <a name="l5649" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5650) <a name="l5650" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5651) <a name="l5651" style="background-color: #ffcccc">         V6 = V( 6 )</a>
  5652) <a name="l5652" style="background-color: #ffcccc">         T6 = TAU*V6</a>
  5653) <a name="l5653" style="background-color: #ffcccc">         V7 = V( 7 )</a>
  5654) <a name="l5654" style="background-color: #ffcccc">         T7 = TAU*V7</a>
  5655) <a name="l5655" style="background-color: #ffcccc">         V8 = V( 8 )</a>
  5656) <a name="l5656" style="background-color: #ffcccc">         T8 = TAU*V8</a>
  5657) <a name="l5657" style="background-color: #ffcccc">         DO 160 J = 1, N</a>
  5658) <a name="l5658" style="background-color: #ffcccc">            SUM = V1*C( 1, J ) + V2*C( 2, J ) + V3*C( 3, J ) + &amp;</a>
  5659) <a name="l5659" style="background-color: #ffcccc">                  V4*C( 4, J ) + V5*C( 5, J ) + V6*C( 6, J ) + &amp;</a>
  5660) <a name="l5660" style="background-color: #ffcccc">                  V7*C( 7, J ) + V8*C( 8, J )</a>
  5661) <a name="l5661" style="background-color: #ffcccc">            C( 1, J ) = C( 1, J ) - SUM*T1</a>
  5662) <a name="l5662" style="background-color: #ffcccc">            C( 2, J ) = C( 2, J ) - SUM*T2</a>
  5663) <a name="l5663" style="background-color: #ffcccc">            C( 3, J ) = C( 3, J ) - SUM*T3</a>
  5664) <a name="l5664" style="background-color: #ffcccc">            C( 4, J ) = C( 4, J ) - SUM*T4</a>
  5665) <a name="l5665" style="background-color: #ffcccc">            C( 5, J ) = C( 5, J ) - SUM*T5</a>
  5666) <a name="l5666" style="background-color: #ffcccc">            C( 6, J ) = C( 6, J ) - SUM*T6</a>
  5667) <a name="l5667" style="background-color: #ffcccc">            C( 7, J ) = C( 7, J ) - SUM*T7</a>
  5668) <a name="l5668" style="background-color: #ffcccc">            C( 8, J ) = C( 8, J ) - SUM*T8</a>
  5669) <a name="l5669" style="background-color: #ffcccc">  160    CONTINUE</a>
  5670) <a name="l5670" style="background-color: #ffcccc">         GO TO 410</a>
  5671) <a name="l5671" style="background-color: #ffcccc">  170    CONTINUE</a>
  5672) <a name="l5672" style="background-color: #ffcccc">!</a>
  5673) <a name="l5673" style="background-color: #ffcccc">!        Special code for 9 x 9 Householder</a>
  5674) <a name="l5674" style="background-color: #ffcccc">!</a>
  5675) <a name="l5675" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5676) <a name="l5676" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5677) <a name="l5677" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5678) <a name="l5678" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5679) <a name="l5679" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5680) <a name="l5680" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5681) <a name="l5681" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5682) <a name="l5682" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5683) <a name="l5683" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5684) <a name="l5684" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5685) <a name="l5685" style="background-color: #ffcccc">         V6 = V( 6 )</a>
  5686) <a name="l5686" style="background-color: #ffcccc">         T6 = TAU*V6</a>
  5687) <a name="l5687" style="background-color: #ffcccc">         V7 = V( 7 )</a>
  5688) <a name="l5688" style="background-color: #ffcccc">         T7 = TAU*V7</a>
  5689) <a name="l5689" style="background-color: #ffcccc">         V8 = V( 8 )</a>
  5690) <a name="l5690" style="background-color: #ffcccc">         T8 = TAU*V8</a>
  5691) <a name="l5691" style="background-color: #ffcccc">         V9 = V( 9 )</a>
  5692) <a name="l5692" style="background-color: #ffcccc">         T9 = TAU*V9</a>
  5693) <a name="l5693" style="background-color: #ffcccc">         DO 180 J = 1, N</a>
  5694) <a name="l5694" style="background-color: #ffcccc">            SUM = V1*C( 1, J ) + V2*C( 2, J ) + V3*C( 3, J ) + &amp;</a>
  5695) <a name="l5695" style="background-color: #ffcccc">                  V4*C( 4, J ) + V5*C( 5, J ) + V6*C( 6, J ) + &amp;</a>
  5696) <a name="l5696" style="background-color: #ffcccc">                  V7*C( 7, J ) + V8*C( 8, J ) + V9*C( 9, J )</a>
  5697) <a name="l5697" style="background-color: #ffcccc">            C( 1, J ) = C( 1, J ) - SUM*T1</a>
  5698) <a name="l5698" style="background-color: #ffcccc">            C( 2, J ) = C( 2, J ) - SUM*T2</a>
  5699) <a name="l5699" style="background-color: #ffcccc">            C( 3, J ) = C( 3, J ) - SUM*T3</a>
  5700) <a name="l5700" style="background-color: #ffcccc">            C( 4, J ) = C( 4, J ) - SUM*T4</a>
  5701) <a name="l5701" style="background-color: #ffcccc">            C( 5, J ) = C( 5, J ) - SUM*T5</a>
  5702) <a name="l5702" style="background-color: #ffcccc">            C( 6, J ) = C( 6, J ) - SUM*T6</a>
  5703) <a name="l5703" style="background-color: #ffcccc">            C( 7, J ) = C( 7, J ) - SUM*T7</a>
  5704) <a name="l5704" style="background-color: #ffcccc">            C( 8, J ) = C( 8, J ) - SUM*T8</a>
  5705) <a name="l5705" style="background-color: #ffcccc">            C( 9, J ) = C( 9, J ) - SUM*T9</a>
  5706) <a name="l5706" style="background-color: #ffcccc">  180    CONTINUE</a>
  5707) <a name="l5707" style="background-color: #ffcccc">         GO TO 410</a>
  5708) <a name="l5708" style="background-color: #ffcccc">  190    CONTINUE</a>
  5709) <a name="l5709" style="background-color: #ffcccc">!</a>
  5710) <a name="l5710" style="background-color: #ffcccc">!        Special code for 10 x 10 Householder</a>
  5711) <a name="l5711" style="background-color: #ffcccc">!</a>
  5712) <a name="l5712" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5713) <a name="l5713" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5714) <a name="l5714" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5715) <a name="l5715" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5716) <a name="l5716" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5717) <a name="l5717" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5718) <a name="l5718" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5719) <a name="l5719" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5720) <a name="l5720" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5721) <a name="l5721" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5722) <a name="l5722" style="background-color: #ffcccc">         V6 = V( 6 )</a>
  5723) <a name="l5723" style="background-color: #ffcccc">         T6 = TAU*V6</a>
  5724) <a name="l5724" style="background-color: #ffcccc">         V7 = V( 7 )</a>
  5725) <a name="l5725" style="background-color: #ffcccc">         T7 = TAU*V7</a>
  5726) <a name="l5726" style="background-color: #ffcccc">         V8 = V( 8 )</a>
  5727) <a name="l5727" style="background-color: #ffcccc">         T8 = TAU*V8</a>
  5728) <a name="l5728" style="background-color: #ffcccc">         V9 = V( 9 )</a>
  5729) <a name="l5729" style="background-color: #ffcccc">         T9 = TAU*V9</a>
  5730) <a name="l5730" style="background-color: #ffcccc">         V10 = V( 10 )</a>
  5731) <a name="l5731" style="background-color: #ffcccc">         T10 = TAU*V10</a>
  5732) <a name="l5732" style="background-color: #ffcccc">         DO 200 J = 1, N</a>
  5733) <a name="l5733" style="background-color: #ffcccc">            SUM = V1*C( 1, J ) + V2*C( 2, J ) + V3*C( 3, J ) + &amp;</a>
  5734) <a name="l5734" style="background-color: #ffcccc">                  V4*C( 4, J ) + V5*C( 5, J ) + V6*C( 6, J ) + &amp;</a>
  5735) <a name="l5735" style="background-color: #ffcccc">                  V7*C( 7, J ) + V8*C( 8, J ) + V9*C( 9, J ) + &amp;</a>
  5736) <a name="l5736" style="background-color: #ffcccc">                  V10*C( 10, J )</a>
  5737) <a name="l5737" style="background-color: #ffcccc">            C( 1, J ) = C( 1, J ) - SUM*T1</a>
  5738) <a name="l5738" style="background-color: #ffcccc">            C( 2, J ) = C( 2, J ) - SUM*T2</a>
  5739) <a name="l5739" style="background-color: #ffcccc">            C( 3, J ) = C( 3, J ) - SUM*T3</a>
  5740) <a name="l5740" style="background-color: #ffcccc">            C( 4, J ) = C( 4, J ) - SUM*T4</a>
  5741) <a name="l5741" style="background-color: #ffcccc">            C( 5, J ) = C( 5, J ) - SUM*T5</a>
  5742) <a name="l5742" style="background-color: #ffcccc">            C( 6, J ) = C( 6, J ) - SUM*T6</a>
  5743) <a name="l5743" style="background-color: #ffcccc">            C( 7, J ) = C( 7, J ) - SUM*T7</a>
  5744) <a name="l5744" style="background-color: #ffcccc">            C( 8, J ) = C( 8, J ) - SUM*T8</a>
  5745) <a name="l5745" style="background-color: #ffcccc">            C( 9, J ) = C( 9, J ) - SUM*T9</a>
  5746) <a name="l5746" style="background-color: #ffcccc">            C( 10, J ) = C( 10, J ) - SUM*T10</a>
  5747) <a name="l5747" style="background-color: #ffcccc">  200    CONTINUE</a>
  5748) <a name="l5748" style="background-color: #ffcccc">         GO TO 410</a>
  5749) <a name="l5749" style="background-color: #ffcccc">      ELSE</a>
  5750) <a name="l5750" style="background-color: #ffcccc">!</a>
  5751) <a name="l5751" style="background-color: #ffcccc">!        Form  C * H, where H has order n.</a>
  5752) <a name="l5752" style="background-color: #ffcccc">!</a>
  5753) <a name="l5753" style="background-color: #ffcccc">         GO TO ( 210, 230, 250, 270, 290, 310, 330, 350, &amp;</a>
  5754) <a name="l5754" style="background-color: #ffcccc">                 370, 390 )N</a>
  5755) <a name="l5755" style="background-color: #ffcccc">!</a>
  5756) <a name="l5756" style="background-color: #ffcccc">!        Code for general N</a>
  5757) <a name="l5757" style="background-color: #ffcccc">!</a>
  5758) <a name="l5758" style="background-color: #ffcccc">!        w := C * v</a>
  5759) <a name="l5759" style="background-color: #ffcccc">!</a>
  5760) <a name="l5760" style="background-color: #ffcccc">         CALL SGEMV( 'No transpose', M, N, ONE, C, LDC, V, 1, ZERO, &amp;</a>
  5761) <a name="l5761" style="background-color: #ffcccc">                     WORK, 1 )</a>
  5762) <a name="l5762" style="background-color: #ffcccc">!</a>
  5763) <a name="l5763" style="background-color: #ffcccc">!        C := C - tau * w * v'</a>
  5764) <a name="l5764" style="background-color: #ffcccc">!</a>
  5765) <a name="l5765" style="background-color: #ffcccc">         CALL SGER( M, N, -TAU, WORK, 1, V, 1, C, LDC )</a>
  5766) <a name="l5766" style="background-color: #ffcccc">         GO TO 410</a>
  5767) <a name="l5767" style="background-color: #ffcccc">  210    CONTINUE</a>
  5768) <a name="l5768" style="background-color: #ffcccc">!</a>
  5769) <a name="l5769" style="background-color: #ffcccc">!        Special code for 1 x 1 Householder</a>
  5770) <a name="l5770" style="background-color: #ffcccc">!</a>
  5771) <a name="l5771" style="background-color: #ffcccc">         T1 = ONE - TAU*V( 1 )*V( 1 )</a>
  5772) <a name="l5772" style="background-color: #ffcccc">         DO 220 J = 1, M</a>
  5773) <a name="l5773" style="background-color: #ffcccc">            C( J, 1 ) = T1*C( J, 1 )</a>
  5774) <a name="l5774" style="background-color: #ffcccc">  220    CONTINUE</a>
  5775) <a name="l5775" style="background-color: #ffcccc">         GO TO 410</a>
  5776) <a name="l5776" style="background-color: #ffcccc">  230    CONTINUE</a>
  5777) <a name="l5777" style="background-color: #ffcccc">!</a>
  5778) <a name="l5778" style="background-color: #ffcccc">!        Special code for 2 x 2 Householder</a>
  5779) <a name="l5779" style="background-color: #ffcccc">!</a>
  5780) <a name="l5780" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5781) <a name="l5781" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5782) <a name="l5782" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5783) <a name="l5783" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5784) <a name="l5784" style="background-color: #ffcccc">         DO 240 J = 1, M</a>
  5785) <a name="l5785" style="background-color: #ffcccc">            SUM = V1*C( J, 1 ) + V2*C( J, 2 )</a>
  5786) <a name="l5786" style="background-color: #ffcccc">            C( J, 1 ) = C( J, 1 ) - SUM*T1</a>
  5787) <a name="l5787" style="background-color: #ffcccc">            C( J, 2 ) = C( J, 2 ) - SUM*T2</a>
  5788) <a name="l5788" style="background-color: #ffcccc">  240    CONTINUE</a>
  5789) <a name="l5789" style="background-color: #ffcccc">         GO TO 410</a>
  5790) <a name="l5790" style="background-color: #ffcccc">  250    CONTINUE</a>
  5791) <a name="l5791" style="background-color: #ffcccc">!</a>
  5792) <a name="l5792" style="background-color: #ffcccc">!        Special code for 3 x 3 Householder</a>
  5793) <a name="l5793" style="background-color: #ffcccc">!</a>
  5794) <a name="l5794" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5795) <a name="l5795" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5796) <a name="l5796" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5797) <a name="l5797" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5798) <a name="l5798" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5799) <a name="l5799" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5800) <a name="l5800" style="background-color: #ffcccc">         DO 260 J = 1, M</a>
  5801) <a name="l5801" style="background-color: #ffcccc">            SUM = V1*C( J, 1 ) + V2*C( J, 2 ) + V3*C( J, 3 )</a>
  5802) <a name="l5802" style="background-color: #ffcccc">            C( J, 1 ) = C( J, 1 ) - SUM*T1</a>
  5803) <a name="l5803" style="background-color: #ffcccc">            C( J, 2 ) = C( J, 2 ) - SUM*T2</a>
  5804) <a name="l5804" style="background-color: #ffcccc">            C( J, 3 ) = C( J, 3 ) - SUM*T3</a>
  5805) <a name="l5805" style="background-color: #ffcccc">  260    CONTINUE</a>
  5806) <a name="l5806" style="background-color: #ffcccc">         GO TO 410</a>
  5807) <a name="l5807" style="background-color: #ffcccc">  270    CONTINUE</a>
  5808) <a name="l5808" style="background-color: #ffcccc">!</a>
  5809) <a name="l5809" style="background-color: #ffcccc">!        Special code for 4 x 4 Householder</a>
  5810) <a name="l5810" style="background-color: #ffcccc">!</a>
  5811) <a name="l5811" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5812) <a name="l5812" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5813) <a name="l5813" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5814) <a name="l5814" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5815) <a name="l5815" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5816) <a name="l5816" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5817) <a name="l5817" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5818) <a name="l5818" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5819) <a name="l5819" style="background-color: #ffcccc">         DO 280 J = 1, M</a>
  5820) <a name="l5820" style="background-color: #ffcccc">            SUM = V1*C( J, 1 ) + V2*C( J, 2 ) + V3*C( J, 3 ) + &amp;</a>
  5821) <a name="l5821" style="background-color: #ffcccc">                  V4*C( J, 4 )</a>
  5822) <a name="l5822" style="background-color: #ffcccc">            C( J, 1 ) = C( J, 1 ) - SUM*T1</a>
  5823) <a name="l5823" style="background-color: #ffcccc">            C( J, 2 ) = C( J, 2 ) - SUM*T2</a>
  5824) <a name="l5824" style="background-color: #ffcccc">            C( J, 3 ) = C( J, 3 ) - SUM*T3</a>
  5825) <a name="l5825" style="background-color: #ffcccc">            C( J, 4 ) = C( J, 4 ) - SUM*T4</a>
  5826) <a name="l5826" style="background-color: #ffcccc">  280    CONTINUE</a>
  5827) <a name="l5827" style="background-color: #ffcccc">         GO TO 410</a>
  5828) <a name="l5828" style="background-color: #ffcccc">  290    CONTINUE</a>
  5829) <a name="l5829" style="background-color: #ffcccc">!</a>
  5830) <a name="l5830" style="background-color: #ffcccc">!        Special code for 5 x 5 Householder</a>
  5831) <a name="l5831" style="background-color: #ffcccc">!</a>
  5832) <a name="l5832" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5833) <a name="l5833" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5834) <a name="l5834" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5835) <a name="l5835" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5836) <a name="l5836" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5837) <a name="l5837" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5838) <a name="l5838" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5839) <a name="l5839" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5840) <a name="l5840" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5841) <a name="l5841" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5842) <a name="l5842" style="background-color: #ffcccc">         DO 300 J = 1, M</a>
  5843) <a name="l5843" style="background-color: #ffcccc">            SUM = V1*C( J, 1 ) + V2*C( J, 2 ) + V3*C( J, 3 ) + &amp;</a>
  5844) <a name="l5844" style="background-color: #ffcccc">                  V4*C( J, 4 ) + V5*C( J, 5 )</a>
  5845) <a name="l5845" style="background-color: #ffcccc">            C( J, 1 ) = C( J, 1 ) - SUM*T1</a>
  5846) <a name="l5846" style="background-color: #ffcccc">            C( J, 2 ) = C( J, 2 ) - SUM*T2</a>
  5847) <a name="l5847" style="background-color: #ffcccc">            C( J, 3 ) = C( J, 3 ) - SUM*T3</a>
  5848) <a name="l5848" style="background-color: #ffcccc">            C( J, 4 ) = C( J, 4 ) - SUM*T4</a>
  5849) <a name="l5849" style="background-color: #ffcccc">            C( J, 5 ) = C( J, 5 ) - SUM*T5</a>
  5850) <a name="l5850" style="background-color: #ffcccc">  300    CONTINUE</a>
  5851) <a name="l5851" style="background-color: #ffcccc">         GO TO 410</a>
  5852) <a name="l5852" style="background-color: #ffcccc">  310    CONTINUE</a>
  5853) <a name="l5853" style="background-color: #ffcccc">!</a>
  5854) <a name="l5854" style="background-color: #ffcccc">!        Special code for 6 x 6 Householder</a>
  5855) <a name="l5855" style="background-color: #ffcccc">!</a>
  5856) <a name="l5856" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5857) <a name="l5857" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5858) <a name="l5858" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5859) <a name="l5859" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5860) <a name="l5860" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5861) <a name="l5861" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5862) <a name="l5862" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5863) <a name="l5863" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5864) <a name="l5864" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5865) <a name="l5865" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5866) <a name="l5866" style="background-color: #ffcccc">         V6 = V( 6 )</a>
  5867) <a name="l5867" style="background-color: #ffcccc">         T6 = TAU*V6</a>
  5868) <a name="l5868" style="background-color: #ffcccc">         DO 320 J = 1, M</a>
  5869) <a name="l5869" style="background-color: #ffcccc">            SUM = V1*C( J, 1 ) + V2*C( J, 2 ) + V3*C( J, 3 ) + &amp;</a>
  5870) <a name="l5870" style="background-color: #ffcccc">                  V4*C( J, 4 ) + V5*C( J, 5 ) + V6*C( J, 6 )</a>
  5871) <a name="l5871" style="background-color: #ffcccc">            C( J, 1 ) = C( J, 1 ) - SUM*T1</a>
  5872) <a name="l5872" style="background-color: #ffcccc">            C( J, 2 ) = C( J, 2 ) - SUM*T2</a>
  5873) <a name="l5873" style="background-color: #ffcccc">            C( J, 3 ) = C( J, 3 ) - SUM*T3</a>
  5874) <a name="l5874" style="background-color: #ffcccc">            C( J, 4 ) = C( J, 4 ) - SUM*T4</a>
  5875) <a name="l5875" style="background-color: #ffcccc">            C( J, 5 ) = C( J, 5 ) - SUM*T5</a>
  5876) <a name="l5876" style="background-color: #ffcccc">            C( J, 6 ) = C( J, 6 ) - SUM*T6</a>
  5877) <a name="l5877" style="background-color: #ffcccc">  320    CONTINUE</a>
  5878) <a name="l5878" style="background-color: #ffcccc">         GO TO 410</a>
  5879) <a name="l5879" style="background-color: #ffcccc">  330    CONTINUE</a>
  5880) <a name="l5880" style="background-color: #ffcccc">!</a>
  5881) <a name="l5881" style="background-color: #ffcccc">!        Special code for 7 x 7 Householder</a>
  5882) <a name="l5882" style="background-color: #ffcccc">!</a>
  5883) <a name="l5883" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5884) <a name="l5884" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5885) <a name="l5885" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5886) <a name="l5886" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5887) <a name="l5887" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5888) <a name="l5888" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5889) <a name="l5889" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5890) <a name="l5890" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5891) <a name="l5891" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5892) <a name="l5892" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5893) <a name="l5893" style="background-color: #ffcccc">         V6 = V( 6 )</a>
  5894) <a name="l5894" style="background-color: #ffcccc">         T6 = TAU*V6</a>
  5895) <a name="l5895" style="background-color: #ffcccc">         V7 = V( 7 )</a>
  5896) <a name="l5896" style="background-color: #ffcccc">         T7 = TAU*V7</a>
  5897) <a name="l5897" style="background-color: #ffcccc">         DO 340 J = 1, M</a>
  5898) <a name="l5898" style="background-color: #ffcccc">            SUM = V1*C( J, 1 ) + V2*C( J, 2 ) + V3*C( J, 3 ) + &amp;</a>
  5899) <a name="l5899" style="background-color: #ffcccc">                  V4*C( J, 4 ) + V5*C( J, 5 ) + V6*C( J, 6 ) + &amp;</a>
  5900) <a name="l5900" style="background-color: #ffcccc">                  V7*C( J, 7 )</a>
  5901) <a name="l5901" style="background-color: #ffcccc">            C( J, 1 ) = C( J, 1 ) - SUM*T1</a>
  5902) <a name="l5902" style="background-color: #ffcccc">            C( J, 2 ) = C( J, 2 ) - SUM*T2</a>
  5903) <a name="l5903" style="background-color: #ffcccc">            C( J, 3 ) = C( J, 3 ) - SUM*T3</a>
  5904) <a name="l5904" style="background-color: #ffcccc">            C( J, 4 ) = C( J, 4 ) - SUM*T4</a>
  5905) <a name="l5905" style="background-color: #ffcccc">            C( J, 5 ) = C( J, 5 ) - SUM*T5</a>
  5906) <a name="l5906" style="background-color: #ffcccc">            C( J, 6 ) = C( J, 6 ) - SUM*T6</a>
  5907) <a name="l5907" style="background-color: #ffcccc">            C( J, 7 ) = C( J, 7 ) - SUM*T7</a>
  5908) <a name="l5908" style="background-color: #ffcccc">  340    CONTINUE</a>
  5909) <a name="l5909" style="background-color: #ffcccc">         GO TO 410</a>
  5910) <a name="l5910" style="background-color: #ffcccc">  350    CONTINUE</a>
  5911) <a name="l5911" style="background-color: #ffcccc">!</a>
  5912) <a name="l5912" style="background-color: #ffcccc">!        Special code for 8 x 8 Householder</a>
  5913) <a name="l5913" style="background-color: #ffcccc">!</a>
  5914) <a name="l5914" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5915) <a name="l5915" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5916) <a name="l5916" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5917) <a name="l5917" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5918) <a name="l5918" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5919) <a name="l5919" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5920) <a name="l5920" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5921) <a name="l5921" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5922) <a name="l5922" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5923) <a name="l5923" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5924) <a name="l5924" style="background-color: #ffcccc">         V6 = V( 6 )</a>
  5925) <a name="l5925" style="background-color: #ffcccc">         T6 = TAU*V6</a>
  5926) <a name="l5926" style="background-color: #ffcccc">         V7 = V( 7 )</a>
  5927) <a name="l5927" style="background-color: #ffcccc">         T7 = TAU*V7</a>
  5928) <a name="l5928" style="background-color: #ffcccc">         V8 = V( 8 )</a>
  5929) <a name="l5929" style="background-color: #ffcccc">         T8 = TAU*V8</a>
  5930) <a name="l5930" style="background-color: #ffcccc">         DO 360 J = 1, M</a>
  5931) <a name="l5931" style="background-color: #ffcccc">            SUM = V1*C( J, 1 ) + V2*C( J, 2 ) + V3*C( J, 3 ) + &amp;</a>
  5932) <a name="l5932" style="background-color: #ffcccc">                  V4*C( J, 4 ) + V5*C( J, 5 ) + V6*C( J, 6 ) + &amp;</a>
  5933) <a name="l5933" style="background-color: #ffcccc">                  V7*C( J, 7 ) + V8*C( J, 8 )</a>
  5934) <a name="l5934" style="background-color: #ffcccc">            C( J, 1 ) = C( J, 1 ) - SUM*T1</a>
  5935) <a name="l5935" style="background-color: #ffcccc">            C( J, 2 ) = C( J, 2 ) - SUM*T2</a>
  5936) <a name="l5936" style="background-color: #ffcccc">            C( J, 3 ) = C( J, 3 ) - SUM*T3</a>
  5937) <a name="l5937" style="background-color: #ffcccc">            C( J, 4 ) = C( J, 4 ) - SUM*T4</a>
  5938) <a name="l5938" style="background-color: #ffcccc">            C( J, 5 ) = C( J, 5 ) - SUM*T5</a>
  5939) <a name="l5939" style="background-color: #ffcccc">            C( J, 6 ) = C( J, 6 ) - SUM*T6</a>
  5940) <a name="l5940" style="background-color: #ffcccc">            C( J, 7 ) = C( J, 7 ) - SUM*T7</a>
  5941) <a name="l5941" style="background-color: #ffcccc">            C( J, 8 ) = C( J, 8 ) - SUM*T8</a>
  5942) <a name="l5942" style="background-color: #ffcccc">  360    CONTINUE</a>
  5943) <a name="l5943" style="background-color: #ffcccc">         GO TO 410</a>
  5944) <a name="l5944" style="background-color: #ffcccc">  370    CONTINUE</a>
  5945) <a name="l5945" style="background-color: #ffcccc">!</a>
  5946) <a name="l5946" style="background-color: #ffcccc">!        Special code for 9 x 9 Householder</a>
  5947) <a name="l5947" style="background-color: #ffcccc">!</a>
  5948) <a name="l5948" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5949) <a name="l5949" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5950) <a name="l5950" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5951) <a name="l5951" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5952) <a name="l5952" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5953) <a name="l5953" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5954) <a name="l5954" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5955) <a name="l5955" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5956) <a name="l5956" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5957) <a name="l5957" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5958) <a name="l5958" style="background-color: #ffcccc">         V6 = V( 6 )</a>
  5959) <a name="l5959" style="background-color: #ffcccc">         T6 = TAU*V6</a>
  5960) <a name="l5960" style="background-color: #ffcccc">         V7 = V( 7 )</a>
  5961) <a name="l5961" style="background-color: #ffcccc">         T7 = TAU*V7</a>
  5962) <a name="l5962" style="background-color: #ffcccc">         V8 = V( 8 )</a>
  5963) <a name="l5963" style="background-color: #ffcccc">         T8 = TAU*V8</a>
  5964) <a name="l5964" style="background-color: #ffcccc">         V9 = V( 9 )</a>
  5965) <a name="l5965" style="background-color: #ffcccc">         T9 = TAU*V9</a>
  5966) <a name="l5966" style="background-color: #ffcccc">         DO 380 J = 1, M</a>
  5967) <a name="l5967" style="background-color: #ffcccc">            SUM = V1*C( J, 1 ) + V2*C( J, 2 ) + V3*C( J, 3 ) + &amp;</a>
  5968) <a name="l5968" style="background-color: #ffcccc">                  V4*C( J, 4 ) + V5*C( J, 5 ) + V6*C( J, 6 ) + &amp;</a>
  5969) <a name="l5969" style="background-color: #ffcccc">                  V7*C( J, 7 ) + V8*C( J, 8 ) + V9*C( J, 9 )</a>
  5970) <a name="l5970" style="background-color: #ffcccc">            C( J, 1 ) = C( J, 1 ) - SUM*T1</a>
  5971) <a name="l5971" style="background-color: #ffcccc">            C( J, 2 ) = C( J, 2 ) - SUM*T2</a>
  5972) <a name="l5972" style="background-color: #ffcccc">            C( J, 3 ) = C( J, 3 ) - SUM*T3</a>
  5973) <a name="l5973" style="background-color: #ffcccc">            C( J, 4 ) = C( J, 4 ) - SUM*T4</a>
  5974) <a name="l5974" style="background-color: #ffcccc">            C( J, 5 ) = C( J, 5 ) - SUM*T5</a>
  5975) <a name="l5975" style="background-color: #ffcccc">            C( J, 6 ) = C( J, 6 ) - SUM*T6</a>
  5976) <a name="l5976" style="background-color: #ffcccc">            C( J, 7 ) = C( J, 7 ) - SUM*T7</a>
  5977) <a name="l5977" style="background-color: #ffcccc">            C( J, 8 ) = C( J, 8 ) - SUM*T8</a>
  5978) <a name="l5978" style="background-color: #ffcccc">            C( J, 9 ) = C( J, 9 ) - SUM*T9</a>
  5979) <a name="l5979" style="background-color: #ffcccc">  380    CONTINUE</a>
  5980) <a name="l5980" style="background-color: #ffcccc">         GO TO 410</a>
  5981) <a name="l5981" style="background-color: #ffcccc">  390    CONTINUE</a>
  5982) <a name="l5982" style="background-color: #ffcccc">!</a>
  5983) <a name="l5983" style="background-color: #ffcccc">!        Special code for 10 x 10 Householder</a>
  5984) <a name="l5984" style="background-color: #ffcccc">!</a>
  5985) <a name="l5985" style="background-color: #ffcccc">         V1 = V( 1 )</a>
  5986) <a name="l5986" style="background-color: #ffcccc">         T1 = TAU*V1</a>
  5987) <a name="l5987" style="background-color: #ffcccc">         V2 = V( 2 )</a>
  5988) <a name="l5988" style="background-color: #ffcccc">         T2 = TAU*V2</a>
  5989) <a name="l5989" style="background-color: #ffcccc">         V3 = V( 3 )</a>
  5990) <a name="l5990" style="background-color: #ffcccc">         T3 = TAU*V3</a>
  5991) <a name="l5991" style="background-color: #ffcccc">         V4 = V( 4 )</a>
  5992) <a name="l5992" style="background-color: #ffcccc">         T4 = TAU*V4</a>
  5993) <a name="l5993" style="background-color: #ffcccc">         V5 = V( 5 )</a>
  5994) <a name="l5994" style="background-color: #ffcccc">         T5 = TAU*V5</a>
  5995) <a name="l5995" style="background-color: #ffcccc">         V6 = V( 6 )</a>
  5996) <a name="l5996" style="background-color: #ffcccc">         T6 = TAU*V6</a>
  5997) <a name="l5997" style="background-color: #ffcccc">         V7 = V( 7 )</a>
  5998) <a name="l5998" style="background-color: #ffcccc">         T7 = TAU*V7</a>
  5999) <a name="l5999" style="background-color: #ffcccc">         V8 = V( 8 )</a>
  6000) <a name="l6000" style="background-color: #ffcccc">         T8 = TAU*V8</a>
  6001) <a name="l6001" style="background-color: #ffcccc">         V9 = V( 9 )</a>
  6002) <a name="l6002" style="background-color: #ffcccc">         T9 = TAU*V9</a>
  6003) <a name="l6003" style="background-color: #ffcccc">         V10 = V( 10 )</a>
  6004) <a name="l6004" style="background-color: #ffcccc">         T10 = TAU*V10</a>
  6005) <a name="l6005" style="background-color: #ffcccc">         DO 400 J = 1, M</a>
  6006) <a name="l6006" style="background-color: #ffcccc">            SUM = V1*C( J, 1 ) + V2*C( J, 2 ) + V3*C( J, 3 ) + &amp;</a>
  6007) <a name="l6007" style="background-color: #ffcccc">                  V4*C( J, 4 ) + V5*C( J, 5 ) + V6*C( J, 6 ) + &amp;</a>
  6008) <a name="l6008" style="background-color: #ffcccc">                  V7*C( J, 7 ) + V8*C( J, 8 ) + V9*C( J, 9 ) + &amp;</a>
  6009) <a name="l6009" style="background-color: #ffcccc">                  V10*C( J, 10 )</a>
  6010) <a name="l6010" style="background-color: #ffcccc">            C( J, 1 ) = C( J, 1 ) - SUM*T1</a>
  6011) <a name="l6011" style="background-color: #ffcccc">            C( J, 2 ) = C( J, 2 ) - SUM*T2</a>
  6012) <a name="l6012" style="background-color: #ffcccc">            C( J, 3 ) = C( J, 3 ) - SUM*T3</a>
  6013) <a name="l6013" style="background-color: #ffcccc">            C( J, 4 ) = C( J, 4 ) - SUM*T4</a>
  6014) <a name="l6014" style="background-color: #ffcccc">            C( J, 5 ) = C( J, 5 ) - SUM*T5</a>
  6015) <a name="l6015" style="background-color: #ffcccc">            C( J, 6 ) = C( J, 6 ) - SUM*T6</a>
  6016) <a name="l6016" style="background-color: #ffcccc">            C( J, 7 ) = C( J, 7 ) - SUM*T7</a>
  6017) <a name="l6017" style="background-color: #ffcccc">            C( J, 8 ) = C( J, 8 ) - SUM*T8</a>
  6018) <a name="l6018" style="background-color: #ffcccc">            C( J, 9 ) = C( J, 9 ) - SUM*T9</a>
  6019) <a name="l6019" style="background-color: #ffcccc">            C( J, 10 ) = C( J, 10 ) - SUM*T10</a>
  6020) <a name="l6020" style="background-color: #ffcccc">  400    CONTINUE</a>
  6021) <a name="l6021" style="background-color: #ffcccc">         GO TO 410</a>
  6022) <a name="l6022" style="background-color: #ffcccc">      END IF</a>
  6023) <a name="l6023" style="background-color: #ffcccc">  410 RETURN</a>
  6024) <a name="l6024" style="background-color: #ffcccc">!</a>
  6025) <a name="l6025" style="background-color: #ffcccc">!     End of SLARFX</a>
  6026) <a name="l6026" style="background-color: #ffcccc">!</a>
  6027) <a name="l6027" style="background-color: #ffcccc">      END SUBROUTINE SLARFX</a>
  6028) <a name="l6028" style="background-color: #ffffff"></a>
  6029) <a name="l6029" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  6030) <a name="l6030" style="background-color: #ffffff"></a>
  6031) <a name="l6031" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLARTG( F, G, CS, SN, R )</a>
  6032) <a name="l6032" style="background-color: #ffcccc"></a>
  6033) <a name="l6033" style="background-color: #ffcccc">!</a>
  6034) <a name="l6034" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  6035) <a name="l6035" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  6036) <a name="l6036" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  6037) <a name="l6037" style="background-color: #ffcccc">!     September 30, 1994</a>
  6038) <a name="l6038" style="background-color: #ffcccc">!</a>
  6039) <a name="l6039" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  6040) <a name="l6040" style="background-color: #ffcccc">      REAL(r8)               CS, F, G, R, SN</a>
  6041) <a name="l6041" style="background-color: #ffcccc">!     ..</a>
  6042) <a name="l6042" style="background-color: #ffcccc">!</a>
  6043) <a name="l6043" style="background-color: #ffcccc">!  Purpose</a>
  6044) <a name="l6044" style="background-color: #ffcccc">!  =======</a>
  6045) <a name="l6045" style="background-color: #ffcccc">!</a>
  6046) <a name="l6046" style="background-color: #ffcccc">!  SLARTG generate a plane rotation so that</a>
  6047) <a name="l6047" style="background-color: #ffcccc">!</a>
  6048) <a name="l6048" style="background-color: #ffcccc">!     [  CS  SN  ]  .  [ F ]  =  [ R ]   where CS**2 + SN**2 = 1.</a>
  6049) <a name="l6049" style="background-color: #ffcccc">!     [ -SN  CS  ]     [ G ]     [ 0 ]</a>
  6050) <a name="l6050" style="background-color: #ffcccc">!</a>
  6051) <a name="l6051" style="background-color: #ffcccc">!  This is a slower, more accurate version of the BLAS1 routine SROTG,</a>
  6052) <a name="l6052" style="background-color: #ffcccc">!  with the following other differences:</a>
  6053) <a name="l6053" style="background-color: #ffcccc">!     F and G are unchanged on return.</a>
  6054) <a name="l6054" style="background-color: #ffcccc">!     If G=0, then CS=1 and SN=0.</a>
  6055) <a name="l6055" style="background-color: #ffcccc">!     If F=0 and (G .ne. 0), then CS=0 and SN=1 without doing any</a>
  6056) <a name="l6056" style="background-color: #ffcccc">!        floating point operations (saves work in SBDSQR when</a>
  6057) <a name="l6057" style="background-color: #ffcccc">!        there are zeros on the diagonal).</a>
  6058) <a name="l6058" style="background-color: #ffcccc">!</a>
  6059) <a name="l6059" style="background-color: #ffcccc">!  If F exceeds G in magnitude, CS will be positive.</a>
  6060) <a name="l6060" style="background-color: #ffcccc">!</a>
  6061) <a name="l6061" style="background-color: #ffcccc">!  Arguments</a>
  6062) <a name="l6062" style="background-color: #ffcccc">!  =========</a>
  6063) <a name="l6063" style="background-color: #ffcccc">!</a>
  6064) <a name="l6064" style="background-color: #ffcccc">!  F       (input) REAL</a>
  6065) <a name="l6065" style="background-color: #ffcccc">!          The first component of vector to be rotated.</a>
  6066) <a name="l6066" style="background-color: #ffcccc">!</a>
  6067) <a name="l6067" style="background-color: #ffcccc">!  G       (input) REAL</a>
  6068) <a name="l6068" style="background-color: #ffcccc">!          The second component of vector to be rotated.</a>
  6069) <a name="l6069" style="background-color: #ffcccc">!</a>
  6070) <a name="l6070" style="background-color: #ffcccc">!  CS      (output) REAL</a>
  6071) <a name="l6071" style="background-color: #ffcccc">!          The cosine of the rotation.</a>
  6072) <a name="l6072" style="background-color: #ffcccc">!</a>
  6073) <a name="l6073" style="background-color: #ffcccc">!  SN      (output) REAL</a>
  6074) <a name="l6074" style="background-color: #ffcccc">!          The sine of the rotation.</a>
  6075) <a name="l6075" style="background-color: #ffcccc">!</a>
  6076) <a name="l6076" style="background-color: #ffcccc">!  R       (output) REAL</a>
  6077) <a name="l6077" style="background-color: #ffcccc">!          The nonzero component of the rotated vector.</a>
  6078) <a name="l6078" style="background-color: #ffcccc">!</a>
  6079) <a name="l6079" style="background-color: #ffcccc">!  =====================================================================</a>
  6080) <a name="l6080" style="background-color: #ffcccc">!</a>
  6081) <a name="l6081" style="background-color: #ffcccc">!     .. Parameters ..</a>
  6082) <a name="l6082" style="background-color: #ffcccc">      REAL(r8)               ZERO</a>
  6083) <a name="l6083" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E0_r8 )</a>
  6084) <a name="l6084" style="background-color: #ffcccc">      REAL(r8)               ONE</a>
  6085) <a name="l6085" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E0_r8 )</a>
  6086) <a name="l6086" style="background-color: #ffcccc">      REAL(r8)               TWO</a>
  6087) <a name="l6087" style="background-color: #ffcccc">      PARAMETER          ( TWO = 2.0E0_r8 )</a>
  6088) <a name="l6088" style="background-color: #ffcccc">!     ..</a>
  6089) <a name="l6089" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  6090) <a name="l6090" style="background-color: #ffcccc">      LOGICAL            FIRST</a>
  6091) <a name="l6091" style="background-color: #ffcccc">      INTEGER            COUNT, I</a>
  6092) <a name="l6092" style="background-color: #ffcccc">      REAL(r8)               EPS, F1, G1, SAFMIN, SAFMN2, SAFMX2, SCALE</a>
  6093) <a name="l6093" style="background-color: #ffcccc">!     ..</a>
  6094) <a name="l6094" style="background-color: #ffcccc">!     .. Save statement ..</a>
  6095) <a name="l6095" style="background-color: #ffcccc">      SAVE               FIRST, SAFMX2, SAFMIN, SAFMN2</a>
  6096) <a name="l6096" style="background-color: #ffcccc">!     ..</a>
  6097) <a name="l6097" style="background-color: #ffcccc">!     .. Data statements ..</a>
  6098) <a name="l6098" style="background-color: #ffcccc">      DATA               FIRST / .TRUE. /</a>
  6099) <a name="l6099" style="background-color: #ffcccc">!     ..</a>
  6100) <a name="l6100" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  6101) <a name="l6101" style="background-color: #ffcccc">!</a>
  6102) <a name="l6102" style="background-color: #ffcccc">      IF( FIRST ) THEN</a>
  6103) <a name="l6103" style="background-color: #ffcccc">         FIRST = .FALSE.</a>
  6104) <a name="l6104" style="background-color: #ffcccc">         SAFMIN = SLAMCH( 'S' )</a>
  6105) <a name="l6105" style="background-color: #ffcccc">         EPS = SLAMCH( 'E' )</a>
  6106) <a name="l6106" style="background-color: #ffcccc">         SAFMN2 = SLAMCH( 'B' )**INT( LOG( SAFMIN / EPS ) / &amp;</a>
  6107) <a name="l6107" style="background-color: #ffcccc">                  LOG( SLAMCH( 'B' ) ) / TWO )</a>
  6108) <a name="l6108" style="background-color: #ffcccc">         SAFMX2 = ONE / SAFMN2</a>
  6109) <a name="l6109" style="background-color: #ffcccc">      END IF</a>
  6110) <a name="l6110" style="background-color: #ffcccc">      IF( G.EQ.ZERO ) THEN</a>
  6111) <a name="l6111" style="background-color: #ffcccc">         CS = ONE</a>
  6112) <a name="l6112" style="background-color: #ffcccc">         SN = ZERO</a>
  6113) <a name="l6113" style="background-color: #ffcccc">         R = F</a>
  6114) <a name="l6114" style="background-color: #ffcccc">      ELSE IF( F.EQ.ZERO ) THEN</a>
  6115) <a name="l6115" style="background-color: #ffcccc">         CS = ZERO</a>
  6116) <a name="l6116" style="background-color: #ffcccc">         SN = ONE</a>
  6117) <a name="l6117" style="background-color: #ffcccc">         R = G</a>
  6118) <a name="l6118" style="background-color: #ffcccc">      ELSE</a>
  6119) <a name="l6119" style="background-color: #ffcccc">         F1 = F</a>
  6120) <a name="l6120" style="background-color: #ffcccc">         G1 = G</a>
  6121) <a name="l6121" style="background-color: #ffcccc">         SCALE = MAX( ABS( F1 ), ABS( G1 ) )</a>
  6122) <a name="l6122" style="background-color: #ffcccc">         IF( SCALE.GE.SAFMX2 ) THEN</a>
  6123) <a name="l6123" style="background-color: #ffcccc">            COUNT = 0</a>
  6124) <a name="l6124" style="background-color: #ffcccc">   10       CONTINUE</a>
  6125) <a name="l6125" style="background-color: #ffcccc">            COUNT = COUNT + 1</a>
  6126) <a name="l6126" style="background-color: #ffcccc">            F1 = F1*SAFMN2</a>
  6127) <a name="l6127" style="background-color: #ffcccc">            G1 = G1*SAFMN2</a>
  6128) <a name="l6128" style="background-color: #ffcccc">            SCALE = MAX( ABS( F1 ), ABS( G1 ) )</a>
  6129) <a name="l6129" style="background-color: #ffcccc">            IF( SCALE.GE.SAFMX2 ) &amp;</a>
  6130) <a name="l6130" style="background-color: #ffcccc">               GO TO 10</a>
  6131) <a name="l6131" style="background-color: #ffcccc">            R = SQRT( F1**2+G1**2 )</a>
  6132) <a name="l6132" style="background-color: #ffcccc">            CS = F1 / R</a>
  6133) <a name="l6133" style="background-color: #ffcccc">            SN = G1 / R</a>
  6134) <a name="l6134" style="background-color: #ffcccc">            DO 20 I = 1, COUNT</a>
  6135) <a name="l6135" style="background-color: #ffcccc">               R = R*SAFMX2</a>
  6136) <a name="l6136" style="background-color: #ffcccc">   20       CONTINUE</a>
  6137) <a name="l6137" style="background-color: #ffcccc">         ELSE IF( SCALE.LE.SAFMN2 ) THEN</a>
  6138) <a name="l6138" style="background-color: #ffcccc">            COUNT = 0</a>
  6139) <a name="l6139" style="background-color: #ffcccc">   30       CONTINUE</a>
  6140) <a name="l6140" style="background-color: #ffcccc">            COUNT = COUNT + 1</a>
  6141) <a name="l6141" style="background-color: #ffcccc">            F1 = F1*SAFMX2</a>
  6142) <a name="l6142" style="background-color: #ffcccc">            G1 = G1*SAFMX2</a>
  6143) <a name="l6143" style="background-color: #ffcccc">            SCALE = MAX( ABS( F1 ), ABS( G1 ) )</a>
  6144) <a name="l6144" style="background-color: #ffcccc">            IF( SCALE.LE.SAFMN2 ) &amp;</a>
  6145) <a name="l6145" style="background-color: #ffcccc">               GO TO 30</a>
  6146) <a name="l6146" style="background-color: #ffcccc">            R = SQRT( F1**2+G1**2 )</a>
  6147) <a name="l6147" style="background-color: #ffcccc">            CS = F1 / R</a>
  6148) <a name="l6148" style="background-color: #ffcccc">            SN = G1 / R</a>
  6149) <a name="l6149" style="background-color: #ffcccc">            DO 40 I = 1, COUNT</a>
  6150) <a name="l6150" style="background-color: #ffcccc">               R = R*SAFMN2</a>
  6151) <a name="l6151" style="background-color: #ffcccc">   40       CONTINUE</a>
  6152) <a name="l6152" style="background-color: #ffcccc">         ELSE</a>
  6153) <a name="l6153" style="background-color: #ffcccc">            R = SQRT( F1**2+G1**2 )</a>
  6154) <a name="l6154" style="background-color: #ffcccc">            CS = F1 / R</a>
  6155) <a name="l6155" style="background-color: #ffcccc">            SN = G1 / R</a>
  6156) <a name="l6156" style="background-color: #ffcccc">         END IF</a>
  6157) <a name="l6157" style="background-color: #ffcccc">         IF( ABS( F ).GT.ABS( G ) .AND. CS.LT.ZERO ) THEN</a>
  6158) <a name="l6158" style="background-color: #ffcccc">            CS = -CS</a>
  6159) <a name="l6159" style="background-color: #ffcccc">            SN = -SN</a>
  6160) <a name="l6160" style="background-color: #ffcccc">            R = -R</a>
  6161) <a name="l6161" style="background-color: #ffcccc">         END IF</a>
  6162) <a name="l6162" style="background-color: #ffcccc">      END IF</a>
  6163) <a name="l6163" style="background-color: #ffcccc">      RETURN</a>
  6164) <a name="l6164" style="background-color: #ffcccc">!</a>
  6165) <a name="l6165" style="background-color: #ffcccc">!     End of SLARTG</a>
  6166) <a name="l6166" style="background-color: #ffcccc">!</a>
  6167) <a name="l6167" style="background-color: #ffcccc">      END SUBROUTINE SLARTG</a>
  6168) <a name="l6168" style="background-color: #ffffff"></a>
  6169) <a name="l6169" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  6170) <a name="l6170" style="background-color: #ffffff"></a>
  6171) <a name="l6171" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLASCL( TYPE, KL, KU, CFROM, CTO, M, N, A, LDA, INFO )</a>
  6172) <a name="l6172" style="background-color: #ffcccc"></a>
  6173) <a name="l6173" style="background-color: #ffcccc">!</a>
  6174) <a name="l6174" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  6175) <a name="l6175" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  6176) <a name="l6176" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  6177) <a name="l6177" style="background-color: #ffcccc">!     February 29, 1992</a>
  6178) <a name="l6178" style="background-color: #ffcccc">!</a>
  6179) <a name="l6179" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  6180) <a name="l6180" style="background-color: #ffcccc">      CHARACTER          TYPE</a>
  6181) <a name="l6181" style="background-color: #ffcccc">      INTEGER            INFO, KL, KU, LDA, M, N</a>
  6182) <a name="l6182" style="background-color: #ffcccc">      REAL(r8)               CFROM, CTO</a>
  6183) <a name="l6183" style="background-color: #ffcccc">!     ..</a>
  6184) <a name="l6184" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  6185) <a name="l6185" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * )</a>
  6186) <a name="l6186" style="background-color: #ffcccc">!     ..</a>
  6187) <a name="l6187" style="background-color: #ffcccc">!</a>
  6188) <a name="l6188" style="background-color: #ffcccc">!  Purpose</a>
  6189) <a name="l6189" style="background-color: #ffcccc">!  =======</a>
  6190) <a name="l6190" style="background-color: #ffcccc">!</a>
  6191) <a name="l6191" style="background-color: #ffcccc">!  SLASCL multiplies the M by N real matrix A by the real scalar</a>
  6192) <a name="l6192" style="background-color: #ffcccc">!  CTO/CFROM.  This is done without over/underflow as long as the final</a>
  6193) <a name="l6193" style="background-color: #ffcccc">!  result CTO*A(I,J)/CFROM does not over/underflow. TYPE specifies that</a>
  6194) <a name="l6194" style="background-color: #ffcccc">!  A may be full, upper triangular, lower triangular, upper Hessenberg,</a>
  6195) <a name="l6195" style="background-color: #ffcccc">!  or banded.</a>
  6196) <a name="l6196" style="background-color: #ffcccc">!</a>
  6197) <a name="l6197" style="background-color: #ffcccc">!  Arguments</a>
  6198) <a name="l6198" style="background-color: #ffcccc">!  =========</a>
  6199) <a name="l6199" style="background-color: #ffcccc">!</a>
  6200) <a name="l6200" style="background-color: #ffcccc">!  TYPE    (input) CHARACTER*1</a>
  6201) <a name="l6201" style="background-color: #ffcccc">!          TYPE indices the storage type of the input matrix.</a>
  6202) <a name="l6202" style="background-color: #ffcccc">!          = 'G':  A is a full matrix.</a>
  6203) <a name="l6203" style="background-color: #ffcccc">!          = 'L':  A is a lower triangular matrix.</a>
  6204) <a name="l6204" style="background-color: #ffcccc">!          = 'U':  A is an upper triangular matrix.</a>
  6205) <a name="l6205" style="background-color: #ffcccc">!          = 'H':  A is an upper Hessenberg matrix.</a>
  6206) <a name="l6206" style="background-color: #ffcccc">!          = 'B':  A is a symmetric band matrix with lower bandwidth KL</a>
  6207) <a name="l6207" style="background-color: #ffcccc">!                  and upper bandwidth KU and with the only the lower</a>
  6208) <a name="l6208" style="background-color: #ffcccc">!                  half stored.</a>
  6209) <a name="l6209" style="background-color: #ffcccc">!          = 'Q':  A is a symmetric band matrix with lower bandwidth KL</a>
  6210) <a name="l6210" style="background-color: #ffcccc">!                  and upper bandwidth KU and with the only the upper</a>
  6211) <a name="l6211" style="background-color: #ffcccc">!                  half stored.</a>
  6212) <a name="l6212" style="background-color: #ffcccc">!          = 'Z':  A is a band matrix with lower bandwidth KL and upper</a>
  6213) <a name="l6213" style="background-color: #ffcccc">!                  bandwidth KU.</a>
  6214) <a name="l6214" style="background-color: #ffcccc">!</a>
  6215) <a name="l6215" style="background-color: #ffcccc">!  KL      (input) INTEGER</a>
  6216) <a name="l6216" style="background-color: #ffcccc">!          The lower bandwidth of A.  Referenced only if TYPE = 'B',</a>
  6217) <a name="l6217" style="background-color: #ffcccc">!          'Q' or 'Z'.</a>
  6218) <a name="l6218" style="background-color: #ffcccc">!</a>
  6219) <a name="l6219" style="background-color: #ffcccc">!  KU      (input) INTEGER</a>
  6220) <a name="l6220" style="background-color: #ffcccc">!          The upper bandwidth of A.  Referenced only if TYPE = 'B',</a>
  6221) <a name="l6221" style="background-color: #ffcccc">!          'Q' or 'Z'.</a>
  6222) <a name="l6222" style="background-color: #ffcccc">!</a>
  6223) <a name="l6223" style="background-color: #ffcccc">!  CFROM   (input) REAL</a>
  6224) <a name="l6224" style="background-color: #ffcccc">!  CTO     (input) REAL</a>
  6225) <a name="l6225" style="background-color: #ffcccc">!          The matrix A is multiplied by CTO/CFROM. A(I,J) is computed</a>
  6226) <a name="l6226" style="background-color: #ffcccc">!          without over/underflow if the final result CTO*A(I,J)/CFROM</a>
  6227) <a name="l6227" style="background-color: #ffcccc">!          can be represented without over/underflow.  CFROM must be</a>
  6228) <a name="l6228" style="background-color: #ffcccc">!          nonzero.</a>
  6229) <a name="l6229" style="background-color: #ffcccc">!</a>
  6230) <a name="l6230" style="background-color: #ffcccc">!  M       (input) INTEGER</a>
  6231) <a name="l6231" style="background-color: #ffcccc">!          The number of rows of the matrix A.  M &gt;= 0.</a>
  6232) <a name="l6232" style="background-color: #ffcccc">!</a>
  6233) <a name="l6233" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  6234) <a name="l6234" style="background-color: #ffcccc">!          The number of columns of the matrix A.  N &gt;= 0.</a>
  6235) <a name="l6235" style="background-color: #ffcccc">!</a>
  6236) <a name="l6236" style="background-color: #ffcccc">!  A       (input/output) REAL array, dimension (LDA,M)</a>
  6237) <a name="l6237" style="background-color: #ffcccc">!          The matrix to be multiplied by CTO/CFROM.  See TYPE for the</a>
  6238) <a name="l6238" style="background-color: #ffcccc">!          storage type.</a>
  6239) <a name="l6239" style="background-color: #ffcccc">!</a>
  6240) <a name="l6240" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  6241) <a name="l6241" style="background-color: #ffcccc">!          The leading dimension of the array A.  LDA &gt;= max(1,M).</a>
  6242) <a name="l6242" style="background-color: #ffcccc">!</a>
  6243) <a name="l6243" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  6244) <a name="l6244" style="background-color: #ffcccc">!          0  - successful exit</a>
  6245) <a name="l6245" style="background-color: #ffcccc">!          &lt;0 - if INFO = -i, the i-th argument had an illegal value.</a>
  6246) <a name="l6246" style="background-color: #ffcccc">!</a>
  6247) <a name="l6247" style="background-color: #ffcccc">!  =====================================================================</a>
  6248) <a name="l6248" style="background-color: #ffcccc">!</a>
  6249) <a name="l6249" style="background-color: #ffcccc">!     .. Parameters ..</a>
  6250) <a name="l6250" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
  6251) <a name="l6251" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E0_r8, ONE = 1.0E0_r8 )</a>
  6252) <a name="l6252" style="background-color: #ffcccc">!     ..</a>
  6253) <a name="l6253" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  6254) <a name="l6254" style="background-color: #ffcccc">      LOGICAL            DONE</a>
  6255) <a name="l6255" style="background-color: #ffcccc">      INTEGER            I, ITYPE, J, K1, K2, K3, K4</a>
  6256) <a name="l6256" style="background-color: #ffcccc">      REAL(r8)               BIGNUM, CFROM1, CFROMC, CTO1, CTOC, MUL, SMLNUM</a>
  6257) <a name="l6257" style="background-color: #ffcccc">!     ..</a>
  6258) <a name="l6258" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  6259) <a name="l6259" style="background-color: #ffcccc">!</a>
  6260) <a name="l6260" style="background-color: #ffcccc">!     Test the input arguments</a>
  6261) <a name="l6261" style="background-color: #ffcccc">!</a>
  6262) <a name="l6262" style="background-color: #ffcccc">      INFO = 0</a>
  6263) <a name="l6263" style="background-color: #ffcccc">!</a>
  6264) <a name="l6264" style="background-color: #ffcccc">      IF( LSAME( TYPE, 'G' ) ) THEN</a>
  6265) <a name="l6265" style="background-color: #ffcccc">         ITYPE = 0</a>
  6266) <a name="l6266" style="background-color: #ffcccc">      ELSE IF( LSAME( TYPE, 'L' ) ) THEN</a>
  6267) <a name="l6267" style="background-color: #ffcccc">         ITYPE = 1</a>
  6268) <a name="l6268" style="background-color: #ffcccc">      ELSE IF( LSAME( TYPE, 'U' ) ) THEN</a>
  6269) <a name="l6269" style="background-color: #ffcccc">         ITYPE = 2</a>
  6270) <a name="l6270" style="background-color: #ffcccc">      ELSE IF( LSAME( TYPE, 'H' ) ) THEN</a>
  6271) <a name="l6271" style="background-color: #ffcccc">         ITYPE = 3</a>
  6272) <a name="l6272" style="background-color: #ffcccc">      ELSE IF( LSAME( TYPE, 'B' ) ) THEN</a>
  6273) <a name="l6273" style="background-color: #ffcccc">         ITYPE = 4</a>
  6274) <a name="l6274" style="background-color: #ffcccc">      ELSE IF( LSAME( TYPE, 'Q' ) ) THEN</a>
  6275) <a name="l6275" style="background-color: #ffcccc">         ITYPE = 5</a>
  6276) <a name="l6276" style="background-color: #ffcccc">      ELSE IF( LSAME( TYPE, 'Z' ) ) THEN</a>
  6277) <a name="l6277" style="background-color: #ffcccc">         ITYPE = 6</a>
  6278) <a name="l6278" style="background-color: #ffcccc">      ELSE</a>
  6279) <a name="l6279" style="background-color: #ffcccc">         ITYPE = -1</a>
  6280) <a name="l6280" style="background-color: #ffcccc">      END IF</a>
  6281) <a name="l6281" style="background-color: #ffcccc">!</a>
  6282) <a name="l6282" style="background-color: #ffcccc">      IF( ITYPE.EQ.-1 ) THEN</a>
  6283) <a name="l6283" style="background-color: #ffcccc">         INFO = -1</a>
  6284) <a name="l6284" style="background-color: #ffcccc">      ELSE IF( CFROM.EQ.ZERO ) THEN</a>
  6285) <a name="l6285" style="background-color: #ffcccc">         INFO = -4</a>
  6286) <a name="l6286" style="background-color: #ffcccc">      ELSE IF( M.LT.0 ) THEN</a>
  6287) <a name="l6287" style="background-color: #ffcccc">         INFO = -6</a>
  6288) <a name="l6288" style="background-color: #ffcccc">      ELSE IF( N.LT.0 .OR. ( ITYPE.EQ.4 .AND. N.NE.M ) .OR. &amp;</a>
  6289) <a name="l6289" style="background-color: #ffcccc">               ( ITYPE.EQ.5 .AND. N.NE.M ) ) THEN</a>
  6290) <a name="l6290" style="background-color: #ffcccc">         INFO = -7</a>
  6291) <a name="l6291" style="background-color: #ffcccc">      ELSE IF( ITYPE.LE.3 .AND. LDA.LT.MAX( 1, M ) ) THEN</a>
  6292) <a name="l6292" style="background-color: #ffcccc">         INFO = -9</a>
  6293) <a name="l6293" style="background-color: #ffcccc">      ELSE IF( ITYPE.GE.4 ) THEN</a>
  6294) <a name="l6294" style="background-color: #ffcccc">         IF( KL.LT.0 .OR. KL.GT.MAX( M-1, 0 ) ) THEN</a>
  6295) <a name="l6295" style="background-color: #ffcccc">            INFO = -2</a>
  6296) <a name="l6296" style="background-color: #ffcccc">         ELSE IF( KU.LT.0 .OR. KU.GT.MAX( N-1, 0 ) .OR. &amp;</a>
  6297) <a name="l6297" style="background-color: #ffcccc">                  ( ( ITYPE.EQ.4 .OR. ITYPE.EQ.5 ) .AND. KL.NE.KU ) ) &amp;</a>
  6298) <a name="l6298" style="background-color: #ffcccc">                   THEN</a>
  6299) <a name="l6299" style="background-color: #ffcccc">            INFO = -3</a>
  6300) <a name="l6300" style="background-color: #ffcccc">         ELSE IF( ( ITYPE.EQ.4 .AND. LDA.LT.KL+1 ) .OR. &amp;</a>
  6301) <a name="l6301" style="background-color: #ffcccc">                  ( ITYPE.EQ.5 .AND. LDA.LT.KU+1 ) .OR. &amp;</a>
  6302) <a name="l6302" style="background-color: #ffcccc">                  ( ITYPE.EQ.6 .AND. LDA.LT.2*KL+KU+1 ) ) THEN</a>
  6303) <a name="l6303" style="background-color: #ffcccc">            INFO = -9</a>
  6304) <a name="l6304" style="background-color: #ffcccc">         END IF</a>
  6305) <a name="l6305" style="background-color: #ffcccc">      END IF</a>
  6306) <a name="l6306" style="background-color: #ffcccc">!</a>
  6307) <a name="l6307" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
  6308) <a name="l6308" style="background-color: #ffcccc">         CALL XERBLA( 'SLASCL', -INFO )</a>
  6309) <a name="l6309" style="background-color: #ffcccc">         RETURN</a>
  6310) <a name="l6310" style="background-color: #ffcccc">      END IF</a>
  6311) <a name="l6311" style="background-color: #ffcccc">!</a>
  6312) <a name="l6312" style="background-color: #ffcccc">!     Quick return if possible</a>
  6313) <a name="l6313" style="background-color: #ffcccc">!</a>
  6314) <a name="l6314" style="background-color: #ffcccc">      IF( N.EQ.0 .OR. M.EQ.0 ) &amp;</a>
  6315) <a name="l6315" style="background-color: #ffcccc">         RETURN</a>
  6316) <a name="l6316" style="background-color: #ffcccc">!</a>
  6317) <a name="l6317" style="background-color: #ffcccc">!     Get machine parameters</a>
  6318) <a name="l6318" style="background-color: #ffcccc">!</a>
  6319) <a name="l6319" style="background-color: #ffcccc">      SMLNUM = SLAMCH( 'S' )</a>
  6320) <a name="l6320" style="background-color: #ffcccc">      BIGNUM = ONE / SMLNUM</a>
  6321) <a name="l6321" style="background-color: #ffcccc">!</a>
  6322) <a name="l6322" style="background-color: #ffcccc">      CFROMC = CFROM</a>
  6323) <a name="l6323" style="background-color: #ffcccc">      CTOC = CTO</a>
  6324) <a name="l6324" style="background-color: #ffcccc">!</a>
  6325) <a name="l6325" style="background-color: #ffcccc">   10 CONTINUE</a>
  6326) <a name="l6326" style="background-color: #ffcccc">      CFROM1 = CFROMC*SMLNUM</a>
  6327) <a name="l6327" style="background-color: #ffcccc">      CTO1 = CTOC / BIGNUM</a>
  6328) <a name="l6328" style="background-color: #ffcccc">      IF( ABS( CFROM1 ).GT.ABS( CTOC ) .AND. CTOC.NE.ZERO ) THEN</a>
  6329) <a name="l6329" style="background-color: #ffcccc">         MUL = SMLNUM</a>
  6330) <a name="l6330" style="background-color: #ffcccc">         DONE = .FALSE.</a>
  6331) <a name="l6331" style="background-color: #ffcccc">         CFROMC = CFROM1</a>
  6332) <a name="l6332" style="background-color: #ffcccc">      ELSE IF( ABS( CTO1 ).GT.ABS( CFROMC ) ) THEN</a>
  6333) <a name="l6333" style="background-color: #ffcccc">         MUL = BIGNUM</a>
  6334) <a name="l6334" style="background-color: #ffcccc">         DONE = .FALSE.</a>
  6335) <a name="l6335" style="background-color: #ffcccc">         CTOC = CTO1</a>
  6336) <a name="l6336" style="background-color: #ffcccc">      ELSE</a>
  6337) <a name="l6337" style="background-color: #ffcccc">         MUL = CTOC / CFROMC</a>
  6338) <a name="l6338" style="background-color: #ffcccc">         DONE = .TRUE.</a>
  6339) <a name="l6339" style="background-color: #ffcccc">      END IF</a>
  6340) <a name="l6340" style="background-color: #ffcccc">!</a>
  6341) <a name="l6341" style="background-color: #ffcccc">      IF( ITYPE.EQ.0 ) THEN</a>
  6342) <a name="l6342" style="background-color: #ffcccc">!</a>
  6343) <a name="l6343" style="background-color: #ffcccc">!        Full matrix</a>
  6344) <a name="l6344" style="background-color: #ffcccc">!</a>
  6345) <a name="l6345" style="background-color: #ffcccc">         DO 30 J = 1, N</a>
  6346) <a name="l6346" style="background-color: #ffcccc">            DO 20 I = 1, M</a>
  6347) <a name="l6347" style="background-color: #ffcccc">               A( I, J ) = A( I, J )*MUL</a>
  6348) <a name="l6348" style="background-color: #ffcccc">   20       CONTINUE</a>
  6349) <a name="l6349" style="background-color: #ffcccc">   30    CONTINUE</a>
  6350) <a name="l6350" style="background-color: #ffcccc">!</a>
  6351) <a name="l6351" style="background-color: #ffcccc">      ELSE IF( ITYPE.EQ.1 ) THEN</a>
  6352) <a name="l6352" style="background-color: #ffcccc">!</a>
  6353) <a name="l6353" style="background-color: #ffcccc">!        Lower triangular matrix</a>
  6354) <a name="l6354" style="background-color: #ffcccc">!</a>
  6355) <a name="l6355" style="background-color: #ffcccc">         DO 50 J = 1, N</a>
  6356) <a name="l6356" style="background-color: #ffcccc">            DO 40 I = J, M</a>
  6357) <a name="l6357" style="background-color: #ffcccc">               A( I, J ) = A( I, J )*MUL</a>
  6358) <a name="l6358" style="background-color: #ffcccc">   40       CONTINUE</a>
  6359) <a name="l6359" style="background-color: #ffcccc">   50    CONTINUE</a>
  6360) <a name="l6360" style="background-color: #ffcccc">!</a>
  6361) <a name="l6361" style="background-color: #ffcccc">      ELSE IF( ITYPE.EQ.2 ) THEN</a>
  6362) <a name="l6362" style="background-color: #ffcccc">!</a>
  6363) <a name="l6363" style="background-color: #ffcccc">!        Upper triangular matrix</a>
  6364) <a name="l6364" style="background-color: #ffcccc">!</a>
  6365) <a name="l6365" style="background-color: #ffcccc">         DO 70 J = 1, N</a>
  6366) <a name="l6366" style="background-color: #ffcccc">            DO 60 I = 1, MIN( J, M )</a>
  6367) <a name="l6367" style="background-color: #ffcccc">               A( I, J ) = A( I, J )*MUL</a>
  6368) <a name="l6368" style="background-color: #ffcccc">   60       CONTINUE</a>
  6369) <a name="l6369" style="background-color: #ffcccc">   70    CONTINUE</a>
  6370) <a name="l6370" style="background-color: #ffcccc">!</a>
  6371) <a name="l6371" style="background-color: #ffcccc">      ELSE IF( ITYPE.EQ.3 ) THEN</a>
  6372) <a name="l6372" style="background-color: #ffcccc">!</a>
  6373) <a name="l6373" style="background-color: #ffcccc">!        Upper Hessenberg matrix</a>
  6374) <a name="l6374" style="background-color: #ffcccc">!</a>
  6375) <a name="l6375" style="background-color: #ffcccc">         DO 90 J = 1, N</a>
  6376) <a name="l6376" style="background-color: #ffcccc">            DO 80 I = 1, MIN( J+1, M )</a>
  6377) <a name="l6377" style="background-color: #ffcccc">               A( I, J ) = A( I, J )*MUL</a>
  6378) <a name="l6378" style="background-color: #ffcccc">   80       CONTINUE</a>
  6379) <a name="l6379" style="background-color: #ffcccc">   90    CONTINUE</a>
  6380) <a name="l6380" style="background-color: #ffcccc">!</a>
  6381) <a name="l6381" style="background-color: #ffcccc">      ELSE IF( ITYPE.EQ.4 ) THEN</a>
  6382) <a name="l6382" style="background-color: #ffcccc">!</a>
  6383) <a name="l6383" style="background-color: #ffcccc">!        Lower half of a symmetric band matrix</a>
  6384) <a name="l6384" style="background-color: #ffcccc">!</a>
  6385) <a name="l6385" style="background-color: #ffcccc">         K3 = KL + 1</a>
  6386) <a name="l6386" style="background-color: #ffcccc">         K4 = N + 1</a>
  6387) <a name="l6387" style="background-color: #ffcccc">         DO 110 J = 1, N</a>
  6388) <a name="l6388" style="background-color: #ffcccc">            DO 100 I = 1, MIN( K3, K4-J )</a>
  6389) <a name="l6389" style="background-color: #ffcccc">               A( I, J ) = A( I, J )*MUL</a>
  6390) <a name="l6390" style="background-color: #ffcccc">  100       CONTINUE</a>
  6391) <a name="l6391" style="background-color: #ffcccc">  110    CONTINUE</a>
  6392) <a name="l6392" style="background-color: #ffcccc">!</a>
  6393) <a name="l6393" style="background-color: #ffcccc">      ELSE IF( ITYPE.EQ.5 ) THEN</a>
  6394) <a name="l6394" style="background-color: #ffcccc">!</a>
  6395) <a name="l6395" style="background-color: #ffcccc">!        Upper half of a symmetric band matrix</a>
  6396) <a name="l6396" style="background-color: #ffcccc">!</a>
  6397) <a name="l6397" style="background-color: #ffcccc">         K1 = KU + 2</a>
  6398) <a name="l6398" style="background-color: #ffcccc">         K3 = KU + 1</a>
  6399) <a name="l6399" style="background-color: #ffcccc">         DO 130 J = 1, N</a>
  6400) <a name="l6400" style="background-color: #ffcccc">            DO 120 I = MAX( K1-J, 1 ), K3</a>
  6401) <a name="l6401" style="background-color: #ffcccc">               A( I, J ) = A( I, J )*MUL</a>
  6402) <a name="l6402" style="background-color: #ffcccc">  120       CONTINUE</a>
  6403) <a name="l6403" style="background-color: #ffcccc">  130    CONTINUE</a>
  6404) <a name="l6404" style="background-color: #ffcccc">!</a>
  6405) <a name="l6405" style="background-color: #ffcccc">      ELSE IF( ITYPE.EQ.6 ) THEN</a>
  6406) <a name="l6406" style="background-color: #ffcccc">!</a>
  6407) <a name="l6407" style="background-color: #ffcccc">!        Band matrix</a>
  6408) <a name="l6408" style="background-color: #ffcccc">!</a>
  6409) <a name="l6409" style="background-color: #ffcccc">         K1 = KL + KU + 2</a>
  6410) <a name="l6410" style="background-color: #ffcccc">         K2 = KL + 1</a>
  6411) <a name="l6411" style="background-color: #ffcccc">         K3 = 2*KL + KU + 1</a>
  6412) <a name="l6412" style="background-color: #ffcccc">         K4 = KL + KU + 1 + M</a>
  6413) <a name="l6413" style="background-color: #ffcccc">         DO 150 J = 1, N</a>
  6414) <a name="l6414" style="background-color: #ffcccc">            DO 140 I = MAX( K1-J, K2 ), MIN( K3, K4-J )</a>
  6415) <a name="l6415" style="background-color: #ffcccc">               A( I, J ) = A( I, J )*MUL</a>
  6416) <a name="l6416" style="background-color: #ffcccc">  140       CONTINUE</a>
  6417) <a name="l6417" style="background-color: #ffcccc">  150    CONTINUE</a>
  6418) <a name="l6418" style="background-color: #ffcccc">!</a>
  6419) <a name="l6419" style="background-color: #ffcccc">      END IF</a>
  6420) <a name="l6420" style="background-color: #ffcccc">!</a>
  6421) <a name="l6421" style="background-color: #ffcccc">      IF( .NOT.DONE ) &amp;</a>
  6422) <a name="l6422" style="background-color: #ffcccc">         GO TO 10</a>
  6423) <a name="l6423" style="background-color: #ffcccc">!</a>
  6424) <a name="l6424" style="background-color: #ffcccc">      RETURN</a>
  6425) <a name="l6425" style="background-color: #ffcccc">!</a>
  6426) <a name="l6426" style="background-color: #ffcccc">!     End of SLASCL</a>
  6427) <a name="l6427" style="background-color: #ffcccc">!</a>
  6428) <a name="l6428" style="background-color: #ffcccc">      END SUBROUTINE SLASCL</a>
  6429) <a name="l6429" style="background-color: #ffffff"></a>
  6430) <a name="l6430" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  6431) <a name="l6431" style="background-color: #ffffff"></a>
  6432) <a name="l6432" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLASET( UPLO, M, N, ALPHA, BETA, A, LDA )</a>
  6433) <a name="l6433" style="background-color: #ffcccc"></a>
  6434) <a name="l6434" style="background-color: #ffcccc">!</a>
  6435) <a name="l6435" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  6436) <a name="l6436" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  6437) <a name="l6437" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  6438) <a name="l6438" style="background-color: #ffcccc">!     October 31, 1992</a>
  6439) <a name="l6439" style="background-color: #ffcccc">!</a>
  6440) <a name="l6440" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  6441) <a name="l6441" style="background-color: #ffcccc">      CHARACTER          UPLO</a>
  6442) <a name="l6442" style="background-color: #ffcccc">      INTEGER            LDA, M, N</a>
  6443) <a name="l6443" style="background-color: #ffcccc">      REAL(r8)               ALPHA, BETA</a>
  6444) <a name="l6444" style="background-color: #ffcccc">!     ..</a>
  6445) <a name="l6445" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  6446) <a name="l6446" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * )</a>
  6447) <a name="l6447" style="background-color: #ffcccc">!     ..</a>
  6448) <a name="l6448" style="background-color: #ffcccc">!</a>
  6449) <a name="l6449" style="background-color: #ffcccc">!  Purpose</a>
  6450) <a name="l6450" style="background-color: #ffcccc">!  =======</a>
  6451) <a name="l6451" style="background-color: #ffcccc">!</a>
  6452) <a name="l6452" style="background-color: #ffcccc">!  SLASET initializes an m-by-n matrix A to BETA on the diagonal and</a>
  6453) <a name="l6453" style="background-color: #ffcccc">!  ALPHA on the offdiagonals.</a>
  6454) <a name="l6454" style="background-color: #ffcccc">!</a>
  6455) <a name="l6455" style="background-color: #ffcccc">!  Arguments</a>
  6456) <a name="l6456" style="background-color: #ffcccc">!  =========</a>
  6457) <a name="l6457" style="background-color: #ffcccc">!</a>
  6458) <a name="l6458" style="background-color: #ffcccc">!  UPLO    (input) CHARACTER*1</a>
  6459) <a name="l6459" style="background-color: #ffcccc">!          Specifies the part of the matrix A to be set.</a>
  6460) <a name="l6460" style="background-color: #ffcccc">!          = 'U':      Upper triangular part is set; the strictly lower</a>
  6461) <a name="l6461" style="background-color: #ffcccc">!                      triangular part of A is not changed.</a>
  6462) <a name="l6462" style="background-color: #ffcccc">!          = 'L':      Lower triangular part is set; the strictly upper</a>
  6463) <a name="l6463" style="background-color: #ffcccc">!                      triangular part of A is not changed.</a>
  6464) <a name="l6464" style="background-color: #ffcccc">!          Otherwise:  All of the matrix A is set.</a>
  6465) <a name="l6465" style="background-color: #ffcccc">!</a>
  6466) <a name="l6466" style="background-color: #ffcccc">!  M       (input) INTEGER</a>
  6467) <a name="l6467" style="background-color: #ffcccc">!          The number of rows of the matrix A.  M &gt;= 0.</a>
  6468) <a name="l6468" style="background-color: #ffcccc">!</a>
  6469) <a name="l6469" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  6470) <a name="l6470" style="background-color: #ffcccc">!          The number of columns of the matrix A.  N &gt;= 0.</a>
  6471) <a name="l6471" style="background-color: #ffcccc">!</a>
  6472) <a name="l6472" style="background-color: #ffcccc">!  ALPHA   (input) REAL</a>
  6473) <a name="l6473" style="background-color: #ffcccc">!          The constant to which the offdiagonal elements are to be set.</a>
  6474) <a name="l6474" style="background-color: #ffcccc">!</a>
  6475) <a name="l6475" style="background-color: #ffcccc">!  BETA    (input) REAL</a>
  6476) <a name="l6476" style="background-color: #ffcccc">!          The constant to which the diagonal elements are to be set.</a>
  6477) <a name="l6477" style="background-color: #ffcccc">!</a>
  6478) <a name="l6478" style="background-color: #ffcccc">!  A       (input/output) REAL array, dimension (LDA,N)</a>
  6479) <a name="l6479" style="background-color: #ffcccc">!          On exit, the leading m-by-n submatrix of A is set as follows:</a>
  6480) <a name="l6480" style="background-color: #ffcccc">!</a>
  6481) <a name="l6481" style="background-color: #ffcccc">!          if UPLO = 'U', A(i,j) = ALPHA, 1&lt;=i&lt;=j-1, 1&lt;=j&lt;=n,</a>
  6482) <a name="l6482" style="background-color: #ffcccc">!          if UPLO = 'L', A(i,j) = ALPHA, j+1&lt;=i&lt;=m, 1&lt;=j&lt;=n,</a>
  6483) <a name="l6483" style="background-color: #ffcccc">!          otherwise,     A(i,j) = ALPHA, 1&lt;=i&lt;=m, 1&lt;=j&lt;=n, i.ne.j,</a>
  6484) <a name="l6484" style="background-color: #ffcccc">!</a>
  6485) <a name="l6485" style="background-color: #ffcccc">!          and, for all UPLO, A(i,i) = BETA, 1&lt;=i&lt;=min(m,n).</a>
  6486) <a name="l6486" style="background-color: #ffcccc">!</a>
  6487) <a name="l6487" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  6488) <a name="l6488" style="background-color: #ffcccc">!          The leading dimension of the array A.  LDA &gt;= max(1,M).</a>
  6489) <a name="l6489" style="background-color: #ffcccc">!</a>
  6490) <a name="l6490" style="background-color: #ffcccc">! =====================================================================</a>
  6491) <a name="l6491" style="background-color: #ffcccc">!</a>
  6492) <a name="l6492" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  6493) <a name="l6493" style="background-color: #ffcccc">      INTEGER            I, J</a>
  6494) <a name="l6494" style="background-color: #ffcccc">!     ..</a>
  6495) <a name="l6495" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  6496) <a name="l6496" style="background-color: #ffcccc">!</a>
  6497) <a name="l6497" style="background-color: #ffcccc">      IF( LSAME( UPLO, 'U' ) ) THEN</a>
  6498) <a name="l6498" style="background-color: #ffcccc">!</a>
  6499) <a name="l6499" style="background-color: #ffcccc">!        Set the strictly upper triangular or trapezoidal part of the</a>
  6500) <a name="l6500" style="background-color: #ffcccc">!        array to ALPHA.</a>
  6501) <a name="l6501" style="background-color: #ffcccc">!</a>
  6502) <a name="l6502" style="background-color: #ffcccc">         DO 20 J = 2, N</a>
  6503) <a name="l6503" style="background-color: #ffcccc">            DO 10 I = 1, MIN( J-1, M )</a>
  6504) <a name="l6504" style="background-color: #ffcccc">               A( I, J ) = ALPHA</a>
  6505) <a name="l6505" style="background-color: #ffcccc">   10       CONTINUE</a>
  6506) <a name="l6506" style="background-color: #ffcccc">   20    CONTINUE</a>
  6507) <a name="l6507" style="background-color: #ffcccc">!</a>
  6508) <a name="l6508" style="background-color: #ffcccc">      ELSE IF( LSAME( UPLO, 'L' ) ) THEN</a>
  6509) <a name="l6509" style="background-color: #ffcccc">!</a>
  6510) <a name="l6510" style="background-color: #ffcccc">!        Set the strictly lower triangular or trapezoidal part of the</a>
  6511) <a name="l6511" style="background-color: #ffcccc">!        array to ALPHA.</a>
  6512) <a name="l6512" style="background-color: #ffcccc">!</a>
  6513) <a name="l6513" style="background-color: #ffcccc">         DO 40 J = 1, MIN( M, N )</a>
  6514) <a name="l6514" style="background-color: #ffcccc">            DO 30 I = J + 1, M</a>
  6515) <a name="l6515" style="background-color: #ffcccc">               A( I, J ) = ALPHA</a>
  6516) <a name="l6516" style="background-color: #ffcccc">   30       CONTINUE</a>
  6517) <a name="l6517" style="background-color: #ffcccc">   40    CONTINUE</a>
  6518) <a name="l6518" style="background-color: #ffcccc">!</a>
  6519) <a name="l6519" style="background-color: #ffcccc">      ELSE</a>
  6520) <a name="l6520" style="background-color: #ffcccc">!</a>
  6521) <a name="l6521" style="background-color: #ffcccc">!        Set the leading m-by-n submatrix to ALPHA.</a>
  6522) <a name="l6522" style="background-color: #ffcccc">!</a>
  6523) <a name="l6523" style="background-color: #ffcccc">         DO 60 J = 1, N</a>
  6524) <a name="l6524" style="background-color: #ffcccc">            DO 50 I = 1, M</a>
  6525) <a name="l6525" style="background-color: #ffcccc">               A( I, J ) = ALPHA</a>
  6526) <a name="l6526" style="background-color: #ffcccc">   50       CONTINUE</a>
  6527) <a name="l6527" style="background-color: #ffcccc">   60    CONTINUE</a>
  6528) <a name="l6528" style="background-color: #ffcccc">      END IF</a>
  6529) <a name="l6529" style="background-color: #ffcccc">!</a>
  6530) <a name="l6530" style="background-color: #ffcccc">!     Set the first min(M,N) diagonal elements to BETA.</a>
  6531) <a name="l6531" style="background-color: #ffcccc">!</a>
  6532) <a name="l6532" style="background-color: #ffcccc">      DO 70 I = 1, MIN( M, N )</a>
  6533) <a name="l6533" style="background-color: #ffcccc">         A( I, I ) = BETA</a>
  6534) <a name="l6534" style="background-color: #ffcccc">   70 CONTINUE</a>
  6535) <a name="l6535" style="background-color: #ffcccc">!</a>
  6536) <a name="l6536" style="background-color: #ffcccc">      RETURN</a>
  6537) <a name="l6537" style="background-color: #ffcccc">!</a>
  6538) <a name="l6538" style="background-color: #ffcccc">!     End of SLASET</a>
  6539) <a name="l6539" style="background-color: #ffcccc">!</a>
  6540) <a name="l6540" style="background-color: #ffcccc">      END SUBROUTINE SLASET</a>
  6541) <a name="l6541" style="background-color: #ffffff"></a>
  6542) <a name="l6542" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  6543) <a name="l6543" style="background-color: #ffffff"></a>
  6544) <a name="l6544" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLASSQ( N, X, INCX, SCALE, SUMSQ )</a>
  6545) <a name="l6545" style="background-color: #ffcccc"></a>
  6546) <a name="l6546" style="background-color: #ffcccc">!</a>
  6547) <a name="l6547" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  6548) <a name="l6548" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  6549) <a name="l6549" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  6550) <a name="l6550" style="background-color: #ffcccc">!     October 31, 1992</a>
  6551) <a name="l6551" style="background-color: #ffcccc">!</a>
  6552) <a name="l6552" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  6553) <a name="l6553" style="background-color: #ffcccc">      INTEGER            INCX, N</a>
  6554) <a name="l6554" style="background-color: #ffcccc">      REAL(r8)               SCALE, SUMSQ</a>
  6555) <a name="l6555" style="background-color: #ffcccc">!     ..</a>
  6556) <a name="l6556" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  6557) <a name="l6557" style="background-color: #ffcccc">      REAL(r8)               X( * )</a>
  6558) <a name="l6558" style="background-color: #ffcccc">!     ..</a>
  6559) <a name="l6559" style="background-color: #ffcccc">!</a>
  6560) <a name="l6560" style="background-color: #ffcccc">!  Purpose</a>
  6561) <a name="l6561" style="background-color: #ffcccc">!  =======</a>
  6562) <a name="l6562" style="background-color: #ffcccc">!</a>
  6563) <a name="l6563" style="background-color: #ffcccc">!  SLASSQ  returns the values  scl  and  smsq  such that</a>
  6564) <a name="l6564" style="background-color: #ffcccc">!</a>
  6565) <a name="l6565" style="background-color: #ffcccc">!     ( scl**2 )*smsq = x( 1 )**2 +...+ x( n )**2 + ( scale**2 )*sumsq,</a>
  6566) <a name="l6566" style="background-color: #ffcccc">!</a>
  6567) <a name="l6567" style="background-color: #ffcccc">!  where  x( i ) = X( 1 + ( i - 1 )*INCX ). The value of  sumsq  is</a>
  6568) <a name="l6568" style="background-color: #ffcccc">!  assumed to be non-negative and  scl  returns the value</a>
  6569) <a name="l6569" style="background-color: #ffcccc">!</a>
  6570) <a name="l6570" style="background-color: #ffcccc">!     scl = max( scale, abs( x( i ) ) ).</a>
  6571) <a name="l6571" style="background-color: #ffcccc">!</a>
  6572) <a name="l6572" style="background-color: #ffcccc">!  scale and sumsq must be supplied in SCALE and SUMSQ and</a>
  6573) <a name="l6573" style="background-color: #ffcccc">!  scl and smsq are overwritten on SCALE and SUMSQ respectively.</a>
  6574) <a name="l6574" style="background-color: #ffcccc">!</a>
  6575) <a name="l6575" style="background-color: #ffcccc">!  The routine makes only one pass through the vector x.</a>
  6576) <a name="l6576" style="background-color: #ffcccc">!</a>
  6577) <a name="l6577" style="background-color: #ffcccc">!  Arguments</a>
  6578) <a name="l6578" style="background-color: #ffcccc">!  =========</a>
  6579) <a name="l6579" style="background-color: #ffcccc">!</a>
  6580) <a name="l6580" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  6581) <a name="l6581" style="background-color: #ffcccc">!          The number of elements to be used from the vector X.</a>
  6582) <a name="l6582" style="background-color: #ffcccc">!</a>
  6583) <a name="l6583" style="background-color: #ffcccc">!  X       (input) REAL</a>
  6584) <a name="l6584" style="background-color: #ffcccc">!          The vector for which a scaled sum of squares is computed.</a>
  6585) <a name="l6585" style="background-color: #ffcccc">!             x( i )  = X( 1 + ( i - 1 )*INCX ), 1 &lt;= i &lt;= n.</a>
  6586) <a name="l6586" style="background-color: #ffcccc">!</a>
  6587) <a name="l6587" style="background-color: #ffcccc">!  INCX    (input) INTEGER</a>
  6588) <a name="l6588" style="background-color: #ffcccc">!          The increment between successive values of the vector X.</a>
  6589) <a name="l6589" style="background-color: #ffcccc">!          INCX &gt; 0.</a>
  6590) <a name="l6590" style="background-color: #ffcccc">!</a>
  6591) <a name="l6591" style="background-color: #ffcccc">!  SCALE   (input/output) REAL</a>
  6592) <a name="l6592" style="background-color: #ffcccc">!          On entry, the value  scale  in the equation above.</a>
  6593) <a name="l6593" style="background-color: #ffcccc">!          On exit, SCALE is overwritten with  scl , the scaling factor</a>
  6594) <a name="l6594" style="background-color: #ffcccc">!          for the sum of squares.</a>
  6595) <a name="l6595" style="background-color: #ffcccc">!</a>
  6596) <a name="l6596" style="background-color: #ffcccc">!  SUMSQ   (input/output) REAL</a>
  6597) <a name="l6597" style="background-color: #ffcccc">!          On entry, the value  sumsq  in the equation above.</a>
  6598) <a name="l6598" style="background-color: #ffcccc">!          On exit, SUMSQ is overwritten with  smsq , the basic sum of</a>
  6599) <a name="l6599" style="background-color: #ffcccc">!          squares from which  scl  has been factored out.</a>
  6600) <a name="l6600" style="background-color: #ffcccc">!</a>
  6601) <a name="l6601" style="background-color: #ffcccc">! =====================================================================</a>
  6602) <a name="l6602" style="background-color: #ffcccc">!</a>
  6603) <a name="l6603" style="background-color: #ffcccc">!     .. Parameters ..</a>
  6604) <a name="l6604" style="background-color: #ffcccc">      REAL(r8)               ZERO</a>
  6605) <a name="l6605" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8 )</a>
  6606) <a name="l6606" style="background-color: #ffcccc">!     ..</a>
  6607) <a name="l6607" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  6608) <a name="l6608" style="background-color: #ffcccc">      INTEGER            IX</a>
  6609) <a name="l6609" style="background-color: #ffcccc">      REAL(r8)               ABSXI</a>
  6610) <a name="l6610" style="background-color: #ffcccc">!     ..</a>
  6611) <a name="l6611" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  6612) <a name="l6612" style="background-color: #ffcccc">!</a>
  6613) <a name="l6613" style="background-color: #ffcccc">      IF( N.GT.0 ) THEN</a>
  6614) <a name="l6614" style="background-color: #ffcccc">         DO 10 IX = 1, 1 + ( N-1 )*INCX, INCX</a>
  6615) <a name="l6615" style="background-color: #ffcccc">            IF( X( IX ).NE.ZERO ) THEN</a>
  6616) <a name="l6616" style="background-color: #ffcccc">               ABSXI = ABS( X( IX ) )</a>
  6617) <a name="l6617" style="background-color: #ffcccc">               IF( SCALE.LT.ABSXI ) THEN</a>
  6618) <a name="l6618" style="background-color: #ffcccc">                  SUMSQ = 1 + SUMSQ*( SCALE / ABSXI )**2</a>
  6619) <a name="l6619" style="background-color: #ffcccc">                  SCALE = ABSXI</a>
  6620) <a name="l6620" style="background-color: #ffcccc">               ELSE</a>
  6621) <a name="l6621" style="background-color: #ffcccc">                  SUMSQ = SUMSQ + ( ABSXI / SCALE )**2</a>
  6622) <a name="l6622" style="background-color: #ffcccc">               END IF</a>
  6623) <a name="l6623" style="background-color: #ffcccc">            END IF</a>
  6624) <a name="l6624" style="background-color: #ffcccc">   10    CONTINUE</a>
  6625) <a name="l6625" style="background-color: #ffcccc">      END IF</a>
  6626) <a name="l6626" style="background-color: #ffcccc">      RETURN</a>
  6627) <a name="l6627" style="background-color: #ffcccc">!</a>
  6628) <a name="l6628" style="background-color: #ffcccc">!     End of SLASSQ</a>
  6629) <a name="l6629" style="background-color: #ffcccc">!</a>
  6630) <a name="l6630" style="background-color: #ffcccc">      END SUBROUTINE SLASSQ</a>
  6631) <a name="l6631" style="background-color: #ffffff"></a>
  6632) <a name="l6632" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  6633) <a name="l6633" style="background-color: #ffffff"></a>
  6634) <a name="l6634" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SORG2R( M, N, K, A, LDA, TAU, WORK, INFO )</a>
  6635) <a name="l6635" style="background-color: #ffcccc"></a>
  6636) <a name="l6636" style="background-color: #ffcccc">!</a>
  6637) <a name="l6637" style="background-color: #ffcccc">!  -- LAPACK routine (version 2.0) --</a>
  6638) <a name="l6638" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  6639) <a name="l6639" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  6640) <a name="l6640" style="background-color: #ffcccc">!     February 29, 1992</a>
  6641) <a name="l6641" style="background-color: #ffcccc">!</a>
  6642) <a name="l6642" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  6643) <a name="l6643" style="background-color: #ffcccc">      INTEGER            INFO, K, LDA, M, N</a>
  6644) <a name="l6644" style="background-color: #ffcccc">!     ..</a>
  6645) <a name="l6645" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  6646) <a name="l6646" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), TAU( * ), WORK( * )</a>
  6647) <a name="l6647" style="background-color: #ffcccc">!     ..</a>
  6648) <a name="l6648" style="background-color: #ffcccc">!</a>
  6649) <a name="l6649" style="background-color: #ffcccc">!  Purpose</a>
  6650) <a name="l6650" style="background-color: #ffcccc">!  =======</a>
  6651) <a name="l6651" style="background-color: #ffcccc">!</a>
  6652) <a name="l6652" style="background-color: #ffcccc">!  SORG2R generates an m by n real matrix Q with orthonormal columns,</a>
  6653) <a name="l6653" style="background-color: #ffcccc">!  which is defined as the first n columns of a product of k elementary</a>
  6654) <a name="l6654" style="background-color: #ffcccc">!  reflectors of order m</a>
  6655) <a name="l6655" style="background-color: #ffcccc">!</a>
  6656) <a name="l6656" style="background-color: #ffcccc">!        Q  =  H(1) H(2) . . . H(k)</a>
  6657) <a name="l6657" style="background-color: #ffcccc">!</a>
  6658) <a name="l6658" style="background-color: #ffcccc">!  as returned by SGEQRF.</a>
  6659) <a name="l6659" style="background-color: #ffcccc">!</a>
  6660) <a name="l6660" style="background-color: #ffcccc">!  Arguments</a>
  6661) <a name="l6661" style="background-color: #ffcccc">!  =========</a>
  6662) <a name="l6662" style="background-color: #ffcccc">!</a>
  6663) <a name="l6663" style="background-color: #ffcccc">!  M       (input) INTEGER</a>
  6664) <a name="l6664" style="background-color: #ffcccc">!          The number of rows of the matrix Q. M &gt;= 0.</a>
  6665) <a name="l6665" style="background-color: #ffcccc">!</a>
  6666) <a name="l6666" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  6667) <a name="l6667" style="background-color: #ffcccc">!          The number of columns of the matrix Q. M &gt;= N &gt;= 0.</a>
  6668) <a name="l6668" style="background-color: #ffcccc">!</a>
  6669) <a name="l6669" style="background-color: #ffcccc">!  K       (input) INTEGER</a>
  6670) <a name="l6670" style="background-color: #ffcccc">!          The number of elementary reflectors whose product defines the</a>
  6671) <a name="l6671" style="background-color: #ffcccc">!          matrix Q. N &gt;= K &gt;= 0.</a>
  6672) <a name="l6672" style="background-color: #ffcccc">!</a>
  6673) <a name="l6673" style="background-color: #ffcccc">!  A       (input/output) REAL array, dimension (LDA,N)</a>
  6674) <a name="l6674" style="background-color: #ffcccc">!          On entry, the i-th column must contain the vector which</a>
  6675) <a name="l6675" style="background-color: #ffcccc">!          defines the elementary reflector H(i), for i = 1,2,...,k, as</a>
  6676) <a name="l6676" style="background-color: #ffcccc">!          returned by SGEQRF in the first k columns of its array</a>
  6677) <a name="l6677" style="background-color: #ffcccc">!          argument A.</a>
  6678) <a name="l6678" style="background-color: #ffcccc">!          On exit, the m-by-n matrix Q.</a>
  6679) <a name="l6679" style="background-color: #ffcccc">!</a>
  6680) <a name="l6680" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  6681) <a name="l6681" style="background-color: #ffcccc">!          The first dimension of the array A. LDA &gt;= max(1,M).</a>
  6682) <a name="l6682" style="background-color: #ffcccc">!</a>
  6683) <a name="l6683" style="background-color: #ffcccc">!  TAU     (input) REAL array, dimension (K)</a>
  6684) <a name="l6684" style="background-color: #ffcccc">!          TAU(i) must contain the scalar factor of the elementary</a>
  6685) <a name="l6685" style="background-color: #ffcccc">!          reflector H(i), as returned by SGEQRF.</a>
  6686) <a name="l6686" style="background-color: #ffcccc">!</a>
  6687) <a name="l6687" style="background-color: #ffcccc">!  WORK    (workspace) REAL array, dimension (N)</a>
  6688) <a name="l6688" style="background-color: #ffcccc">!</a>
  6689) <a name="l6689" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  6690) <a name="l6690" style="background-color: #ffcccc">!          = 0: successful exit</a>
  6691) <a name="l6691" style="background-color: #ffcccc">!          &lt; 0: if INFO = -i, the i-th argument has an illegal value</a>
  6692) <a name="l6692" style="background-color: #ffcccc">!</a>
  6693) <a name="l6693" style="background-color: #ffcccc">!  =====================================================================</a>
  6694) <a name="l6694" style="background-color: #ffcccc">!</a>
  6695) <a name="l6695" style="background-color: #ffcccc">!     .. Parameters ..</a>
  6696) <a name="l6696" style="background-color: #ffcccc">      REAL(r8)               ONE, ZERO</a>
  6697) <a name="l6697" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
  6698) <a name="l6698" style="background-color: #ffcccc">!     ..</a>
  6699) <a name="l6699" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  6700) <a name="l6700" style="background-color: #ffcccc">      INTEGER            I, J, L</a>
  6701) <a name="l6701" style="background-color: #ffcccc">!     ..</a>
  6702) <a name="l6702" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  6703) <a name="l6703" style="background-color: #ffcccc">!</a>
  6704) <a name="l6704" style="background-color: #ffcccc">!     Test the input arguments</a>
  6705) <a name="l6705" style="background-color: #ffcccc">!</a>
  6706) <a name="l6706" style="background-color: #ffcccc">      INFO = 0</a>
  6707) <a name="l6707" style="background-color: #ffcccc">      IF( M.LT.0 ) THEN</a>
  6708) <a name="l6708" style="background-color: #ffcccc">         INFO = -1</a>
  6709) <a name="l6709" style="background-color: #ffcccc">      ELSE IF( N.LT.0 .OR. N.GT.M ) THEN</a>
  6710) <a name="l6710" style="background-color: #ffcccc">         INFO = -2</a>
  6711) <a name="l6711" style="background-color: #ffcccc">      ELSE IF( K.LT.0 .OR. K.GT.N ) THEN</a>
  6712) <a name="l6712" style="background-color: #ffcccc">         INFO = -3</a>
  6713) <a name="l6713" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, M ) ) THEN</a>
  6714) <a name="l6714" style="background-color: #ffcccc">         INFO = -5</a>
  6715) <a name="l6715" style="background-color: #ffcccc">      END IF</a>
  6716) <a name="l6716" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
  6717) <a name="l6717" style="background-color: #ffcccc">         CALL XERBLA( 'SORG2R', -INFO )</a>
  6718) <a name="l6718" style="background-color: #ffcccc">         RETURN</a>
  6719) <a name="l6719" style="background-color: #ffcccc">      END IF</a>
  6720) <a name="l6720" style="background-color: #ffcccc">!</a>
  6721) <a name="l6721" style="background-color: #ffcccc">!     Quick return if possible</a>
  6722) <a name="l6722" style="background-color: #ffcccc">!</a>
  6723) <a name="l6723" style="background-color: #ffcccc">      IF( N.LE.0 ) &amp;</a>
  6724) <a name="l6724" style="background-color: #ffcccc">         RETURN</a>
  6725) <a name="l6725" style="background-color: #ffcccc">!</a>
  6726) <a name="l6726" style="background-color: #ffcccc">!     Initialise columns k+1:n to columns of the unit matrix</a>
  6727) <a name="l6727" style="background-color: #ffcccc">!</a>
  6728) <a name="l6728" style="background-color: #ffcccc">      DO 20 J = K + 1, N</a>
  6729) <a name="l6729" style="background-color: #ffcccc">         DO 10 L = 1, M</a>
  6730) <a name="l6730" style="background-color: #ffcccc">            A( L, J ) = ZERO</a>
  6731) <a name="l6731" style="background-color: #ffcccc">   10    CONTINUE</a>
  6732) <a name="l6732" style="background-color: #ffcccc">         A( J, J ) = ONE</a>
  6733) <a name="l6733" style="background-color: #ffcccc">   20 CONTINUE</a>
  6734) <a name="l6734" style="background-color: #ffcccc">!</a>
  6735) <a name="l6735" style="background-color: #ffcccc">      DO 40 I = K, 1, -1</a>
  6736) <a name="l6736" style="background-color: #ffcccc">!</a>
  6737) <a name="l6737" style="background-color: #ffcccc">!        Apply H(i) to A(i:m,i:n) from the left</a>
  6738) <a name="l6738" style="background-color: #ffcccc">!</a>
  6739) <a name="l6739" style="background-color: #ffcccc">         IF( I.LT.N ) THEN</a>
  6740) <a name="l6740" style="background-color: #ffcccc">            A( I, I ) = ONE</a>
  6741) <a name="l6741" style="background-color: #ffcccc">            CALL SLARF( 'Left', M-I+1, N-I, A( I, I ), 1, TAU( I ), &amp;</a>
  6742) <a name="l6742" style="background-color: #ffcccc">                        A( I, I+1 ), LDA, WORK )</a>
  6743) <a name="l6743" style="background-color: #ffcccc">         END IF</a>
  6744) <a name="l6744" style="background-color: #ffcccc">         IF( I.LT.M ) &amp;</a>
  6745) <a name="l6745" style="background-color: #ffcccc">            CALL SSCAL( M-I, -TAU( I ), A( I+1, I ), 1 )</a>
  6746) <a name="l6746" style="background-color: #ffcccc">         A( I, I ) = ONE - TAU( I )</a>
  6747) <a name="l6747" style="background-color: #ffcccc">!</a>
  6748) <a name="l6748" style="background-color: #ffcccc">!        Set A(1:i-1,i) to zero</a>
  6749) <a name="l6749" style="background-color: #ffcccc">!</a>
  6750) <a name="l6750" style="background-color: #ffcccc">         DO 30 L = 1, I - 1</a>
  6751) <a name="l6751" style="background-color: #ffcccc">            A( L, I ) = ZERO</a>
  6752) <a name="l6752" style="background-color: #ffcccc">   30    CONTINUE</a>
  6753) <a name="l6753" style="background-color: #ffcccc">   40 CONTINUE</a>
  6754) <a name="l6754" style="background-color: #ffcccc">      RETURN</a>
  6755) <a name="l6755" style="background-color: #ffcccc">!</a>
  6756) <a name="l6756" style="background-color: #ffcccc">!     End of SORG2R</a>
  6757) <a name="l6757" style="background-color: #ffcccc">!</a>
  6758) <a name="l6758" style="background-color: #ffcccc">      END SUBROUTINE SORG2R</a>
  6759) <a name="l6759" style="background-color: #ffffff"></a>
  6760) <a name="l6760" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  6761) <a name="l6761" style="background-color: #ffffff"></a>
  6762) <a name="l6762" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SORGHR( N, ILO, IHI, A, LDA, TAU, WORK, LWORK, INFO )</a>
  6763) <a name="l6763" style="background-color: #ffcccc"></a>
  6764) <a name="l6764" style="background-color: #ffcccc">!</a>
  6765) <a name="l6765" style="background-color: #ffcccc">!  -- LAPACK routine (version 2.0) --</a>
  6766) <a name="l6766" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  6767) <a name="l6767" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  6768) <a name="l6768" style="background-color: #ffcccc">!     September 30, 1994</a>
  6769) <a name="l6769" style="background-color: #ffcccc">!</a>
  6770) <a name="l6770" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  6771) <a name="l6771" style="background-color: #ffcccc">      INTEGER            IHI, ILO, INFO, LDA, LWORK, N</a>
  6772) <a name="l6772" style="background-color: #ffcccc">!     ..</a>
  6773) <a name="l6773" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  6774) <a name="l6774" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), TAU( * ), WORK( LWORK )</a>
  6775) <a name="l6775" style="background-color: #ffcccc">!     ..</a>
  6776) <a name="l6776" style="background-color: #ffcccc">!</a>
  6777) <a name="l6777" style="background-color: #ffcccc">!  Purpose</a>
  6778) <a name="l6778" style="background-color: #ffcccc">!  =======</a>
  6779) <a name="l6779" style="background-color: #ffcccc">!</a>
  6780) <a name="l6780" style="background-color: #ffcccc">!  SORGHR generates a real orthogonal matrix Q which is defined as the</a>
  6781) <a name="l6781" style="background-color: #ffcccc">!  product of IHI-ILO elementary reflectors of order N, as returned by</a>
  6782) <a name="l6782" style="background-color: #ffcccc">!  SGEHRD:</a>
  6783) <a name="l6783" style="background-color: #ffcccc">!</a>
  6784) <a name="l6784" style="background-color: #ffcccc">!  Q = H(ilo) H(ilo+1) . . . H(ihi-1).</a>
  6785) <a name="l6785" style="background-color: #ffcccc">!</a>
  6786) <a name="l6786" style="background-color: #ffcccc">!  Arguments</a>
  6787) <a name="l6787" style="background-color: #ffcccc">!  =========</a>
  6788) <a name="l6788" style="background-color: #ffcccc">!</a>
  6789) <a name="l6789" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  6790) <a name="l6790" style="background-color: #ffcccc">!          The order of the matrix Q. N &gt;= 0.</a>
  6791) <a name="l6791" style="background-color: #ffcccc">!</a>
  6792) <a name="l6792" style="background-color: #ffcccc">!  ILO     (input) INTEGER</a>
  6793) <a name="l6793" style="background-color: #ffcccc">!  IHI     (input) INTEGER</a>
  6794) <a name="l6794" style="background-color: #ffcccc">!          ILO and IHI must have the same values as in the previous call</a>
  6795) <a name="l6795" style="background-color: #ffcccc">!          of SGEHRD. Q is equal to the unit matrix except in the</a>
  6796) <a name="l6796" style="background-color: #ffcccc">!          submatrix Q(ilo+1:ihi,ilo+1:ihi).</a>
  6797) <a name="l6797" style="background-color: #ffcccc">!          1 &lt;= ILO &lt;= IHI &lt;= N, if N &gt; 0; ILO=1 and IHI=0, if N=0.</a>
  6798) <a name="l6798" style="background-color: #ffcccc">!</a>
  6799) <a name="l6799" style="background-color: #ffcccc">!  A       (input/output) REAL array, dimension (LDA,N)</a>
  6800) <a name="l6800" style="background-color: #ffcccc">!          On entry, the vectors which define the elementary reflectors,</a>
  6801) <a name="l6801" style="background-color: #ffcccc">!          as returned by SGEHRD.</a>
  6802) <a name="l6802" style="background-color: #ffcccc">!          On exit, the N-by-N orthogonal matrix Q.</a>
  6803) <a name="l6803" style="background-color: #ffcccc">!</a>
  6804) <a name="l6804" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  6805) <a name="l6805" style="background-color: #ffcccc">!          The leading dimension of the array A. LDA &gt;= max(1,N).</a>
  6806) <a name="l6806" style="background-color: #ffcccc">!</a>
  6807) <a name="l6807" style="background-color: #ffcccc">!  TAU     (input) REAL array, dimension (N-1)</a>
  6808) <a name="l6808" style="background-color: #ffcccc">!          TAU(i) must contain the scalar factor of the elementary</a>
  6809) <a name="l6809" style="background-color: #ffcccc">!          reflector H(i), as returned by SGEHRD.</a>
  6810) <a name="l6810" style="background-color: #ffcccc">!</a>
  6811) <a name="l6811" style="background-color: #ffcccc">!  WORK    (workspace/output) REAL array, dimension (LWORK)</a>
  6812) <a name="l6812" style="background-color: #ffcccc">!          On exit, if INFO = 0, WORK(1) returns the optimal LWORK.</a>
  6813) <a name="l6813" style="background-color: #ffcccc">!</a>
  6814) <a name="l6814" style="background-color: #ffcccc">!  LWORK   (input) INTEGER</a>
  6815) <a name="l6815" style="background-color: #ffcccc">!          The dimension of the array WORK. LWORK &gt;= IHI-ILO.</a>
  6816) <a name="l6816" style="background-color: #ffcccc">!          For optimum performance LWORK &gt;= (IHI-ILO)*NB, where NB is</a>
  6817) <a name="l6817" style="background-color: #ffcccc">!          the optimal blocksize.</a>
  6818) <a name="l6818" style="background-color: #ffcccc">!</a>
  6819) <a name="l6819" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  6820) <a name="l6820" style="background-color: #ffcccc">!          = 0:  successful exit</a>
  6821) <a name="l6821" style="background-color: #ffcccc">!          &lt; 0:  if INFO = -i, the i-th argument had an illegal value</a>
  6822) <a name="l6822" style="background-color: #ffcccc">!</a>
  6823) <a name="l6823" style="background-color: #ffcccc">!  =====================================================================</a>
  6824) <a name="l6824" style="background-color: #ffcccc">!</a>
  6825) <a name="l6825" style="background-color: #ffcccc">!     .. Parameters ..</a>
  6826) <a name="l6826" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
  6827) <a name="l6827" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8, ONE = 1.0E+0_r8 )</a>
  6828) <a name="l6828" style="background-color: #ffcccc">!     ..</a>
  6829) <a name="l6829" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  6830) <a name="l6830" style="background-color: #ffcccc">      INTEGER            I, IINFO, J, NH</a>
  6831) <a name="l6831" style="background-color: #ffcccc">!     ..</a>
  6832) <a name="l6832" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  6833) <a name="l6833" style="background-color: #ffcccc">!</a>
  6834) <a name="l6834" style="background-color: #ffcccc">!     Test the input arguments</a>
  6835) <a name="l6835" style="background-color: #ffcccc">!</a>
  6836) <a name="l6836" style="background-color: #ffcccc">      INFO = 0</a>
  6837) <a name="l6837" style="background-color: #ffcccc">      IF( N.LT.0 ) THEN</a>
  6838) <a name="l6838" style="background-color: #ffcccc">         INFO = -1</a>
  6839) <a name="l6839" style="background-color: #ffcccc">      ELSE IF( ILO.LT.1 .OR. ILO.GT.MAX( 1, N ) ) THEN</a>
  6840) <a name="l6840" style="background-color: #ffcccc">         INFO = -2</a>
  6841) <a name="l6841" style="background-color: #ffcccc">      ELSE IF( IHI.LT.MIN( ILO, N ) .OR. IHI.GT.N ) THEN</a>
  6842) <a name="l6842" style="background-color: #ffcccc">         INFO = -3</a>
  6843) <a name="l6843" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, N ) ) THEN</a>
  6844) <a name="l6844" style="background-color: #ffcccc">         INFO = -5</a>
  6845) <a name="l6845" style="background-color: #ffcccc">      ELSE IF( LWORK.LT.MAX( 1, IHI-ILO ) ) THEN</a>
  6846) <a name="l6846" style="background-color: #ffcccc">         INFO = -8</a>
  6847) <a name="l6847" style="background-color: #ffcccc">      END IF</a>
  6848) <a name="l6848" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
  6849) <a name="l6849" style="background-color: #ffcccc">         CALL XERBLA( 'SORGHR', -INFO )</a>
  6850) <a name="l6850" style="background-color: #ffcccc">         RETURN</a>
  6851) <a name="l6851" style="background-color: #ffcccc">      END IF</a>
  6852) <a name="l6852" style="background-color: #ffcccc">!</a>
  6853) <a name="l6853" style="background-color: #ffcccc">!     Quick return if possible</a>
  6854) <a name="l6854" style="background-color: #ffcccc">!</a>
  6855) <a name="l6855" style="background-color: #ffcccc">      IF( N.EQ.0 ) THEN</a>
  6856) <a name="l6856" style="background-color: #ffcccc">         WORK( 1 ) = 1</a>
  6857) <a name="l6857" style="background-color: #ffcccc">         RETURN</a>
  6858) <a name="l6858" style="background-color: #ffcccc">      END IF</a>
  6859) <a name="l6859" style="background-color: #ffcccc">!</a>
  6860) <a name="l6860" style="background-color: #ffcccc">!     Shift the vectors which define the elementary reflectors one</a>
  6861) <a name="l6861" style="background-color: #ffcccc">!     column to the right, and set the first ilo and the last n-ihi</a>
  6862) <a name="l6862" style="background-color: #ffcccc">!     rows and columns to those of the unit matrix</a>
  6863) <a name="l6863" style="background-color: #ffcccc">!</a>
  6864) <a name="l6864" style="background-color: #ffcccc">      DO 40 J = IHI, ILO + 1, -1</a>
  6865) <a name="l6865" style="background-color: #ffcccc">         DO 10 I = 1, J - 1</a>
  6866) <a name="l6866" style="background-color: #ffcccc">            A( I, J ) = ZERO</a>
  6867) <a name="l6867" style="background-color: #ffcccc">   10    CONTINUE</a>
  6868) <a name="l6868" style="background-color: #ffcccc">         DO 20 I = J + 1, IHI</a>
  6869) <a name="l6869" style="background-color: #ffcccc">            A( I, J ) = A( I, J-1 )</a>
  6870) <a name="l6870" style="background-color: #ffcccc">   20    CONTINUE</a>
  6871) <a name="l6871" style="background-color: #ffcccc">         DO 30 I = IHI + 1, N</a>
  6872) <a name="l6872" style="background-color: #ffcccc">            A( I, J ) = ZERO</a>
  6873) <a name="l6873" style="background-color: #ffcccc">   30    CONTINUE</a>
  6874) <a name="l6874" style="background-color: #ffcccc">   40 CONTINUE</a>
  6875) <a name="l6875" style="background-color: #ffcccc">      DO 60 J = 1, ILO</a>
  6876) <a name="l6876" style="background-color: #ffcccc">         DO 50 I = 1, N</a>
  6877) <a name="l6877" style="background-color: #ffcccc">            A( I, J ) = ZERO</a>
  6878) <a name="l6878" style="background-color: #ffcccc">   50    CONTINUE</a>
  6879) <a name="l6879" style="background-color: #ffcccc">         A( J, J ) = ONE</a>
  6880) <a name="l6880" style="background-color: #ffcccc">   60 CONTINUE</a>
  6881) <a name="l6881" style="background-color: #ffcccc">      DO 80 J = IHI + 1, N</a>
  6882) <a name="l6882" style="background-color: #ffcccc">         DO 70 I = 1, N</a>
  6883) <a name="l6883" style="background-color: #ffcccc">            A( I, J ) = ZERO</a>
  6884) <a name="l6884" style="background-color: #ffcccc">   70    CONTINUE</a>
  6885) <a name="l6885" style="background-color: #ffcccc">         A( J, J ) = ONE</a>
  6886) <a name="l6886" style="background-color: #ffcccc">   80 CONTINUE</a>
  6887) <a name="l6887" style="background-color: #ffcccc">!</a>
  6888) <a name="l6888" style="background-color: #ffcccc">      NH = IHI - ILO</a>
  6889) <a name="l6889" style="background-color: #ffcccc">      IF( NH.GT.0 ) THEN</a>
  6890) <a name="l6890" style="background-color: #ffcccc">!</a>
  6891) <a name="l6891" style="background-color: #ffcccc">!        Generate Q(ilo+1:ihi,ilo+1:ihi)</a>
  6892) <a name="l6892" style="background-color: #ffcccc">!</a>
  6893) <a name="l6893" style="background-color: #ffcccc">         CALL SORGQR( NH, NH, NH, A( ILO+1, ILO+1 ), LDA, TAU( ILO ), &amp;</a>
  6894) <a name="l6894" style="background-color: #ffcccc">                      WORK, LWORK, IINFO )</a>
  6895) <a name="l6895" style="background-color: #ffcccc">      END IF</a>
  6896) <a name="l6896" style="background-color: #ffcccc">      RETURN</a>
  6897) <a name="l6897" style="background-color: #ffcccc">!</a>
  6898) <a name="l6898" style="background-color: #ffcccc">!     End of SORGHR</a>
  6899) <a name="l6899" style="background-color: #ffcccc">!</a>
  6900) <a name="l6900" style="background-color: #ffcccc">      END SUBROUTINE SORGHR</a>
  6901) <a name="l6901" style="background-color: #ffffff"></a>
  6902) <a name="l6902" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  6903) <a name="l6903" style="background-color: #ffffff"></a>
  6904) <a name="l6904" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SORGQR( M, N, K, A, LDA, TAU, WORK, LWORK, INFO )</a>
  6905) <a name="l6905" style="background-color: #ffcccc"></a>
  6906) <a name="l6906" style="background-color: #ffcccc">!</a>
  6907) <a name="l6907" style="background-color: #ffcccc">!  -- LAPACK routine (version 2.0) --</a>
  6908) <a name="l6908" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  6909) <a name="l6909" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  6910) <a name="l6910" style="background-color: #ffcccc">!     September 30, 1994</a>
  6911) <a name="l6911" style="background-color: #ffcccc">!</a>
  6912) <a name="l6912" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  6913) <a name="l6913" style="background-color: #ffcccc">      INTEGER            INFO, K, LDA, LWORK, M, N</a>
  6914) <a name="l6914" style="background-color: #ffcccc">!     ..</a>
  6915) <a name="l6915" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  6916) <a name="l6916" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), TAU( * ), WORK( LWORK )</a>
  6917) <a name="l6917" style="background-color: #ffcccc">!     ..</a>
  6918) <a name="l6918" style="background-color: #ffcccc">!</a>
  6919) <a name="l6919" style="background-color: #ffcccc">!  Purpose</a>
  6920) <a name="l6920" style="background-color: #ffcccc">!  =======</a>
  6921) <a name="l6921" style="background-color: #ffcccc">!</a>
  6922) <a name="l6922" style="background-color: #ffcccc">!  SORGQR generates an M-by-N real matrix Q with orthonormal columns,</a>
  6923) <a name="l6923" style="background-color: #ffcccc">!  which is defined as the first N columns of a product of K elementary</a>
  6924) <a name="l6924" style="background-color: #ffcccc">!  reflectors of order M</a>
  6925) <a name="l6925" style="background-color: #ffcccc">!</a>
  6926) <a name="l6926" style="background-color: #ffcccc">!        Q  =  H(1) H(2) . . . H(k)</a>
  6927) <a name="l6927" style="background-color: #ffcccc">!</a>
  6928) <a name="l6928" style="background-color: #ffcccc">!  as returned by SGEQRF.</a>
  6929) <a name="l6929" style="background-color: #ffcccc">!</a>
  6930) <a name="l6930" style="background-color: #ffcccc">!  Arguments</a>
  6931) <a name="l6931" style="background-color: #ffcccc">!  =========</a>
  6932) <a name="l6932" style="background-color: #ffcccc">!</a>
  6933) <a name="l6933" style="background-color: #ffcccc">!  M       (input) INTEGER</a>
  6934) <a name="l6934" style="background-color: #ffcccc">!          The number of rows of the matrix Q. M &gt;= 0.</a>
  6935) <a name="l6935" style="background-color: #ffcccc">!</a>
  6936) <a name="l6936" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  6937) <a name="l6937" style="background-color: #ffcccc">!          The number of columns of the matrix Q. M &gt;= N &gt;= 0.</a>
  6938) <a name="l6938" style="background-color: #ffcccc">!</a>
  6939) <a name="l6939" style="background-color: #ffcccc">!  K       (input) INTEGER</a>
  6940) <a name="l6940" style="background-color: #ffcccc">!          The number of elementary reflectors whose product defines the</a>
  6941) <a name="l6941" style="background-color: #ffcccc">!          matrix Q. N &gt;= K &gt;= 0.</a>
  6942) <a name="l6942" style="background-color: #ffcccc">!</a>
  6943) <a name="l6943" style="background-color: #ffcccc">!  A       (input/output) REAL array, dimension (LDA,N)</a>
  6944) <a name="l6944" style="background-color: #ffcccc">!          On entry, the i-th column must contain the vector which</a>
  6945) <a name="l6945" style="background-color: #ffcccc">!          defines the elementary reflector H(i), for i = 1,2,...,k, as</a>
  6946) <a name="l6946" style="background-color: #ffcccc">!          returned by SGEQRF in the first k columns of its array</a>
  6947) <a name="l6947" style="background-color: #ffcccc">!          argument A.</a>
  6948) <a name="l6948" style="background-color: #ffcccc">!          On exit, the M-by-N matrix Q.</a>
  6949) <a name="l6949" style="background-color: #ffcccc">!</a>
  6950) <a name="l6950" style="background-color: #ffcccc">!  LDA     (input) INTEGER</a>
  6951) <a name="l6951" style="background-color: #ffcccc">!          The first dimension of the array A. LDA &gt;= max(1,M).</a>
  6952) <a name="l6952" style="background-color: #ffcccc">!</a>
  6953) <a name="l6953" style="background-color: #ffcccc">!  TAU     (input) REAL array, dimension (K)</a>
  6954) <a name="l6954" style="background-color: #ffcccc">!          TAU(i) must contain the scalar factor of the elementary</a>
  6955) <a name="l6955" style="background-color: #ffcccc">!          reflector H(i), as returned by SGEQRF.</a>
  6956) <a name="l6956" style="background-color: #ffcccc">!</a>
  6957) <a name="l6957" style="background-color: #ffcccc">!  WORK    (workspace/output) REAL array, dimension (LWORK)</a>
  6958) <a name="l6958" style="background-color: #ffcccc">!          On exit, if INFO = 0, WORK(1) returns the optimal LWORK.</a>
  6959) <a name="l6959" style="background-color: #ffcccc">!</a>
  6960) <a name="l6960" style="background-color: #ffcccc">!  LWORK   (input) INTEGER</a>
  6961) <a name="l6961" style="background-color: #ffcccc">!          The dimension of the array WORK. LWORK &gt;= max(1,N).</a>
  6962) <a name="l6962" style="background-color: #ffcccc">!          For optimum performance LWORK &gt;= N*NB, where NB is the</a>
  6963) <a name="l6963" style="background-color: #ffcccc">!          optimal blocksize.</a>
  6964) <a name="l6964" style="background-color: #ffcccc">!</a>
  6965) <a name="l6965" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  6966) <a name="l6966" style="background-color: #ffcccc">!          = 0:  successful exit</a>
  6967) <a name="l6967" style="background-color: #ffcccc">!          &lt; 0:  if INFO = -i, the i-th argument has an illegal value</a>
  6968) <a name="l6968" style="background-color: #ffcccc">!</a>
  6969) <a name="l6969" style="background-color: #ffcccc">!  =====================================================================</a>
  6970) <a name="l6970" style="background-color: #ffcccc">!</a>
  6971) <a name="l6971" style="background-color: #ffcccc">!     .. Parameters ..</a>
  6972) <a name="l6972" style="background-color: #ffcccc">      REAL(r8)               ZERO</a>
  6973) <a name="l6973" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8 )</a>
  6974) <a name="l6974" style="background-color: #ffcccc">!     ..</a>
  6975) <a name="l6975" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  6976) <a name="l6976" style="background-color: #ffcccc">      INTEGER            I, IB, IINFO, IWS, J, KI, KK, L, LDWORK, NB, &amp;</a>
  6977) <a name="l6977" style="background-color: #ffcccc">                         NBMIN, NX</a>
  6978) <a name="l6978" style="background-color: #ffcccc">!     ..</a>
  6979) <a name="l6979" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  6980) <a name="l6980" style="background-color: #ffcccc">!</a>
  6981) <a name="l6981" style="background-color: #ffcccc">!     Test the input arguments</a>
  6982) <a name="l6982" style="background-color: #ffcccc">!</a>
  6983) <a name="l6983" style="background-color: #ffcccc">      INFO = 0</a>
  6984) <a name="l6984" style="background-color: #ffcccc">      IF( M.LT.0 ) THEN</a>
  6985) <a name="l6985" style="background-color: #ffcccc">         INFO = -1</a>
  6986) <a name="l6986" style="background-color: #ffcccc">      ELSE IF( N.LT.0 .OR. N.GT.M ) THEN</a>
  6987) <a name="l6987" style="background-color: #ffcccc">         INFO = -2</a>
  6988) <a name="l6988" style="background-color: #ffcccc">      ELSE IF( K.LT.0 .OR. K.GT.N ) THEN</a>
  6989) <a name="l6989" style="background-color: #ffcccc">         INFO = -3</a>
  6990) <a name="l6990" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, M ) ) THEN</a>
  6991) <a name="l6991" style="background-color: #ffcccc">         INFO = -5</a>
  6992) <a name="l6992" style="background-color: #ffcccc">      ELSE IF( LWORK.LT.MAX( 1, N ) ) THEN</a>
  6993) <a name="l6993" style="background-color: #ffcccc">         INFO = -8</a>
  6994) <a name="l6994" style="background-color: #ffcccc">      END IF</a>
  6995) <a name="l6995" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
  6996) <a name="l6996" style="background-color: #ffcccc">         CALL XERBLA( 'SORGQR', -INFO )</a>
  6997) <a name="l6997" style="background-color: #ffcccc">         RETURN</a>
  6998) <a name="l6998" style="background-color: #ffcccc">      END IF</a>
  6999) <a name="l6999" style="background-color: #ffcccc">!</a>
  7000) <a name="l7000" style="background-color: #ffcccc">!     Quick return if possible</a>
  7001) <a name="l7001" style="background-color: #ffcccc">!</a>
  7002) <a name="l7002" style="background-color: #ffcccc">      IF( N.LE.0 ) THEN</a>
  7003) <a name="l7003" style="background-color: #ffcccc">         WORK( 1 ) = 1</a>
  7004) <a name="l7004" style="background-color: #ffcccc">         RETURN</a>
  7005) <a name="l7005" style="background-color: #ffcccc">      END IF</a>
  7006) <a name="l7006" style="background-color: #ffcccc">!</a>
  7007) <a name="l7007" style="background-color: #ffcccc">!     Determine the block size.</a>
  7008) <a name="l7008" style="background-color: #ffcccc">!</a>
  7009) <a name="l7009" style="background-color: #ffcccc">      NB = ILAENV( 1, 'SORGQR', ' ', M, N, K, -1 )</a>
  7010) <a name="l7010" style="background-color: #ffcccc">      NBMIN = 2</a>
  7011) <a name="l7011" style="background-color: #ffcccc">      NX = 0</a>
  7012) <a name="l7012" style="background-color: #ffcccc">      IWS = N</a>
  7013) <a name="l7013" style="background-color: #ffcccc">      IF( NB.GT.1 .AND. NB.LT.K ) THEN</a>
  7014) <a name="l7014" style="background-color: #ffcccc">!</a>
  7015) <a name="l7015" style="background-color: #ffcccc">!        Determine when to cross over from blocked to unblocked code.</a>
  7016) <a name="l7016" style="background-color: #ffcccc">!</a>
  7017) <a name="l7017" style="background-color: #ffcccc">         NX = MAX( 0, ILAENV( 3, 'SORGQR', ' ', M, N, K, -1 ) )</a>
  7018) <a name="l7018" style="background-color: #ffcccc">         IF( NX.LT.K ) THEN</a>
  7019) <a name="l7019" style="background-color: #ffcccc">!</a>
  7020) <a name="l7020" style="background-color: #ffcccc">!           Determine if workspace is large enough for blocked code.</a>
  7021) <a name="l7021" style="background-color: #ffcccc">!</a>
  7022) <a name="l7022" style="background-color: #ffcccc">            LDWORK = N</a>
  7023) <a name="l7023" style="background-color: #ffcccc">            IWS = LDWORK*NB</a>
  7024) <a name="l7024" style="background-color: #ffcccc">            IF( LWORK.LT.IWS ) THEN</a>
  7025) <a name="l7025" style="background-color: #ffcccc">!</a>
  7026) <a name="l7026" style="background-color: #ffcccc">!              Not enough workspace to use optimal NB:  reduce NB and</a>
  7027) <a name="l7027" style="background-color: #ffcccc">!              determine the minimum value of NB.</a>
  7028) <a name="l7028" style="background-color: #ffcccc">!</a>
  7029) <a name="l7029" style="background-color: #ffcccc">               NB = LWORK / LDWORK</a>
  7030) <a name="l7030" style="background-color: #ffcccc">               NBMIN = MAX( 2, ILAENV( 2, 'SORGQR', ' ', M, N, K, -1 ) )</a>
  7031) <a name="l7031" style="background-color: #ffcccc">            END IF</a>
  7032) <a name="l7032" style="background-color: #ffcccc">         END IF</a>
  7033) <a name="l7033" style="background-color: #ffcccc">      END IF</a>
  7034) <a name="l7034" style="background-color: #ffcccc">!</a>
  7035) <a name="l7035" style="background-color: #ffcccc">      IF( NB.GE.NBMIN .AND. NB.LT.K .AND. NX.LT.K ) THEN</a>
  7036) <a name="l7036" style="background-color: #ffcccc">!</a>
  7037) <a name="l7037" style="background-color: #ffcccc">!        Use blocked code after the last block.</a>
  7038) <a name="l7038" style="background-color: #ffcccc">!        The first kk columns are handled by the block method.</a>
  7039) <a name="l7039" style="background-color: #ffcccc">!</a>
  7040) <a name="l7040" style="background-color: #ffcccc">         KI = ( ( K-NX-1 ) / NB )*NB</a>
  7041) <a name="l7041" style="background-color: #ffcccc">         KK = MIN( K, KI+NB )</a>
  7042) <a name="l7042" style="background-color: #ffcccc">!</a>
  7043) <a name="l7043" style="background-color: #ffcccc">!        Set A(1:kk,kk+1:n) to zero.</a>
  7044) <a name="l7044" style="background-color: #ffcccc">!</a>
  7045) <a name="l7045" style="background-color: #ffcccc">         DO 20 J = KK + 1, N</a>
  7046) <a name="l7046" style="background-color: #ffcccc">            DO 10 I = 1, KK</a>
  7047) <a name="l7047" style="background-color: #ffcccc">               A( I, J ) = ZERO</a>
  7048) <a name="l7048" style="background-color: #ffcccc">   10       CONTINUE</a>
  7049) <a name="l7049" style="background-color: #ffcccc">   20    CONTINUE</a>
  7050) <a name="l7050" style="background-color: #ffcccc">      ELSE</a>
  7051) <a name="l7051" style="background-color: #ffcccc">         KK = 0</a>
  7052) <a name="l7052" style="background-color: #ffcccc">      END IF</a>
  7053) <a name="l7053" style="background-color: #ffcccc">!</a>
  7054) <a name="l7054" style="background-color: #ffcccc">!     Use unblocked code for the last or only block.</a>
  7055) <a name="l7055" style="background-color: #ffcccc">!</a>
  7056) <a name="l7056" style="background-color: #ffcccc">      IF( KK.LT.N ) &amp;</a>
  7057) <a name="l7057" style="background-color: #ffcccc">         CALL SORG2R( M-KK, N-KK, K-KK, A( KK+1, KK+1 ), LDA, &amp;</a>
  7058) <a name="l7058" style="background-color: #ffcccc">                      TAU( KK+1 ), WORK, IINFO )</a>
  7059) <a name="l7059" style="background-color: #ffcccc">!</a>
  7060) <a name="l7060" style="background-color: #ffcccc">      IF( KK.GT.0 ) THEN</a>
  7061) <a name="l7061" style="background-color: #ffcccc">!</a>
  7062) <a name="l7062" style="background-color: #ffcccc">!        Use blocked code</a>
  7063) <a name="l7063" style="background-color: #ffcccc">!</a>
  7064) <a name="l7064" style="background-color: #ffcccc">         DO 50 I = KI + 1, 1, -NB</a>
  7065) <a name="l7065" style="background-color: #ffcccc">            IB = MIN( NB, K-I+1 )</a>
  7066) <a name="l7066" style="background-color: #ffcccc">            IF( I+IB.LE.N ) THEN</a>
  7067) <a name="l7067" style="background-color: #ffcccc">!</a>
  7068) <a name="l7068" style="background-color: #ffcccc">!              Form the triangular factor of the block reflector</a>
  7069) <a name="l7069" style="background-color: #ffcccc">!              H = H(i) H(i+1) . . . H(i+ib-1)</a>
  7070) <a name="l7070" style="background-color: #ffcccc">!</a>
  7071) <a name="l7071" style="background-color: #ffcccc">               CALL SLARFT( 'Forward', 'Columnwise', M-I+1, IB, &amp;</a>
  7072) <a name="l7072" style="background-color: #ffcccc">                            A( I, I ), LDA, TAU( I ), WORK, LDWORK )</a>
  7073) <a name="l7073" style="background-color: #ffcccc">!</a>
  7074) <a name="l7074" style="background-color: #ffcccc">!              Apply H to A(i:m,i+ib:n) from the left</a>
  7075) <a name="l7075" style="background-color: #ffcccc">!</a>
  7076) <a name="l7076" style="background-color: #ffcccc">               CALL SLARFB( 'Left', 'No transpose', 'Forward', &amp;</a>
  7077) <a name="l7077" style="background-color: #ffcccc">                            'Columnwise', M-I+1, N-I-IB+1, IB, &amp;</a>
  7078) <a name="l7078" style="background-color: #ffcccc">                            A( I, I ), LDA, WORK, LDWORK, A( I, I+IB ), &amp;</a>
  7079) <a name="l7079" style="background-color: #ffcccc">                            LDA, WORK( IB+1 ), LDWORK )</a>
  7080) <a name="l7080" style="background-color: #ffcccc">            END IF</a>
  7081) <a name="l7081" style="background-color: #ffcccc">!</a>
  7082) <a name="l7082" style="background-color: #ffcccc">!           Apply H to rows i:m of current block</a>
  7083) <a name="l7083" style="background-color: #ffcccc">!</a>
  7084) <a name="l7084" style="background-color: #ffcccc">            CALL SORG2R( M-I+1, IB, IB, A( I, I ), LDA, TAU( I ), WORK, &amp;</a>
  7085) <a name="l7085" style="background-color: #ffcccc">                         IINFO )</a>
  7086) <a name="l7086" style="background-color: #ffcccc">!</a>
  7087) <a name="l7087" style="background-color: #ffcccc">!           Set rows 1:i-1 of current block to zero</a>
  7088) <a name="l7088" style="background-color: #ffcccc">!</a>
  7089) <a name="l7089" style="background-color: #ffcccc">            DO 40 J = I, I + IB - 1</a>
  7090) <a name="l7090" style="background-color: #ffcccc">               DO 30 L = 1, I - 1</a>
  7091) <a name="l7091" style="background-color: #ffcccc">                  A( L, J ) = ZERO</a>
  7092) <a name="l7092" style="background-color: #ffcccc">   30          CONTINUE</a>
  7093) <a name="l7093" style="background-color: #ffcccc">   40       CONTINUE</a>
  7094) <a name="l7094" style="background-color: #ffcccc">   50    CONTINUE</a>
  7095) <a name="l7095" style="background-color: #ffcccc">      END IF</a>
  7096) <a name="l7096" style="background-color: #ffcccc">!</a>
  7097) <a name="l7097" style="background-color: #ffcccc">      WORK( 1 ) = IWS</a>
  7098) <a name="l7098" style="background-color: #ffcccc">      RETURN</a>
  7099) <a name="l7099" style="background-color: #ffcccc">!</a>
  7100) <a name="l7100" style="background-color: #ffcccc">!     End of SORGQR</a>
  7101) <a name="l7101" style="background-color: #ffcccc">!</a>
  7102) <a name="l7102" style="background-color: #ffcccc">      END SUBROUTINE SORGQR</a>
  7103) <a name="l7103" style="background-color: #ffffff"></a>
  7104) <a name="l7104" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  7105) <a name="l7105" style="background-color: #ffffff"></a>
  7106) <a name="l7106" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">STREVC( SIDE, HOWMNY, SELECT, N, T, LDT, VL, LDVL, VR, &amp;</a>
  7107) <a name="l7107" style="background-color: #ffcccc">                         LDVR, MM, M, WORK, INFO )</a>
  7108) <a name="l7108" style="background-color: #ffcccc"></a>
  7109) <a name="l7109" style="background-color: #ffcccc">!</a>
  7110) <a name="l7110" style="background-color: #ffcccc">!  -- LAPACK routine (version 2.0) --</a>
  7111) <a name="l7111" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  7112) <a name="l7112" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  7113) <a name="l7113" style="background-color: #ffcccc">!     September 30, 1994</a>
  7114) <a name="l7114" style="background-color: #ffcccc">!</a>
  7115) <a name="l7115" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  7116) <a name="l7116" style="background-color: #ffcccc">      CHARACTER          HOWMNY, SIDE</a>
  7117) <a name="l7117" style="background-color: #ffcccc">      INTEGER            INFO, LDT, LDVL, LDVR, M, MM, N</a>
  7118) <a name="l7118" style="background-color: #ffcccc">!     ..</a>
  7119) <a name="l7119" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  7120) <a name="l7120" style="background-color: #ffcccc">      LOGICAL            SELECT( * )</a>
  7121) <a name="l7121" style="background-color: #ffcccc">      REAL(r8)               T( LDT, * ), VL( LDVL, * ), VR( LDVR, * ), &amp;</a>
  7122) <a name="l7122" style="background-color: #ffcccc">                         WORK( * )</a>
  7123) <a name="l7123" style="background-color: #ffcccc">!     ..</a>
  7124) <a name="l7124" style="background-color: #ffcccc">!</a>
  7125) <a name="l7125" style="background-color: #ffcccc">!  Purpose</a>
  7126) <a name="l7126" style="background-color: #ffcccc">!  =======</a>
  7127) <a name="l7127" style="background-color: #ffcccc">!</a>
  7128) <a name="l7128" style="background-color: #ffcccc">!  STREVC computes some or all of the right and/or left eigenvectors of</a>
  7129) <a name="l7129" style="background-color: #ffcccc">!  a real upper quasi-triangular matrix T.</a>
  7130) <a name="l7130" style="background-color: #ffcccc">!</a>
  7131) <a name="l7131" style="background-color: #ffcccc">!  The right eigenvector x and the left eigenvector y of T corresponding</a>
  7132) <a name="l7132" style="background-color: #ffcccc">!  to an eigenvalue w are defined by:</a>
  7133) <a name="l7133" style="background-color: #ffcccc">!</a>
  7134) <a name="l7134" style="background-color: #ffcccc">!               T*x = w*x,     y'*T = w*y'</a>
  7135) <a name="l7135" style="background-color: #ffcccc">!</a>
  7136) <a name="l7136" style="background-color: #ffcccc">!  where y' denotes the conjugate transpose of the vector y.</a>
  7137) <a name="l7137" style="background-color: #ffcccc">!</a>
  7138) <a name="l7138" style="background-color: #ffcccc">!  If all eigenvectors are requested, the routine may either return the</a>
  7139) <a name="l7139" style="background-color: #ffcccc">!  matrices X and/or Y of right or left eigenvectors of T, or the</a>
  7140) <a name="l7140" style="background-color: #ffcccc">!  products Q*X and/or Q*Y, where Q is an input orthogonal</a>
  7141) <a name="l7141" style="background-color: #ffcccc">!  matrix. If T was obtained from the real-Schur factorization of an</a>
  7142) <a name="l7142" style="background-color: #ffcccc">!  original matrix A = Q*T*Q', then Q*X and Q*Y are the matrices of</a>
  7143) <a name="l7143" style="background-color: #ffcccc">!  right or left eigenvectors of A.</a>
  7144) <a name="l7144" style="background-color: #ffcccc">!</a>
  7145) <a name="l7145" style="background-color: #ffcccc">!  T must be in Schur canonical form (as returned by SHSEQR), that is,</a>
  7146) <a name="l7146" style="background-color: #ffcccc">!  block upper triangular with 1-by-1 and 2-by-2 diagonal blocks; each</a>
  7147) <a name="l7147" style="background-color: #ffcccc">!  2-by-2 diagonal block has its diagonal elements equal and its</a>
  7148) <a name="l7148" style="background-color: #ffcccc">!  off-diagonal elements of opposite sign.  Corresponding to each 2-by-2</a>
  7149) <a name="l7149" style="background-color: #ffcccc">!  diagonal block is a complex conjugate pair of eigenvalues and</a>
  7150) <a name="l7150" style="background-color: #ffcccc">!  eigenvectors; only one eigenvector of the pair is computed, namely</a>
  7151) <a name="l7151" style="background-color: #ffcccc">!  the one corresponding to the eigenvalue with positive imaginary part.</a>
  7152) <a name="l7152" style="background-color: #ffcccc"></a>
  7153) <a name="l7153" style="background-color: #ffcccc">!</a>
  7154) <a name="l7154" style="background-color: #ffcccc">!  Arguments</a>
  7155) <a name="l7155" style="background-color: #ffcccc">!  =========</a>
  7156) <a name="l7156" style="background-color: #ffcccc">!</a>
  7157) <a name="l7157" style="background-color: #ffcccc">!  SIDE    (input) CHARACTER*1</a>
  7158) <a name="l7158" style="background-color: #ffcccc">!          = 'R':  compute right eigenvectors only;</a>
  7159) <a name="l7159" style="background-color: #ffcccc">!          = 'L':  compute left eigenvectors only;</a>
  7160) <a name="l7160" style="background-color: #ffcccc">!          = 'B':  compute both right and left eigenvectors.</a>
  7161) <a name="l7161" style="background-color: #ffcccc">!</a>
  7162) <a name="l7162" style="background-color: #ffcccc">!  HOWMNY  (input) CHARACTER*1</a>
  7163) <a name="l7163" style="background-color: #ffcccc">!          = 'A':  compute all right and/or left eigenvectors;</a>
  7164) <a name="l7164" style="background-color: #ffcccc">!          = 'B':  compute all right and/or left eigenvectors,</a>
  7165) <a name="l7165" style="background-color: #ffcccc">!                  and backtransform them using the input matrices</a>
  7166) <a name="l7166" style="background-color: #ffcccc">!                  supplied in VR and/or VL;</a>
  7167) <a name="l7167" style="background-color: #ffcccc">!          = 'S':  compute selected right and/or left eigenvectors,</a>
  7168) <a name="l7168" style="background-color: #ffcccc">!                  specified by the logical array SELECT.</a>
  7169) <a name="l7169" style="background-color: #ffcccc">!</a>
  7170) <a name="l7170" style="background-color: #ffcccc">!  SELECT  (input/output) LOGICAL array, dimension (N)</a>
  7171) <a name="l7171" style="background-color: #ffcccc">!          If HOWMNY = 'S', SELECT specifies the eigenvectors to be</a>
  7172) <a name="l7172" style="background-color: #ffcccc">!          computed.</a>
  7173) <a name="l7173" style="background-color: #ffcccc">!          If HOWMNY = 'A' or 'B', SELECT is not referenced.</a>
  7174) <a name="l7174" style="background-color: #ffcccc">!          To select the real eigenvector corresponding to a real</a>
  7175) <a name="l7175" style="background-color: #ffcccc">!          eigenvalue w(j), SELECT(j) must be set to .TRUE..  To select</a>
  7176) <a name="l7176" style="background-color: #ffcccc">!          the complex eigenvector corresponding to a complex conjugate</a>
  7177) <a name="l7177" style="background-color: #ffcccc">!          pair w(j) and w(j+1), either SELECT(j) or SELECT(j+1) must be</a>
  7178) <a name="l7178" style="background-color: #ffcccc">!          set to .TRUE.; then on exit SELECT(j) is .TRUE. and</a>
  7179) <a name="l7179" style="background-color: #ffcccc">!          SELECT(j+1) is .FALSE..</a>
  7180) <a name="l7180" style="background-color: #ffcccc">!</a>
  7181) <a name="l7181" style="background-color: #ffcccc">!  N       (input) INTEGER</a>
  7182) <a name="l7182" style="background-color: #ffcccc">!          The order of the matrix T. N &gt;= 0.</a>
  7183) <a name="l7183" style="background-color: #ffcccc">!</a>
  7184) <a name="l7184" style="background-color: #ffcccc">!  T       (input) REAL array, dimension (LDT,N)</a>
  7185) <a name="l7185" style="background-color: #ffcccc">!          The upper quasi-triangular matrix T in Schur canonical form.</a>
  7186) <a name="l7186" style="background-color: #ffcccc">!</a>
  7187) <a name="l7187" style="background-color: #ffcccc">!  LDT     (input) INTEGER</a>
  7188) <a name="l7188" style="background-color: #ffcccc">!          The leading dimension of the array T. LDT &gt;= max(1,N).</a>
  7189) <a name="l7189" style="background-color: #ffcccc">!</a>
  7190) <a name="l7190" style="background-color: #ffcccc">!  VL      (input/output) REAL array, dimension (LDVL,MM)</a>
  7191) <a name="l7191" style="background-color: #ffcccc">!          On entry, if SIDE = 'L' or 'B' and HOWMNY = 'B', VL must</a>
  7192) <a name="l7192" style="background-color: #ffcccc">!          contain an N-by-N matrix Q (usually the orthogonal matrix Q</a>
  7193) <a name="l7193" style="background-color: #ffcccc">!          of Schur vectors returned by SHSEQR).</a>
  7194) <a name="l7194" style="background-color: #ffcccc">!          On exit, if SIDE = 'L' or 'B', VL contains:</a>
  7195) <a name="l7195" style="background-color: #ffcccc">!          if HOWMNY = 'A', the matrix Y of left eigenvectors of T;</a>
  7196) <a name="l7196" style="background-color: #ffcccc">!          if HOWMNY = 'B', the matrix Q*Y;</a>
  7197) <a name="l7197" style="background-color: #ffcccc">!          if HOWMNY = 'S', the left eigenvectors of T specified by</a>
  7198) <a name="l7198" style="background-color: #ffcccc">!                           SELECT, stored consecutively in the columns</a>
  7199) <a name="l7199" style="background-color: #ffcccc">!                           of VL, in the same order as their</a>
  7200) <a name="l7200" style="background-color: #ffcccc">!                           eigenvalues.</a>
  7201) <a name="l7201" style="background-color: #ffcccc">!          A complex eigenvector corresponding to a complex eigenvalue</a>
  7202) <a name="l7202" style="background-color: #ffcccc">!          is stored in two consecutive columns, the first holding the</a>
  7203) <a name="l7203" style="background-color: #ffcccc">!          real part, and the second the imaginary part.</a>
  7204) <a name="l7204" style="background-color: #ffcccc">!          If SIDE = 'R', VL is not referenced.</a>
  7205) <a name="l7205" style="background-color: #ffcccc">!</a>
  7206) <a name="l7206" style="background-color: #ffcccc">!  LDVL    (input) INTEGER</a>
  7207) <a name="l7207" style="background-color: #ffcccc">!          The leading dimension of the array VL.  LDVL &gt;= max(1,N) if</a>
  7208) <a name="l7208" style="background-color: #ffcccc">!          SIDE = 'L' or 'B'; LDVL &gt;= 1 otherwise.</a>
  7209) <a name="l7209" style="background-color: #ffcccc">!</a>
  7210) <a name="l7210" style="background-color: #ffcccc">!  VR      (input/output) REAL array, dimension (LDVR,MM)</a>
  7211) <a name="l7211" style="background-color: #ffcccc">!          On entry, if SIDE = 'R' or 'B' and HOWMNY = 'B', VR must</a>
  7212) <a name="l7212" style="background-color: #ffcccc">!          contain an N-by-N matrix Q (usually the orthogonal matrix Q</a>
  7213) <a name="l7213" style="background-color: #ffcccc">!          of Schur vectors returned by SHSEQR).</a>
  7214) <a name="l7214" style="background-color: #ffcccc">!          On exit, if SIDE = 'R' or 'B', VR contains:</a>
  7215) <a name="l7215" style="background-color: #ffcccc">!          if HOWMNY = 'A', the matrix X of right eigenvectors of T;</a>
  7216) <a name="l7216" style="background-color: #ffcccc">!          if HOWMNY = 'B', the matrix Q*X;</a>
  7217) <a name="l7217" style="background-color: #ffcccc">!          if HOWMNY = 'S', the right eigenvectors of T specified by</a>
  7218) <a name="l7218" style="background-color: #ffcccc">!                           SELECT, stored consecutively in the columns</a>
  7219) <a name="l7219" style="background-color: #ffcccc">!                           of VR, in the same order as their</a>
  7220) <a name="l7220" style="background-color: #ffcccc">!                           eigenvalues.</a>
  7221) <a name="l7221" style="background-color: #ffcccc">!          A complex eigenvector corresponding to a complex eigenvalue</a>
  7222) <a name="l7222" style="background-color: #ffcccc">!          is stored in two consecutive columns, the first holding the</a>
  7223) <a name="l7223" style="background-color: #ffcccc">!          real part and the second the imaginary part.</a>
  7224) <a name="l7224" style="background-color: #ffcccc">!          If SIDE = 'L', VR is not referenced.</a>
  7225) <a name="l7225" style="background-color: #ffcccc">!</a>
  7226) <a name="l7226" style="background-color: #ffcccc">!  LDVR    (input) INTEGER</a>
  7227) <a name="l7227" style="background-color: #ffcccc">!          The leading dimension of the array VR.  LDVR &gt;= max(1,N) if</a>
  7228) <a name="l7228" style="background-color: #ffcccc">!          SIDE = 'R' or 'B'; LDVR &gt;= 1 otherwise.</a>
  7229) <a name="l7229" style="background-color: #ffcccc">!</a>
  7230) <a name="l7230" style="background-color: #ffcccc">!  MM      (input) INTEGER</a>
  7231) <a name="l7231" style="background-color: #ffcccc">!          The number of columns in the arrays VL and/or VR. MM &gt;= M.</a>
  7232) <a name="l7232" style="background-color: #ffcccc">!</a>
  7233) <a name="l7233" style="background-color: #ffcccc">!  M       (output) INTEGER</a>
  7234) <a name="l7234" style="background-color: #ffcccc">!          The number of columns in the arrays VL and/or VR actually</a>
  7235) <a name="l7235" style="background-color: #ffcccc">!          used to store the eigenvectors.</a>
  7236) <a name="l7236" style="background-color: #ffcccc">!          If HOWMNY = 'A' or 'B', M is set to N.</a>
  7237) <a name="l7237" style="background-color: #ffcccc">!          Each selected real eigenvector occupies one column and each</a>
  7238) <a name="l7238" style="background-color: #ffcccc">!          selected complex eigenvector occupies two columns.</a>
  7239) <a name="l7239" style="background-color: #ffcccc">!</a>
  7240) <a name="l7240" style="background-color: #ffcccc">!  WORK    (workspace) REAL array, dimension (3*N)</a>
  7241) <a name="l7241" style="background-color: #ffcccc">!</a>
  7242) <a name="l7242" style="background-color: #ffcccc">!  INFO    (output) INTEGER</a>
  7243) <a name="l7243" style="background-color: #ffcccc">!          = 0:  successful exit</a>
  7244) <a name="l7244" style="background-color: #ffcccc">!          &lt; 0:  if INFO = -i, the i-th argument had an illegal value</a>
  7245) <a name="l7245" style="background-color: #ffcccc">!</a>
  7246) <a name="l7246" style="background-color: #ffcccc">!  Further Details</a>
  7247) <a name="l7247" style="background-color: #ffcccc">!  ===============</a>
  7248) <a name="l7248" style="background-color: #ffcccc">!</a>
  7249) <a name="l7249" style="background-color: #ffcccc">!  The algorithm used in this program is basically backward (forward)</a>
  7250) <a name="l7250" style="background-color: #ffcccc">!  substitution, with scaling to make the the code robust against</a>
  7251) <a name="l7251" style="background-color: #ffcccc">!  possible overflow.</a>
  7252) <a name="l7252" style="background-color: #ffcccc">!</a>
  7253) <a name="l7253" style="background-color: #ffcccc">!  Each eigenvector is normalized so that the element of largest</a>
  7254) <a name="l7254" style="background-color: #ffcccc">!  magnitude has magnitude 1; here the magnitude of a complex number</a>
  7255) <a name="l7255" style="background-color: #ffcccc">!  (x,y) is taken to be |x| + |y|.</a>
  7256) <a name="l7256" style="background-color: #ffcccc">!</a>
  7257) <a name="l7257" style="background-color: #ffcccc">!  =====================================================================</a>
  7258) <a name="l7258" style="background-color: #ffcccc">!</a>
  7259) <a name="l7259" style="background-color: #ffcccc">!     .. Parameters ..</a>
  7260) <a name="l7260" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
  7261) <a name="l7261" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E+0_r8, ONE = 1.0E+0_r8 )</a>
  7262) <a name="l7262" style="background-color: #ffcccc">!     ..</a>
  7263) <a name="l7263" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  7264) <a name="l7264" style="background-color: #ffcccc">      LOGICAL            ALLV, BOTHV, LEFTV, OVER, PAIR, RIGHTV, SOMEV</a>
  7265) <a name="l7265" style="background-color: #ffcccc">      INTEGER            I, IERR, II, IP, IS, J, J1, J2, JNXT, K, KI, N2</a>
  7266) <a name="l7266" style="background-color: #ffcccc">      REAL(r8)               BETA, BIGNUM, EMAX, OVFL, REC, REMAX, SCALE, &amp;</a>
  7267) <a name="l7267" style="background-color: #ffcccc">                         SMIN, SMLNUM, ULP, UNFL, VCRIT, VMAX, WI, WR, &amp;</a>
  7268) <a name="l7268" style="background-color: #ffcccc">                         XNORM</a>
  7269) <a name="l7269" style="background-color: #ffcccc">!     ..</a>
  7270) <a name="l7270" style="background-color: #ffcccc">!     .. Local Arrays ..</a>
  7271) <a name="l7271" style="background-color: #ffcccc">      REAL(r8)               X( 2, 2 )</a>
  7272) <a name="l7272" style="background-color: #ffcccc">!     ..</a>
  7273) <a name="l7273" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  7274) <a name="l7274" style="background-color: #ffcccc">!</a>
  7275) <a name="l7275" style="background-color: #ffcccc">!     Decode and test the input parameters</a>
  7276) <a name="l7276" style="background-color: #ffcccc">!</a>
  7277) <a name="l7277" style="background-color: #ffcccc">      BOTHV = LSAME( SIDE, 'B' )</a>
  7278) <a name="l7278" style="background-color: #ffcccc">      RIGHTV = LSAME( SIDE, 'R' ) .OR. BOTHV</a>
  7279) <a name="l7279" style="background-color: #ffcccc">      LEFTV = LSAME( SIDE, 'L' ) .OR. BOTHV</a>
  7280) <a name="l7280" style="background-color: #ffcccc">!</a>
  7281) <a name="l7281" style="background-color: #ffcccc">      ALLV = LSAME( HOWMNY, 'A' )</a>
  7282) <a name="l7282" style="background-color: #ffcccc">      OVER = LSAME( HOWMNY, 'B' ) .OR. LSAME( HOWMNY, 'O' )</a>
  7283) <a name="l7283" style="background-color: #ffcccc">      SOMEV = LSAME( HOWMNY, 'S' )</a>
  7284) <a name="l7284" style="background-color: #ffcccc">!</a>
  7285) <a name="l7285" style="background-color: #ffcccc">      INFO = 0</a>
  7286) <a name="l7286" style="background-color: #ffcccc">      IF( .NOT.RIGHTV .AND. .NOT.LEFTV ) THEN</a>
  7287) <a name="l7287" style="background-color: #ffcccc">         INFO = -1</a>
  7288) <a name="l7288" style="background-color: #ffcccc">      ELSE IF( .NOT.ALLV .AND. .NOT.OVER .AND. .NOT.SOMEV ) THEN</a>
  7289) <a name="l7289" style="background-color: #ffcccc">         INFO = -2</a>
  7290) <a name="l7290" style="background-color: #ffcccc">      ELSE IF( N.LT.0 ) THEN</a>
  7291) <a name="l7291" style="background-color: #ffcccc">         INFO = -4</a>
  7292) <a name="l7292" style="background-color: #ffcccc">      ELSE IF( LDT.LT.MAX( 1, N ) ) THEN</a>
  7293) <a name="l7293" style="background-color: #ffcccc">         INFO = -6</a>
  7294) <a name="l7294" style="background-color: #ffcccc">      ELSE IF( LDVL.LT.1 .OR. ( LEFTV .AND. LDVL.LT.N ) ) THEN</a>
  7295) <a name="l7295" style="background-color: #ffcccc">         INFO = -8</a>
  7296) <a name="l7296" style="background-color: #ffcccc">      ELSE IF( LDVR.LT.1 .OR. ( RIGHTV .AND. LDVR.LT.N ) ) THEN</a>
  7297) <a name="l7297" style="background-color: #ffcccc">         INFO = -10</a>
  7298) <a name="l7298" style="background-color: #ffcccc">      ELSE</a>
  7299) <a name="l7299" style="background-color: #ffcccc">!</a>
  7300) <a name="l7300" style="background-color: #ffcccc">!        Set M to the number of columns required to store the selected</a>
  7301) <a name="l7301" style="background-color: #ffcccc">!        eigenvectors, standardize the array SELECT if necessary, and</a>
  7302) <a name="l7302" style="background-color: #ffcccc">!        test MM.</a>
  7303) <a name="l7303" style="background-color: #ffcccc">!</a>
  7304) <a name="l7304" style="background-color: #ffcccc">         IF( SOMEV ) THEN</a>
  7305) <a name="l7305" style="background-color: #ffcccc">            M = 0</a>
  7306) <a name="l7306" style="background-color: #ffcccc">            PAIR = .FALSE.</a>
  7307) <a name="l7307" style="background-color: #ffcccc">            DO 10 J = 1, N</a>
  7308) <a name="l7308" style="background-color: #ffcccc">               IF( PAIR ) THEN</a>
  7309) <a name="l7309" style="background-color: #ffcccc">                  PAIR = .FALSE.</a>
  7310) <a name="l7310" style="background-color: #ffcccc">                  SELECT( J ) = .FALSE.</a>
  7311) <a name="l7311" style="background-color: #ffcccc">               ELSE</a>
  7312) <a name="l7312" style="background-color: #ffcccc">                  IF( J.LT.N ) THEN</a>
  7313) <a name="l7313" style="background-color: #ffcccc">                     IF( T( J+1, J ).EQ.ZERO ) THEN</a>
  7314) <a name="l7314" style="background-color: #ffcccc">                        IF( SELECT( J ) ) &amp;</a>
  7315) <a name="l7315" style="background-color: #ffcccc">                           M = M + 1</a>
  7316) <a name="l7316" style="background-color: #ffcccc">                     ELSE</a>
  7317) <a name="l7317" style="background-color: #ffcccc">                        PAIR = .TRUE.</a>
  7318) <a name="l7318" style="background-color: #ffcccc">                        IF( SELECT( J ) .OR. SELECT( J+1 ) ) THEN</a>
  7319) <a name="l7319" style="background-color: #ffcccc">                           SELECT( J ) = .TRUE.</a>
  7320) <a name="l7320" style="background-color: #ffcccc">                           M = M + 2</a>
  7321) <a name="l7321" style="background-color: #ffcccc">                        END IF</a>
  7322) <a name="l7322" style="background-color: #ffcccc">                     END IF</a>
  7323) <a name="l7323" style="background-color: #ffcccc">                  ELSE</a>
  7324) <a name="l7324" style="background-color: #ffcccc">                     IF( SELECT( N ) ) &amp;</a>
  7325) <a name="l7325" style="background-color: #ffcccc">                        M = M + 1</a>
  7326) <a name="l7326" style="background-color: #ffcccc">                  END IF</a>
  7327) <a name="l7327" style="background-color: #ffcccc">               END IF</a>
  7328) <a name="l7328" style="background-color: #ffcccc">   10       CONTINUE</a>
  7329) <a name="l7329" style="background-color: #ffcccc">         ELSE</a>
  7330) <a name="l7330" style="background-color: #ffcccc">            M = N</a>
  7331) <a name="l7331" style="background-color: #ffcccc">         END IF</a>
  7332) <a name="l7332" style="background-color: #ffcccc">!</a>
  7333) <a name="l7333" style="background-color: #ffcccc">         IF( MM.LT.M ) THEN</a>
  7334) <a name="l7334" style="background-color: #ffcccc">            INFO = -11</a>
  7335) <a name="l7335" style="background-color: #ffcccc">         END IF</a>
  7336) <a name="l7336" style="background-color: #ffcccc">      END IF</a>
  7337) <a name="l7337" style="background-color: #ffcccc">      IF( INFO.NE.0 ) THEN</a>
  7338) <a name="l7338" style="background-color: #ffcccc">         CALL XERBLA( 'STREVC', -INFO )</a>
  7339) <a name="l7339" style="background-color: #ffcccc">         RETURN</a>
  7340) <a name="l7340" style="background-color: #ffcccc">      END IF</a>
  7341) <a name="l7341" style="background-color: #ffcccc">!</a>
  7342) <a name="l7342" style="background-color: #ffcccc">!     Quick return if possible.</a>
  7343) <a name="l7343" style="background-color: #ffcccc">!</a>
  7344) <a name="l7344" style="background-color: #ffcccc">      IF( N.EQ.0 ) &amp;</a>
  7345) <a name="l7345" style="background-color: #ffcccc">         RETURN</a>
  7346) <a name="l7346" style="background-color: #ffcccc">!</a>
  7347) <a name="l7347" style="background-color: #ffcccc">!     Set the constants to control overflow.</a>
  7348) <a name="l7348" style="background-color: #ffcccc">!</a>
  7349) <a name="l7349" style="background-color: #ffcccc">      UNFL = SLAMCH( 'Safe minimum' )</a>
  7350) <a name="l7350" style="background-color: #ffcccc">      OVFL = ONE / UNFL</a>
  7351) <a name="l7351" style="background-color: #ffcccc">      CALL SLABAD( UNFL, OVFL )</a>
  7352) <a name="l7352" style="background-color: #ffcccc">      ULP = SLAMCH( 'Precision' )</a>
  7353) <a name="l7353" style="background-color: #ffcccc">      SMLNUM = UNFL*( N / ULP )</a>
  7354) <a name="l7354" style="background-color: #ffcccc">      BIGNUM = ( ONE-ULP ) / SMLNUM</a>
  7355) <a name="l7355" style="background-color: #ffcccc">!</a>
  7356) <a name="l7356" style="background-color: #ffcccc">!     Compute 1-norm of each column of strictly upper triangular</a>
  7357) <a name="l7357" style="background-color: #ffcccc">!     part of T to control overflow in triangular solver.</a>
  7358) <a name="l7358" style="background-color: #ffcccc">!</a>
  7359) <a name="l7359" style="background-color: #ffcccc">      WORK( 1 ) = ZERO</a>
  7360) <a name="l7360" style="background-color: #ffcccc">      DO 30 J = 2, N</a>
  7361) <a name="l7361" style="background-color: #ffcccc">         WORK( J ) = ZERO</a>
  7362) <a name="l7362" style="background-color: #ffcccc">         DO 20 I = 1, J - 1</a>
  7363) <a name="l7363" style="background-color: #ffcccc">            WORK( J ) = WORK( J ) + ABS( T( I, J ) )</a>
  7364) <a name="l7364" style="background-color: #ffcccc">   20    CONTINUE</a>
  7365) <a name="l7365" style="background-color: #ffcccc">   30 CONTINUE</a>
  7366) <a name="l7366" style="background-color: #ffcccc">!</a>
  7367) <a name="l7367" style="background-color: #ffcccc">!     Index IP is used to specify the real or complex eigenvalue:</a>
  7368) <a name="l7368" style="background-color: #ffcccc">!       IP = 0, real eigenvalue,</a>
  7369) <a name="l7369" style="background-color: #ffcccc">!            1, first of conjugate complex pair: (wr,wi)</a>
  7370) <a name="l7370" style="background-color: #ffcccc">!           -1, second of conjugate complex pair: (wr,wi)</a>
  7371) <a name="l7371" style="background-color: #ffcccc">!</a>
  7372) <a name="l7372" style="background-color: #ffcccc">      N2 = 2*N</a>
  7373) <a name="l7373" style="background-color: #ffcccc">!</a>
  7374) <a name="l7374" style="background-color: #ffcccc">      IF( RIGHTV ) THEN</a>
  7375) <a name="l7375" style="background-color: #ffcccc">!</a>
  7376) <a name="l7376" style="background-color: #ffcccc">!        Compute right eigenvectors.</a>
  7377) <a name="l7377" style="background-color: #ffcccc">!</a>
  7378) <a name="l7378" style="background-color: #ffcccc">         IP = 0</a>
  7379) <a name="l7379" style="background-color: #ffcccc">         IS = M</a>
  7380) <a name="l7380" style="background-color: #ffcccc">         DO 140 KI = N, 1, -1</a>
  7381) <a name="l7381" style="background-color: #ffcccc">!</a>
  7382) <a name="l7382" style="background-color: #ffcccc">            IF( IP.EQ.1 ) &amp;</a>
  7383) <a name="l7383" style="background-color: #ffcccc">               GO TO 130</a>
  7384) <a name="l7384" style="background-color: #ffcccc">            IF( KI.EQ.1 ) &amp;</a>
  7385) <a name="l7385" style="background-color: #ffcccc">               GO TO 40</a>
  7386) <a name="l7386" style="background-color: #ffcccc">            IF( T( KI, KI-1 ).EQ.ZERO ) &amp;</a>
  7387) <a name="l7387" style="background-color: #ffcccc">               GO TO 40</a>
  7388) <a name="l7388" style="background-color: #ffcccc">            IP = -1</a>
  7389) <a name="l7389" style="background-color: #ffcccc">!</a>
  7390) <a name="l7390" style="background-color: #ffcccc">   40       CONTINUE</a>
  7391) <a name="l7391" style="background-color: #ffcccc">            IF( SOMEV ) THEN</a>
  7392) <a name="l7392" style="background-color: #ffcccc">               IF( IP.EQ.0 ) THEN</a>
  7393) <a name="l7393" style="background-color: #ffcccc">                  IF( .NOT.SELECT( KI ) ) &amp;</a>
  7394) <a name="l7394" style="background-color: #ffcccc">                     GO TO 130</a>
  7395) <a name="l7395" style="background-color: #ffcccc">               ELSE</a>
  7396) <a name="l7396" style="background-color: #ffcccc">                  IF( .NOT.SELECT( KI-1 ) ) &amp;</a>
  7397) <a name="l7397" style="background-color: #ffcccc">                     GO TO 130</a>
  7398) <a name="l7398" style="background-color: #ffcccc">               END IF</a>
  7399) <a name="l7399" style="background-color: #ffcccc">            END IF</a>
  7400) <a name="l7400" style="background-color: #ffcccc">!</a>
  7401) <a name="l7401" style="background-color: #ffcccc">!           Compute the KI-th eigenvalue (WR,WI).</a>
  7402) <a name="l7402" style="background-color: #ffcccc">!</a>
  7403) <a name="l7403" style="background-color: #ffcccc">            WR = T( KI, KI )</a>
  7404) <a name="l7404" style="background-color: #ffcccc">            WI = ZERO</a>
  7405) <a name="l7405" style="background-color: #ffcccc">            IF( IP.NE.0 ) &amp;</a>
  7406) <a name="l7406" style="background-color: #ffcccc">               WI = SQRT( ABS( T( KI, KI-1 ) ) )* &amp;</a>
  7407) <a name="l7407" style="background-color: #ffcccc">                    SQRT( ABS( T( KI-1, KI ) ) )</a>
  7408) <a name="l7408" style="background-color: #ffcccc">            SMIN = MAX( ULP*( ABS( WR )+ABS( WI ) ), SMLNUM )</a>
  7409) <a name="l7409" style="background-color: #ffcccc">!</a>
  7410) <a name="l7410" style="background-color: #ffcccc">            IF( IP.EQ.0 ) THEN</a>
  7411) <a name="l7411" style="background-color: #ffcccc">!</a>
  7412) <a name="l7412" style="background-color: #ffcccc">!              Real right eigenvector</a>
  7413) <a name="l7413" style="background-color: #ffcccc">!</a>
  7414) <a name="l7414" style="background-color: #ffcccc">               WORK( KI+N ) = ONE</a>
  7415) <a name="l7415" style="background-color: #ffcccc">!</a>
  7416) <a name="l7416" style="background-color: #ffcccc">!              Form right-hand side</a>
  7417) <a name="l7417" style="background-color: #ffcccc">!</a>
  7418) <a name="l7418" style="background-color: #ffcccc">               DO 50 K = 1, KI - 1</a>
  7419) <a name="l7419" style="background-color: #ffcccc">                  WORK( K+N ) = -T( K, KI )</a>
  7420) <a name="l7420" style="background-color: #ffcccc">   50          CONTINUE</a>
  7421) <a name="l7421" style="background-color: #ffcccc">!</a>
  7422) <a name="l7422" style="background-color: #ffcccc">!              Solve the upper quasi-triangular system:</a>
  7423) <a name="l7423" style="background-color: #ffcccc">!                 (T(1:KI-1,1:KI-1) - WR)*X = SCALE*WORK.</a>
  7424) <a name="l7424" style="background-color: #ffcccc">!</a>
  7425) <a name="l7425" style="background-color: #ffcccc">               JNXT = KI - 1</a>
  7426) <a name="l7426" style="background-color: #ffcccc">               DO 60 J = KI - 1, 1, -1</a>
  7427) <a name="l7427" style="background-color: #ffcccc">                  IF( J.GT.JNXT ) &amp;</a>
  7428) <a name="l7428" style="background-color: #ffcccc">                     GO TO 60</a>
  7429) <a name="l7429" style="background-color: #ffcccc">                  J1 = J</a>
  7430) <a name="l7430" style="background-color: #ffcccc">                  J2 = J</a>
  7431) <a name="l7431" style="background-color: #ffcccc">                  JNXT = J - 1</a>
  7432) <a name="l7432" style="background-color: #ffcccc">                  IF( J.GT.1 ) THEN</a>
  7433) <a name="l7433" style="background-color: #ffcccc">                     IF( T( J, J-1 ).NE.ZERO ) THEN</a>
  7434) <a name="l7434" style="background-color: #ffcccc">                        J1 = J - 1</a>
  7435) <a name="l7435" style="background-color: #ffcccc">                        JNXT = J - 2</a>
  7436) <a name="l7436" style="background-color: #ffcccc">                     END IF</a>
  7437) <a name="l7437" style="background-color: #ffcccc">                  END IF</a>
  7438) <a name="l7438" style="background-color: #ffcccc">!</a>
  7439) <a name="l7439" style="background-color: #ffcccc">                  IF( J1.EQ.J2 ) THEN</a>
  7440) <a name="l7440" style="background-color: #ffcccc">!</a>
  7441) <a name="l7441" style="background-color: #ffcccc">!                    1-by-1 diagonal block</a>
  7442) <a name="l7442" style="background-color: #ffcccc">!</a>
  7443) <a name="l7443" style="background-color: #ffcccc">                     CALL SLALN2( .FALSE., 1, 1, SMIN, ONE, T( J, J ), &amp;</a>
  7444) <a name="l7444" style="background-color: #ffcccc">                                  LDT, ONE, ONE, WORK( J+N ), N, WR, &amp;</a>
  7445) <a name="l7445" style="background-color: #ffcccc">                                  ZERO, X, 2, SCALE, XNORM, IERR )</a>
  7446) <a name="l7446" style="background-color: #ffcccc">!</a>
  7447) <a name="l7447" style="background-color: #ffcccc">!                    Scale X(1,1) to avoid overflow when updating</a>
  7448) <a name="l7448" style="background-color: #ffcccc">!                    the right-hand side.</a>
  7449) <a name="l7449" style="background-color: #ffcccc">!</a>
  7450) <a name="l7450" style="background-color: #ffcccc">                     IF( XNORM.GT.ONE ) THEN</a>
  7451) <a name="l7451" style="background-color: #ffcccc">                        IF( WORK( J ).GT.BIGNUM / XNORM ) THEN</a>
  7452) <a name="l7452" style="background-color: #ffcccc">                           X( 1, 1 ) = X( 1, 1 ) / XNORM</a>
  7453) <a name="l7453" style="background-color: #ffcccc">                           SCALE = SCALE / XNORM</a>
  7454) <a name="l7454" style="background-color: #ffcccc">                        END IF</a>
  7455) <a name="l7455" style="background-color: #ffcccc">                     END IF</a>
  7456) <a name="l7456" style="background-color: #ffcccc">!</a>
  7457) <a name="l7457" style="background-color: #ffcccc">!                    Scale if necessary</a>
  7458) <a name="l7458" style="background-color: #ffcccc">!</a>
  7459) <a name="l7459" style="background-color: #ffcccc">                     IF( SCALE.NE.ONE ) &amp;</a>
  7460) <a name="l7460" style="background-color: #ffcccc">                        CALL SSCAL( KI, SCALE, WORK( 1+N ), 1 )</a>
  7461) <a name="l7461" style="background-color: #ffcccc">                     WORK( J+N ) = X( 1, 1 )</a>
  7462) <a name="l7462" style="background-color: #ffcccc">!</a>
  7463) <a name="l7463" style="background-color: #ffcccc">!                    Update right-hand side</a>
  7464) <a name="l7464" style="background-color: #ffcccc">!</a>
  7465) <a name="l7465" style="background-color: #ffcccc">                     CALL SAXPY( J-1, -X( 1, 1 ), T( 1, J ), 1, &amp;</a>
  7466) <a name="l7466" style="background-color: #ffcccc">                                 WORK( 1+N ), 1 )</a>
  7467) <a name="l7467" style="background-color: #ffcccc">!</a>
  7468) <a name="l7468" style="background-color: #ffcccc">                  ELSE</a>
  7469) <a name="l7469" style="background-color: #ffcccc">!</a>
  7470) <a name="l7470" style="background-color: #ffcccc">!                    2-by-2 diagonal block</a>
  7471) <a name="l7471" style="background-color: #ffcccc">!</a>
  7472) <a name="l7472" style="background-color: #ffcccc">                     CALL SLALN2( .FALSE., 2, 1, SMIN, ONE, &amp;</a>
  7473) <a name="l7473" style="background-color: #ffcccc">                                  T( J-1, J-1 ), LDT, ONE, ONE, &amp;</a>
  7474) <a name="l7474" style="background-color: #ffcccc">                                  WORK( J-1+N ), N, WR, ZERO, X, 2, &amp;</a>
  7475) <a name="l7475" style="background-color: #ffcccc">                                  SCALE, XNORM, IERR )</a>
  7476) <a name="l7476" style="background-color: #ffcccc">!</a>
  7477) <a name="l7477" style="background-color: #ffcccc">!                    Scale X(1,1) and X(2,1) to avoid overflow when</a>
  7478) <a name="l7478" style="background-color: #ffcccc">!                    updating the right-hand side.</a>
  7479) <a name="l7479" style="background-color: #ffcccc">!</a>
  7480) <a name="l7480" style="background-color: #ffcccc">                     IF( XNORM.GT.ONE ) THEN</a>
  7481) <a name="l7481" style="background-color: #ffcccc">                        BETA = MAX( WORK( J-1 ), WORK( J ) )</a>
  7482) <a name="l7482" style="background-color: #ffcccc">                        IF( BETA.GT.BIGNUM / XNORM ) THEN</a>
  7483) <a name="l7483" style="background-color: #ffcccc">                           X( 1, 1 ) = X( 1, 1 ) / XNORM</a>
  7484) <a name="l7484" style="background-color: #ffcccc">                           X( 2, 1 ) = X( 2, 1 ) / XNORM</a>
  7485) <a name="l7485" style="background-color: #ffcccc">                           SCALE = SCALE / XNORM</a>
  7486) <a name="l7486" style="background-color: #ffcccc">                        END IF</a>
  7487) <a name="l7487" style="background-color: #ffcccc">                     END IF</a>
  7488) <a name="l7488" style="background-color: #ffcccc">!</a>
  7489) <a name="l7489" style="background-color: #ffcccc">!                    Scale if necessary</a>
  7490) <a name="l7490" style="background-color: #ffcccc">!</a>
  7491) <a name="l7491" style="background-color: #ffcccc">                     IF( SCALE.NE.ONE ) &amp;</a>
  7492) <a name="l7492" style="background-color: #ffcccc">                        CALL SSCAL( KI, SCALE, WORK( 1+N ), 1 )</a>
  7493) <a name="l7493" style="background-color: #ffcccc">                     WORK( J-1+N ) = X( 1, 1 )</a>
  7494) <a name="l7494" style="background-color: #ffcccc">                     WORK( J+N ) = X( 2, 1 )</a>
  7495) <a name="l7495" style="background-color: #ffcccc">!</a>
  7496) <a name="l7496" style="background-color: #ffcccc">!                    Update right-hand side</a>
  7497) <a name="l7497" style="background-color: #ffcccc">!</a>
  7498) <a name="l7498" style="background-color: #ffcccc">                     CALL SAXPY( J-2, -X( 1, 1 ), T( 1, J-1 ), 1, &amp;</a>
  7499) <a name="l7499" style="background-color: #ffcccc">                                 WORK( 1+N ), 1 )</a>
  7500) <a name="l7500" style="background-color: #ffcccc">                     CALL SAXPY( J-2, -X( 2, 1 ), T( 1, J ), 1, &amp;</a>
  7501) <a name="l7501" style="background-color: #ffcccc">                                 WORK( 1+N ), 1 )</a>
  7502) <a name="l7502" style="background-color: #ffcccc">                  END IF</a>
  7503) <a name="l7503" style="background-color: #ffcccc">   60          CONTINUE</a>
  7504) <a name="l7504" style="background-color: #ffcccc">!</a>
  7505) <a name="l7505" style="background-color: #ffcccc">!              Copy the vector x or Q*x to VR and normalize.</a>
  7506) <a name="l7506" style="background-color: #ffcccc">!</a>
  7507) <a name="l7507" style="background-color: #ffcccc">               IF( .NOT.OVER ) THEN</a>
  7508) <a name="l7508" style="background-color: #ffcccc">                  CALL SCOPY( KI, WORK( 1+N ), 1, VR( 1, IS ), 1 )</a>
  7509) <a name="l7509" style="background-color: #ffcccc">!</a>
  7510) <a name="l7510" style="background-color: #ffcccc">                  II = ISAMAX( KI, VR( 1, IS ), 1 )</a>
  7511) <a name="l7511" style="background-color: #ffcccc">                  REMAX = ONE / ABS( VR( II, IS ) )</a>
  7512) <a name="l7512" style="background-color: #ffcccc">                  CALL SSCAL( KI, REMAX, VR( 1, IS ), 1 )</a>
  7513) <a name="l7513" style="background-color: #ffcccc">!</a>
  7514) <a name="l7514" style="background-color: #ffcccc">                  DO 70 K = KI + 1, N</a>
  7515) <a name="l7515" style="background-color: #ffcccc">                     VR( K, IS ) = ZERO</a>
  7516) <a name="l7516" style="background-color: #ffcccc">   70             CONTINUE</a>
  7517) <a name="l7517" style="background-color: #ffcccc">               ELSE</a>
  7518) <a name="l7518" style="background-color: #ffcccc">                  IF( KI.GT.1 ) &amp;</a>
  7519) <a name="l7519" style="background-color: #ffcccc">                     CALL SGEMV( 'N', N, KI-1, ONE, VR, LDVR, &amp;</a>
  7520) <a name="l7520" style="background-color: #ffcccc">                                 WORK( 1+N ), 1, WORK( KI+N ), &amp;</a>
  7521) <a name="l7521" style="background-color: #ffcccc">                                 VR( 1, KI ), 1 )</a>
  7522) <a name="l7522" style="background-color: #ffcccc">!</a>
  7523) <a name="l7523" style="background-color: #ffcccc">                  II = ISAMAX( N, VR( 1, KI ), 1 )</a>
  7524) <a name="l7524" style="background-color: #ffcccc">                  REMAX = ONE / ABS( VR( II, KI ) )</a>
  7525) <a name="l7525" style="background-color: #ffcccc">                  CALL SSCAL( N, REMAX, VR( 1, KI ), 1 )</a>
  7526) <a name="l7526" style="background-color: #ffcccc">               END IF</a>
  7527) <a name="l7527" style="background-color: #ffcccc">!</a>
  7528) <a name="l7528" style="background-color: #ffcccc">            ELSE</a>
  7529) <a name="l7529" style="background-color: #ffcccc">!</a>
  7530) <a name="l7530" style="background-color: #ffcccc">!              Complex right eigenvector.</a>
  7531) <a name="l7531" style="background-color: #ffcccc">!</a>
  7532) <a name="l7532" style="background-color: #ffcccc">!              Initial solve</a>
  7533) <a name="l7533" style="background-color: #ffcccc">!                [ (T(KI-1,KI-1) T(KI-1,KI) ) - (WR + I* WI)]*X = 0.</a>
  7534) <a name="l7534" style="background-color: #ffcccc">!                [ (T(KI,KI-1)   T(KI,KI)   )               ]</a>
  7535) <a name="l7535" style="background-color: #ffcccc">!</a>
  7536) <a name="l7536" style="background-color: #ffcccc">               IF( ABS( T( KI-1, KI ) ).GE.ABS( T( KI, KI-1 ) ) ) THEN</a>
  7537) <a name="l7537" style="background-color: #ffcccc">                  WORK( KI-1+N ) = ONE</a>
  7538) <a name="l7538" style="background-color: #ffcccc">                  WORK( KI+N2 ) = WI / T( KI-1, KI )</a>
  7539) <a name="l7539" style="background-color: #ffcccc">               ELSE</a>
  7540) <a name="l7540" style="background-color: #ffcccc">                  WORK( KI-1+N ) = -WI / T( KI, KI-1 )</a>
  7541) <a name="l7541" style="background-color: #ffcccc">                  WORK( KI+N2 ) = ONE</a>
  7542) <a name="l7542" style="background-color: #ffcccc">               END IF</a>
  7543) <a name="l7543" style="background-color: #ffcccc">               WORK( KI+N ) = ZERO</a>
  7544) <a name="l7544" style="background-color: #ffcccc">               WORK( KI-1+N2 ) = ZERO</a>
  7545) <a name="l7545" style="background-color: #ffcccc">!</a>
  7546) <a name="l7546" style="background-color: #ffcccc">!              Form right-hand side</a>
  7547) <a name="l7547" style="background-color: #ffcccc">!</a>
  7548) <a name="l7548" style="background-color: #ffcccc">               DO 80 K = 1, KI - 2</a>
  7549) <a name="l7549" style="background-color: #ffcccc">                  WORK( K+N ) = -WORK( KI-1+N )*T( K, KI-1 )</a>
  7550) <a name="l7550" style="background-color: #ffcccc">                  WORK( K+N2 ) = -WORK( KI+N2 )*T( K, KI )</a>
  7551) <a name="l7551" style="background-color: #ffcccc">   80          CONTINUE</a>
  7552) <a name="l7552" style="background-color: #ffcccc">!</a>
  7553) <a name="l7553" style="background-color: #ffcccc">!              Solve upper quasi-triangular system:</a>
  7554) <a name="l7554" style="background-color: #ffcccc">!              (T(1:KI-2,1:KI-2) - (WR+i*WI))*X = SCALE*(WORK+i*WORK2)</a>
  7555) <a name="l7555" style="background-color: #ffcccc">!</a>
  7556) <a name="l7556" style="background-color: #ffcccc">               JNXT = KI - 2</a>
  7557) <a name="l7557" style="background-color: #ffcccc">               DO 90 J = KI - 2, 1, -1</a>
  7558) <a name="l7558" style="background-color: #ffcccc">                  IF( J.GT.JNXT ) &amp;</a>
  7559) <a name="l7559" style="background-color: #ffcccc">                     GO TO 90</a>
  7560) <a name="l7560" style="background-color: #ffcccc">                  J1 = J</a>
  7561) <a name="l7561" style="background-color: #ffcccc">                  J2 = J</a>
  7562) <a name="l7562" style="background-color: #ffcccc">                  JNXT = J - 1</a>
  7563) <a name="l7563" style="background-color: #ffcccc">                  IF( J.GT.1 ) THEN</a>
  7564) <a name="l7564" style="background-color: #ffcccc">                     IF( T( J, J-1 ).NE.ZERO ) THEN</a>
  7565) <a name="l7565" style="background-color: #ffcccc">                        J1 = J - 1</a>
  7566) <a name="l7566" style="background-color: #ffcccc">                        JNXT = J - 2</a>
  7567) <a name="l7567" style="background-color: #ffcccc">                     END IF</a>
  7568) <a name="l7568" style="background-color: #ffcccc">                  END IF</a>
  7569) <a name="l7569" style="background-color: #ffcccc">!</a>
  7570) <a name="l7570" style="background-color: #ffcccc">                  IF( J1.EQ.J2 ) THEN</a>
  7571) <a name="l7571" style="background-color: #ffcccc">!</a>
  7572) <a name="l7572" style="background-color: #ffcccc">!                    1-by-1 diagonal block</a>
  7573) <a name="l7573" style="background-color: #ffcccc">!</a>
  7574) <a name="l7574" style="background-color: #ffcccc">                     CALL SLALN2( .FALSE., 1, 2, SMIN, ONE, T( J, J ), &amp;</a>
  7575) <a name="l7575" style="background-color: #ffcccc">                                  LDT, ONE, ONE, WORK( J+N ), N, WR, WI, &amp;</a>
  7576) <a name="l7576" style="background-color: #ffcccc">                                  X, 2, SCALE, XNORM, IERR )</a>
  7577) <a name="l7577" style="background-color: #ffcccc">!</a>
  7578) <a name="l7578" style="background-color: #ffcccc">!                    Scale X(1,1) and X(1,2) to avoid overflow when</a>
  7579) <a name="l7579" style="background-color: #ffcccc">!                    updating the right-hand side.</a>
  7580) <a name="l7580" style="background-color: #ffcccc">!</a>
  7581) <a name="l7581" style="background-color: #ffcccc">                     IF( XNORM.GT.ONE ) THEN</a>
  7582) <a name="l7582" style="background-color: #ffcccc">                        IF( WORK( J ).GT.BIGNUM / XNORM ) THEN</a>
  7583) <a name="l7583" style="background-color: #ffcccc">                           X( 1, 1 ) = X( 1, 1 ) / XNORM</a>
  7584) <a name="l7584" style="background-color: #ffcccc">                           X( 1, 2 ) = X( 1, 2 ) / XNORM</a>
  7585) <a name="l7585" style="background-color: #ffcccc">                           SCALE = SCALE / XNORM</a>
  7586) <a name="l7586" style="background-color: #ffcccc">                        END IF</a>
  7587) <a name="l7587" style="background-color: #ffcccc">                     END IF</a>
  7588) <a name="l7588" style="background-color: #ffcccc">!</a>
  7589) <a name="l7589" style="background-color: #ffcccc">!                    Scale if necessary</a>
  7590) <a name="l7590" style="background-color: #ffcccc">!</a>
  7591) <a name="l7591" style="background-color: #ffcccc">                     IF( SCALE.NE.ONE ) THEN</a>
  7592) <a name="l7592" style="background-color: #ffcccc">                        CALL SSCAL( KI, SCALE, WORK( 1+N ), 1 )</a>
  7593) <a name="l7593" style="background-color: #ffcccc">                        CALL SSCAL( KI, SCALE, WORK( 1+N2 ), 1 )</a>
  7594) <a name="l7594" style="background-color: #ffcccc">                     END IF</a>
  7595) <a name="l7595" style="background-color: #ffcccc">                     WORK( J+N ) = X( 1, 1 )</a>
  7596) <a name="l7596" style="background-color: #ffcccc">                     WORK( J+N2 ) = X( 1, 2 )</a>
  7597) <a name="l7597" style="background-color: #ffcccc">!</a>
  7598) <a name="l7598" style="background-color: #ffcccc">!                    Update the right-hand side</a>
  7599) <a name="l7599" style="background-color: #ffcccc">!</a>
  7600) <a name="l7600" style="background-color: #ffcccc">                     CALL SAXPY( J-1, -X( 1, 1 ), T( 1, J ), 1, &amp;</a>
  7601) <a name="l7601" style="background-color: #ffcccc">                                 WORK( 1+N ), 1 )</a>
  7602) <a name="l7602" style="background-color: #ffcccc">                     CALL SAXPY( J-1, -X( 1, 2 ), T( 1, J ), 1, &amp;</a>
  7603) <a name="l7603" style="background-color: #ffcccc">                                 WORK( 1+N2 ), 1 )</a>
  7604) <a name="l7604" style="background-color: #ffcccc">!</a>
  7605) <a name="l7605" style="background-color: #ffcccc">                  ELSE</a>
  7606) <a name="l7606" style="background-color: #ffcccc">!</a>
  7607) <a name="l7607" style="background-color: #ffcccc">!                    2-by-2 diagonal block</a>
  7608) <a name="l7608" style="background-color: #ffcccc">!</a>
  7609) <a name="l7609" style="background-color: #ffcccc">                     CALL SLALN2( .FALSE., 2, 2, SMIN, ONE, &amp;</a>
  7610) <a name="l7610" style="background-color: #ffcccc">                                  T( J-1, J-1 ), LDT, ONE, ONE, &amp;</a>
  7611) <a name="l7611" style="background-color: #ffcccc">                                  WORK( J-1+N ), N, WR, WI, X, 2, SCALE, &amp;</a>
  7612) <a name="l7612" style="background-color: #ffcccc">                                  XNORM, IERR )</a>
  7613) <a name="l7613" style="background-color: #ffcccc">!</a>
  7614) <a name="l7614" style="background-color: #ffcccc">!                    Scale X to avoid overflow when updating</a>
  7615) <a name="l7615" style="background-color: #ffcccc">!                    the right-hand side.</a>
  7616) <a name="l7616" style="background-color: #ffcccc">!</a>
  7617) <a name="l7617" style="background-color: #ffcccc">                     IF( XNORM.GT.ONE ) THEN</a>
  7618) <a name="l7618" style="background-color: #ffcccc">                        BETA = MAX( WORK( J-1 ), WORK( J ) )</a>
  7619) <a name="l7619" style="background-color: #ffcccc">                        IF( BETA.GT.BIGNUM / XNORM ) THEN</a>
  7620) <a name="l7620" style="background-color: #ffcccc">                           REC = ONE / XNORM</a>
  7621) <a name="l7621" style="background-color: #ffcccc">                           X( 1, 1 ) = X( 1, 1 )*REC</a>
  7622) <a name="l7622" style="background-color: #ffcccc">                           X( 1, 2 ) = X( 1, 2 )*REC</a>
  7623) <a name="l7623" style="background-color: #ffcccc">                           X( 2, 1 ) = X( 2, 1 )*REC</a>
  7624) <a name="l7624" style="background-color: #ffcccc">                           X( 2, 2 ) = X( 2, 2 )*REC</a>
  7625) <a name="l7625" style="background-color: #ffcccc">                           SCALE = SCALE*REC</a>
  7626) <a name="l7626" style="background-color: #ffcccc">                        END IF</a>
  7627) <a name="l7627" style="background-color: #ffcccc">                     END IF</a>
  7628) <a name="l7628" style="background-color: #ffcccc">!</a>
  7629) <a name="l7629" style="background-color: #ffcccc">!                    Scale if necessary</a>
  7630) <a name="l7630" style="background-color: #ffcccc">!</a>
  7631) <a name="l7631" style="background-color: #ffcccc">                     IF( SCALE.NE.ONE ) THEN</a>
  7632) <a name="l7632" style="background-color: #ffcccc">                        CALL SSCAL( KI, SCALE, WORK( 1+N ), 1 )</a>
  7633) <a name="l7633" style="background-color: #ffcccc">                        CALL SSCAL( KI, SCALE, WORK( 1+N2 ), 1 )</a>
  7634) <a name="l7634" style="background-color: #ffcccc">                     END IF</a>
  7635) <a name="l7635" style="background-color: #ffcccc">                     WORK( J-1+N ) = X( 1, 1 )</a>
  7636) <a name="l7636" style="background-color: #ffcccc">                     WORK( J+N ) = X( 2, 1 )</a>
  7637) <a name="l7637" style="background-color: #ffcccc">                     WORK( J-1+N2 ) = X( 1, 2 )</a>
  7638) <a name="l7638" style="background-color: #ffcccc">                     WORK( J+N2 ) = X( 2, 2 )</a>
  7639) <a name="l7639" style="background-color: #ffcccc">!</a>
  7640) <a name="l7640" style="background-color: #ffcccc">!                    Update the right-hand side</a>
  7641) <a name="l7641" style="background-color: #ffcccc">!</a>
  7642) <a name="l7642" style="background-color: #ffcccc">                     CALL SAXPY( J-2, -X( 1, 1 ), T( 1, J-1 ), 1, &amp;</a>
  7643) <a name="l7643" style="background-color: #ffcccc">                                 WORK( 1+N ), 1 )</a>
  7644) <a name="l7644" style="background-color: #ffcccc">                     CALL SAXPY( J-2, -X( 2, 1 ), T( 1, J ), 1, &amp;</a>
  7645) <a name="l7645" style="background-color: #ffcccc">                                 WORK( 1+N ), 1 )</a>
  7646) <a name="l7646" style="background-color: #ffcccc">                     CALL SAXPY( J-2, -X( 1, 2 ), T( 1, J-1 ), 1, &amp;</a>
  7647) <a name="l7647" style="background-color: #ffcccc">                                 WORK( 1+N2 ), 1 )</a>
  7648) <a name="l7648" style="background-color: #ffcccc">                     CALL SAXPY( J-2, -X( 2, 2 ), T( 1, J ), 1, &amp;</a>
  7649) <a name="l7649" style="background-color: #ffcccc">                                 WORK( 1+N2 ), 1 )</a>
  7650) <a name="l7650" style="background-color: #ffcccc">                  END IF</a>
  7651) <a name="l7651" style="background-color: #ffcccc">   90          CONTINUE</a>
  7652) <a name="l7652" style="background-color: #ffcccc">!</a>
  7653) <a name="l7653" style="background-color: #ffcccc">!              Copy the vector x or Q*x to VR and normalize.</a>
  7654) <a name="l7654" style="background-color: #ffcccc">!</a>
  7655) <a name="l7655" style="background-color: #ffcccc">               IF( .NOT.OVER ) THEN</a>
  7656) <a name="l7656" style="background-color: #ffcccc">                  CALL SCOPY( KI, WORK( 1+N ), 1, VR( 1, IS-1 ), 1 )</a>
  7657) <a name="l7657" style="background-color: #ffcccc">                  CALL SCOPY( KI, WORK( 1+N2 ), 1, VR( 1, IS ), 1 )</a>
  7658) <a name="l7658" style="background-color: #ffcccc">!</a>
  7659) <a name="l7659" style="background-color: #ffcccc">                  EMAX = ZERO</a>
  7660) <a name="l7660" style="background-color: #ffcccc">                  DO 100 K = 1, KI</a>
  7661) <a name="l7661" style="background-color: #ffcccc">                     EMAX = MAX( EMAX, ABS( VR( K, IS-1 ) )+ &amp;</a>
  7662) <a name="l7662" style="background-color: #ffcccc">                            ABS( VR( K, IS ) ) )</a>
  7663) <a name="l7663" style="background-color: #ffcccc">  100             CONTINUE</a>
  7664) <a name="l7664" style="background-color: #ffcccc">!</a>
  7665) <a name="l7665" style="background-color: #ffcccc">                  REMAX = ONE / EMAX</a>
  7666) <a name="l7666" style="background-color: #ffcccc">                  CALL SSCAL( KI, REMAX, VR( 1, IS-1 ), 1 )</a>
  7667) <a name="l7667" style="background-color: #ffcccc">                  CALL SSCAL( KI, REMAX, VR( 1, IS ), 1 )</a>
  7668) <a name="l7668" style="background-color: #ffcccc">!</a>
  7669) <a name="l7669" style="background-color: #ffcccc">                  DO 110 K = KI + 1, N</a>
  7670) <a name="l7670" style="background-color: #ffcccc">                     VR( K, IS-1 ) = ZERO</a>
  7671) <a name="l7671" style="background-color: #ffcccc">                     VR( K, IS ) = ZERO</a>
  7672) <a name="l7672" style="background-color: #ffcccc">  110             CONTINUE</a>
  7673) <a name="l7673" style="background-color: #ffcccc">!</a>
  7674) <a name="l7674" style="background-color: #ffcccc">               ELSE</a>
  7675) <a name="l7675" style="background-color: #ffcccc">!</a>
  7676) <a name="l7676" style="background-color: #ffcccc">                  IF( KI.GT.2 ) THEN</a>
  7677) <a name="l7677" style="background-color: #ffcccc">                     CALL SGEMV( 'N', N, KI-2, ONE, VR, LDVR, &amp;</a>
  7678) <a name="l7678" style="background-color: #ffcccc">                                 WORK( 1+N ), 1, WORK( KI-1+N ), &amp;</a>
  7679) <a name="l7679" style="background-color: #ffcccc">                                 VR( 1, KI-1 ), 1 )</a>
  7680) <a name="l7680" style="background-color: #ffcccc">                     CALL SGEMV( 'N', N, KI-2, ONE, VR, LDVR, &amp;</a>
  7681) <a name="l7681" style="background-color: #ffcccc">                                 WORK( 1+N2 ), 1, WORK( KI+N2 ), &amp;</a>
  7682) <a name="l7682" style="background-color: #ffcccc">                                 VR( 1, KI ), 1 )</a>
  7683) <a name="l7683" style="background-color: #ffcccc">                  ELSE</a>
  7684) <a name="l7684" style="background-color: #ffcccc">                     CALL SSCAL( N, WORK( KI-1+N ), VR( 1, KI-1 ), 1 )</a>
  7685) <a name="l7685" style="background-color: #ffcccc">                     CALL SSCAL( N, WORK( KI+N2 ), VR( 1, KI ), 1 )</a>
  7686) <a name="l7686" style="background-color: #ffcccc">                  END IF</a>
  7687) <a name="l7687" style="background-color: #ffcccc">!</a>
  7688) <a name="l7688" style="background-color: #ffcccc">                  EMAX = ZERO</a>
  7689) <a name="l7689" style="background-color: #ffcccc">                  DO 120 K = 1, N</a>
  7690) <a name="l7690" style="background-color: #ffcccc">                     EMAX = MAX( EMAX, ABS( VR( K, KI-1 ) )+ &amp;</a>
  7691) <a name="l7691" style="background-color: #ffcccc">                            ABS( VR( K, KI ) ) )</a>
  7692) <a name="l7692" style="background-color: #ffcccc">  120             CONTINUE</a>
  7693) <a name="l7693" style="background-color: #ffcccc">                  REMAX = ONE / EMAX</a>
  7694) <a name="l7694" style="background-color: #ffcccc">                  CALL SSCAL( N, REMAX, VR( 1, KI-1 ), 1 )</a>
  7695) <a name="l7695" style="background-color: #ffcccc">                  CALL SSCAL( N, REMAX, VR( 1, KI ), 1 )</a>
  7696) <a name="l7696" style="background-color: #ffcccc">               END IF</a>
  7697) <a name="l7697" style="background-color: #ffcccc">            END IF</a>
  7698) <a name="l7698" style="background-color: #ffcccc">!</a>
  7699) <a name="l7699" style="background-color: #ffcccc">            IS = IS - 1</a>
  7700) <a name="l7700" style="background-color: #ffcccc">            IF( IP.NE.0 ) &amp;</a>
  7701) <a name="l7701" style="background-color: #ffcccc">               IS = IS - 1</a>
  7702) <a name="l7702" style="background-color: #ffcccc">  130       CONTINUE</a>
  7703) <a name="l7703" style="background-color: #ffcccc">            IF( IP.EQ.1 ) &amp;</a>
  7704) <a name="l7704" style="background-color: #ffcccc">               IP = 0</a>
  7705) <a name="l7705" style="background-color: #ffcccc">            IF( IP.EQ.-1 ) &amp;</a>
  7706) <a name="l7706" style="background-color: #ffcccc">               IP = 1</a>
  7707) <a name="l7707" style="background-color: #ffcccc">  140    CONTINUE</a>
  7708) <a name="l7708" style="background-color: #ffcccc">      END IF</a>
  7709) <a name="l7709" style="background-color: #ffcccc">!</a>
  7710) <a name="l7710" style="background-color: #ffcccc">      IF( LEFTV ) THEN</a>
  7711) <a name="l7711" style="background-color: #ffcccc">!</a>
  7712) <a name="l7712" style="background-color: #ffcccc">!        Compute left eigenvectors.</a>
  7713) <a name="l7713" style="background-color: #ffcccc">!</a>
  7714) <a name="l7714" style="background-color: #ffcccc">         IP = 0</a>
  7715) <a name="l7715" style="background-color: #ffcccc">         IS = 1</a>
  7716) <a name="l7716" style="background-color: #ffcccc">         DO 260 KI = 1, N</a>
  7717) <a name="l7717" style="background-color: #ffcccc">!</a>
  7718) <a name="l7718" style="background-color: #ffcccc">            IF( IP.EQ.-1 ) &amp;</a>
  7719) <a name="l7719" style="background-color: #ffcccc">               GO TO 250</a>
  7720) <a name="l7720" style="background-color: #ffcccc">            IF( KI.EQ.N ) &amp;</a>
  7721) <a name="l7721" style="background-color: #ffcccc">               GO TO 150</a>
  7722) <a name="l7722" style="background-color: #ffcccc">            IF( T( KI+1, KI ).EQ.ZERO ) &amp;</a>
  7723) <a name="l7723" style="background-color: #ffcccc">               GO TO 150</a>
  7724) <a name="l7724" style="background-color: #ffcccc">            IP = 1</a>
  7725) <a name="l7725" style="background-color: #ffcccc">!</a>
  7726) <a name="l7726" style="background-color: #ffcccc">  150       CONTINUE</a>
  7727) <a name="l7727" style="background-color: #ffcccc">            IF( SOMEV ) THEN</a>
  7728) <a name="l7728" style="background-color: #ffcccc">               IF( .NOT.SELECT( KI ) ) &amp;</a>
  7729) <a name="l7729" style="background-color: #ffcccc">                  GO TO 250</a>
  7730) <a name="l7730" style="background-color: #ffcccc">            END IF</a>
  7731) <a name="l7731" style="background-color: #ffcccc">!</a>
  7732) <a name="l7732" style="background-color: #ffcccc">!           Compute the KI-th eigenvalue (WR,WI).</a>
  7733) <a name="l7733" style="background-color: #ffcccc">!</a>
  7734) <a name="l7734" style="background-color: #ffcccc">            WR = T( KI, KI )</a>
  7735) <a name="l7735" style="background-color: #ffcccc">            WI = ZERO</a>
  7736) <a name="l7736" style="background-color: #ffcccc">            IF( IP.NE.0 ) &amp;</a>
  7737) <a name="l7737" style="background-color: #ffcccc">               WI = SQRT( ABS( T( KI, KI+1 ) ) )* &amp;</a>
  7738) <a name="l7738" style="background-color: #ffcccc">                    SQRT( ABS( T( KI+1, KI ) ) )</a>
  7739) <a name="l7739" style="background-color: #ffcccc">            SMIN = MAX( ULP*( ABS( WR )+ABS( WI ) ), SMLNUM )</a>
  7740) <a name="l7740" style="background-color: #ffcccc">!</a>
  7741) <a name="l7741" style="background-color: #ffcccc">            IF( IP.EQ.0 ) THEN</a>
  7742) <a name="l7742" style="background-color: #ffcccc">!</a>
  7743) <a name="l7743" style="background-color: #ffcccc">!              Real left eigenvector.</a>
  7744) <a name="l7744" style="background-color: #ffcccc">!</a>
  7745) <a name="l7745" style="background-color: #ffcccc">               WORK( KI+N ) = ONE</a>
  7746) <a name="l7746" style="background-color: #ffcccc">!</a>
  7747) <a name="l7747" style="background-color: #ffcccc">!              Form right-hand side</a>
  7748) <a name="l7748" style="background-color: #ffcccc">!</a>
  7749) <a name="l7749" style="background-color: #ffcccc">               DO 160 K = KI + 1, N</a>
  7750) <a name="l7750" style="background-color: #ffcccc">                  WORK( K+N ) = -T( KI, K )</a>
  7751) <a name="l7751" style="background-color: #ffcccc">  160          CONTINUE</a>
  7752) <a name="l7752" style="background-color: #ffcccc">!</a>
  7753) <a name="l7753" style="background-color: #ffcccc">!              Solve the quasi-triangular system:</a>
  7754) <a name="l7754" style="background-color: #ffcccc">!                 (T(KI+1:N,KI+1:N) - WR)'*X = SCALE*WORK</a>
  7755) <a name="l7755" style="background-color: #ffcccc">!</a>
  7756) <a name="l7756" style="background-color: #ffcccc">               VMAX = ONE</a>
  7757) <a name="l7757" style="background-color: #ffcccc">               VCRIT = BIGNUM</a>
  7758) <a name="l7758" style="background-color: #ffcccc">!</a>
  7759) <a name="l7759" style="background-color: #ffcccc">               JNXT = KI + 1</a>
  7760) <a name="l7760" style="background-color: #ffcccc">               DO 170 J = KI + 1, N</a>
  7761) <a name="l7761" style="background-color: #ffcccc">                  IF( J.LT.JNXT ) &amp;</a>
  7762) <a name="l7762" style="background-color: #ffcccc">                     GO TO 170</a>
  7763) <a name="l7763" style="background-color: #ffcccc">                  J1 = J</a>
  7764) <a name="l7764" style="background-color: #ffcccc">                  J2 = J</a>
  7765) <a name="l7765" style="background-color: #ffcccc">                  JNXT = J + 1</a>
  7766) <a name="l7766" style="background-color: #ffcccc">                  IF( J.LT.N ) THEN</a>
  7767) <a name="l7767" style="background-color: #ffcccc">                     IF( T( J+1, J ).NE.ZERO ) THEN</a>
  7768) <a name="l7768" style="background-color: #ffcccc">                        J2 = J + 1</a>
  7769) <a name="l7769" style="background-color: #ffcccc">                        JNXT = J + 2</a>
  7770) <a name="l7770" style="background-color: #ffcccc">                     END IF</a>
  7771) <a name="l7771" style="background-color: #ffcccc">                  END IF</a>
  7772) <a name="l7772" style="background-color: #ffcccc">!</a>
  7773) <a name="l7773" style="background-color: #ffcccc">                  IF( J1.EQ.J2 ) THEN</a>
  7774) <a name="l7774" style="background-color: #ffcccc">!</a>
  7775) <a name="l7775" style="background-color: #ffcccc">!                    1-by-1 diagonal block</a>
  7776) <a name="l7776" style="background-color: #ffcccc">!</a>
  7777) <a name="l7777" style="background-color: #ffcccc">!                    Scale if necessary to avoid overflow when forming</a>
  7778) <a name="l7778" style="background-color: #ffcccc">!                    the right-hand side.</a>
  7779) <a name="l7779" style="background-color: #ffcccc">!</a>
  7780) <a name="l7780" style="background-color: #ffcccc">                     IF( WORK( J ).GT.VCRIT ) THEN</a>
  7781) <a name="l7781" style="background-color: #ffcccc">                        REC = ONE / VMAX</a>
  7782) <a name="l7782" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, REC, WORK( KI+N ), 1 )</a>
  7783) <a name="l7783" style="background-color: #ffcccc">                        VMAX = ONE</a>
  7784) <a name="l7784" style="background-color: #ffcccc">                        VCRIT = BIGNUM</a>
  7785) <a name="l7785" style="background-color: #ffcccc">                     END IF</a>
  7786) <a name="l7786" style="background-color: #ffcccc">!</a>
  7787) <a name="l7787" style="background-color: #ffcccc">                     WORK( J+N ) = WORK( J+N ) - &amp;</a>
  7788) <a name="l7788" style="background-color: #ffcccc">                                   SDOT( J-KI-1, T( KI+1, J ), 1, &amp;</a>
  7789) <a name="l7789" style="background-color: #ffcccc">                                   WORK( KI+1+N ), 1 )</a>
  7790) <a name="l7790" style="background-color: #ffcccc">!</a>
  7791) <a name="l7791" style="background-color: #ffcccc">!                    Solve (T(J,J)-WR)'*X = WORK</a>
  7792) <a name="l7792" style="background-color: #ffcccc">!</a>
  7793) <a name="l7793" style="background-color: #ffcccc">                     CALL SLALN2( .FALSE., 1, 1, SMIN, ONE, T( J, J ), &amp;</a>
  7794) <a name="l7794" style="background-color: #ffcccc">                                  LDT, ONE, ONE, WORK( J+N ), N, WR, &amp;</a>
  7795) <a name="l7795" style="background-color: #ffcccc">                                  ZERO, X, 2, SCALE, XNORM, IERR )</a>
  7796) <a name="l7796" style="background-color: #ffcccc">!</a>
  7797) <a name="l7797" style="background-color: #ffcccc">!                    Scale if necessary</a>
  7798) <a name="l7798" style="background-color: #ffcccc">!</a>
  7799) <a name="l7799" style="background-color: #ffcccc">                     IF( SCALE.NE.ONE ) &amp;</a>
  7800) <a name="l7800" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, SCALE, WORK( KI+N ), 1 )</a>
  7801) <a name="l7801" style="background-color: #ffcccc">                     WORK( J+N ) = X( 1, 1 )</a>
  7802) <a name="l7802" style="background-color: #ffcccc">                     VMAX = MAX( ABS( WORK( J+N ) ), VMAX )</a>
  7803) <a name="l7803" style="background-color: #ffcccc">                     VCRIT = BIGNUM / VMAX</a>
  7804) <a name="l7804" style="background-color: #ffcccc">!</a>
  7805) <a name="l7805" style="background-color: #ffcccc">                  ELSE</a>
  7806) <a name="l7806" style="background-color: #ffcccc">!</a>
  7807) <a name="l7807" style="background-color: #ffcccc">!                    2-by-2 diagonal block</a>
  7808) <a name="l7808" style="background-color: #ffcccc">!</a>
  7809) <a name="l7809" style="background-color: #ffcccc">!                    Scale if necessary to avoid overflow when forming</a>
  7810) <a name="l7810" style="background-color: #ffcccc">!                    the right-hand side.</a>
  7811) <a name="l7811" style="background-color: #ffcccc">!</a>
  7812) <a name="l7812" style="background-color: #ffcccc">                     BETA = MAX( WORK( J ), WORK( J+1 ) )</a>
  7813) <a name="l7813" style="background-color: #ffcccc">                     IF( BETA.GT.VCRIT ) THEN</a>
  7814) <a name="l7814" style="background-color: #ffcccc">                        REC = ONE / VMAX</a>
  7815) <a name="l7815" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, REC, WORK( KI+N ), 1 )</a>
  7816) <a name="l7816" style="background-color: #ffcccc">                        VMAX = ONE</a>
  7817) <a name="l7817" style="background-color: #ffcccc">                        VCRIT = BIGNUM</a>
  7818) <a name="l7818" style="background-color: #ffcccc">                     END IF</a>
  7819) <a name="l7819" style="background-color: #ffcccc">!</a>
  7820) <a name="l7820" style="background-color: #ffcccc">                     WORK( J+N ) = WORK( J+N ) - &amp;</a>
  7821) <a name="l7821" style="background-color: #ffcccc">                                   SDOT( J-KI-1, T( KI+1, J ), 1, &amp;</a>
  7822) <a name="l7822" style="background-color: #ffcccc">                                   WORK( KI+1+N ), 1 )</a>
  7823) <a name="l7823" style="background-color: #ffcccc">!</a>
  7824) <a name="l7824" style="background-color: #ffcccc">                     WORK( J+1+N ) = WORK( J+1+N ) - &amp;</a>
  7825) <a name="l7825" style="background-color: #ffcccc">                                     SDOT( J-KI-1, T( KI+1, J+1 ), 1, &amp;</a>
  7826) <a name="l7826" style="background-color: #ffcccc">                                     WORK( KI+1+N ), 1 )</a>
  7827) <a name="l7827" style="background-color: #ffcccc">!</a>
  7828) <a name="l7828" style="background-color: #ffcccc">!                    Solve</a>
  7829) <a name="l7829" style="background-color: #ffcccc">!                      [T(J,J)-WR   T(J,J+1)     ]'* X = SCALE*( WORK1 )</a>
  7830) <a name="l7830" style="background-color: #ffcccc">!                      [T(J+1,J)    T(J+1,J+1)-WR]             ( WORK2 )</a>
  7831) <a name="l7831" style="background-color: #ffcccc">!</a>
  7832) <a name="l7832" style="background-color: #ffcccc">                     CALL SLALN2( .TRUE., 2, 1, SMIN, ONE, T( J, J ), &amp;</a>
  7833) <a name="l7833" style="background-color: #ffcccc">                                  LDT, ONE, ONE, WORK( J+N ), N, WR, &amp;</a>
  7834) <a name="l7834" style="background-color: #ffcccc">                                  ZERO, X, 2, SCALE, XNORM, IERR )</a>
  7835) <a name="l7835" style="background-color: #ffcccc">!</a>
  7836) <a name="l7836" style="background-color: #ffcccc">!                    Scale if necessary</a>
  7837) <a name="l7837" style="background-color: #ffcccc">!</a>
  7838) <a name="l7838" style="background-color: #ffcccc">                     IF( SCALE.NE.ONE ) &amp;</a>
  7839) <a name="l7839" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, SCALE, WORK( KI+N ), 1 )</a>
  7840) <a name="l7840" style="background-color: #ffcccc">                     WORK( J+N ) = X( 1, 1 )</a>
  7841) <a name="l7841" style="background-color: #ffcccc">                     WORK( J+1+N ) = X( 2, 1 )</a>
  7842) <a name="l7842" style="background-color: #ffcccc">!</a>
  7843) <a name="l7843" style="background-color: #ffcccc">                     VMAX = MAX( ABS( WORK( J+N ) ), &amp;</a>
  7844) <a name="l7844" style="background-color: #ffcccc">                            ABS( WORK( J+1+N ) ), VMAX )</a>
  7845) <a name="l7845" style="background-color: #ffcccc">                     VCRIT = BIGNUM / VMAX</a>
  7846) <a name="l7846" style="background-color: #ffcccc">!</a>
  7847) <a name="l7847" style="background-color: #ffcccc">                  END IF</a>
  7848) <a name="l7848" style="background-color: #ffcccc">  170          CONTINUE</a>
  7849) <a name="l7849" style="background-color: #ffcccc">!</a>
  7850) <a name="l7850" style="background-color: #ffcccc">!              Copy the vector x or Q*x to VL and normalize.</a>
  7851) <a name="l7851" style="background-color: #ffcccc">!</a>
  7852) <a name="l7852" style="background-color: #ffcccc">               IF( .NOT.OVER ) THEN</a>
  7853) <a name="l7853" style="background-color: #ffcccc">                  CALL SCOPY( N-KI+1, WORK( KI+N ), 1, VL( KI, IS ), 1 )</a>
  7854) <a name="l7854" style="background-color: #ffcccc">!</a>
  7855) <a name="l7855" style="background-color: #ffcccc">                  II = ISAMAX( N-KI+1, VL( KI, IS ), 1 ) + KI - 1</a>
  7856) <a name="l7856" style="background-color: #ffcccc">                  REMAX = ONE / ABS( VL( II, IS ) )</a>
  7857) <a name="l7857" style="background-color: #ffcccc">                  CALL SSCAL( N-KI+1, REMAX, VL( KI, IS ), 1 )</a>
  7858) <a name="l7858" style="background-color: #ffcccc">!</a>
  7859) <a name="l7859" style="background-color: #ffcccc">                  DO 180 K = 1, KI - 1</a>
  7860) <a name="l7860" style="background-color: #ffcccc">                     VL( K, IS ) = ZERO</a>
  7861) <a name="l7861" style="background-color: #ffcccc">  180             CONTINUE</a>
  7862) <a name="l7862" style="background-color: #ffcccc">!</a>
  7863) <a name="l7863" style="background-color: #ffcccc">               ELSE</a>
  7864) <a name="l7864" style="background-color: #ffcccc">!</a>
  7865) <a name="l7865" style="background-color: #ffcccc">                  IF( KI.LT.N ) &amp;</a>
  7866) <a name="l7866" style="background-color: #ffcccc">                     CALL SGEMV( 'N', N, N-KI, ONE, VL( 1, KI+1 ), LDVL, &amp;</a>
  7867) <a name="l7867" style="background-color: #ffcccc">                                 WORK( KI+1+N ), 1, WORK( KI+N ), &amp;</a>
  7868) <a name="l7868" style="background-color: #ffcccc">                                 VL( 1, KI ), 1 )</a>
  7869) <a name="l7869" style="background-color: #ffcccc">!</a>
  7870) <a name="l7870" style="background-color: #ffcccc">                  II = ISAMAX( N, VL( 1, KI ), 1 )</a>
  7871) <a name="l7871" style="background-color: #ffcccc">                  REMAX = ONE / ABS( VL( II, KI ) )</a>
  7872) <a name="l7872" style="background-color: #ffcccc">                  CALL SSCAL( N, REMAX, VL( 1, KI ), 1 )</a>
  7873) <a name="l7873" style="background-color: #ffcccc">!</a>
  7874) <a name="l7874" style="background-color: #ffcccc">               END IF</a>
  7875) <a name="l7875" style="background-color: #ffcccc">!</a>
  7876) <a name="l7876" style="background-color: #ffcccc">            ELSE</a>
  7877) <a name="l7877" style="background-color: #ffcccc">!</a>
  7878) <a name="l7878" style="background-color: #ffcccc">!              Complex left eigenvector.</a>
  7879) <a name="l7879" style="background-color: #ffcccc">!</a>
  7880) <a name="l7880" style="background-color: #ffcccc">!               Initial solve:</a>
  7881) <a name="l7881" style="background-color: #ffcccc">!                 ((T(KI,KI)    T(KI,KI+1) )' - (WR - I* WI))*X = 0.</a>
  7882) <a name="l7882" style="background-color: #ffcccc">!                 ((T(KI+1,KI) T(KI+1,KI+1))                )</a>
  7883) <a name="l7883" style="background-color: #ffcccc">!</a>
  7884) <a name="l7884" style="background-color: #ffcccc">               IF( ABS( T( KI, KI+1 ) ).GE.ABS( T( KI+1, KI ) ) ) THEN</a>
  7885) <a name="l7885" style="background-color: #ffcccc">                  WORK( KI+N ) = WI / T( KI, KI+1 )</a>
  7886) <a name="l7886" style="background-color: #ffcccc">                  WORK( KI+1+N2 ) = ONE</a>
  7887) <a name="l7887" style="background-color: #ffcccc">               ELSE</a>
  7888) <a name="l7888" style="background-color: #ffcccc">                  WORK( KI+N ) = ONE</a>
  7889) <a name="l7889" style="background-color: #ffcccc">                  WORK( KI+1+N2 ) = -WI / T( KI+1, KI )</a>
  7890) <a name="l7890" style="background-color: #ffcccc">               END IF</a>
  7891) <a name="l7891" style="background-color: #ffcccc">               WORK( KI+1+N ) = ZERO</a>
  7892) <a name="l7892" style="background-color: #ffcccc">               WORK( KI+N2 ) = ZERO</a>
  7893) <a name="l7893" style="background-color: #ffcccc">!</a>
  7894) <a name="l7894" style="background-color: #ffcccc">!              Form right-hand side</a>
  7895) <a name="l7895" style="background-color: #ffcccc">!</a>
  7896) <a name="l7896" style="background-color: #ffcccc">               DO 190 K = KI + 2, N</a>
  7897) <a name="l7897" style="background-color: #ffcccc">                  WORK( K+N ) = -WORK( KI+N )*T( KI, K )</a>
  7898) <a name="l7898" style="background-color: #ffcccc">                  WORK( K+N2 ) = -WORK( KI+1+N2 )*T( KI+1, K )</a>
  7899) <a name="l7899" style="background-color: #ffcccc">  190          CONTINUE</a>
  7900) <a name="l7900" style="background-color: #ffcccc">!</a>
  7901) <a name="l7901" style="background-color: #ffcccc">!              Solve complex quasi-triangular system:</a>
  7902) <a name="l7902" style="background-color: #ffcccc">!              ( T(KI+2,N:KI+2,N) - (WR-i*WI) )*X = WORK1+i*WORK2</a>
  7903) <a name="l7903" style="background-color: #ffcccc">!</a>
  7904) <a name="l7904" style="background-color: #ffcccc">               VMAX = ONE</a>
  7905) <a name="l7905" style="background-color: #ffcccc">               VCRIT = BIGNUM</a>
  7906) <a name="l7906" style="background-color: #ffcccc">!</a>
  7907) <a name="l7907" style="background-color: #ffcccc">               JNXT = KI + 2</a>
  7908) <a name="l7908" style="background-color: #ffcccc">               DO 200 J = KI + 2, N</a>
  7909) <a name="l7909" style="background-color: #ffcccc">                  IF( J.LT.JNXT ) &amp;</a>
  7910) <a name="l7910" style="background-color: #ffcccc">                     GO TO 200</a>
  7911) <a name="l7911" style="background-color: #ffcccc">                  J1 = J</a>
  7912) <a name="l7912" style="background-color: #ffcccc">                  J2 = J</a>
  7913) <a name="l7913" style="background-color: #ffcccc">                  JNXT = J + 1</a>
  7914) <a name="l7914" style="background-color: #ffcccc">                  IF( J.LT.N ) THEN</a>
  7915) <a name="l7915" style="background-color: #ffcccc">                     IF( T( J+1, J ).NE.ZERO ) THEN</a>
  7916) <a name="l7916" style="background-color: #ffcccc">                        J2 = J + 1</a>
  7917) <a name="l7917" style="background-color: #ffcccc">                        JNXT = J + 2</a>
  7918) <a name="l7918" style="background-color: #ffcccc">                     END IF</a>
  7919) <a name="l7919" style="background-color: #ffcccc">                  END IF</a>
  7920) <a name="l7920" style="background-color: #ffcccc">!</a>
  7921) <a name="l7921" style="background-color: #ffcccc">                  IF( J1.EQ.J2 ) THEN</a>
  7922) <a name="l7922" style="background-color: #ffcccc">!</a>
  7923) <a name="l7923" style="background-color: #ffcccc">!                    1-by-1 diagonal block</a>
  7924) <a name="l7924" style="background-color: #ffcccc">!</a>
  7925) <a name="l7925" style="background-color: #ffcccc">!                    Scale if necessary to avoid overflow when</a>
  7926) <a name="l7926" style="background-color: #ffcccc">!                    forming the right-hand side elements.</a>
  7927) <a name="l7927" style="background-color: #ffcccc">!</a>
  7928) <a name="l7928" style="background-color: #ffcccc">                     IF( WORK( J ).GT.VCRIT ) THEN</a>
  7929) <a name="l7929" style="background-color: #ffcccc">                        REC = ONE / VMAX</a>
  7930) <a name="l7930" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, REC, WORK( KI+N ), 1 )</a>
  7931) <a name="l7931" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, REC, WORK( KI+N2 ), 1 )</a>
  7932) <a name="l7932" style="background-color: #ffcccc">                        VMAX = ONE</a>
  7933) <a name="l7933" style="background-color: #ffcccc">                        VCRIT = BIGNUM</a>
  7934) <a name="l7934" style="background-color: #ffcccc">                     END IF</a>
  7935) <a name="l7935" style="background-color: #ffcccc">!</a>
  7936) <a name="l7936" style="background-color: #ffcccc">                     WORK( J+N ) = WORK( J+N ) - &amp;</a>
  7937) <a name="l7937" style="background-color: #ffcccc">                                   SDOT( J-KI-2, T( KI+2, J ), 1, &amp;</a>
  7938) <a name="l7938" style="background-color: #ffcccc">                                   WORK( KI+2+N ), 1 )</a>
  7939) <a name="l7939" style="background-color: #ffcccc">                     WORK( J+N2 ) = WORK( J+N2 ) - &amp;</a>
  7940) <a name="l7940" style="background-color: #ffcccc">                                    SDOT( J-KI-2, T( KI+2, J ), 1, &amp;</a>
  7941) <a name="l7941" style="background-color: #ffcccc">                                    WORK( KI+2+N2 ), 1 )</a>
  7942) <a name="l7942" style="background-color: #ffcccc">!</a>
  7943) <a name="l7943" style="background-color: #ffcccc">!                    Solve (T(J,J)-(WR-i*WI))*(X11+i*X12)= WK+I*WK2</a>
  7944) <a name="l7944" style="background-color: #ffcccc">!</a>
  7945) <a name="l7945" style="background-color: #ffcccc">                     CALL SLALN2( .FALSE., 1, 2, SMIN, ONE, T( J, J ), &amp;</a>
  7946) <a name="l7946" style="background-color: #ffcccc">                                  LDT, ONE, ONE, WORK( J+N ), N, WR, &amp;</a>
  7947) <a name="l7947" style="background-color: #ffcccc">                                  -WI, X, 2, SCALE, XNORM, IERR )</a>
  7948) <a name="l7948" style="background-color: #ffcccc">!</a>
  7949) <a name="l7949" style="background-color: #ffcccc">!                    Scale if necessary</a>
  7950) <a name="l7950" style="background-color: #ffcccc">!</a>
  7951) <a name="l7951" style="background-color: #ffcccc">                     IF( SCALE.NE.ONE ) THEN</a>
  7952) <a name="l7952" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, SCALE, WORK( KI+N ), 1 )</a>
  7953) <a name="l7953" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, SCALE, WORK( KI+N2 ), 1 )</a>
  7954) <a name="l7954" style="background-color: #ffcccc">                     END IF</a>
  7955) <a name="l7955" style="background-color: #ffcccc">                     WORK( J+N ) = X( 1, 1 )</a>
  7956) <a name="l7956" style="background-color: #ffcccc">                     WORK( J+N2 ) = X( 1, 2 )</a>
  7957) <a name="l7957" style="background-color: #ffcccc">                     VMAX = MAX( ABS( WORK( J+N ) ), &amp;</a>
  7958) <a name="l7958" style="background-color: #ffcccc">                            ABS( WORK( J+N2 ) ), VMAX )</a>
  7959) <a name="l7959" style="background-color: #ffcccc">                     VCRIT = BIGNUM / VMAX</a>
  7960) <a name="l7960" style="background-color: #ffcccc">!</a>
  7961) <a name="l7961" style="background-color: #ffcccc">                  ELSE</a>
  7962) <a name="l7962" style="background-color: #ffcccc">!</a>
  7963) <a name="l7963" style="background-color: #ffcccc">!                    2-by-2 diagonal block</a>
  7964) <a name="l7964" style="background-color: #ffcccc">!</a>
  7965) <a name="l7965" style="background-color: #ffcccc">!                    Scale if necessary to avoid overflow when forming</a>
  7966) <a name="l7966" style="background-color: #ffcccc">!                    the right-hand side elements.</a>
  7967) <a name="l7967" style="background-color: #ffcccc">!</a>
  7968) <a name="l7968" style="background-color: #ffcccc">                     BETA = MAX( WORK( J ), WORK( J+1 ) )</a>
  7969) <a name="l7969" style="background-color: #ffcccc">                     IF( BETA.GT.VCRIT ) THEN</a>
  7970) <a name="l7970" style="background-color: #ffcccc">                        REC = ONE / VMAX</a>
  7971) <a name="l7971" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, REC, WORK( KI+N ), 1 )</a>
  7972) <a name="l7972" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, REC, WORK( KI+N2 ), 1 )</a>
  7973) <a name="l7973" style="background-color: #ffcccc">                        VMAX = ONE</a>
  7974) <a name="l7974" style="background-color: #ffcccc">                        VCRIT = BIGNUM</a>
  7975) <a name="l7975" style="background-color: #ffcccc">                     END IF</a>
  7976) <a name="l7976" style="background-color: #ffcccc">!</a>
  7977) <a name="l7977" style="background-color: #ffcccc">                     WORK( J+N ) = WORK( J+N ) - &amp;</a>
  7978) <a name="l7978" style="background-color: #ffcccc">                                   SDOT( J-KI-2, T( KI+2, J ), 1, &amp;</a>
  7979) <a name="l7979" style="background-color: #ffcccc">                                   WORK( KI+2+N ), 1 )</a>
  7980) <a name="l7980" style="background-color: #ffcccc">!</a>
  7981) <a name="l7981" style="background-color: #ffcccc">                     WORK( J+N2 ) = WORK( J+N2 ) - &amp;</a>
  7982) <a name="l7982" style="background-color: #ffcccc">                                    SDOT( J-KI-2, T( KI+2, J ), 1, &amp;</a>
  7983) <a name="l7983" style="background-color: #ffcccc">                                    WORK( KI+2+N2 ), 1 )</a>
  7984) <a name="l7984" style="background-color: #ffcccc">!</a>
  7985) <a name="l7985" style="background-color: #ffcccc">                     WORK( J+1+N ) = WORK( J+1+N ) - &amp;</a>
  7986) <a name="l7986" style="background-color: #ffcccc">                                     SDOT( J-KI-2, T( KI+2, J+1 ), 1, &amp;</a>
  7987) <a name="l7987" style="background-color: #ffcccc">                                     WORK( KI+2+N ), 1 )</a>
  7988) <a name="l7988" style="background-color: #ffcccc">!</a>
  7989) <a name="l7989" style="background-color: #ffcccc">                     WORK( J+1+N2 ) = WORK( J+1+N2 ) - &amp;</a>
  7990) <a name="l7990" style="background-color: #ffcccc">                                      SDOT( J-KI-2, T( KI+2, J+1 ), 1, &amp;</a>
  7991) <a name="l7991" style="background-color: #ffcccc">                                      WORK( KI+2+N2 ), 1 )</a>
  7992) <a name="l7992" style="background-color: #ffcccc">!</a>
  7993) <a name="l7993" style="background-color: #ffcccc">!                    Solve 2-by-2 complex linear equation</a>
  7994) <a name="l7994" style="background-color: #ffcccc">!                      ([T(j,j)   T(j,j+1)  ]'-(wr-i*wi)*I)*X = SCALE*B</a>
  7995) <a name="l7995" style="background-color: #ffcccc">!                      ([T(j+1,j) T(j+1,j+1)]             )</a>
  7996) <a name="l7996" style="background-color: #ffcccc">!</a>
  7997) <a name="l7997" style="background-color: #ffcccc">                     CALL SLALN2( .TRUE., 2, 2, SMIN, ONE, T( J, J ), &amp;</a>
  7998) <a name="l7998" style="background-color: #ffcccc">                                  LDT, ONE, ONE, WORK( J+N ), N, WR, &amp;</a>
  7999) <a name="l7999" style="background-color: #ffcccc">                                  -WI, X, 2, SCALE, XNORM, IERR )</a>
  8000) <a name="l8000" style="background-color: #ffcccc">!</a>
  8001) <a name="l8001" style="background-color: #ffcccc">!                    Scale if necessary</a>
  8002) <a name="l8002" style="background-color: #ffcccc">!</a>
  8003) <a name="l8003" style="background-color: #ffcccc">                     IF( SCALE.NE.ONE ) THEN</a>
  8004) <a name="l8004" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, SCALE, WORK( KI+N ), 1 )</a>
  8005) <a name="l8005" style="background-color: #ffcccc">                        CALL SSCAL( N-KI+1, SCALE, WORK( KI+N2 ), 1 )</a>
  8006) <a name="l8006" style="background-color: #ffcccc">                     END IF</a>
  8007) <a name="l8007" style="background-color: #ffcccc">                     WORK( J+N ) = X( 1, 1 )</a>
  8008) <a name="l8008" style="background-color: #ffcccc">                     WORK( J+N2 ) = X( 1, 2 )</a>
  8009) <a name="l8009" style="background-color: #ffcccc">                     WORK( J+1+N ) = X( 2, 1 )</a>
  8010) <a name="l8010" style="background-color: #ffcccc">                     WORK( J+1+N2 ) = X( 2, 2 )</a>
  8011) <a name="l8011" style="background-color: #ffcccc">                     VMAX = MAX( ABS( X( 1, 1 ) ), ABS( X( 1, 2 ) ), &amp;</a>
  8012) <a name="l8012" style="background-color: #ffcccc">                            ABS( X( 2, 1 ) ), ABS( X( 2, 2 ) ), VMAX )</a>
  8013) <a name="l8013" style="background-color: #ffcccc">                     VCRIT = BIGNUM / VMAX</a>
  8014) <a name="l8014" style="background-color: #ffcccc">!</a>
  8015) <a name="l8015" style="background-color: #ffcccc">                  END IF</a>
  8016) <a name="l8016" style="background-color: #ffcccc">  200          CONTINUE</a>
  8017) <a name="l8017" style="background-color: #ffcccc">!</a>
  8018) <a name="l8018" style="background-color: #ffcccc">!              Copy the vector x or Q*x to VL and normalize.</a>
  8019) <a name="l8019" style="background-color: #ffcccc">!</a>
  8020) <a name="l8020" style="background-color: #ffcccc">  210          CONTINUE</a>
  8021) <a name="l8021" style="background-color: #ffcccc">               IF( .NOT.OVER ) THEN</a>
  8022) <a name="l8022" style="background-color: #ffcccc">                  CALL SCOPY( N-KI+1, WORK( KI+N ), 1, VL( KI, IS ), 1 )</a>
  8023) <a name="l8023" style="background-color: #ffcccc">                  CALL SCOPY( N-KI+1, WORK( KI+N2 ), 1, VL( KI, IS+1 ), &amp;</a>
  8024) <a name="l8024" style="background-color: #ffcccc">                              1 )</a>
  8025) <a name="l8025" style="background-color: #ffcccc">!</a>
  8026) <a name="l8026" style="background-color: #ffcccc">                  EMAX = ZERO</a>
  8027) <a name="l8027" style="background-color: #ffcccc">                  DO 220 K = KI, N</a>
  8028) <a name="l8028" style="background-color: #ffcccc">                     EMAX = MAX( EMAX, ABS( VL( K, IS ) )+ &amp;</a>
  8029) <a name="l8029" style="background-color: #ffcccc">                            ABS( VL( K, IS+1 ) ) )</a>
  8030) <a name="l8030" style="background-color: #ffcccc">  220             CONTINUE</a>
  8031) <a name="l8031" style="background-color: #ffcccc">                  REMAX = ONE / EMAX</a>
  8032) <a name="l8032" style="background-color: #ffcccc">                  CALL SSCAL( N-KI+1, REMAX, VL( KI, IS ), 1 )</a>
  8033) <a name="l8033" style="background-color: #ffcccc">                  CALL SSCAL( N-KI+1, REMAX, VL( KI, IS+1 ), 1 )</a>
  8034) <a name="l8034" style="background-color: #ffcccc">!</a>
  8035) <a name="l8035" style="background-color: #ffcccc">                  DO 230 K = 1, KI - 1</a>
  8036) <a name="l8036" style="background-color: #ffcccc">                     VL( K, IS ) = ZERO</a>
  8037) <a name="l8037" style="background-color: #ffcccc">                     VL( K, IS+1 ) = ZERO</a>
  8038) <a name="l8038" style="background-color: #ffcccc">  230             CONTINUE</a>
  8039) <a name="l8039" style="background-color: #ffcccc">               ELSE</a>
  8040) <a name="l8040" style="background-color: #ffcccc">                  IF( KI.LT.N-1 ) THEN</a>
  8041) <a name="l8041" style="background-color: #ffcccc">                     CALL SGEMV( 'N', N, N-KI-1, ONE, VL( 1, KI+2 ), &amp;</a>
  8042) <a name="l8042" style="background-color: #ffcccc">                                 LDVL, WORK( KI+2+N ), 1, WORK( KI+N ), &amp;</a>
  8043) <a name="l8043" style="background-color: #ffcccc">                                 VL( 1, KI ), 1 )</a>
  8044) <a name="l8044" style="background-color: #ffcccc">                     CALL SGEMV( 'N', N, N-KI-1, ONE, VL( 1, KI+2 ), &amp;</a>
  8045) <a name="l8045" style="background-color: #ffcccc">                                 LDVL, WORK( KI+2+N2 ), 1, &amp;</a>
  8046) <a name="l8046" style="background-color: #ffcccc">                                 WORK( KI+1+N2 ), VL( 1, KI+1 ), 1 )</a>
  8047) <a name="l8047" style="background-color: #ffcccc">                  ELSE</a>
  8048) <a name="l8048" style="background-color: #ffcccc">                     CALL SSCAL( N, WORK( KI+N ), VL( 1, KI ), 1 )</a>
  8049) <a name="l8049" style="background-color: #ffcccc">                     CALL SSCAL( N, WORK( KI+1+N2 ), VL( 1, KI+1 ), 1 )</a>
  8050) <a name="l8050" style="background-color: #ffcccc">                  END IF</a>
  8051) <a name="l8051" style="background-color: #ffcccc">!</a>
  8052) <a name="l8052" style="background-color: #ffcccc">                  EMAX = ZERO</a>
  8053) <a name="l8053" style="background-color: #ffcccc">                  DO 240 K = 1, N</a>
  8054) <a name="l8054" style="background-color: #ffcccc">                     EMAX = MAX( EMAX, ABS( VL( K, KI ) )+ &amp;</a>
  8055) <a name="l8055" style="background-color: #ffcccc">                            ABS( VL( K, KI+1 ) ) )</a>
  8056) <a name="l8056" style="background-color: #ffcccc">  240             CONTINUE</a>
  8057) <a name="l8057" style="background-color: #ffcccc">                  REMAX = ONE / EMAX</a>
  8058) <a name="l8058" style="background-color: #ffcccc">                  CALL SSCAL( N, REMAX, VL( 1, KI ), 1 )</a>
  8059) <a name="l8059" style="background-color: #ffcccc">                  CALL SSCAL( N, REMAX, VL( 1, KI+1 ), 1 )</a>
  8060) <a name="l8060" style="background-color: #ffcccc">!</a>
  8061) <a name="l8061" style="background-color: #ffcccc">               END IF</a>
  8062) <a name="l8062" style="background-color: #ffcccc">!</a>
  8063) <a name="l8063" style="background-color: #ffcccc">            END IF</a>
  8064) <a name="l8064" style="background-color: #ffcccc">!</a>
  8065) <a name="l8065" style="background-color: #ffcccc">            IS = IS + 1</a>
  8066) <a name="l8066" style="background-color: #ffcccc">            IF( IP.NE.0 ) &amp;</a>
  8067) <a name="l8067" style="background-color: #ffcccc">               IS = IS + 1</a>
  8068) <a name="l8068" style="background-color: #ffcccc">  250       CONTINUE</a>
  8069) <a name="l8069" style="background-color: #ffcccc">            IF( IP.EQ.-1 ) &amp;</a>
  8070) <a name="l8070" style="background-color: #ffcccc">               IP = 0</a>
  8071) <a name="l8071" style="background-color: #ffcccc">            IF( IP.EQ.1 ) &amp;</a>
  8072) <a name="l8072" style="background-color: #ffcccc">               IP = -1</a>
  8073) <a name="l8073" style="background-color: #ffcccc">!</a>
  8074) <a name="l8074" style="background-color: #ffcccc">  260    CONTINUE</a>
  8075) <a name="l8075" style="background-color: #ffcccc">!</a>
  8076) <a name="l8076" style="background-color: #ffcccc">      END IF</a>
  8077) <a name="l8077" style="background-color: #ffcccc">!</a>
  8078) <a name="l8078" style="background-color: #ffcccc">      RETURN</a>
  8079) <a name="l8079" style="background-color: #ffcccc">!</a>
  8080) <a name="l8080" style="background-color: #ffcccc">!     End of STREVC</a>
  8081) <a name="l8081" style="background-color: #ffcccc">!</a>
  8082) <a name="l8082" style="background-color: #ffcccc">      END SUBROUTINE STREVC</a>
  8083) <a name="l8083" style="background-color: #ffffff"></a>
  8084) <a name="l8084" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  8085) <a name="l8085" style="background-color: #ffffff"></a>
  8086) <a name="l8086" style="background-color: #ffffff">      INTEGER FUNCTION </a><a style="background-color: #ffcccc">ILAENV( ISPEC, NAME, OPTS, N1, N2, N3, &amp;</a>
  8087) <a name="l8087" style="background-color: #ffcccc">                               N4 )</a>
  8088) <a name="l8088" style="background-color: #ffcccc"></a>
  8089) <a name="l8089" style="background-color: #ffcccc">!</a>
  8090) <a name="l8090" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  8091) <a name="l8091" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  8092) <a name="l8092" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  8093) <a name="l8093" style="background-color: #ffcccc">!     September 30, 1994</a>
  8094) <a name="l8094" style="background-color: #ffcccc">!</a>
  8095) <a name="l8095" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  8096) <a name="l8096" style="background-color: #ffcccc">      CHARACTER*( * )    NAME, OPTS</a>
  8097) <a name="l8097" style="background-color: #ffcccc">      INTEGER            ISPEC, N1, N2, N3, N4</a>
  8098) <a name="l8098" style="background-color: #ffcccc">!     ..</a>
  8099) <a name="l8099" style="background-color: #ffcccc">!</a>
  8100) <a name="l8100" style="background-color: #ffcccc">!  Purpose</a>
  8101) <a name="l8101" style="background-color: #ffcccc">!  =======</a>
  8102) <a name="l8102" style="background-color: #ffcccc">!</a>
  8103) <a name="l8103" style="background-color: #ffcccc">!  ILAENV is called from the LAPACK routines to choose problem-dependent</a>
  8104) <a name="l8104" style="background-color: #ffcccc">!  parameters for the local environment.  See ISPEC for a description of</a>
  8105) <a name="l8105" style="background-color: #ffcccc">!  the parameters.</a>
  8106) <a name="l8106" style="background-color: #ffcccc">!</a>
  8107) <a name="l8107" style="background-color: #ffcccc">!  This version provides a set of parameters which should give good,</a>
  8108) <a name="l8108" style="background-color: #ffcccc">!  but not optimal, performance on many of the currently available</a>
  8109) <a name="l8109" style="background-color: #ffcccc">!  computers.  Users are encouraged to modify this subroutine to set</a>
  8110) <a name="l8110" style="background-color: #ffcccc">!  the tuning parameters for their particular machine using the option</a>
  8111) <a name="l8111" style="background-color: #ffcccc">!  and problem size information in the arguments.</a>
  8112) <a name="l8112" style="background-color: #ffcccc">!</a>
  8113) <a name="l8113" style="background-color: #ffcccc">!  This routine will not function correctly if it is converted to all</a>
  8114) <a name="l8114" style="background-color: #ffcccc">!  lower case.  Converting it to all upper case is allowed.</a>
  8115) <a name="l8115" style="background-color: #ffcccc">!</a>
  8116) <a name="l8116" style="background-color: #ffcccc">!  Arguments</a>
  8117) <a name="l8117" style="background-color: #ffcccc">!  =========</a>
  8118) <a name="l8118" style="background-color: #ffcccc">!</a>
  8119) <a name="l8119" style="background-color: #ffcccc">!  ISPEC   (input) INTEGER</a>
  8120) <a name="l8120" style="background-color: #ffcccc">!          Specifies the parameter to be returned as the value of</a>
  8121) <a name="l8121" style="background-color: #ffcccc">!          ILAENV.</a>
  8122) <a name="l8122" style="background-color: #ffcccc">!          = 1: the optimal blocksize; if this value is 1, an unblocked</a>
  8123) <a name="l8123" style="background-color: #ffcccc">!               algorithm will give the best performance.</a>
  8124) <a name="l8124" style="background-color: #ffcccc">!          = 2: the minimum block size for which the block routine</a>
  8125) <a name="l8125" style="background-color: #ffcccc">!               should be used; if the usable block size is less than</a>
  8126) <a name="l8126" style="background-color: #ffcccc">!               this value, an unblocked routine should be used.</a>
  8127) <a name="l8127" style="background-color: #ffcccc">!          = 3: the crossover point (in a block routine, for N less</a>
  8128) <a name="l8128" style="background-color: #ffcccc">!               than this value, an unblocked routine should be used)</a>
  8129) <a name="l8129" style="background-color: #ffcccc">!          = 4: the number of shifts, used in the nonsymmetric</a>
  8130) <a name="l8130" style="background-color: #ffcccc">!               eigenvalue routines</a>
  8131) <a name="l8131" style="background-color: #ffcccc">!          = 5: the minimum column dimension for blocking to be used;</a>
  8132) <a name="l8132" style="background-color: #ffcccc">!               rectangular blocks must have dimension at least k by m,</a>
  8133) <a name="l8133" style="background-color: #ffcccc">!               where k is given by ILAENV(2,...) and m by ILAENV(5,...)</a>
  8134) <a name="l8134" style="background-color: #ffcccc">!          = 6: the crossover point for the SVD (when reducing an m by n</a>
  8135) <a name="l8135" style="background-color: #ffcccc">!               matrix to bidiagonal form, if max(m,n)/min(m,n) exceeds</a>
  8136) <a name="l8136" style="background-color: #ffcccc">!               this value, a QR factorization is used first to reduce</a>
  8137) <a name="l8137" style="background-color: #ffcccc">!               the matrix to a triangular form.)</a>
  8138) <a name="l8138" style="background-color: #ffcccc">!          = 7: the number of processors</a>
  8139) <a name="l8139" style="background-color: #ffcccc">!          = 8: the crossover point for the multishift QR and QZ methods</a>
  8140) <a name="l8140" style="background-color: #ffcccc">!               for nonsymmetric eigenvalue problems.</a>
  8141) <a name="l8141" style="background-color: #ffcccc">!</a>
  8142) <a name="l8142" style="background-color: #ffcccc">!  NAME    (input) CHARACTER*(*)</a>
  8143) <a name="l8143" style="background-color: #ffcccc">!          The name of the calling subroutine, in either upper case or</a>
  8144) <a name="l8144" style="background-color: #ffcccc">!          lower case.</a>
  8145) <a name="l8145" style="background-color: #ffcccc">!</a>
  8146) <a name="l8146" style="background-color: #ffcccc">!  OPTS    (input) CHARACTER*(*)</a>
  8147) <a name="l8147" style="background-color: #ffcccc">!          The character options to the subroutine NAME, concatenated</a>
  8148) <a name="l8148" style="background-color: #ffcccc">!          into a single character string.  For example, UPLO = 'U',</a>
  8149) <a name="l8149" style="background-color: #ffcccc">!          TRANS = 'T', and DIAG = 'N' for a triangular routine would</a>
  8150) <a name="l8150" style="background-color: #ffcccc">!          be specified as OPTS = 'UTN'.</a>
  8151) <a name="l8151" style="background-color: #ffcccc">!</a>
  8152) <a name="l8152" style="background-color: #ffcccc">!  N1      (input) INTEGER</a>
  8153) <a name="l8153" style="background-color: #ffcccc">!  N2      (input) INTEGER</a>
  8154) <a name="l8154" style="background-color: #ffcccc">!  N3      (input) INTEGER</a>
  8155) <a name="l8155" style="background-color: #ffcccc">!  N4      (input) INTEGER</a>
  8156) <a name="l8156" style="background-color: #ffcccc">!          Problem dimensions for the subroutine NAME; these may not all</a>
  8157) <a name="l8157" style="background-color: #ffcccc">!          be required.</a>
  8158) <a name="l8158" style="background-color: #ffcccc">!</a>
  8159) <a name="l8159" style="background-color: #ffcccc">! (ILAENV) (output) INTEGER</a>
  8160) <a name="l8160" style="background-color: #ffcccc">!          &gt;= 0: the value of the parameter specified by ISPEC</a>
  8161) <a name="l8161" style="background-color: #ffcccc">!          &lt; 0:  if ILAENV = -k, the k-th argument had an illegal value.</a>
  8162) <a name="l8162" style="background-color: #ffcccc">!</a>
  8163) <a name="l8163" style="background-color: #ffcccc">!  Further Details</a>
  8164) <a name="l8164" style="background-color: #ffcccc">!  ===============</a>
  8165) <a name="l8165" style="background-color: #ffcccc">!</a>
  8166) <a name="l8166" style="background-color: #ffcccc">!  The following conventions have been used when calling ILAENV from the</a>
  8167) <a name="l8167" style="background-color: #ffcccc">!  LAPACK routines:</a>
  8168) <a name="l8168" style="background-color: #ffcccc">!  1)  OPTS is a concatenation of all of the character options to</a>
  8169) <a name="l8169" style="background-color: #ffcccc">!      subroutine NAME, in the same order that they appear in the</a>
  8170) <a name="l8170" style="background-color: #ffcccc">!      argument list for NAME, even if they are not used in determining</a>
  8171) <a name="l8171" style="background-color: #ffcccc">!      the value of the parameter specified by ISPEC.</a>
  8172) <a name="l8172" style="background-color: #ffcccc">!  2)  The problem dimensions N1, N2, N3, N4 are specified in the order</a>
  8173) <a name="l8173" style="background-color: #ffcccc">!      that they appear in the argument list for NAME.  N1 is used</a>
  8174) <a name="l8174" style="background-color: #ffcccc">!      first, N2 second, and so on, and unused problem dimensions are</a>
  8175) <a name="l8175" style="background-color: #ffcccc">!      passed a value of -1.</a>
  8176) <a name="l8176" style="background-color: #ffcccc">!  3)  The parameter value returned by ILAENV is checked for validity in</a>
  8177) <a name="l8177" style="background-color: #ffcccc">!      the calling subroutine.  For example, ILAENV is used to retrieve</a>
  8178) <a name="l8178" style="background-color: #ffcccc">!      the optimal blocksize for STRTRI as follows:</a>
  8179) <a name="l8179" style="background-color: #ffcccc">!</a>
  8180) <a name="l8180" style="background-color: #ffcccc">!      NB = ILAENV( 1, 'STRTRI', UPLO // DIAG, N, -1, -1, -1 )</a>
  8181) <a name="l8181" style="background-color: #ffcccc">!      IF( NB.LE.1 ) NB = MAX( 1, N )</a>
  8182) <a name="l8182" style="background-color: #ffcccc">!</a>
  8183) <a name="l8183" style="background-color: #ffcccc">!  =====================================================================</a>
  8184) <a name="l8184" style="background-color: #ffcccc">!</a>
  8185) <a name="l8185" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  8186) <a name="l8186" style="background-color: #ffcccc">      LOGICAL            CNAME, SNAME</a>
  8187) <a name="l8187" style="background-color: #ffcccc">      CHARACTER*1        C1</a>
  8188) <a name="l8188" style="background-color: #ffcccc">      CHARACTER*2        C2, C4</a>
  8189) <a name="l8189" style="background-color: #ffcccc">      CHARACTER*3        C3</a>
  8190) <a name="l8190" style="background-color: #ffcccc">      CHARACTER*6        SUBNAM</a>
  8191) <a name="l8191" style="background-color: #ffcccc">      INTEGER            I, IC, IZ, NB, NBMIN, NX</a>
  8192) <a name="l8192" style="background-color: #ffcccc">!     ..</a>
  8193) <a name="l8193" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  8194) <a name="l8194" style="background-color: #ffcccc">!</a>
  8195) <a name="l8195" style="background-color: #ffcccc">      GO TO ( 100, 100, 100, 400, 500, 600, 700, 800 ) ISPEC</a>
  8196) <a name="l8196" style="background-color: #ffcccc">!</a>
  8197) <a name="l8197" style="background-color: #ffcccc">!     Invalid value for ISPEC</a>
  8198) <a name="l8198" style="background-color: #ffcccc">!</a>
  8199) <a name="l8199" style="background-color: #ffcccc">      ILAENV = -1</a>
  8200) <a name="l8200" style="background-color: #ffcccc">      RETURN</a>
  8201) <a name="l8201" style="background-color: #ffcccc">!</a>
  8202) <a name="l8202" style="background-color: #ffcccc">  100 CONTINUE</a>
  8203) <a name="l8203" style="background-color: #ffcccc">!</a>
  8204) <a name="l8204" style="background-color: #ffcccc">!     Convert NAME to upper case if the first character is lower case.</a>
  8205) <a name="l8205" style="background-color: #ffcccc">!</a>
  8206) <a name="l8206" style="background-color: #ffcccc">      ILAENV = 1</a>
  8207) <a name="l8207" style="background-color: #ffcccc">      SUBNAM = NAME</a>
  8208) <a name="l8208" style="background-color: #ffcccc">      IC = ICHAR( SUBNAM( 1:1 ) )</a>
  8209) <a name="l8209" style="background-color: #ffcccc">      IZ = ICHAR( 'Z' )</a>
  8210) <a name="l8210" style="background-color: #ffcccc">      IF( IZ.EQ.90 .OR. IZ.EQ.122 ) THEN</a>
  8211) <a name="l8211" style="background-color: #ffcccc">!</a>
  8212) <a name="l8212" style="background-color: #ffcccc">!        ASCII character set</a>
  8213) <a name="l8213" style="background-color: #ffcccc">!</a>
  8214) <a name="l8214" style="background-color: #ffcccc">         IF( IC.GE.97 .AND. IC.LE.122 ) THEN</a>
  8215) <a name="l8215" style="background-color: #ffcccc">            SUBNAM( 1:1 ) = CHAR( IC-32 )</a>
  8216) <a name="l8216" style="background-color: #ffcccc">            DO 10 I = 2, 6</a>
  8217) <a name="l8217" style="background-color: #ffcccc">               IC = ICHAR( SUBNAM( I:I ) )</a>
  8218) <a name="l8218" style="background-color: #ffcccc">               IF( IC.GE.97 .AND. IC.LE.122 ) &amp;</a>
  8219) <a name="l8219" style="background-color: #ffcccc">                  SUBNAM( I:I ) = CHAR( IC-32 )</a>
  8220) <a name="l8220" style="background-color: #ffcccc">   10       CONTINUE</a>
  8221) <a name="l8221" style="background-color: #ffcccc">         END IF</a>
  8222) <a name="l8222" style="background-color: #ffcccc">!</a>
  8223) <a name="l8223" style="background-color: #ffcccc">      ELSE IF( IZ.EQ.233 .OR. IZ.EQ.169 ) THEN</a>
  8224) <a name="l8224" style="background-color: #ffcccc">!</a>
  8225) <a name="l8225" style="background-color: #ffcccc">!        EBCDIC character set</a>
  8226) <a name="l8226" style="background-color: #ffcccc">!</a>
  8227) <a name="l8227" style="background-color: #ffcccc">         IF( ( IC.GE.129 .AND. IC.LE.137 ) .OR. &amp;</a>
  8228) <a name="l8228" style="background-color: #ffcccc">             ( IC.GE.145 .AND. IC.LE.153 ) .OR. &amp;</a>
  8229) <a name="l8229" style="background-color: #ffcccc">             ( IC.GE.162 .AND. IC.LE.169 ) ) THEN</a>
  8230) <a name="l8230" style="background-color: #ffcccc">            SUBNAM( 1:1 ) = CHAR( IC+64 )</a>
  8231) <a name="l8231" style="background-color: #ffcccc">            DO 20 I = 2, 6</a>
  8232) <a name="l8232" style="background-color: #ffcccc">               IC = ICHAR( SUBNAM( I:I ) )</a>
  8233) <a name="l8233" style="background-color: #ffcccc">               IF( ( IC.GE.129 .AND. IC.LE.137 ) .OR. &amp;</a>
  8234) <a name="l8234" style="background-color: #ffcccc">                   ( IC.GE.145 .AND. IC.LE.153 ) .OR. &amp;</a>
  8235) <a name="l8235" style="background-color: #ffcccc">                   ( IC.GE.162 .AND. IC.LE.169 ) ) &amp;</a>
  8236) <a name="l8236" style="background-color: #ffcccc">                  SUBNAM( I:I ) = CHAR( IC+64 )</a>
  8237) <a name="l8237" style="background-color: #ffcccc">   20       CONTINUE</a>
  8238) <a name="l8238" style="background-color: #ffcccc">         END IF</a>
  8239) <a name="l8239" style="background-color: #ffcccc">!</a>
  8240) <a name="l8240" style="background-color: #ffcccc">      ELSE IF( IZ.EQ.218 .OR. IZ.EQ.250 ) THEN</a>
  8241) <a name="l8241" style="background-color: #ffcccc">!</a>
  8242) <a name="l8242" style="background-color: #ffcccc">!        Prime machines:  ASCII+128</a>
  8243) <a name="l8243" style="background-color: #ffcccc">!</a>
  8244) <a name="l8244" style="background-color: #ffcccc">         IF( IC.GE.225 .AND. IC.LE.250 ) THEN</a>
  8245) <a name="l8245" style="background-color: #ffcccc">            SUBNAM( 1:1 ) = CHAR( IC-32 )</a>
  8246) <a name="l8246" style="background-color: #ffcccc">            DO 30 I = 2, 6</a>
  8247) <a name="l8247" style="background-color: #ffcccc">               IC = ICHAR( SUBNAM( I:I ) )</a>
  8248) <a name="l8248" style="background-color: #ffcccc">               IF( IC.GE.225 .AND. IC.LE.250 ) &amp;</a>
  8249) <a name="l8249" style="background-color: #ffcccc">                  SUBNAM( I:I ) = CHAR( IC-32 )</a>
  8250) <a name="l8250" style="background-color: #ffcccc">   30       CONTINUE</a>
  8251) <a name="l8251" style="background-color: #ffcccc">         END IF</a>
  8252) <a name="l8252" style="background-color: #ffcccc">      END IF</a>
  8253) <a name="l8253" style="background-color: #ffcccc">!</a>
  8254) <a name="l8254" style="background-color: #ffcccc">      C1 = SUBNAM( 1:1 )</a>
  8255) <a name="l8255" style="background-color: #ffcccc">      SNAME = C1.EQ.'S' .OR. C1.EQ.'D'</a>
  8256) <a name="l8256" style="background-color: #ffcccc">      CNAME = C1.EQ.'C' .OR. C1.EQ.'Z'</a>
  8257) <a name="l8257" style="background-color: #ffcccc">      IF( .NOT.( CNAME .OR. SNAME ) ) &amp;</a>
  8258) <a name="l8258" style="background-color: #ffcccc">         RETURN</a>
  8259) <a name="l8259" style="background-color: #ffcccc">      C2 = SUBNAM( 2:3 )</a>
  8260) <a name="l8260" style="background-color: #ffcccc">      C3 = SUBNAM( 4:6 )</a>
  8261) <a name="l8261" style="background-color: #ffcccc">      C4 = C3( 2:3 )</a>
  8262) <a name="l8262" style="background-color: #ffcccc">!</a>
  8263) <a name="l8263" style="background-color: #ffcccc">      GO TO ( 110, 200, 300 ) ISPEC</a>
  8264) <a name="l8264" style="background-color: #ffcccc">!</a>
  8265) <a name="l8265" style="background-color: #ffcccc">  110 CONTINUE</a>
  8266) <a name="l8266" style="background-color: #ffcccc">!</a>
  8267) <a name="l8267" style="background-color: #ffcccc">!     ISPEC = 1:  block size</a>
  8268) <a name="l8268" style="background-color: #ffcccc">!</a>
  8269) <a name="l8269" style="background-color: #ffcccc">!     In these examples, separate code is provided for setting NB for</a>
  8270) <a name="l8270" style="background-color: #ffcccc">!     real and complex.  We assume that NB will take the same value in</a>
  8271) <a name="l8271" style="background-color: #ffcccc">!     single or double precision.</a>
  8272) <a name="l8272" style="background-color: #ffcccc">!</a>
  8273) <a name="l8273" style="background-color: #ffcccc">      NB = 1</a>
  8274) <a name="l8274" style="background-color: #ffcccc">!</a>
  8275) <a name="l8275" style="background-color: #ffcccc">      IF( C2.EQ.'GE' ) THEN</a>
  8276) <a name="l8276" style="background-color: #ffcccc">         IF( C3.EQ.'TRF' ) THEN</a>
  8277) <a name="l8277" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8278) <a name="l8278" style="background-color: #ffcccc">               NB = 64</a>
  8279) <a name="l8279" style="background-color: #ffcccc">            ELSE</a>
  8280) <a name="l8280" style="background-color: #ffcccc">               NB = 64</a>
  8281) <a name="l8281" style="background-color: #ffcccc">            END IF</a>
  8282) <a name="l8282" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'QRF' .OR. C3.EQ.'RQF' .OR. C3.EQ.'LQF' .OR. &amp;</a>
  8283) <a name="l8283" style="background-color: #ffcccc">                  C3.EQ.'QLF' ) THEN</a>
  8284) <a name="l8284" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8285) <a name="l8285" style="background-color: #ffcccc">               NB = 32</a>
  8286) <a name="l8286" style="background-color: #ffcccc">            ELSE</a>
  8287) <a name="l8287" style="background-color: #ffcccc">               NB = 32</a>
  8288) <a name="l8288" style="background-color: #ffcccc">            END IF</a>
  8289) <a name="l8289" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'HRD' ) THEN</a>
  8290) <a name="l8290" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8291) <a name="l8291" style="background-color: #ffcccc">               NB = 32</a>
  8292) <a name="l8292" style="background-color: #ffcccc">            ELSE</a>
  8293) <a name="l8293" style="background-color: #ffcccc">               NB = 32</a>
  8294) <a name="l8294" style="background-color: #ffcccc">            END IF</a>
  8295) <a name="l8295" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'BRD' ) THEN</a>
  8296) <a name="l8296" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8297) <a name="l8297" style="background-color: #ffcccc">               NB = 32</a>
  8298) <a name="l8298" style="background-color: #ffcccc">            ELSE</a>
  8299) <a name="l8299" style="background-color: #ffcccc">               NB = 32</a>
  8300) <a name="l8300" style="background-color: #ffcccc">            END IF</a>
  8301) <a name="l8301" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'TRI' ) THEN</a>
  8302) <a name="l8302" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8303) <a name="l8303" style="background-color: #ffcccc">               NB = 64</a>
  8304) <a name="l8304" style="background-color: #ffcccc">            ELSE</a>
  8305) <a name="l8305" style="background-color: #ffcccc">               NB = 64</a>
  8306) <a name="l8306" style="background-color: #ffcccc">            END IF</a>
  8307) <a name="l8307" style="background-color: #ffcccc">         END IF</a>
  8308) <a name="l8308" style="background-color: #ffcccc">      ELSE IF( C2.EQ.'PO' ) THEN</a>
  8309) <a name="l8309" style="background-color: #ffcccc">         IF( C3.EQ.'TRF' ) THEN</a>
  8310) <a name="l8310" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8311) <a name="l8311" style="background-color: #ffcccc">               NB = 64</a>
  8312) <a name="l8312" style="background-color: #ffcccc">            ELSE</a>
  8313) <a name="l8313" style="background-color: #ffcccc">               NB = 64</a>
  8314) <a name="l8314" style="background-color: #ffcccc">            END IF</a>
  8315) <a name="l8315" style="background-color: #ffcccc">         END IF</a>
  8316) <a name="l8316" style="background-color: #ffcccc">      ELSE IF( C2.EQ.'SY' ) THEN</a>
  8317) <a name="l8317" style="background-color: #ffcccc">         IF( C3.EQ.'TRF' ) THEN</a>
  8318) <a name="l8318" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8319) <a name="l8319" style="background-color: #ffcccc">               NB = 64</a>
  8320) <a name="l8320" style="background-color: #ffcccc">            ELSE</a>
  8321) <a name="l8321" style="background-color: #ffcccc">               NB = 64</a>
  8322) <a name="l8322" style="background-color: #ffcccc">            END IF</a>
  8323) <a name="l8323" style="background-color: #ffcccc">         ELSE IF( SNAME .AND. C3.EQ.'TRD' ) THEN</a>
  8324) <a name="l8324" style="background-color: #ffcccc">            NB = 1</a>
  8325) <a name="l8325" style="background-color: #ffcccc">         ELSE IF( SNAME .AND. C3.EQ.'GST' ) THEN</a>
  8326) <a name="l8326" style="background-color: #ffcccc">            NB = 64</a>
  8327) <a name="l8327" style="background-color: #ffcccc">         END IF</a>
  8328) <a name="l8328" style="background-color: #ffcccc">      ELSE IF( CNAME .AND. C2.EQ.'HE' ) THEN</a>
  8329) <a name="l8329" style="background-color: #ffcccc">         IF( C3.EQ.'TRF' ) THEN</a>
  8330) <a name="l8330" style="background-color: #ffcccc">            NB = 64</a>
  8331) <a name="l8331" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'TRD' ) THEN</a>
  8332) <a name="l8332" style="background-color: #ffcccc">            NB = 1</a>
  8333) <a name="l8333" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'GST' ) THEN</a>
  8334) <a name="l8334" style="background-color: #ffcccc">            NB = 64</a>
  8335) <a name="l8335" style="background-color: #ffcccc">         END IF</a>
  8336) <a name="l8336" style="background-color: #ffcccc">      ELSE IF( SNAME .AND. C2.EQ.'OR' ) THEN</a>
  8337) <a name="l8337" style="background-color: #ffcccc">         IF( C3( 1:1 ).EQ.'G' ) THEN</a>
  8338) <a name="l8338" style="background-color: #ffcccc">            IF( C4.EQ.'QR' .OR. C4.EQ.'RQ' .OR. C4.EQ.'LQ' .OR. &amp;</a>
  8339) <a name="l8339" style="background-color: #ffcccc">                C4.EQ.'QL' .OR. C4.EQ.'HR' .OR. C4.EQ.'TR' .OR. &amp;</a>
  8340) <a name="l8340" style="background-color: #ffcccc">                C4.EQ.'BR' ) THEN</a>
  8341) <a name="l8341" style="background-color: #ffcccc">               NB = 32</a>
  8342) <a name="l8342" style="background-color: #ffcccc">            END IF</a>
  8343) <a name="l8343" style="background-color: #ffcccc">         ELSE IF( C3( 1:1 ).EQ.'M' ) THEN</a>
  8344) <a name="l8344" style="background-color: #ffcccc">            IF( C4.EQ.'QR' .OR. C4.EQ.'RQ' .OR. C4.EQ.'LQ' .OR. &amp;</a>
  8345) <a name="l8345" style="background-color: #ffcccc">                C4.EQ.'QL' .OR. C4.EQ.'HR' .OR. C4.EQ.'TR' .OR. &amp;</a>
  8346) <a name="l8346" style="background-color: #ffcccc">                C4.EQ.'BR' ) THEN</a>
  8347) <a name="l8347" style="background-color: #ffcccc">               NB = 32</a>
  8348) <a name="l8348" style="background-color: #ffcccc">            END IF</a>
  8349) <a name="l8349" style="background-color: #ffcccc">         END IF</a>
  8350) <a name="l8350" style="background-color: #ffcccc">      ELSE IF( CNAME .AND. C2.EQ.'UN' ) THEN</a>
  8351) <a name="l8351" style="background-color: #ffcccc">         IF( C3( 1:1 ).EQ.'G' ) THEN</a>
  8352) <a name="l8352" style="background-color: #ffcccc">            IF( C4.EQ.'QR' .OR. C4.EQ.'RQ' .OR. C4.EQ.'LQ' .OR. &amp;</a>
  8353) <a name="l8353" style="background-color: #ffcccc">                C4.EQ.'QL' .OR. C4.EQ.'HR' .OR. C4.EQ.'TR' .OR. &amp;</a>
  8354) <a name="l8354" style="background-color: #ffcccc">                C4.EQ.'BR' ) THEN</a>
  8355) <a name="l8355" style="background-color: #ffcccc">               NB = 32</a>
  8356) <a name="l8356" style="background-color: #ffcccc">            END IF</a>
  8357) <a name="l8357" style="background-color: #ffcccc">         ELSE IF( C3( 1:1 ).EQ.'M' ) THEN</a>
  8358) <a name="l8358" style="background-color: #ffcccc">            IF( C4.EQ.'QR' .OR. C4.EQ.'RQ' .OR. C4.EQ.'LQ' .OR. &amp;</a>
  8359) <a name="l8359" style="background-color: #ffcccc">                C4.EQ.'QL' .OR. C4.EQ.'HR' .OR. C4.EQ.'TR' .OR. &amp;</a>
  8360) <a name="l8360" style="background-color: #ffcccc">                C4.EQ.'BR' ) THEN</a>
  8361) <a name="l8361" style="background-color: #ffcccc">               NB = 32</a>
  8362) <a name="l8362" style="background-color: #ffcccc">            END IF</a>
  8363) <a name="l8363" style="background-color: #ffcccc">         END IF</a>
  8364) <a name="l8364" style="background-color: #ffcccc">      ELSE IF( C2.EQ.'GB' ) THEN</a>
  8365) <a name="l8365" style="background-color: #ffcccc">         IF( C3.EQ.'TRF' ) THEN</a>
  8366) <a name="l8366" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8367) <a name="l8367" style="background-color: #ffcccc">               IF( N4.LE.64 ) THEN</a>
  8368) <a name="l8368" style="background-color: #ffcccc">                  NB = 1</a>
  8369) <a name="l8369" style="background-color: #ffcccc">               ELSE</a>
  8370) <a name="l8370" style="background-color: #ffcccc">                  NB = 32</a>
  8371) <a name="l8371" style="background-color: #ffcccc">               END IF</a>
  8372) <a name="l8372" style="background-color: #ffcccc">            ELSE</a>
  8373) <a name="l8373" style="background-color: #ffcccc">               IF( N4.LE.64 ) THEN</a>
  8374) <a name="l8374" style="background-color: #ffcccc">                  NB = 1</a>
  8375) <a name="l8375" style="background-color: #ffcccc">               ELSE</a>
  8376) <a name="l8376" style="background-color: #ffcccc">                  NB = 32</a>
  8377) <a name="l8377" style="background-color: #ffcccc">               END IF</a>
  8378) <a name="l8378" style="background-color: #ffcccc">            END IF</a>
  8379) <a name="l8379" style="background-color: #ffcccc">         END IF</a>
  8380) <a name="l8380" style="background-color: #ffcccc">      ELSE IF( C2.EQ.'PB' ) THEN</a>
  8381) <a name="l8381" style="background-color: #ffcccc">         IF( C3.EQ.'TRF' ) THEN</a>
  8382) <a name="l8382" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8383) <a name="l8383" style="background-color: #ffcccc">               IF( N2.LE.64 ) THEN</a>
  8384) <a name="l8384" style="background-color: #ffcccc">                  NB = 1</a>
  8385) <a name="l8385" style="background-color: #ffcccc">               ELSE</a>
  8386) <a name="l8386" style="background-color: #ffcccc">                  NB = 32</a>
  8387) <a name="l8387" style="background-color: #ffcccc">               END IF</a>
  8388) <a name="l8388" style="background-color: #ffcccc">            ELSE</a>
  8389) <a name="l8389" style="background-color: #ffcccc">               IF( N2.LE.64 ) THEN</a>
  8390) <a name="l8390" style="background-color: #ffcccc">                  NB = 1</a>
  8391) <a name="l8391" style="background-color: #ffcccc">               ELSE</a>
  8392) <a name="l8392" style="background-color: #ffcccc">                  NB = 32</a>
  8393) <a name="l8393" style="background-color: #ffcccc">               END IF</a>
  8394) <a name="l8394" style="background-color: #ffcccc">            END IF</a>
  8395) <a name="l8395" style="background-color: #ffcccc">         END IF</a>
  8396) <a name="l8396" style="background-color: #ffcccc">      ELSE IF( C2.EQ.'TR' ) THEN</a>
  8397) <a name="l8397" style="background-color: #ffcccc">         IF( C3.EQ.'TRI' ) THEN</a>
  8398) <a name="l8398" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8399) <a name="l8399" style="background-color: #ffcccc">               NB = 64</a>
  8400) <a name="l8400" style="background-color: #ffcccc">            ELSE</a>
  8401) <a name="l8401" style="background-color: #ffcccc">               NB = 64</a>
  8402) <a name="l8402" style="background-color: #ffcccc">            END IF</a>
  8403) <a name="l8403" style="background-color: #ffcccc">         END IF</a>
  8404) <a name="l8404" style="background-color: #ffcccc">      ELSE IF( C2.EQ.'LA' ) THEN</a>
  8405) <a name="l8405" style="background-color: #ffcccc">         IF( C3.EQ.'UUM' ) THEN</a>
  8406) <a name="l8406" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8407) <a name="l8407" style="background-color: #ffcccc">               NB = 64</a>
  8408) <a name="l8408" style="background-color: #ffcccc">            ELSE</a>
  8409) <a name="l8409" style="background-color: #ffcccc">               NB = 64</a>
  8410) <a name="l8410" style="background-color: #ffcccc">            END IF</a>
  8411) <a name="l8411" style="background-color: #ffcccc">         END IF</a>
  8412) <a name="l8412" style="background-color: #ffcccc">      ELSE IF( SNAME .AND. C2.EQ.'ST' ) THEN</a>
  8413) <a name="l8413" style="background-color: #ffcccc">         IF( C3.EQ.'EBZ' ) THEN</a>
  8414) <a name="l8414" style="background-color: #ffcccc">            NB = 1</a>
  8415) <a name="l8415" style="background-color: #ffcccc">         END IF</a>
  8416) <a name="l8416" style="background-color: #ffcccc">      END IF</a>
  8417) <a name="l8417" style="background-color: #ffcccc">      ILAENV = NB</a>
  8418) <a name="l8418" style="background-color: #ffcccc">      RETURN</a>
  8419) <a name="l8419" style="background-color: #ffcccc">!</a>
  8420) <a name="l8420" style="background-color: #ffcccc">  200 CONTINUE</a>
  8421) <a name="l8421" style="background-color: #ffcccc">!</a>
  8422) <a name="l8422" style="background-color: #ffcccc">!     ISPEC = 2:  minimum block size</a>
  8423) <a name="l8423" style="background-color: #ffcccc">!</a>
  8424) <a name="l8424" style="background-color: #ffcccc">      NBMIN = 2</a>
  8425) <a name="l8425" style="background-color: #ffcccc">      IF( C2.EQ.'GE' ) THEN</a>
  8426) <a name="l8426" style="background-color: #ffcccc">         IF( C3.EQ.'QRF' .OR. C3.EQ.'RQF' .OR. C3.EQ.'LQF' .OR. &amp;</a>
  8427) <a name="l8427" style="background-color: #ffcccc">             C3.EQ.'QLF' ) THEN</a>
  8428) <a name="l8428" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8429) <a name="l8429" style="background-color: #ffcccc">               NBMIN = 2</a>
  8430) <a name="l8430" style="background-color: #ffcccc">            ELSE</a>
  8431) <a name="l8431" style="background-color: #ffcccc">               NBMIN = 2</a>
  8432) <a name="l8432" style="background-color: #ffcccc">            END IF</a>
  8433) <a name="l8433" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'HRD' ) THEN</a>
  8434) <a name="l8434" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8435) <a name="l8435" style="background-color: #ffcccc">               NBMIN = 2</a>
  8436) <a name="l8436" style="background-color: #ffcccc">            ELSE</a>
  8437) <a name="l8437" style="background-color: #ffcccc">               NBMIN = 2</a>
  8438) <a name="l8438" style="background-color: #ffcccc">            END IF</a>
  8439) <a name="l8439" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'BRD' ) THEN</a>
  8440) <a name="l8440" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8441) <a name="l8441" style="background-color: #ffcccc">               NBMIN = 2</a>
  8442) <a name="l8442" style="background-color: #ffcccc">            ELSE</a>
  8443) <a name="l8443" style="background-color: #ffcccc">               NBMIN = 2</a>
  8444) <a name="l8444" style="background-color: #ffcccc">            END IF</a>
  8445) <a name="l8445" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'TRI' ) THEN</a>
  8446) <a name="l8446" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8447) <a name="l8447" style="background-color: #ffcccc">               NBMIN = 2</a>
  8448) <a name="l8448" style="background-color: #ffcccc">            ELSE</a>
  8449) <a name="l8449" style="background-color: #ffcccc">               NBMIN = 2</a>
  8450) <a name="l8450" style="background-color: #ffcccc">            END IF</a>
  8451) <a name="l8451" style="background-color: #ffcccc">         END IF</a>
  8452) <a name="l8452" style="background-color: #ffcccc">      ELSE IF( C2.EQ.'SY' ) THEN</a>
  8453) <a name="l8453" style="background-color: #ffcccc">         IF( C3.EQ.'TRF' ) THEN</a>
  8454) <a name="l8454" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8455) <a name="l8455" style="background-color: #ffcccc">               NBMIN = 8</a>
  8456) <a name="l8456" style="background-color: #ffcccc">            ELSE</a>
  8457) <a name="l8457" style="background-color: #ffcccc">               NBMIN = 8</a>
  8458) <a name="l8458" style="background-color: #ffcccc">            END IF</a>
  8459) <a name="l8459" style="background-color: #ffcccc">         ELSE IF( SNAME .AND. C3.EQ.'TRD' ) THEN</a>
  8460) <a name="l8460" style="background-color: #ffcccc">            NBMIN = 2</a>
  8461) <a name="l8461" style="background-color: #ffcccc">         END IF</a>
  8462) <a name="l8462" style="background-color: #ffcccc">      ELSE IF( CNAME .AND. C2.EQ.'HE' ) THEN</a>
  8463) <a name="l8463" style="background-color: #ffcccc">         IF( C3.EQ.'TRD' ) THEN</a>
  8464) <a name="l8464" style="background-color: #ffcccc">            NBMIN = 2</a>
  8465) <a name="l8465" style="background-color: #ffcccc">         END IF</a>
  8466) <a name="l8466" style="background-color: #ffcccc">      ELSE IF( SNAME .AND. C2.EQ.'OR' ) THEN</a>
  8467) <a name="l8467" style="background-color: #ffcccc">         IF( C3( 1:1 ).EQ.'G' ) THEN</a>
  8468) <a name="l8468" style="background-color: #ffcccc">            IF( C4.EQ.'QR' .OR. C4.EQ.'RQ' .OR. C4.EQ.'LQ' .OR. &amp;</a>
  8469) <a name="l8469" style="background-color: #ffcccc">                C4.EQ.'QL' .OR. C4.EQ.'HR' .OR. C4.EQ.'TR' .OR. &amp;</a>
  8470) <a name="l8470" style="background-color: #ffcccc">                C4.EQ.'BR' ) THEN</a>
  8471) <a name="l8471" style="background-color: #ffcccc">               NBMIN = 2</a>
  8472) <a name="l8472" style="background-color: #ffcccc">            END IF</a>
  8473) <a name="l8473" style="background-color: #ffcccc">         ELSE IF( C3( 1:1 ).EQ.'M' ) THEN</a>
  8474) <a name="l8474" style="background-color: #ffcccc">            IF( C4.EQ.'QR' .OR. C4.EQ.'RQ' .OR. C4.EQ.'LQ' .OR. &amp;</a>
  8475) <a name="l8475" style="background-color: #ffcccc">                C4.EQ.'QL' .OR. C4.EQ.'HR' .OR. C4.EQ.'TR' .OR. &amp;</a>
  8476) <a name="l8476" style="background-color: #ffcccc">                C4.EQ.'BR' ) THEN</a>
  8477) <a name="l8477" style="background-color: #ffcccc">               NBMIN = 2</a>
  8478) <a name="l8478" style="background-color: #ffcccc">            END IF</a>
  8479) <a name="l8479" style="background-color: #ffcccc">         END IF</a>
  8480) <a name="l8480" style="background-color: #ffcccc">      ELSE IF( CNAME .AND. C2.EQ.'UN' ) THEN</a>
  8481) <a name="l8481" style="background-color: #ffcccc">         IF( C3( 1:1 ).EQ.'G' ) THEN</a>
  8482) <a name="l8482" style="background-color: #ffcccc">            IF( C4.EQ.'QR' .OR. C4.EQ.'RQ' .OR. C4.EQ.'LQ' .OR. &amp;</a>
  8483) <a name="l8483" style="background-color: #ffcccc">                C4.EQ.'QL' .OR. C4.EQ.'HR' .OR. C4.EQ.'TR' .OR. &amp;</a>
  8484) <a name="l8484" style="background-color: #ffcccc">                C4.EQ.'BR' ) THEN</a>
  8485) <a name="l8485" style="background-color: #ffcccc">               NBMIN = 2</a>
  8486) <a name="l8486" style="background-color: #ffcccc">            END IF</a>
  8487) <a name="l8487" style="background-color: #ffcccc">         ELSE IF( C3( 1:1 ).EQ.'M' ) THEN</a>
  8488) <a name="l8488" style="background-color: #ffcccc">            IF( C4.EQ.'QR' .OR. C4.EQ.'RQ' .OR. C4.EQ.'LQ' .OR. &amp;</a>
  8489) <a name="l8489" style="background-color: #ffcccc">                C4.EQ.'QL' .OR. C4.EQ.'HR' .OR. C4.EQ.'TR' .OR. &amp;</a>
  8490) <a name="l8490" style="background-color: #ffcccc">                C4.EQ.'BR' ) THEN</a>
  8491) <a name="l8491" style="background-color: #ffcccc">               NBMIN = 2</a>
  8492) <a name="l8492" style="background-color: #ffcccc">            END IF</a>
  8493) <a name="l8493" style="background-color: #ffcccc">         END IF</a>
  8494) <a name="l8494" style="background-color: #ffcccc">      END IF</a>
  8495) <a name="l8495" style="background-color: #ffcccc">      ILAENV = NBMIN</a>
  8496) <a name="l8496" style="background-color: #ffcccc">      RETURN</a>
  8497) <a name="l8497" style="background-color: #ffcccc">!</a>
  8498) <a name="l8498" style="background-color: #ffcccc">  300 CONTINUE</a>
  8499) <a name="l8499" style="background-color: #ffcccc">!</a>
  8500) <a name="l8500" style="background-color: #ffcccc">!     ISPEC = 3:  crossover point</a>
  8501) <a name="l8501" style="background-color: #ffcccc">!</a>
  8502) <a name="l8502" style="background-color: #ffcccc">      NX = 0</a>
  8503) <a name="l8503" style="background-color: #ffcccc">      IF( C2.EQ.'GE' ) THEN</a>
  8504) <a name="l8504" style="background-color: #ffcccc">         IF( C3.EQ.'QRF' .OR. C3.EQ.'RQF' .OR. C3.EQ.'LQF' .OR. &amp;</a>
  8505) <a name="l8505" style="background-color: #ffcccc">             C3.EQ.'QLF' ) THEN</a>
  8506) <a name="l8506" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8507) <a name="l8507" style="background-color: #ffcccc">               NX = 128</a>
  8508) <a name="l8508" style="background-color: #ffcccc">            ELSE</a>
  8509) <a name="l8509" style="background-color: #ffcccc">               NX = 128</a>
  8510) <a name="l8510" style="background-color: #ffcccc">            END IF</a>
  8511) <a name="l8511" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'HRD' ) THEN</a>
  8512) <a name="l8512" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8513) <a name="l8513" style="background-color: #ffcccc">               NX = 128</a>
  8514) <a name="l8514" style="background-color: #ffcccc">            ELSE</a>
  8515) <a name="l8515" style="background-color: #ffcccc">               NX = 128</a>
  8516) <a name="l8516" style="background-color: #ffcccc">            END IF</a>
  8517) <a name="l8517" style="background-color: #ffcccc">         ELSE IF( C3.EQ.'BRD' ) THEN</a>
  8518) <a name="l8518" style="background-color: #ffcccc">            IF( SNAME ) THEN</a>
  8519) <a name="l8519" style="background-color: #ffcccc">               NX = 128</a>
  8520) <a name="l8520" style="background-color: #ffcccc">            ELSE</a>
  8521) <a name="l8521" style="background-color: #ffcccc">               NX = 128</a>
  8522) <a name="l8522" style="background-color: #ffcccc">            END IF</a>
  8523) <a name="l8523" style="background-color: #ffcccc">         END IF</a>
  8524) <a name="l8524" style="background-color: #ffcccc">      ELSE IF( C2.EQ.'SY' ) THEN</a>
  8525) <a name="l8525" style="background-color: #ffcccc">         IF( SNAME .AND. C3.EQ.'TRD' ) THEN</a>
  8526) <a name="l8526" style="background-color: #ffcccc">            NX = 1</a>
  8527) <a name="l8527" style="background-color: #ffcccc">         END IF</a>
  8528) <a name="l8528" style="background-color: #ffcccc">      ELSE IF( CNAME .AND. C2.EQ.'HE' ) THEN</a>
  8529) <a name="l8529" style="background-color: #ffcccc">         IF( C3.EQ.'TRD' ) THEN</a>
  8530) <a name="l8530" style="background-color: #ffcccc">            NX = 1</a>
  8531) <a name="l8531" style="background-color: #ffcccc">         END IF</a>
  8532) <a name="l8532" style="background-color: #ffcccc">      ELSE IF( SNAME .AND. C2.EQ.'OR' ) THEN</a>
  8533) <a name="l8533" style="background-color: #ffcccc">         IF( C3( 1:1 ).EQ.'G' ) THEN</a>
  8534) <a name="l8534" style="background-color: #ffcccc">            IF( C4.EQ.'QR' .OR. C4.EQ.'RQ' .OR. C4.EQ.'LQ' .OR. &amp;</a>
  8535) <a name="l8535" style="background-color: #ffcccc">                C4.EQ.'QL' .OR. C4.EQ.'HR' .OR. C4.EQ.'TR' .OR. &amp;</a>
  8536) <a name="l8536" style="background-color: #ffcccc">                C4.EQ.'BR' ) THEN</a>
  8537) <a name="l8537" style="background-color: #ffcccc">               NX = 128</a>
  8538) <a name="l8538" style="background-color: #ffcccc">            END IF</a>
  8539) <a name="l8539" style="background-color: #ffcccc">         END IF</a>
  8540) <a name="l8540" style="background-color: #ffcccc">      ELSE IF( CNAME .AND. C2.EQ.'UN' ) THEN</a>
  8541) <a name="l8541" style="background-color: #ffcccc">         IF( C3( 1:1 ).EQ.'G' ) THEN</a>
  8542) <a name="l8542" style="background-color: #ffcccc">            IF( C4.EQ.'QR' .OR. C4.EQ.'RQ' .OR. C4.EQ.'LQ' .OR. &amp;</a>
  8543) <a name="l8543" style="background-color: #ffcccc">                C4.EQ.'QL' .OR. C4.EQ.'HR' .OR. C4.EQ.'TR' .OR. &amp;</a>
  8544) <a name="l8544" style="background-color: #ffcccc">                C4.EQ.'BR' ) THEN</a>
  8545) <a name="l8545" style="background-color: #ffcccc">               NX = 128</a>
  8546) <a name="l8546" style="background-color: #ffcccc">            END IF</a>
  8547) <a name="l8547" style="background-color: #ffcccc">         END IF</a>
  8548) <a name="l8548" style="background-color: #ffcccc">      END IF</a>
  8549) <a name="l8549" style="background-color: #ffcccc">      ILAENV = NX</a>
  8550) <a name="l8550" style="background-color: #ffcccc">      RETURN</a>
  8551) <a name="l8551" style="background-color: #ffcccc">!</a>
  8552) <a name="l8552" style="background-color: #ffcccc">  400 CONTINUE</a>
  8553) <a name="l8553" style="background-color: #ffcccc">!</a>
  8554) <a name="l8554" style="background-color: #ffcccc">!     ISPEC = 4:  number of shifts (used by xHSEQR)</a>
  8555) <a name="l8555" style="background-color: #ffcccc">!</a>
  8556) <a name="l8556" style="background-color: #ffcccc">      ILAENV = 6</a>
  8557) <a name="l8557" style="background-color: #ffcccc">      RETURN</a>
  8558) <a name="l8558" style="background-color: #ffcccc">!</a>
  8559) <a name="l8559" style="background-color: #ffcccc">  500 CONTINUE</a>
  8560) <a name="l8560" style="background-color: #ffcccc">!</a>
  8561) <a name="l8561" style="background-color: #ffcccc">!     ISPEC = 5:  minimum column dimension (not used)</a>
  8562) <a name="l8562" style="background-color: #ffcccc">!</a>
  8563) <a name="l8563" style="background-color: #ffcccc">      ILAENV = 2</a>
  8564) <a name="l8564" style="background-color: #ffcccc">      RETURN</a>
  8565) <a name="l8565" style="background-color: #ffcccc">!</a>
  8566) <a name="l8566" style="background-color: #ffcccc">  600 CONTINUE </a>
  8567) <a name="l8567" style="background-color: #ffcccc">!</a>
  8568) <a name="l8568" style="background-color: #ffcccc">!     ISPEC = 6:  crossover point for SVD (used by xGELSS and xGESVD)</a>
  8569) <a name="l8569" style="background-color: #ffcccc">!</a>
  8570) <a name="l8570" style="background-color: #ffcccc">      ILAENV = INT( REAL( MIN( N1, N2 ) ,r8)*1.6E0_r8 )</a>
  8571) <a name="l8571" style="background-color: #ffcccc">      RETURN</a>
  8572) <a name="l8572" style="background-color: #ffcccc">!</a>
  8573) <a name="l8573" style="background-color: #ffcccc">  700 CONTINUE</a>
  8574) <a name="l8574" style="background-color: #ffcccc">!</a>
  8575) <a name="l8575" style="background-color: #ffcccc">!     ISPEC = 7:  number of processors (not used)</a>
  8576) <a name="l8576" style="background-color: #ffcccc">!</a>
  8577) <a name="l8577" style="background-color: #ffcccc">      ILAENV = 1</a>
  8578) <a name="l8578" style="background-color: #ffcccc">      RETURN</a>
  8579) <a name="l8579" style="background-color: #ffcccc">!</a>
  8580) <a name="l8580" style="background-color: #ffcccc">  800 CONTINUE</a>
  8581) <a name="l8581" style="background-color: #ffcccc">!</a>
  8582) <a name="l8582" style="background-color: #ffcccc">!     ISPEC = 8:  crossover point for multishift (used by xHSEQR)</a>
  8583) <a name="l8583" style="background-color: #ffcccc">!</a>
  8584) <a name="l8584" style="background-color: #ffcccc">      ILAENV = 50</a>
  8585) <a name="l8585" style="background-color: #ffcccc">      RETURN</a>
  8586) <a name="l8586" style="background-color: #ffcccc">!</a>
  8587) <a name="l8587" style="background-color: #ffcccc">!     End of ILAENV</a>
  8588) <a name="l8588" style="background-color: #ffcccc">!</a>
  8589) <a name="l8589" style="background-color: #ffcccc">      END FUNCTION ILAENV</a>
  8590) <a name="l8590" style="background-color: #ffffff"></a>
  8591) <a name="l8591" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  8592) <a name="l8592" style="background-color: #ffffff"></a>
  8593) <a name="l8593" style="background-color: #ffffff">      LOGICAL FUNCTION </a><a style="background-color: #ffcccc">LSAME( CA, CB )</a>
  8594) <a name="l8594" style="background-color: #ffcccc"></a>
  8595) <a name="l8595" style="background-color: #ffcccc">!</a>
  8596) <a name="l8596" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  8597) <a name="l8597" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  8598) <a name="l8598" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  8599) <a name="l8599" style="background-color: #ffcccc">!     September 30, 1994</a>
  8600) <a name="l8600" style="background-color: #ffcccc">!</a>
  8601) <a name="l8601" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  8602) <a name="l8602" style="background-color: #ffcccc">      CHARACTER          CA, CB</a>
  8603) <a name="l8603" style="background-color: #ffcccc">!     ..</a>
  8604) <a name="l8604" style="background-color: #ffcccc">!</a>
  8605) <a name="l8605" style="background-color: #ffcccc">!  Purpose</a>
  8606) <a name="l8606" style="background-color: #ffcccc">!  =======</a>
  8607) <a name="l8607" style="background-color: #ffcccc">!</a>
  8608) <a name="l8608" style="background-color: #ffcccc">!  LSAME returns .TRUE. if CA is the same letter as CB regardless of</a>
  8609) <a name="l8609" style="background-color: #ffcccc">!  case.</a>
  8610) <a name="l8610" style="background-color: #ffcccc">!</a>
  8611) <a name="l8611" style="background-color: #ffcccc">!  Arguments</a>
  8612) <a name="l8612" style="background-color: #ffcccc">!  =========</a>
  8613) <a name="l8613" style="background-color: #ffcccc">!</a>
  8614) <a name="l8614" style="background-color: #ffcccc">!  CA      (input) CHARACTER*1</a>
  8615) <a name="l8615" style="background-color: #ffcccc">!  CB      (input) CHARACTER*1</a>
  8616) <a name="l8616" style="background-color: #ffcccc">!          CA and CB specify the single characters to be compared.</a>
  8617) <a name="l8617" style="background-color: #ffcccc">!</a>
  8618) <a name="l8618" style="background-color: #ffcccc">! =====================================================================</a>
  8619) <a name="l8619" style="background-color: #ffcccc">!</a>
  8620) <a name="l8620" style="background-color: #ffcccc">!     ..</a>
  8621) <a name="l8621" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  8622) <a name="l8622" style="background-color: #ffcccc">      INTEGER            INTA, INTB, ZCODE</a>
  8623) <a name="l8623" style="background-color: #ffcccc">!     ..</a>
  8624) <a name="l8624" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  8625) <a name="l8625" style="background-color: #ffcccc">!</a>
  8626) <a name="l8626" style="background-color: #ffcccc">!     Test if the characters are equal</a>
  8627) <a name="l8627" style="background-color: #ffcccc">!</a>
  8628) <a name="l8628" style="background-color: #ffcccc">      LSAME = CA.EQ.CB</a>
  8629) <a name="l8629" style="background-color: #ffcccc">      IF( LSAME ) &amp;</a>
  8630) <a name="l8630" style="background-color: #ffcccc">         RETURN</a>
  8631) <a name="l8631" style="background-color: #ffcccc">!</a>
  8632) <a name="l8632" style="background-color: #ffcccc">!     Now test for equivalence if both characters are alphabetic.</a>
  8633) <a name="l8633" style="background-color: #ffcccc">!</a>
  8634) <a name="l8634" style="background-color: #ffcccc">      ZCODE = ICHAR( 'Z' )</a>
  8635) <a name="l8635" style="background-color: #ffcccc">!</a>
  8636) <a name="l8636" style="background-color: #ffcccc">!     Use 'Z' rather than 'A' so that ASCII can be detected on Prime</a>
  8637) <a name="l8637" style="background-color: #ffcccc">!     machines, on which ICHAR returns a value with bit 8 set.</a>
  8638) <a name="l8638" style="background-color: #ffcccc">!     ICHAR('A') on Prime machines returns 193 which is the same as</a>
  8639) <a name="l8639" style="background-color: #ffcccc">!     ICHAR('A') on an EBCDIC machine.</a>
  8640) <a name="l8640" style="background-color: #ffcccc">!</a>
  8641) <a name="l8641" style="background-color: #ffcccc">      INTA = ICHAR( CA )</a>
  8642) <a name="l8642" style="background-color: #ffcccc">      INTB = ICHAR( CB )</a>
  8643) <a name="l8643" style="background-color: #ffcccc">!</a>
  8644) <a name="l8644" style="background-color: #ffcccc">      IF( ZCODE.EQ.90 .OR. ZCODE.EQ.122 ) THEN</a>
  8645) <a name="l8645" style="background-color: #ffcccc">!</a>
  8646) <a name="l8646" style="background-color: #ffcccc">!        ASCII is assumed - ZCODE is the ASCII code of either lower or</a>
  8647) <a name="l8647" style="background-color: #ffcccc">!        upper case 'Z'.</a>
  8648) <a name="l8648" style="background-color: #ffcccc">!</a>
  8649) <a name="l8649" style="background-color: #ffcccc">         IF( INTA.GE.97 .AND. INTA.LE.122 ) INTA = INTA - 32</a>
  8650) <a name="l8650" style="background-color: #ffcccc">         IF( INTB.GE.97 .AND. INTB.LE.122 ) INTB = INTB - 32</a>
  8651) <a name="l8651" style="background-color: #ffcccc">!</a>
  8652) <a name="l8652" style="background-color: #ffcccc">      ELSE IF( ZCODE.EQ.233 .OR. ZCODE.EQ.169 ) THEN</a>
  8653) <a name="l8653" style="background-color: #ffcccc">!</a>
  8654) <a name="l8654" style="background-color: #ffcccc">!        EBCDIC is assumed - ZCODE is the EBCDIC code of either lower or</a>
  8655) <a name="l8655" style="background-color: #ffcccc">!        upper case 'Z'.</a>
  8656) <a name="l8656" style="background-color: #ffcccc">!</a>
  8657) <a name="l8657" style="background-color: #ffcccc">         IF( INTA.GE.129 .AND. INTA.LE.137 .OR. &amp;</a>
  8658) <a name="l8658" style="background-color: #ffcccc">             INTA.GE.145 .AND. INTA.LE.153 .OR. &amp;</a>
  8659) <a name="l8659" style="background-color: #ffcccc">             INTA.GE.162 .AND. INTA.LE.169 ) INTA = INTA + 64</a>
  8660) <a name="l8660" style="background-color: #ffcccc">         IF( INTB.GE.129 .AND. INTB.LE.137 .OR. &amp;</a>
  8661) <a name="l8661" style="background-color: #ffcccc">             INTB.GE.145 .AND. INTB.LE.153 .OR. &amp;</a>
  8662) <a name="l8662" style="background-color: #ffcccc">             INTB.GE.162 .AND. INTB.LE.169 ) INTB = INTB + 64</a>
  8663) <a name="l8663" style="background-color: #ffcccc">!</a>
  8664) <a name="l8664" style="background-color: #ffcccc">      ELSE IF( ZCODE.EQ.218 .OR. ZCODE.EQ.250 ) THEN</a>
  8665) <a name="l8665" style="background-color: #ffcccc">!</a>
  8666) <a name="l8666" style="background-color: #ffcccc">!        ASCII is assumed, on Prime machines - ZCODE is the ASCII code</a>
  8667) <a name="l8667" style="background-color: #ffcccc">!        plus 128 of either lower or upper case 'Z'.</a>
  8668) <a name="l8668" style="background-color: #ffcccc">!</a>
  8669) <a name="l8669" style="background-color: #ffcccc">         IF( INTA.GE.225 .AND. INTA.LE.250 ) INTA = INTA - 32</a>
  8670) <a name="l8670" style="background-color: #ffcccc">         IF( INTB.GE.225 .AND. INTB.LE.250 ) INTB = INTB - 32</a>
  8671) <a name="l8671" style="background-color: #ffcccc">      END IF</a>
  8672) <a name="l8672" style="background-color: #ffcccc">      LSAME = INTA.EQ.INTB</a>
  8673) <a name="l8673" style="background-color: #ffcccc">!</a>
  8674) <a name="l8674" style="background-color: #ffcccc">!     RETURN</a>
  8675) <a name="l8675" style="background-color: #ffcccc">!</a>
  8676) <a name="l8676" style="background-color: #ffcccc">!     End of LSAME</a>
  8677) <a name="l8677" style="background-color: #ffcccc">!</a>
  8678) <a name="l8678" style="background-color: #ffcccc">      END FUNCTION LSAME</a>
  8679) <a name="l8679" style="background-color: #ffffff"></a>
  8680) <a name="l8680" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  8681) <a name="l8681" style="background-color: #ffffff"></a>
  8682) <a name="l8682" style="background-color: #ffffff">      FUNCTION </a><a style="background-color: #ffcccc">SLAMCH( CMACH )</a>
  8683) <a name="l8683" style="background-color: #ffcccc"></a>
  8684) <a name="l8684" style="background-color: #ffcccc">      real(r8) slamch</a>
  8685) <a name="l8685" style="background-color: #ffcccc"></a>
  8686) <a name="l8686" style="background-color: #ffcccc">!</a>
  8687) <a name="l8687" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  8688) <a name="l8688" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  8689) <a name="l8689" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  8690) <a name="l8690" style="background-color: #ffcccc">!     October 31, 1992 </a>
  8691) <a name="l8691" style="background-color: #ffcccc">!</a>
  8692) <a name="l8692" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  8693) <a name="l8693" style="background-color: #ffcccc">      CHARACTER          CMACH</a>
  8694) <a name="l8694" style="background-color: #ffcccc">!     ..</a>
  8695) <a name="l8695" style="background-color: #ffcccc">!</a>
  8696) <a name="l8696" style="background-color: #ffcccc">!  Purpose</a>
  8697) <a name="l8697" style="background-color: #ffcccc">!  =======</a>
  8698) <a name="l8698" style="background-color: #ffcccc">!</a>
  8699) <a name="l8699" style="background-color: #ffcccc">!  SLAMCH determines single precision machine parameters.</a>
  8700) <a name="l8700" style="background-color: #ffcccc">!</a>
  8701) <a name="l8701" style="background-color: #ffcccc">!  Arguments</a>
  8702) <a name="l8702" style="background-color: #ffcccc">!  =========</a>
  8703) <a name="l8703" style="background-color: #ffcccc">!</a>
  8704) <a name="l8704" style="background-color: #ffcccc">!  CMACH   (input) CHARACTER*1</a>
  8705) <a name="l8705" style="background-color: #ffcccc">!          Specifies the value to be returned by SLAMCH:</a>
  8706) <a name="l8706" style="background-color: #ffcccc">!          = 'E' or 'e',   SLAMCH := eps</a>
  8707) <a name="l8707" style="background-color: #ffcccc">!          = 'S' or 's ,   SLAMCH := sfmin</a>
  8708) <a name="l8708" style="background-color: #ffcccc">!          = 'B' or 'b',   SLAMCH := base</a>
  8709) <a name="l8709" style="background-color: #ffcccc">!          = 'P' or 'p',   SLAMCH := eps*base</a>
  8710) <a name="l8710" style="background-color: #ffcccc">!          = 'N' or 'n',   SLAMCH := t</a>
  8711) <a name="l8711" style="background-color: #ffcccc">!          = 'R' or 'r',   SLAMCH := rnd</a>
  8712) <a name="l8712" style="background-color: #ffcccc">!          = 'M' or 'm',   SLAMCH := emin</a>
  8713) <a name="l8713" style="background-color: #ffcccc">!          = 'U' or 'u',   SLAMCH := rmin</a>
  8714) <a name="l8714" style="background-color: #ffcccc">!          = 'L' or 'l',   SLAMCH := emax</a>
  8715) <a name="l8715" style="background-color: #ffcccc">!          = 'O' or 'o',   SLAMCH := rmax</a>
  8716) <a name="l8716" style="background-color: #ffcccc">!</a>
  8717) <a name="l8717" style="background-color: #ffcccc">!          where</a>
  8718) <a name="l8718" style="background-color: #ffcccc">!</a>
  8719) <a name="l8719" style="background-color: #ffcccc">!          eps   = relative machine precision</a>
  8720) <a name="l8720" style="background-color: #ffcccc">!          sfmin = safe minimum, such that 1/sfmin does not overflow</a>
  8721) <a name="l8721" style="background-color: #ffcccc">!          base  = base of the machine</a>
  8722) <a name="l8722" style="background-color: #ffcccc">!          prec  = eps*base</a>
  8723) <a name="l8723" style="background-color: #ffcccc">!          t     = number of (base) digits in the mantissa</a>
  8724) <a name="l8724" style="background-color: #ffcccc">!          rnd   = 1.0 when rounding occurs in addition, 0.0 otherwise</a>
  8725) <a name="l8725" style="background-color: #ffcccc">!          emin  = minimum exponent before (gradual) underflow</a>
  8726) <a name="l8726" style="background-color: #ffcccc">!          rmin  = underflow threshold - base**(emin-1)</a>
  8727) <a name="l8727" style="background-color: #ffcccc">!          emax  = largest exponent before overflow</a>
  8728) <a name="l8728" style="background-color: #ffcccc">!          rmax  = overflow threshold  - (base**emax)*(1-eps)</a>
  8729) <a name="l8729" style="background-color: #ffcccc">!</a>
  8730) <a name="l8730" style="background-color: #ffcccc">! =====================================================================</a>
  8731) <a name="l8731" style="background-color: #ffcccc">!</a>
  8732) <a name="l8732" style="background-color: #ffcccc">!     .. Parameters ..</a>
  8733) <a name="l8733" style="background-color: #ffcccc">      REAL(r8)               ONE, ZERO</a>
  8734) <a name="l8734" style="background-color: #ffcccc">      PARAMETER          ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
  8735) <a name="l8735" style="background-color: #ffcccc">!     ..</a>
  8736) <a name="l8736" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  8737) <a name="l8737" style="background-color: #ffcccc">      LOGICAL            FIRST, LRND</a>
  8738) <a name="l8738" style="background-color: #ffcccc">      INTEGER            BETA, IMAX, IMIN, IT</a>
  8739) <a name="l8739" style="background-color: #ffcccc">      REAL(r8)               BASE, EMAX, EMIN, EPS, PREC, RMACH, RMAX, RMIN, &amp;</a>
  8740) <a name="l8740" style="background-color: #ffcccc">                         RND, SFMIN, SMALL, T</a>
  8741) <a name="l8741" style="background-color: #ffcccc">!     ..</a>
  8742) <a name="l8742" style="background-color: #ffcccc">!     .. Save statement ..</a>
  8743) <a name="l8743" style="background-color: #ffcccc">      SAVE               FIRST, EPS, SFMIN, BASE, T, RND, EMIN, RMIN, &amp;</a>
  8744) <a name="l8744" style="background-color: #ffcccc">                         EMAX, RMAX, PREC</a>
  8745) <a name="l8745" style="background-color: #ffcccc">!     ..</a>
  8746) <a name="l8746" style="background-color: #ffcccc">!     .. Data statements ..</a>
  8747) <a name="l8747" style="background-color: #ffcccc">      DATA               FIRST / .TRUE. /</a>
  8748) <a name="l8748" style="background-color: #ffcccc">!     ..</a>
  8749) <a name="l8749" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  8750) <a name="l8750" style="background-color: #ffcccc">!</a>
  8751) <a name="l8751" style="background-color: #ffcccc">      IF( FIRST ) THEN</a>
  8752) <a name="l8752" style="background-color: #ffcccc">         FIRST = .FALSE.</a>
  8753) <a name="l8753" style="background-color: #ffcccc">         CALL SLAMC2( BETA, IT, LRND, EPS, IMIN, RMIN, IMAX, RMAX )</a>
  8754) <a name="l8754" style="background-color: #ffcccc">         BASE = BETA</a>
  8755) <a name="l8755" style="background-color: #ffcccc">         T = IT</a>
  8756) <a name="l8756" style="background-color: #ffcccc">         IF( LRND ) THEN</a>
  8757) <a name="l8757" style="background-color: #ffcccc">            RND = ONE</a>
  8758) <a name="l8758" style="background-color: #ffcccc">            EPS = ( BASE**( 1-IT ) ) / 2</a>
  8759) <a name="l8759" style="background-color: #ffcccc">         ELSE</a>
  8760) <a name="l8760" style="background-color: #ffcccc">            RND = ZERO</a>
  8761) <a name="l8761" style="background-color: #ffcccc">            EPS = BASE**( 1-IT )</a>
  8762) <a name="l8762" style="background-color: #ffcccc">         END IF</a>
  8763) <a name="l8763" style="background-color: #ffcccc">         PREC = EPS*BASE</a>
  8764) <a name="l8764" style="background-color: #ffcccc">         EMIN = IMIN</a>
  8765) <a name="l8765" style="background-color: #ffcccc">         EMAX = IMAX</a>
  8766) <a name="l8766" style="background-color: #ffcccc">         SFMIN = RMIN</a>
  8767) <a name="l8767" style="background-color: #ffcccc">         SMALL = ONE / RMAX</a>
  8768) <a name="l8768" style="background-color: #ffcccc">         IF( SMALL.GE.SFMIN ) THEN</a>
  8769) <a name="l8769" style="background-color: #ffcccc">!</a>
  8770) <a name="l8770" style="background-color: #ffcccc">!           Use SMALL plus a bit, to avoid the possibility of rounding</a>
  8771) <a name="l8771" style="background-color: #ffcccc">!           causing overflow when computing  1/sfmin.</a>
  8772) <a name="l8772" style="background-color: #ffcccc">!</a>
  8773) <a name="l8773" style="background-color: #ffcccc">            SFMIN = SMALL*( ONE+EPS )</a>
  8774) <a name="l8774" style="background-color: #ffcccc">         END IF</a>
  8775) <a name="l8775" style="background-color: #ffcccc">      END IF</a>
  8776) <a name="l8776" style="background-color: #ffcccc">!</a>
  8777) <a name="l8777" style="background-color: #ffcccc">      IF( LSAME( CMACH, 'E' ) ) THEN</a>
  8778) <a name="l8778" style="background-color: #ffcccc">         RMACH = EPS</a>
  8779) <a name="l8779" style="background-color: #ffcccc">      ELSE IF( LSAME( CMACH, 'S' ) ) THEN</a>
  8780) <a name="l8780" style="background-color: #ffcccc">         RMACH = SFMIN</a>
  8781) <a name="l8781" style="background-color: #ffcccc">      ELSE IF( LSAME( CMACH, 'B' ) ) THEN</a>
  8782) <a name="l8782" style="background-color: #ffcccc">         RMACH = BASE</a>
  8783) <a name="l8783" style="background-color: #ffcccc">      ELSE IF( LSAME( CMACH, 'P' ) ) THEN</a>
  8784) <a name="l8784" style="background-color: #ffcccc">         RMACH = PREC</a>
  8785) <a name="l8785" style="background-color: #ffcccc">      ELSE IF( LSAME( CMACH, 'N' ) ) THEN</a>
  8786) <a name="l8786" style="background-color: #ffcccc">         RMACH = T</a>
  8787) <a name="l8787" style="background-color: #ffcccc">      ELSE IF( LSAME( CMACH, 'R' ) ) THEN</a>
  8788) <a name="l8788" style="background-color: #ffcccc">         RMACH = RND</a>
  8789) <a name="l8789" style="background-color: #ffcccc">      ELSE IF( LSAME( CMACH, 'M' ) ) THEN</a>
  8790) <a name="l8790" style="background-color: #ffcccc">         RMACH = EMIN</a>
  8791) <a name="l8791" style="background-color: #ffcccc">      ELSE IF( LSAME( CMACH, 'U' ) ) THEN</a>
  8792) <a name="l8792" style="background-color: #ffcccc">         RMACH = RMIN</a>
  8793) <a name="l8793" style="background-color: #ffcccc">      ELSE IF( LSAME( CMACH, 'L' ) ) THEN</a>
  8794) <a name="l8794" style="background-color: #ffcccc">         RMACH = EMAX</a>
  8795) <a name="l8795" style="background-color: #ffcccc">      ELSE IF( LSAME( CMACH, 'O' ) ) THEN</a>
  8796) <a name="l8796" style="background-color: #ffcccc">         RMACH = RMAX</a>
  8797) <a name="l8797" style="background-color: #ffcccc">      END IF</a>
  8798) <a name="l8798" style="background-color: #ffcccc">!</a>
  8799) <a name="l8799" style="background-color: #ffcccc">      SLAMCH = RMACH</a>
  8800) <a name="l8800" style="background-color: #ffcccc">      RETURN</a>
  8801) <a name="l8801" style="background-color: #ffcccc">!</a>
  8802) <a name="l8802" style="background-color: #ffcccc">!     End of SLAMCH</a>
  8803) <a name="l8803" style="background-color: #ffcccc">!</a>
  8804) <a name="l8804" style="background-color: #ffcccc">      END FUNCTION SLAMCH</a>
  8805) <a name="l8805" style="background-color: #ffffff">!</a>
  8806) <a name="l8806" style="background-color: #ffffff">!***********************************************************************</a>
  8807) <a name="l8807" style="background-color: #ffffff">!</a>
  8808) <a name="l8808" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLAMC1( BETA, T, RND, IEEE1 )</a>
  8809) <a name="l8809" style="background-color: #ffcccc"></a>
  8810) <a name="l8810" style="background-color: #ffcccc">!</a>
  8811) <a name="l8811" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  8812) <a name="l8812" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  8813) <a name="l8813" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  8814) <a name="l8814" style="background-color: #ffcccc">!     October 31, 1992</a>
  8815) <a name="l8815" style="background-color: #ffcccc">!</a>
  8816) <a name="l8816" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  8817) <a name="l8817" style="background-color: #ffcccc">      LOGICAL            IEEE1, RND</a>
  8818) <a name="l8818" style="background-color: #ffcccc">      INTEGER            BETA, T</a>
  8819) <a name="l8819" style="background-color: #ffcccc">!     ..</a>
  8820) <a name="l8820" style="background-color: #ffcccc">!</a>
  8821) <a name="l8821" style="background-color: #ffcccc">!  Purpose</a>
  8822) <a name="l8822" style="background-color: #ffcccc">!  =======</a>
  8823) <a name="l8823" style="background-color: #ffcccc">!</a>
  8824) <a name="l8824" style="background-color: #ffcccc">!  SLAMC1 determines the machine parameters given by BETA, T, RND, and</a>
  8825) <a name="l8825" style="background-color: #ffcccc">!  IEEE1.</a>
  8826) <a name="l8826" style="background-color: #ffcccc">!</a>
  8827) <a name="l8827" style="background-color: #ffcccc">!  Arguments</a>
  8828) <a name="l8828" style="background-color: #ffcccc">!  =========</a>
  8829) <a name="l8829" style="background-color: #ffcccc">!</a>
  8830) <a name="l8830" style="background-color: #ffcccc">!  BETA    (output) INTEGER</a>
  8831) <a name="l8831" style="background-color: #ffcccc">!          The base of the machine.</a>
  8832) <a name="l8832" style="background-color: #ffcccc">!</a>
  8833) <a name="l8833" style="background-color: #ffcccc">!  T       (output) INTEGER</a>
  8834) <a name="l8834" style="background-color: #ffcccc">!          The number of ( BETA ) digits in the mantissa.</a>
  8835) <a name="l8835" style="background-color: #ffcccc">!</a>
  8836) <a name="l8836" style="background-color: #ffcccc">!  RND     (output) LOGICAL</a>
  8837) <a name="l8837" style="background-color: #ffcccc">!          Specifies whether proper rounding  ( RND = .TRUE. )  or</a>
  8838) <a name="l8838" style="background-color: #ffcccc">!          chopping  ( RND = .FALSE. )  occurs in addition. This may not</a>
  8839) <a name="l8839" style="background-color: #ffcccc">!          be a reliable guide to the way in which the machine performs</a>
  8840) <a name="l8840" style="background-color: #ffcccc">!          its arithmetic.</a>
  8841) <a name="l8841" style="background-color: #ffcccc">!</a>
  8842) <a name="l8842" style="background-color: #ffcccc">!  IEEE1   (output) LOGICAL</a>
  8843) <a name="l8843" style="background-color: #ffcccc">!          Specifies whether rounding appears to be done in the IEEE</a>
  8844) <a name="l8844" style="background-color: #ffcccc">!          'round to nearest' style.</a>
  8845) <a name="l8845" style="background-color: #ffcccc">!</a>
  8846) <a name="l8846" style="background-color: #ffcccc">!  Further Details</a>
  8847) <a name="l8847" style="background-color: #ffcccc">!  ===============</a>
  8848) <a name="l8848" style="background-color: #ffcccc">!</a>
  8849) <a name="l8849" style="background-color: #ffcccc">!  The routine is based on the routine  ENVRON  by Malcolm and</a>
  8850) <a name="l8850" style="background-color: #ffcccc">!  incorporates suggestions by Gentleman and Marovich. See</a>
  8851) <a name="l8851" style="background-color: #ffcccc">!</a>
  8852) <a name="l8852" style="background-color: #ffcccc">!     Malcolm M. A. (1972) Algorithms to reveal properties of</a>
  8853) <a name="l8853" style="background-color: #ffcccc">!        floating-point arithmetic. Comms. of the ACM, 15, 949-951.</a>
  8854) <a name="l8854" style="background-color: #ffcccc">!</a>
  8855) <a name="l8855" style="background-color: #ffcccc">!     Gentleman W. M. and Marovich S. B. (1974) More on algorithms</a>
  8856) <a name="l8856" style="background-color: #ffcccc">!        that reveal properties of floating point arithmetic units.</a>
  8857) <a name="l8857" style="background-color: #ffcccc">!        Comms. of the ACM, 17, 276-277.</a>
  8858) <a name="l8858" style="background-color: #ffcccc">!</a>
  8859) <a name="l8859" style="background-color: #ffcccc">! =====================================================================</a>
  8860) <a name="l8860" style="background-color: #ffcccc">!</a>
  8861) <a name="l8861" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  8862) <a name="l8862" style="background-color: #ffcccc">      LOGICAL            FIRST, LIEEE1, LRND</a>
  8863) <a name="l8863" style="background-color: #ffcccc">      INTEGER            LBETA, LT</a>
  8864) <a name="l8864" style="background-color: #ffcccc">      REAL(r8)               A, B, C, F, ONE, QTR, SAVEC, T1, T2</a>
  8865) <a name="l8865" style="background-color: #ffcccc">!     ..</a>
  8866) <a name="l8866" style="background-color: #ffcccc">!     .. Save statement ..</a>
  8867) <a name="l8867" style="background-color: #ffcccc">      SAVE               FIRST, LIEEE1, LBETA, LRND, LT</a>
  8868) <a name="l8868" style="background-color: #ffcccc">!     ..</a>
  8869) <a name="l8869" style="background-color: #ffcccc">!     .. Data statements ..</a>
  8870) <a name="l8870" style="background-color: #ffcccc">      DATA               FIRST / .TRUE. /</a>
  8871) <a name="l8871" style="background-color: #ffcccc">!     ..</a>
  8872) <a name="l8872" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  8873) <a name="l8873" style="background-color: #ffcccc">!</a>
  8874) <a name="l8874" style="background-color: #ffcccc">      IF( FIRST ) THEN</a>
  8875) <a name="l8875" style="background-color: #ffcccc">         FIRST = .FALSE.</a>
  8876) <a name="l8876" style="background-color: #ffcccc">         ONE = 1</a>
  8877) <a name="l8877" style="background-color: #ffcccc">!</a>
  8878) <a name="l8878" style="background-color: #ffcccc">!        LBETA,  LIEEE1,  LT and  LRND  are the  local values  of  BETA,</a>
  8879) <a name="l8879" style="background-color: #ffcccc">!        IEEE1, T and RND.</a>
  8880) <a name="l8880" style="background-color: #ffcccc">!</a>
  8881) <a name="l8881" style="background-color: #ffcccc">!        Throughout this routine  we use the function  SLAMC3  to ensure</a>
  8882) <a name="l8882" style="background-color: #ffcccc">!        that relevant values are  stored and not held in registers,  or</a>
  8883) <a name="l8883" style="background-color: #ffcccc">!        are not affected by optimizers.</a>
  8884) <a name="l8884" style="background-color: #ffcccc">!</a>
  8885) <a name="l8885" style="background-color: #ffcccc">!        Compute  a = 2.0**m  with the  smallest positive integer m such</a>
  8886) <a name="l8886" style="background-color: #ffcccc">!        that</a>
  8887) <a name="l8887" style="background-color: #ffcccc">!</a>
  8888) <a name="l8888" style="background-color: #ffcccc">!           fl( a + 1.0 ) = a.</a>
  8889) <a name="l8889" style="background-color: #ffcccc">!</a>
  8890) <a name="l8890" style="background-color: #ffcccc">         A = 1</a>
  8891) <a name="l8891" style="background-color: #ffcccc">         C = 1</a>
  8892) <a name="l8892" style="background-color: #ffcccc">!</a>
  8893) <a name="l8893" style="background-color: #ffcccc">!+       WHILE( C.EQ.ONE )LOOP</a>
  8894) <a name="l8894" style="background-color: #ffcccc">   10    CONTINUE</a>
  8895) <a name="l8895" style="background-color: #ffcccc">         IF( C.EQ.ONE ) THEN</a>
  8896) <a name="l8896" style="background-color: #ffcccc">            A = 2*A</a>
  8897) <a name="l8897" style="background-color: #ffcccc">            C = SLAMC3( A, ONE )</a>
  8898) <a name="l8898" style="background-color: #ffcccc">            C = SLAMC3( C, -A )</a>
  8899) <a name="l8899" style="background-color: #ffcccc">            GO TO 10</a>
  8900) <a name="l8900" style="background-color: #ffcccc">         END IF</a>
  8901) <a name="l8901" style="background-color: #ffcccc">!+       END WHILE</a>
  8902) <a name="l8902" style="background-color: #ffcccc">!</a>
  8903) <a name="l8903" style="background-color: #ffcccc">!        Now compute  b = 2.0**m  with the smallest positive integer m</a>
  8904) <a name="l8904" style="background-color: #ffcccc">!        such that</a>
  8905) <a name="l8905" style="background-color: #ffcccc">!</a>
  8906) <a name="l8906" style="background-color: #ffcccc">!           fl( a + b ) .gt. a.</a>
  8907) <a name="l8907" style="background-color: #ffcccc">!</a>
  8908) <a name="l8908" style="background-color: #ffcccc">         B = 1</a>
  8909) <a name="l8909" style="background-color: #ffcccc">         C = SLAMC3( A, B )</a>
  8910) <a name="l8910" style="background-color: #ffcccc">!</a>
  8911) <a name="l8911" style="background-color: #ffcccc">!+       WHILE( C.EQ.A )LOOP</a>
  8912) <a name="l8912" style="background-color: #ffcccc">   20    CONTINUE</a>
  8913) <a name="l8913" style="background-color: #ffcccc">         IF( C.EQ.A ) THEN</a>
  8914) <a name="l8914" style="background-color: #ffcccc">            B = 2*B</a>
  8915) <a name="l8915" style="background-color: #ffcccc">            C = SLAMC3( A, B )</a>
  8916) <a name="l8916" style="background-color: #ffcccc">            GO TO 20</a>
  8917) <a name="l8917" style="background-color: #ffcccc">         END IF</a>
  8918) <a name="l8918" style="background-color: #ffcccc">!+       END WHILE</a>
  8919) <a name="l8919" style="background-color: #ffcccc">!</a>
  8920) <a name="l8920" style="background-color: #ffcccc">!        Now compute the base.  a and c  are neighbouring floating point</a>
  8921) <a name="l8921" style="background-color: #ffcccc">!        numbers  in the  interval  ( beta**t, beta**( t + 1 ) )  and so</a>
  8922) <a name="l8922" style="background-color: #ffcccc">!        their difference is beta. Adding 0.25 to c is to ensure that it</a>
  8923) <a name="l8923" style="background-color: #ffcccc">!        is truncated to beta and not ( beta - 1 ).</a>
  8924) <a name="l8924" style="background-color: #ffcccc">!</a>
  8925) <a name="l8925" style="background-color: #ffcccc">         QTR = ONE / 4</a>
  8926) <a name="l8926" style="background-color: #ffcccc">         SAVEC = C</a>
  8927) <a name="l8927" style="background-color: #ffcccc">         C = SLAMC3( C, -A )</a>
  8928) <a name="l8928" style="background-color: #ffcccc">         LBETA = C + QTR</a>
  8929) <a name="l8929" style="background-color: #ffcccc">!</a>
  8930) <a name="l8930" style="background-color: #ffcccc">!        Now determine whether rounding or chopping occurs,  by adding a</a>
  8931) <a name="l8931" style="background-color: #ffcccc">!        bit  less  than  beta/2  and a  bit  more  than  beta/2  to  a.</a>
  8932) <a name="l8932" style="background-color: #ffcccc">!</a>
  8933) <a name="l8933" style="background-color: #ffcccc">         B = LBETA</a>
  8934) <a name="l8934" style="background-color: #ffcccc">         F = SLAMC3( B / 2, -B / 100 )</a>
  8935) <a name="l8935" style="background-color: #ffcccc">         C = SLAMC3( F, A )</a>
  8936) <a name="l8936" style="background-color: #ffcccc">         IF( C.EQ.A ) THEN</a>
  8937) <a name="l8937" style="background-color: #ffcccc">            LRND = .TRUE.</a>
  8938) <a name="l8938" style="background-color: #ffcccc">         ELSE</a>
  8939) <a name="l8939" style="background-color: #ffcccc">            LRND = .FALSE.</a>
  8940) <a name="l8940" style="background-color: #ffcccc">         END IF</a>
  8941) <a name="l8941" style="background-color: #ffcccc">         F = SLAMC3( B / 2, B / 100 )</a>
  8942) <a name="l8942" style="background-color: #ffcccc">         C = SLAMC3( F, A )</a>
  8943) <a name="l8943" style="background-color: #ffcccc">         IF( ( LRND ) .AND. ( C.EQ.A ) ) &amp;</a>
  8944) <a name="l8944" style="background-color: #ffcccc">            LRND = .FALSE.</a>
  8945) <a name="l8945" style="background-color: #ffcccc">!</a>
  8946) <a name="l8946" style="background-color: #ffcccc">!        Try and decide whether rounding is done in the  IEEE  'round to</a>
  8947) <a name="l8947" style="background-color: #ffcccc">!        nearest' style. B/2 is half a unit in the last place of the two</a>
  8948) <a name="l8948" style="background-color: #ffcccc">!        numbers A and SAVEC. Furthermore, A is even, i.e. has last  bit</a>
  8949) <a name="l8949" style="background-color: #ffcccc">!        zero, and SAVEC is odd. Thus adding B/2 to A should not  change</a>
  8950) <a name="l8950" style="background-color: #ffcccc">!        A, but adding B/2 to SAVEC should change SAVEC.</a>
  8951) <a name="l8951" style="background-color: #ffcccc">!</a>
  8952) <a name="l8952" style="background-color: #ffcccc">         T1 = SLAMC3( B / 2, A )</a>
  8953) <a name="l8953" style="background-color: #ffcccc">         T2 = SLAMC3( B / 2, SAVEC )</a>
  8954) <a name="l8954" style="background-color: #ffcccc">         LIEEE1 = ( T1.EQ.A ) .AND. ( T2.GT.SAVEC ) .AND. LRND</a>
  8955) <a name="l8955" style="background-color: #ffcccc">!</a>
  8956) <a name="l8956" style="background-color: #ffcccc">!        Now find  the  mantissa, t.  It should  be the  integer part of</a>
  8957) <a name="l8957" style="background-color: #ffcccc">!        log to the base beta of a,  however it is safer to determine  t</a>
  8958) <a name="l8958" style="background-color: #ffcccc">!        by powering.  So we find t as the smallest positive integer for</a>
  8959) <a name="l8959" style="background-color: #ffcccc">!        which</a>
  8960) <a name="l8960" style="background-color: #ffcccc">!</a>
  8961) <a name="l8961" style="background-color: #ffcccc">!           fl( beta**t + 1.0 ) = 1.0.</a>
  8962) <a name="l8962" style="background-color: #ffcccc">!</a>
  8963) <a name="l8963" style="background-color: #ffcccc">         LT = 0</a>
  8964) <a name="l8964" style="background-color: #ffcccc">         A = 1</a>
  8965) <a name="l8965" style="background-color: #ffcccc">         C = 1</a>
  8966) <a name="l8966" style="background-color: #ffcccc">!</a>
  8967) <a name="l8967" style="background-color: #ffcccc">!+       WHILE( C.EQ.ONE )LOOP</a>
  8968) <a name="l8968" style="background-color: #ffcccc">   30    CONTINUE</a>
  8969) <a name="l8969" style="background-color: #ffcccc">         IF( C.EQ.ONE ) THEN</a>
  8970) <a name="l8970" style="background-color: #ffcccc">            LT = LT + 1</a>
  8971) <a name="l8971" style="background-color: #ffcccc">            A = A*LBETA</a>
  8972) <a name="l8972" style="background-color: #ffcccc">            C = SLAMC3( A, ONE )</a>
  8973) <a name="l8973" style="background-color: #ffcccc">            C = SLAMC3( C, -A )</a>
  8974) <a name="l8974" style="background-color: #ffcccc">            GO TO 30</a>
  8975) <a name="l8975" style="background-color: #ffcccc">         END IF</a>
  8976) <a name="l8976" style="background-color: #ffcccc">!+       END WHILE</a>
  8977) <a name="l8977" style="background-color: #ffcccc">!</a>
  8978) <a name="l8978" style="background-color: #ffcccc">      END IF</a>
  8979) <a name="l8979" style="background-color: #ffcccc">!</a>
  8980) <a name="l8980" style="background-color: #ffcccc">      BETA = LBETA</a>
  8981) <a name="l8981" style="background-color: #ffcccc">      T = LT</a>
  8982) <a name="l8982" style="background-color: #ffcccc">      RND = LRND</a>
  8983) <a name="l8983" style="background-color: #ffcccc">      IEEE1 = LIEEE1</a>
  8984) <a name="l8984" style="background-color: #ffcccc">      RETURN</a>
  8985) <a name="l8985" style="background-color: #ffcccc">!</a>
  8986) <a name="l8986" style="background-color: #ffcccc">!     End of SLAMC1</a>
  8987) <a name="l8987" style="background-color: #ffcccc">!</a>
  8988) <a name="l8988" style="background-color: #ffcccc">      END SUBROUTINE SLAMC1</a>
  8989) <a name="l8989" style="background-color: #ffffff">!</a>
  8990) <a name="l8990" style="background-color: #ffffff">!***********************************************************************</a>
  8991) <a name="l8991" style="background-color: #ffffff">!</a>
  8992) <a name="l8992" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLAMC2( BETA, T, RND, EPS, EMIN, RMIN, EMAX, RMAX )</a>
  8993) <a name="l8993" style="background-color: #ffcccc"></a>
  8994) <a name="l8994" style="background-color: #ffcccc">!</a>
  8995) <a name="l8995" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  8996) <a name="l8996" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  8997) <a name="l8997" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  8998) <a name="l8998" style="background-color: #ffcccc">!     October 31, 1992</a>
  8999) <a name="l8999" style="background-color: #ffcccc">!</a>
  9000) <a name="l9000" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  9001) <a name="l9001" style="background-color: #ffcccc">      LOGICAL            RND</a>
  9002) <a name="l9002" style="background-color: #ffcccc">      INTEGER            BETA, EMAX, EMIN, T</a>
  9003) <a name="l9003" style="background-color: #ffcccc">      REAL(r8)               EPS, RMAX, RMIN</a>
  9004) <a name="l9004" style="background-color: #ffcccc">!     ..</a>
  9005) <a name="l9005" style="background-color: #ffcccc">!</a>
  9006) <a name="l9006" style="background-color: #ffcccc">!  Purpose</a>
  9007) <a name="l9007" style="background-color: #ffcccc">!  =======</a>
  9008) <a name="l9008" style="background-color: #ffcccc">!</a>
  9009) <a name="l9009" style="background-color: #ffcccc">!  SLAMC2 determines the machine parameters specified in its argument</a>
  9010) <a name="l9010" style="background-color: #ffcccc">!  list.</a>
  9011) <a name="l9011" style="background-color: #ffcccc">!</a>
  9012) <a name="l9012" style="background-color: #ffcccc">!  Arguments</a>
  9013) <a name="l9013" style="background-color: #ffcccc">!  =========</a>
  9014) <a name="l9014" style="background-color: #ffcccc">!</a>
  9015) <a name="l9015" style="background-color: #ffcccc">!  BETA    (output) INTEGER</a>
  9016) <a name="l9016" style="background-color: #ffcccc">!          The base of the machine.</a>
  9017) <a name="l9017" style="background-color: #ffcccc">!</a>
  9018) <a name="l9018" style="background-color: #ffcccc">!  T       (output) INTEGER</a>
  9019) <a name="l9019" style="background-color: #ffcccc">!          The number of ( BETA ) digits in the mantissa.</a>
  9020) <a name="l9020" style="background-color: #ffcccc">!</a>
  9021) <a name="l9021" style="background-color: #ffcccc">!  RND     (output) LOGICAL</a>
  9022) <a name="l9022" style="background-color: #ffcccc">!          Specifies whether proper rounding  ( RND = .TRUE. )  or</a>
  9023) <a name="l9023" style="background-color: #ffcccc">!          chopping  ( RND = .FALSE. )  occurs in addition. This may not</a>
  9024) <a name="l9024" style="background-color: #ffcccc">!          be a reliable guide to the way in which the machine performs</a>
  9025) <a name="l9025" style="background-color: #ffcccc">!          its arithmetic.</a>
  9026) <a name="l9026" style="background-color: #ffcccc">!</a>
  9027) <a name="l9027" style="background-color: #ffcccc">!  EPS     (output) REAL</a>
  9028) <a name="l9028" style="background-color: #ffcccc">!          The smallest positive number such that</a>
  9029) <a name="l9029" style="background-color: #ffcccc">!</a>
  9030) <a name="l9030" style="background-color: #ffcccc">!             fl( 1.0 - EPS ) .LT. 1.0,</a>
  9031) <a name="l9031" style="background-color: #ffcccc">!</a>
  9032) <a name="l9032" style="background-color: #ffcccc">!          where fl denotes the computed value.</a>
  9033) <a name="l9033" style="background-color: #ffcccc">!</a>
  9034) <a name="l9034" style="background-color: #ffcccc">!  EMIN    (output) INTEGER</a>
  9035) <a name="l9035" style="background-color: #ffcccc">!          The minimum exponent before (gradual) underflow occurs.</a>
  9036) <a name="l9036" style="background-color: #ffcccc">!</a>
  9037) <a name="l9037" style="background-color: #ffcccc">!  RMIN    (output) REAL</a>
  9038) <a name="l9038" style="background-color: #ffcccc">!          The smallest normalized number for the machine, given by</a>
  9039) <a name="l9039" style="background-color: #ffcccc">!          BASE**( EMIN - 1 ), where  BASE  is the floating point value</a>
  9040) <a name="l9040" style="background-color: #ffcccc">!          of BETA.</a>
  9041) <a name="l9041" style="background-color: #ffcccc">!</a>
  9042) <a name="l9042" style="background-color: #ffcccc">!  EMAX    (output) INTEGER</a>
  9043) <a name="l9043" style="background-color: #ffcccc">!          The maximum exponent before overflow occurs.</a>
  9044) <a name="l9044" style="background-color: #ffcccc">!</a>
  9045) <a name="l9045" style="background-color: #ffcccc">!  RMAX    (output) REAL</a>
  9046) <a name="l9046" style="background-color: #ffcccc">!          The largest positive number for the machine, given by</a>
  9047) <a name="l9047" style="background-color: #ffcccc">!          BASE**EMAX * ( 1 - EPS ), where  BASE  is the floating point</a>
  9048) <a name="l9048" style="background-color: #ffcccc">!          value of BETA.</a>
  9049) <a name="l9049" style="background-color: #ffcccc">!</a>
  9050) <a name="l9050" style="background-color: #ffcccc">!  Further Details</a>
  9051) <a name="l9051" style="background-color: #ffcccc">!  ===============</a>
  9052) <a name="l9052" style="background-color: #ffcccc">!</a>
  9053) <a name="l9053" style="background-color: #ffcccc">!  The computation of  EPS  is based on a routine PARANOIA by</a>
  9054) <a name="l9054" style="background-color: #ffcccc">!  W. Kahan of the University of California at Berkeley.</a>
  9055) <a name="l9055" style="background-color: #ffcccc">!</a>
  9056) <a name="l9056" style="background-color: #ffcccc">! =====================================================================</a>
  9057) <a name="l9057" style="background-color: #ffcccc">!</a>
  9058) <a name="l9058" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  9059) <a name="l9059" style="background-color: #ffcccc">      LOGICAL            FIRST, IEEE, IWARN, LIEEE1, LRND</a>
  9060) <a name="l9060" style="background-color: #ffcccc">      INTEGER            GNMIN, GPMIN, I, LBETA, LEMAX, LEMIN, LT, &amp;</a>
  9061) <a name="l9061" style="background-color: #ffcccc">                         NGNMIN, NGPMIN</a>
  9062) <a name="l9062" style="background-color: #ffcccc">      REAL(r8)               A, B, C, HALF, LEPS, LRMAX, LRMIN, ONE, RBASE, &amp;</a>
  9063) <a name="l9063" style="background-color: #ffcccc">                         SIXTH, SMALL, THIRD, TWO, ZERO</a>
  9064) <a name="l9064" style="background-color: #ffcccc">!     ..</a>
  9065) <a name="l9065" style="background-color: #ffcccc">!     .. Save statement ..</a>
  9066) <a name="l9066" style="background-color: #ffcccc">      SAVE               FIRST, IWARN, LBETA, LEMAX, LEMIN, LEPS, LRMAX, &amp;</a>
  9067) <a name="l9067" style="background-color: #ffcccc">                         LRMIN, LT</a>
  9068) <a name="l9068" style="background-color: #ffcccc">!     ..</a>
  9069) <a name="l9069" style="background-color: #ffcccc">!     .. Data statements ..</a>
  9070) <a name="l9070" style="background-color: #ffcccc">      DATA               FIRST / .TRUE. / , IWARN / .FALSE. /</a>
  9071) <a name="l9071" style="background-color: #ffcccc">!     ..</a>
  9072) <a name="l9072" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  9073) <a name="l9073" style="background-color: #ffcccc">!</a>
  9074) <a name="l9074" style="background-color: #ffcccc">      IF( FIRST ) THEN</a>
  9075) <a name="l9075" style="background-color: #ffcccc">         FIRST = .FALSE.</a>
  9076) <a name="l9076" style="background-color: #ffcccc">         ZERO = 0</a>
  9077) <a name="l9077" style="background-color: #ffcccc">         ONE = 1</a>
  9078) <a name="l9078" style="background-color: #ffcccc">         TWO = 2</a>
  9079) <a name="l9079" style="background-color: #ffcccc">!</a>
  9080) <a name="l9080" style="background-color: #ffcccc">!        LBETA, LT, LRND, LEPS, LEMIN and LRMIN  are the local values of</a>
  9081) <a name="l9081" style="background-color: #ffcccc">!        BETA, T, RND, EPS, EMIN and RMIN.</a>
  9082) <a name="l9082" style="background-color: #ffcccc">!</a>
  9083) <a name="l9083" style="background-color: #ffcccc">!        Throughout this routine  we use the function  SLAMC3  to ensure</a>
  9084) <a name="l9084" style="background-color: #ffcccc">!        that relevant values are stored  and not held in registers,  or</a>
  9085) <a name="l9085" style="background-color: #ffcccc">!        are not affected by optimizers.</a>
  9086) <a name="l9086" style="background-color: #ffcccc">!</a>
  9087) <a name="l9087" style="background-color: #ffcccc">!        SLAMC1 returns the parameters  LBETA, LT, LRND and LIEEE1.</a>
  9088) <a name="l9088" style="background-color: #ffcccc">!</a>
  9089) <a name="l9089" style="background-color: #ffcccc">         CALL SLAMC1( LBETA, LT, LRND, LIEEE1 )</a>
  9090) <a name="l9090" style="background-color: #ffcccc">!</a>
  9091) <a name="l9091" style="background-color: #ffcccc">!        Start to find EPS.</a>
  9092) <a name="l9092" style="background-color: #ffcccc">!</a>
  9093) <a name="l9093" style="background-color: #ffcccc">         B = LBETA</a>
  9094) <a name="l9094" style="background-color: #ffcccc">         A = B**( -LT )</a>
  9095) <a name="l9095" style="background-color: #ffcccc">         LEPS = A</a>
  9096) <a name="l9096" style="background-color: #ffcccc">!</a>
  9097) <a name="l9097" style="background-color: #ffcccc">!        Try some tricks to see whether or not this is the correct  EPS.</a>
  9098) <a name="l9098" style="background-color: #ffcccc">!</a>
  9099) <a name="l9099" style="background-color: #ffcccc">         B = TWO / 3</a>
  9100) <a name="l9100" style="background-color: #ffcccc">         HALF = ONE / 2</a>
  9101) <a name="l9101" style="background-color: #ffcccc">         SIXTH = SLAMC3( B, -HALF )</a>
  9102) <a name="l9102" style="background-color: #ffcccc">         THIRD = SLAMC3( SIXTH, SIXTH )</a>
  9103) <a name="l9103" style="background-color: #ffcccc">         B = SLAMC3( THIRD, -HALF )</a>
  9104) <a name="l9104" style="background-color: #ffcccc">         B = SLAMC3( B, SIXTH )</a>
  9105) <a name="l9105" style="background-color: #ffcccc">         B = ABS( B )</a>
  9106) <a name="l9106" style="background-color: #ffcccc">         IF( B.LT.LEPS ) &amp;</a>
  9107) <a name="l9107" style="background-color: #ffcccc">            B = LEPS</a>
  9108) <a name="l9108" style="background-color: #ffcccc">!</a>
  9109) <a name="l9109" style="background-color: #ffcccc">         LEPS = 1</a>
  9110) <a name="l9110" style="background-color: #ffcccc">!</a>
  9111) <a name="l9111" style="background-color: #ffcccc">!+       WHILE( ( LEPS.GT.B ).AND.( B.GT.ZERO ) )LOOP</a>
  9112) <a name="l9112" style="background-color: #ffcccc">   10    CONTINUE</a>
  9113) <a name="l9113" style="background-color: #ffcccc">         IF( ( LEPS.GT.B ) .AND. ( B.GT.ZERO ) ) THEN</a>
  9114) <a name="l9114" style="background-color: #ffcccc">            LEPS = B</a>
  9115) <a name="l9115" style="background-color: #ffcccc">            C = SLAMC3( HALF*LEPS, ( TWO**5 )*( LEPS**2 ) )</a>
  9116) <a name="l9116" style="background-color: #ffcccc">            C = SLAMC3( HALF, -C )</a>
  9117) <a name="l9117" style="background-color: #ffcccc">            B = SLAMC3( HALF, C )</a>
  9118) <a name="l9118" style="background-color: #ffcccc">            C = SLAMC3( HALF, -B )</a>
  9119) <a name="l9119" style="background-color: #ffcccc">            B = SLAMC3( HALF, C )</a>
  9120) <a name="l9120" style="background-color: #ffcccc">            GO TO 10</a>
  9121) <a name="l9121" style="background-color: #ffcccc">         END IF</a>
  9122) <a name="l9122" style="background-color: #ffcccc">!+       END WHILE</a>
  9123) <a name="l9123" style="background-color: #ffcccc">!</a>
  9124) <a name="l9124" style="background-color: #ffcccc">         IF( A.LT.LEPS ) &amp;</a>
  9125) <a name="l9125" style="background-color: #ffcccc">            LEPS = A</a>
  9126) <a name="l9126" style="background-color: #ffcccc">!</a>
  9127) <a name="l9127" style="background-color: #ffcccc">!        Computation of EPS complete.</a>
  9128) <a name="l9128" style="background-color: #ffcccc">!</a>
  9129) <a name="l9129" style="background-color: #ffcccc">!        Now find  EMIN.  Let A = + or - 1, and + or - (1 + BASE**(-3)).</a>
  9130) <a name="l9130" style="background-color: #ffcccc">!        Keep dividing  A by BETA until (gradual) underflow occurs. This</a>
  9131) <a name="l9131" style="background-color: #ffcccc">!        is detected when we cannot recover the previous A.</a>
  9132) <a name="l9132" style="background-color: #ffcccc">!</a>
  9133) <a name="l9133" style="background-color: #ffcccc">         RBASE = ONE / LBETA</a>
  9134) <a name="l9134" style="background-color: #ffcccc">         SMALL = ONE</a>
  9135) <a name="l9135" style="background-color: #ffcccc">         DO 20 I = 1, 3</a>
  9136) <a name="l9136" style="background-color: #ffcccc">            SMALL = SLAMC3( SMALL*RBASE, ZERO )</a>
  9137) <a name="l9137" style="background-color: #ffcccc">   20    CONTINUE</a>
  9138) <a name="l9138" style="background-color: #ffcccc">         A = SLAMC3( ONE, SMALL )</a>
  9139) <a name="l9139" style="background-color: #ffcccc">         CALL SLAMC4( NGPMIN, ONE, LBETA )</a>
  9140) <a name="l9140" style="background-color: #ffcccc">         CALL SLAMC4( NGNMIN, -ONE, LBETA )</a>
  9141) <a name="l9141" style="background-color: #ffcccc">         CALL SLAMC4( GPMIN, A, LBETA )</a>
  9142) <a name="l9142" style="background-color: #ffcccc">         CALL SLAMC4( GNMIN, -A, LBETA )</a>
  9143) <a name="l9143" style="background-color: #ffcccc">         IEEE = .FALSE.</a>
  9144) <a name="l9144" style="background-color: #ffcccc">!</a>
  9145) <a name="l9145" style="background-color: #ffcccc">         IF( ( NGPMIN.EQ.NGNMIN ) .AND. ( GPMIN.EQ.GNMIN ) ) THEN</a>
  9146) <a name="l9146" style="background-color: #ffcccc">            IF( NGPMIN.EQ.GPMIN ) THEN</a>
  9147) <a name="l9147" style="background-color: #ffcccc">               LEMIN = NGPMIN</a>
  9148) <a name="l9148" style="background-color: #ffcccc">!            ( Non twos-complement machines, no gradual underflow;</a>
  9149) <a name="l9149" style="background-color: #ffcccc">!              e.g.,  VAX )</a>
  9150) <a name="l9150" style="background-color: #ffcccc">            ELSE IF( ( GPMIN-NGPMIN ).EQ.3 ) THEN</a>
  9151) <a name="l9151" style="background-color: #ffcccc">               LEMIN = NGPMIN - 1 + LT</a>
  9152) <a name="l9152" style="background-color: #ffcccc">               IEEE = .TRUE.</a>
  9153) <a name="l9153" style="background-color: #ffcccc">!            ( Non twos-complement machines, with gradual underflow;</a>
  9154) <a name="l9154" style="background-color: #ffcccc">!              e.g., IEEE standard followers )</a>
  9155) <a name="l9155" style="background-color: #ffcccc">            ELSE</a>
  9156) <a name="l9156" style="background-color: #ffcccc">               LEMIN = MIN( NGPMIN, GPMIN )</a>
  9157) <a name="l9157" style="background-color: #ffcccc">!            ( A guess; no known machine )</a>
  9158) <a name="l9158" style="background-color: #ffcccc">               IWARN = .TRUE.</a>
  9159) <a name="l9159" style="background-color: #ffcccc">            END IF</a>
  9160) <a name="l9160" style="background-color: #ffcccc">!</a>
  9161) <a name="l9161" style="background-color: #ffcccc">         ELSE IF( ( NGPMIN.EQ.GPMIN ) .AND. ( NGNMIN.EQ.GNMIN ) ) THEN</a>
  9162) <a name="l9162" style="background-color: #ffcccc">            IF( ABS( NGPMIN-NGNMIN ).EQ.1 ) THEN</a>
  9163) <a name="l9163" style="background-color: #ffcccc">               LEMIN = MAX( NGPMIN, NGNMIN )</a>
  9164) <a name="l9164" style="background-color: #ffcccc">!            ( Twos-complement machines, no gradual underflow;</a>
  9165) <a name="l9165" style="background-color: #ffcccc">!              e.g., CYBER 205 )</a>
  9166) <a name="l9166" style="background-color: #ffcccc">            ELSE</a>
  9167) <a name="l9167" style="background-color: #ffcccc">               LEMIN = MIN( NGPMIN, NGNMIN )</a>
  9168) <a name="l9168" style="background-color: #ffcccc">!            ( A guess; no known machine )</a>
  9169) <a name="l9169" style="background-color: #ffcccc">               IWARN = .TRUE.</a>
  9170) <a name="l9170" style="background-color: #ffcccc">            END IF</a>
  9171) <a name="l9171" style="background-color: #ffcccc">!</a>
  9172) <a name="l9172" style="background-color: #ffcccc">         ELSE IF( ( ABS( NGPMIN-NGNMIN ).EQ.1 ) .AND. &amp;</a>
  9173) <a name="l9173" style="background-color: #ffcccc">                  ( GPMIN.EQ.GNMIN ) ) THEN</a>
  9174) <a name="l9174" style="background-color: #ffcccc">            IF( ( GPMIN-MIN( NGPMIN, NGNMIN ) ).EQ.3 ) THEN</a>
  9175) <a name="l9175" style="background-color: #ffcccc">               LEMIN = MAX( NGPMIN, NGNMIN ) - 1 + LT</a>
  9176) <a name="l9176" style="background-color: #ffcccc">!            ( Twos-complement machines with gradual underflow;</a>
  9177) <a name="l9177" style="background-color: #ffcccc">!              no known machine )</a>
  9178) <a name="l9178" style="background-color: #ffcccc">            ELSE</a>
  9179) <a name="l9179" style="background-color: #ffcccc">               LEMIN = MIN( NGPMIN, NGNMIN )</a>
  9180) <a name="l9180" style="background-color: #ffcccc">!            ( A guess; no known machine )</a>
  9181) <a name="l9181" style="background-color: #ffcccc">               IWARN = .TRUE.</a>
  9182) <a name="l9182" style="background-color: #ffcccc">            END IF</a>
  9183) <a name="l9183" style="background-color: #ffcccc">!</a>
  9184) <a name="l9184" style="background-color: #ffcccc">         ELSE</a>
  9185) <a name="l9185" style="background-color: #ffcccc">            LEMIN = MIN( NGPMIN, NGNMIN, GPMIN, GNMIN )</a>
  9186) <a name="l9186" style="background-color: #ffcccc">!         ( A guess; no known machine )</a>
  9187) <a name="l9187" style="background-color: #ffcccc">            IWARN = .TRUE.</a>
  9188) <a name="l9188" style="background-color: #ffcccc">         END IF</a>
  9189) <a name="l9189" style="background-color: #ffcccc">!**</a>
  9190) <a name="l9190" style="background-color: #ffcccc">! Comment out this if block if EMIN is ok</a>
  9191) <a name="l9191" style="background-color: #ffcccc">         IF( IWARN ) THEN</a>
  9192) <a name="l9192" style="background-color: #ffcccc">            FIRST = .TRUE.</a>
  9193) <a name="l9193" style="background-color: #ffcccc">            write(iulog, FMT = 9999 )LEMIN</a>
  9194) <a name="l9194" style="background-color: #ffcccc">         END IF</a>
  9195) <a name="l9195" style="background-color: #ffcccc">!**</a>
  9196) <a name="l9196" style="background-color: #ffcccc">!</a>
  9197) <a name="l9197" style="background-color: #ffcccc">!        Assume IEEE arithmetic if we found denormalised  numbers above,</a>
  9198) <a name="l9198" style="background-color: #ffcccc">!        or if arithmetic seems to round in the  IEEE style,  determined</a>
  9199) <a name="l9199" style="background-color: #ffcccc">!        in routine SLAMC1. A true IEEE machine should have both  things</a>
  9200) <a name="l9200" style="background-color: #ffcccc">!        true; however, faulty machines may have one or the other.</a>
  9201) <a name="l9201" style="background-color: #ffcccc">!</a>
  9202) <a name="l9202" style="background-color: #ffcccc">         IEEE = IEEE .OR. LIEEE1</a>
  9203) <a name="l9203" style="background-color: #ffcccc">!</a>
  9204) <a name="l9204" style="background-color: #ffcccc">!        Compute  RMIN by successive division by  BETA. We could compute</a>
  9205) <a name="l9205" style="background-color: #ffcccc">!        RMIN as BASE**( EMIN - 1 ),  but some machines underflow during</a>
  9206) <a name="l9206" style="background-color: #ffcccc">!        this computation.</a>
  9207) <a name="l9207" style="background-color: #ffcccc">!</a>
  9208) <a name="l9208" style="background-color: #ffcccc">         LRMIN = 1</a>
  9209) <a name="l9209" style="background-color: #ffcccc">         DO 30 I = 1, 1 - LEMIN</a>
  9210) <a name="l9210" style="background-color: #ffcccc">            LRMIN = SLAMC3( LRMIN*RBASE, ZERO )</a>
  9211) <a name="l9211" style="background-color: #ffcccc">   30    CONTINUE</a>
  9212) <a name="l9212" style="background-color: #ffcccc">!</a>
  9213) <a name="l9213" style="background-color: #ffcccc">!        Finally, call SLAMC5 to compute EMAX and RMAX.</a>
  9214) <a name="l9214" style="background-color: #ffcccc">!</a>
  9215) <a name="l9215" style="background-color: #ffcccc">         CALL SLAMC5( LBETA, LT, LEMIN, IEEE, LEMAX, LRMAX )</a>
  9216) <a name="l9216" style="background-color: #ffcccc">      END IF</a>
  9217) <a name="l9217" style="background-color: #ffcccc">!</a>
  9218) <a name="l9218" style="background-color: #ffcccc">      BETA = LBETA</a>
  9219) <a name="l9219" style="background-color: #ffcccc">      T = LT</a>
  9220) <a name="l9220" style="background-color: #ffcccc">      RND = LRND</a>
  9221) <a name="l9221" style="background-color: #ffcccc">      EPS = LEPS</a>
  9222) <a name="l9222" style="background-color: #ffcccc">      EMIN = LEMIN</a>
  9223) <a name="l9223" style="background-color: #ffcccc">      RMIN = LRMIN</a>
  9224) <a name="l9224" style="background-color: #ffcccc">      EMAX = LEMAX</a>
  9225) <a name="l9225" style="background-color: #ffcccc">      RMAX = LRMAX</a>
  9226) <a name="l9226" style="background-color: #ffcccc">!</a>
  9227) <a name="l9227" style="background-color: #ffcccc">      RETURN</a>
  9228) <a name="l9228" style="background-color: #ffcccc">!</a>
  9229) <a name="l9229" style="background-color: #ffcccc"> 9999 FORMAT( / / ' WARNING. The value EMIN may be incorrect:-', &amp;</a>
  9230) <a name="l9230" style="background-color: #ffcccc">            '  EMIN = ', I8, / &amp;</a>
  9231) <a name="l9231" style="background-color: #ffcccc">            ' If, after inspection, the value EMIN looks', &amp;</a>
  9232) <a name="l9232" style="background-color: #ffcccc">            ' acceptable please comment out ', &amp;</a>
  9233) <a name="l9233" style="background-color: #ffcccc">            / ' the IF block as marked within the code of routine', &amp;</a>
  9234) <a name="l9234" style="background-color: #ffcccc">            ' SLAMC2,', / ' otherwise supply EMIN explicitly.', / )</a>
  9235) <a name="l9235" style="background-color: #ffcccc">!</a>
  9236) <a name="l9236" style="background-color: #ffcccc">!     End of SLAMC2</a>
  9237) <a name="l9237" style="background-color: #ffcccc">!</a>
  9238) <a name="l9238" style="background-color: #ffcccc">      END SUBROUTINE SLAMC2</a>
  9239) <a name="l9239" style="background-color: #ffffff">!</a>
  9240) <a name="l9240" style="background-color: #ffffff">!***********************************************************************</a>
  9241) <a name="l9241" style="background-color: #ffffff">!</a>
  9242) <a name="l9242" style="background-color: #ffffff">      FUNCTION </a><a style="background-color: #ffcccc">SLAMC3( A, B )</a>
  9243) <a name="l9243" style="background-color: #ffcccc"></a>
  9244) <a name="l9244" style="background-color: #ffcccc">      real(r8) slamc3</a>
  9245) <a name="l9245" style="background-color: #ffcccc"></a>
  9246) <a name="l9246" style="background-color: #ffcccc">!</a>
  9247) <a name="l9247" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  9248) <a name="l9248" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  9249) <a name="l9249" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  9250) <a name="l9250" style="background-color: #ffcccc">!     October 31, 1992</a>
  9251) <a name="l9251" style="background-color: #ffcccc">!</a>
  9252) <a name="l9252" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  9253) <a name="l9253" style="background-color: #ffcccc">      REAL(r8)               A, B</a>
  9254) <a name="l9254" style="background-color: #ffcccc">!     ..</a>
  9255) <a name="l9255" style="background-color: #ffcccc">!</a>
  9256) <a name="l9256" style="background-color: #ffcccc">!  Purpose</a>
  9257) <a name="l9257" style="background-color: #ffcccc">!  =======</a>
  9258) <a name="l9258" style="background-color: #ffcccc">!</a>
  9259) <a name="l9259" style="background-color: #ffcccc">!  SLAMC3  is intended to force  A  and  B  to be stored prior to doing</a>
  9260) <a name="l9260" style="background-color: #ffcccc">!  the addition of  A  and  B ,  for use in situations where optimizers</a>
  9261) <a name="l9261" style="background-color: #ffcccc">!  might hold one of these in a register.</a>
  9262) <a name="l9262" style="background-color: #ffcccc">!</a>
  9263) <a name="l9263" style="background-color: #ffcccc">!  Arguments</a>
  9264) <a name="l9264" style="background-color: #ffcccc">!  =========</a>
  9265) <a name="l9265" style="background-color: #ffcccc">!</a>
  9266) <a name="l9266" style="background-color: #ffcccc">!  A, B    (input) REAL</a>
  9267) <a name="l9267" style="background-color: #ffcccc">!          The values A and B.</a>
  9268) <a name="l9268" style="background-color: #ffcccc">!</a>
  9269) <a name="l9269" style="background-color: #ffcccc">! =====================================================================</a>
  9270) <a name="l9270" style="background-color: #ffcccc">!</a>
  9271) <a name="l9271" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  9272) <a name="l9272" style="background-color: #ffcccc">!</a>
  9273) <a name="l9273" style="background-color: #ffcccc">      SLAMC3 = A + B</a>
  9274) <a name="l9274" style="background-color: #ffcccc">!</a>
  9275) <a name="l9275" style="background-color: #ffcccc">      RETURN</a>
  9276) <a name="l9276" style="background-color: #ffcccc">!</a>
  9277) <a name="l9277" style="background-color: #ffcccc">!     End of SLAMC3</a>
  9278) <a name="l9278" style="background-color: #ffcccc">!</a>
  9279) <a name="l9279" style="background-color: #ffcccc">      END FUNCTION SLAMC3</a>
  9280) <a name="l9280" style="background-color: #ffffff">!</a>
  9281) <a name="l9281" style="background-color: #ffffff">!***********************************************************************</a>
  9282) <a name="l9282" style="background-color: #ffffff">!</a>
  9283) <a name="l9283" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLAMC4( EMIN, START, BASE )</a>
  9284) <a name="l9284" style="background-color: #ffcccc"></a>
  9285) <a name="l9285" style="background-color: #ffcccc">!</a>
  9286) <a name="l9286" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  9287) <a name="l9287" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  9288) <a name="l9288" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  9289) <a name="l9289" style="background-color: #ffcccc">!     October 31, 1992</a>
  9290) <a name="l9290" style="background-color: #ffcccc">!</a>
  9291) <a name="l9291" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  9292) <a name="l9292" style="background-color: #ffcccc">      INTEGER            BASE, EMIN</a>
  9293) <a name="l9293" style="background-color: #ffcccc">      REAL(r8)               START</a>
  9294) <a name="l9294" style="background-color: #ffcccc">!     ..</a>
  9295) <a name="l9295" style="background-color: #ffcccc">!</a>
  9296) <a name="l9296" style="background-color: #ffcccc">!  Purpose</a>
  9297) <a name="l9297" style="background-color: #ffcccc">!  =======</a>
  9298) <a name="l9298" style="background-color: #ffcccc">!</a>
  9299) <a name="l9299" style="background-color: #ffcccc">!  SLAMC4 is a service routine for SLAMC2.</a>
  9300) <a name="l9300" style="background-color: #ffcccc">!</a>
  9301) <a name="l9301" style="background-color: #ffcccc">!  Arguments</a>
  9302) <a name="l9302" style="background-color: #ffcccc">!  =========</a>
  9303) <a name="l9303" style="background-color: #ffcccc">!</a>
  9304) <a name="l9304" style="background-color: #ffcccc">!  EMIN    (output) EMIN</a>
  9305) <a name="l9305" style="background-color: #ffcccc">!          The minimum exponent before (gradual) underflow, computed by</a>
  9306) <a name="l9306" style="background-color: #ffcccc">!          setting A = START and dividing by BASE until the previous A</a>
  9307) <a name="l9307" style="background-color: #ffcccc">!          can not be recovered.</a>
  9308) <a name="l9308" style="background-color: #ffcccc">!</a>
  9309) <a name="l9309" style="background-color: #ffcccc">!  START   (input) REAL</a>
  9310) <a name="l9310" style="background-color: #ffcccc">!          The starting point for determining EMIN.</a>
  9311) <a name="l9311" style="background-color: #ffcccc">!</a>
  9312) <a name="l9312" style="background-color: #ffcccc">!  BASE    (input) INTEGER</a>
  9313) <a name="l9313" style="background-color: #ffcccc">!          The base of the machine.</a>
  9314) <a name="l9314" style="background-color: #ffcccc">!</a>
  9315) <a name="l9315" style="background-color: #ffcccc">! =====================================================================</a>
  9316) <a name="l9316" style="background-color: #ffcccc">!</a>
  9317) <a name="l9317" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  9318) <a name="l9318" style="background-color: #ffcccc">      INTEGER            I</a>
  9319) <a name="l9319" style="background-color: #ffcccc">      REAL(r8)               A, B1, B2, C1, C2, D1, D2, ONE, RBASE, ZERO</a>
  9320) <a name="l9320" style="background-color: #ffcccc">!     ..</a>
  9321) <a name="l9321" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  9322) <a name="l9322" style="background-color: #ffcccc">!</a>
  9323) <a name="l9323" style="background-color: #ffcccc">      A = START</a>
  9324) <a name="l9324" style="background-color: #ffcccc">      ONE = 1</a>
  9325) <a name="l9325" style="background-color: #ffcccc">      RBASE = ONE / BASE</a>
  9326) <a name="l9326" style="background-color: #ffcccc">      ZERO = 0</a>
  9327) <a name="l9327" style="background-color: #ffcccc">      EMIN = 1</a>
  9328) <a name="l9328" style="background-color: #ffcccc">      B1 = SLAMC3( A*RBASE, ZERO )</a>
  9329) <a name="l9329" style="background-color: #ffcccc">      C1 = A</a>
  9330) <a name="l9330" style="background-color: #ffcccc">      C2 = A</a>
  9331) <a name="l9331" style="background-color: #ffcccc">      D1 = A</a>
  9332) <a name="l9332" style="background-color: #ffcccc">      D2 = A</a>
  9333) <a name="l9333" style="background-color: #ffcccc">!+    WHILE( ( C1.EQ.A ).AND.( C2.EQ.A ).AND.</a>
  9334) <a name="l9334" style="background-color: #ffcccc">!    $       ( D1.EQ.A ).AND.( D2.EQ.A )      )LOOP</a>
  9335) <a name="l9335" style="background-color: #ffcccc">   10 CONTINUE</a>
  9336) <a name="l9336" style="background-color: #ffcccc">      IF( ( C1.EQ.A ) .AND. ( C2.EQ.A ) .AND. ( D1.EQ.A ) .AND. &amp;</a>
  9337) <a name="l9337" style="background-color: #ffcccc">          ( D2.EQ.A ) ) THEN</a>
  9338) <a name="l9338" style="background-color: #ffcccc">         EMIN = EMIN - 1</a>
  9339) <a name="l9339" style="background-color: #ffcccc">         A = B1</a>
  9340) <a name="l9340" style="background-color: #ffcccc">         B1 = SLAMC3( A / BASE, ZERO )</a>
  9341) <a name="l9341" style="background-color: #ffcccc">         C1 = SLAMC3( B1*BASE, ZERO )</a>
  9342) <a name="l9342" style="background-color: #ffcccc">         D1 = ZERO</a>
  9343) <a name="l9343" style="background-color: #ffcccc">         DO 20 I = 1, BASE</a>
  9344) <a name="l9344" style="background-color: #ffcccc">            D1 = D1 + B1</a>
  9345) <a name="l9345" style="background-color: #ffcccc">   20    CONTINUE</a>
  9346) <a name="l9346" style="background-color: #ffcccc">         B2 = SLAMC3( A*RBASE, ZERO )</a>
  9347) <a name="l9347" style="background-color: #ffcccc">         C2 = SLAMC3( B2 / RBASE, ZERO )</a>
  9348) <a name="l9348" style="background-color: #ffcccc">         D2 = ZERO</a>
  9349) <a name="l9349" style="background-color: #ffcccc">         DO 30 I = 1, BASE</a>
  9350) <a name="l9350" style="background-color: #ffcccc">            D2 = D2 + B2</a>
  9351) <a name="l9351" style="background-color: #ffcccc">   30    CONTINUE</a>
  9352) <a name="l9352" style="background-color: #ffcccc">         GO TO 10</a>
  9353) <a name="l9353" style="background-color: #ffcccc">      END IF</a>
  9354) <a name="l9354" style="background-color: #ffcccc">!+    END WHILE</a>
  9355) <a name="l9355" style="background-color: #ffcccc">!</a>
  9356) <a name="l9356" style="background-color: #ffcccc">      RETURN</a>
  9357) <a name="l9357" style="background-color: #ffcccc">!</a>
  9358) <a name="l9358" style="background-color: #ffcccc">!     End of SLAMC4</a>
  9359) <a name="l9359" style="background-color: #ffcccc">!</a>
  9360) <a name="l9360" style="background-color: #ffcccc">      END SUBROUTINE SLAMC4</a>
  9361) <a name="l9361" style="background-color: #ffffff">!</a>
  9362) <a name="l9362" style="background-color: #ffffff">!***********************************************************************</a>
  9363) <a name="l9363" style="background-color: #ffffff">!</a>
  9364) <a name="l9364" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SLAMC5( BETA, P, EMIN, IEEE, EMAX, RMAX )</a>
  9365) <a name="l9365" style="background-color: #ffcccc"></a>
  9366) <a name="l9366" style="background-color: #ffcccc">!</a>
  9367) <a name="l9367" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  9368) <a name="l9368" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  9369) <a name="l9369" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  9370) <a name="l9370" style="background-color: #ffcccc">!     October 31, 1992</a>
  9371) <a name="l9371" style="background-color: #ffcccc">!</a>
  9372) <a name="l9372" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  9373) <a name="l9373" style="background-color: #ffcccc">      LOGICAL            IEEE</a>
  9374) <a name="l9374" style="background-color: #ffcccc">      INTEGER            BETA, EMAX, EMIN, P</a>
  9375) <a name="l9375" style="background-color: #ffcccc">      REAL(r8)               RMAX</a>
  9376) <a name="l9376" style="background-color: #ffcccc">!     ..</a>
  9377) <a name="l9377" style="background-color: #ffcccc">!</a>
  9378) <a name="l9378" style="background-color: #ffcccc">!  Purpose</a>
  9379) <a name="l9379" style="background-color: #ffcccc">!  =======</a>
  9380) <a name="l9380" style="background-color: #ffcccc">!</a>
  9381) <a name="l9381" style="background-color: #ffcccc">!  SLAMC5 attempts to compute RMAX, the largest machine floating-point</a>
  9382) <a name="l9382" style="background-color: #ffcccc">!  number, without overflow.  It assumes that EMAX + abs(EMIN) sum</a>
  9383) <a name="l9383" style="background-color: #ffcccc">!  approximately to a power of 2.  It will fail on machines where this</a>
  9384) <a name="l9384" style="background-color: #ffcccc">!  assumption does not hold, for example, the Cyber 205 (EMIN = -28625,</a>
  9385) <a name="l9385" style="background-color: #ffcccc">!  EMAX = 28718).  It will also fail if the value supplied for EMIN is</a>
  9386) <a name="l9386" style="background-color: #ffcccc">!  too large (i.e. too close to zero), probably with overflow.</a>
  9387) <a name="l9387" style="background-color: #ffcccc">!</a>
  9388) <a name="l9388" style="background-color: #ffcccc">!  Arguments</a>
  9389) <a name="l9389" style="background-color: #ffcccc">!  =========</a>
  9390) <a name="l9390" style="background-color: #ffcccc">!</a>
  9391) <a name="l9391" style="background-color: #ffcccc">!  BETA    (input) INTEGER</a>
  9392) <a name="l9392" style="background-color: #ffcccc">!          The base of floating-point arithmetic.</a>
  9393) <a name="l9393" style="background-color: #ffcccc">!</a>
  9394) <a name="l9394" style="background-color: #ffcccc">!  P       (input) INTEGER</a>
  9395) <a name="l9395" style="background-color: #ffcccc">!          The number of base BETA digits in the mantissa of a</a>
  9396) <a name="l9396" style="background-color: #ffcccc">!          floating-point value.</a>
  9397) <a name="l9397" style="background-color: #ffcccc">!</a>
  9398) <a name="l9398" style="background-color: #ffcccc">!  EMIN    (input) INTEGER</a>
  9399) <a name="l9399" style="background-color: #ffcccc">!          The minimum exponent before (gradual) underflow.</a>
  9400) <a name="l9400" style="background-color: #ffcccc">!</a>
  9401) <a name="l9401" style="background-color: #ffcccc">!  IEEE    (input) LOGICAL</a>
  9402) <a name="l9402" style="background-color: #ffcccc">!          A logical flag specifying whether or not the arithmetic</a>
  9403) <a name="l9403" style="background-color: #ffcccc">!          system is thought to comply with the IEEE standard.</a>
  9404) <a name="l9404" style="background-color: #ffcccc">!</a>
  9405) <a name="l9405" style="background-color: #ffcccc">!  EMAX    (output) INTEGER</a>
  9406) <a name="l9406" style="background-color: #ffcccc">!          The largest exponent before overflow</a>
  9407) <a name="l9407" style="background-color: #ffcccc">!</a>
  9408) <a name="l9408" style="background-color: #ffcccc">!  RMAX    (output) REAL</a>
  9409) <a name="l9409" style="background-color: #ffcccc">!          The largest machine floating-point number.</a>
  9410) <a name="l9410" style="background-color: #ffcccc">!</a>
  9411) <a name="l9411" style="background-color: #ffcccc">! =====================================================================</a>
  9412) <a name="l9412" style="background-color: #ffcccc">!</a>
  9413) <a name="l9413" style="background-color: #ffcccc">!     .. Parameters ..</a>
  9414) <a name="l9414" style="background-color: #ffcccc">      REAL(r8)               ZERO, ONE</a>
  9415) <a name="l9415" style="background-color: #ffcccc">      PARAMETER          ( ZERO = 0.0E0_r8, ONE = 1.0E0_r8 )</a>
  9416) <a name="l9416" style="background-color: #ffcccc">!     ..</a>
  9417) <a name="l9417" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  9418) <a name="l9418" style="background-color: #ffcccc">      INTEGER            EXBITS, EXPSUM, I, LEXP, NBITS, TRY, UEXP</a>
  9419) <a name="l9419" style="background-color: #ffcccc">      REAL(r8)               OLDY, RECBAS, Y, Z</a>
  9420) <a name="l9420" style="background-color: #ffcccc">!     ..</a>
  9421) <a name="l9421" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  9422) <a name="l9422" style="background-color: #ffcccc">!</a>
  9423) <a name="l9423" style="background-color: #ffcccc">!     First compute LEXP and UEXP, two powers of 2 that bound</a>
  9424) <a name="l9424" style="background-color: #ffcccc">!     abs(EMIN). We then assume that EMAX + abs(EMIN) will sum</a>
  9425) <a name="l9425" style="background-color: #ffcccc">!     approximately to the bound that is closest to abs(EMIN).</a>
  9426) <a name="l9426" style="background-color: #ffcccc">!     (EMAX is the exponent of the required number RMAX).</a>
  9427) <a name="l9427" style="background-color: #ffcccc">!</a>
  9428) <a name="l9428" style="background-color: #ffcccc">      LEXP = 1</a>
  9429) <a name="l9429" style="background-color: #ffcccc">      EXBITS = 1</a>
  9430) <a name="l9430" style="background-color: #ffcccc">   10 CONTINUE</a>
  9431) <a name="l9431" style="background-color: #ffcccc">      TRY = LEXP*2</a>
  9432) <a name="l9432" style="background-color: #ffcccc">      IF( TRY.LE.( -EMIN ) ) THEN</a>
  9433) <a name="l9433" style="background-color: #ffcccc">         LEXP = TRY</a>
  9434) <a name="l9434" style="background-color: #ffcccc">         EXBITS = EXBITS + 1</a>
  9435) <a name="l9435" style="background-color: #ffcccc">         GO TO 10</a>
  9436) <a name="l9436" style="background-color: #ffcccc">      END IF</a>
  9437) <a name="l9437" style="background-color: #ffcccc">      IF( LEXP.EQ.-EMIN ) THEN</a>
  9438) <a name="l9438" style="background-color: #ffcccc">         UEXP = LEXP</a>
  9439) <a name="l9439" style="background-color: #ffcccc">      ELSE</a>
  9440) <a name="l9440" style="background-color: #ffcccc">         UEXP = TRY</a>
  9441) <a name="l9441" style="background-color: #ffcccc">         EXBITS = EXBITS + 1</a>
  9442) <a name="l9442" style="background-color: #ffcccc">      END IF</a>
  9443) <a name="l9443" style="background-color: #ffcccc">!</a>
  9444) <a name="l9444" style="background-color: #ffcccc">!     Now -LEXP is less than or equal to EMIN, and -UEXP is greater</a>
  9445) <a name="l9445" style="background-color: #ffcccc">!     than or equal to EMIN. EXBITS is the number of bits needed to</a>
  9446) <a name="l9446" style="background-color: #ffcccc">!     store the exponent.</a>
  9447) <a name="l9447" style="background-color: #ffcccc">!</a>
  9448) <a name="l9448" style="background-color: #ffcccc">      IF( ( UEXP+EMIN ).GT.( -LEXP-EMIN ) ) THEN</a>
  9449) <a name="l9449" style="background-color: #ffcccc">         EXPSUM = 2*LEXP</a>
  9450) <a name="l9450" style="background-color: #ffcccc">      ELSE</a>
  9451) <a name="l9451" style="background-color: #ffcccc">         EXPSUM = 2*UEXP</a>
  9452) <a name="l9452" style="background-color: #ffcccc">      END IF</a>
  9453) <a name="l9453" style="background-color: #ffcccc">!</a>
  9454) <a name="l9454" style="background-color: #ffcccc">!     EXPSUM is the exponent range, approximately equal to</a>
  9455) <a name="l9455" style="background-color: #ffcccc">!     EMAX - EMIN + 1 .</a>
  9456) <a name="l9456" style="background-color: #ffcccc">!</a>
  9457) <a name="l9457" style="background-color: #ffcccc">      EMAX = EXPSUM + EMIN - 1</a>
  9458) <a name="l9458" style="background-color: #ffcccc">      NBITS = 1 + EXBITS + P</a>
  9459) <a name="l9459" style="background-color: #ffcccc">!</a>
  9460) <a name="l9460" style="background-color: #ffcccc">!     NBITS is the total number of bits needed to store a</a>
  9461) <a name="l9461" style="background-color: #ffcccc">!     floating-point number.</a>
  9462) <a name="l9462" style="background-color: #ffcccc">!</a>
  9463) <a name="l9463" style="background-color: #ffcccc">      IF( ( MOD( NBITS, 2 ).EQ.1 ) .AND. ( BETA.EQ.2 ) ) THEN</a>
  9464) <a name="l9464" style="background-color: #ffcccc">!</a>
  9465) <a name="l9465" style="background-color: #ffcccc">!        Either there are an odd number of bits used to store a</a>
  9466) <a name="l9466" style="background-color: #ffcccc">!        floating-point number, which is unlikely, or some bits are</a>
  9467) <a name="l9467" style="background-color: #ffcccc">!        not used in the representation of numbers, which is possible,</a>
  9468) <a name="l9468" style="background-color: #ffcccc">!        (e.g. Cray machines) or the mantissa has an implicit bit,</a>
  9469) <a name="l9469" style="background-color: #ffcccc">!        (e.g. IEEE machines, Dec Vax machines), which is perhaps the</a>
  9470) <a name="l9470" style="background-color: #ffcccc">!        most likely. We have to assume the last alternative.</a>
  9471) <a name="l9471" style="background-color: #ffcccc">!        If this is true, then we need to reduce EMAX by one because</a>
  9472) <a name="l9472" style="background-color: #ffcccc">!        there must be some way of representing zero in an implicit-bit</a>
  9473) <a name="l9473" style="background-color: #ffcccc">!        system. On machines like Cray, we are reducing EMAX by one</a>
  9474) <a name="l9474" style="background-color: #ffcccc">!        unnecessarily.</a>
  9475) <a name="l9475" style="background-color: #ffcccc">!</a>
  9476) <a name="l9476" style="background-color: #ffcccc">         EMAX = EMAX - 1</a>
  9477) <a name="l9477" style="background-color: #ffcccc">      END IF</a>
  9478) <a name="l9478" style="background-color: #ffcccc">!</a>
  9479) <a name="l9479" style="background-color: #ffcccc">      IF( IEEE ) THEN</a>
  9480) <a name="l9480" style="background-color: #ffcccc">!</a>
  9481) <a name="l9481" style="background-color: #ffcccc">!        Assume we are on an IEEE machine which reserves one exponent</a>
  9482) <a name="l9482" style="background-color: #ffcccc">!        for infinity and NaN.</a>
  9483) <a name="l9483" style="background-color: #ffcccc">!</a>
  9484) <a name="l9484" style="background-color: #ffcccc">         EMAX = EMAX - 1</a>
  9485) <a name="l9485" style="background-color: #ffcccc">      END IF</a>
  9486) <a name="l9486" style="background-color: #ffcccc">!</a>
  9487) <a name="l9487" style="background-color: #ffcccc">!     Now create RMAX, the largest machine number, which should</a>
  9488) <a name="l9488" style="background-color: #ffcccc">!     be equal to (1.0 - BETA**(-P)) * BETA**EMAX .</a>
  9489) <a name="l9489" style="background-color: #ffcccc">!</a>
  9490) <a name="l9490" style="background-color: #ffcccc">!     First compute 1.0 - BETA**(-P), being careful that the</a>
  9491) <a name="l9491" style="background-color: #ffcccc">!     result is less than 1.0 .</a>
  9492) <a name="l9492" style="background-color: #ffcccc">!</a>
  9493) <a name="l9493" style="background-color: #ffcccc">      RECBAS = ONE / BETA</a>
  9494) <a name="l9494" style="background-color: #ffcccc">      Z = BETA - ONE</a>
  9495) <a name="l9495" style="background-color: #ffcccc">      Y = ZERO</a>
  9496) <a name="l9496" style="background-color: #ffcccc">      DO 20 I = 1, P</a>
  9497) <a name="l9497" style="background-color: #ffcccc">         Z = Z*RECBAS</a>
  9498) <a name="l9498" style="background-color: #ffcccc">         IF( Y.LT.ONE ) &amp;</a>
  9499) <a name="l9499" style="background-color: #ffcccc">            OLDY = Y</a>
  9500) <a name="l9500" style="background-color: #ffcccc">         Y = SLAMC3( Y, Z )</a>
  9501) <a name="l9501" style="background-color: #ffcccc">   20 CONTINUE</a>
  9502) <a name="l9502" style="background-color: #ffcccc">      IF( Y.GE.ONE ) &amp;</a>
  9503) <a name="l9503" style="background-color: #ffcccc">         Y = OLDY</a>
  9504) <a name="l9504" style="background-color: #ffcccc">!</a>
  9505) <a name="l9505" style="background-color: #ffcccc">!     Now multiply by BETA**EMAX to get RMAX.</a>
  9506) <a name="l9506" style="background-color: #ffcccc">!</a>
  9507) <a name="l9507" style="background-color: #ffcccc">      DO 30 I = 1, EMAX</a>
  9508) <a name="l9508" style="background-color: #ffcccc">         Y = SLAMC3( Y*BETA, ZERO )</a>
  9509) <a name="l9509" style="background-color: #ffcccc">   30 CONTINUE</a>
  9510) <a name="l9510" style="background-color: #ffcccc">!</a>
  9511) <a name="l9511" style="background-color: #ffcccc">      RMAX = Y</a>
  9512) <a name="l9512" style="background-color: #ffcccc">      RETURN</a>
  9513) <a name="l9513" style="background-color: #ffcccc">!</a>
  9514) <a name="l9514" style="background-color: #ffcccc">!     End of SLAMC5</a>
  9515) <a name="l9515" style="background-color: #ffcccc">!</a>
  9516) <a name="l9516" style="background-color: #ffcccc">      END SUBROUTINE SLAMC5</a>
  9517) <a name="l9517" style="background-color: #ffffff"></a>
  9518) <a name="l9518" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  9519) <a name="l9519" style="background-color: #ffffff"></a>
  9520) <a name="l9520" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">XERBLA( SRNAME, INFO )</a>
  9521) <a name="l9521" style="background-color: #ffcccc"></a>
  9522) <a name="l9522" style="background-color: #ffcccc">!</a>
  9523) <a name="l9523" style="background-color: #ffcccc">!  -- LAPACK auxiliary routine (version 2.0) --</a>
  9524) <a name="l9524" style="background-color: #ffcccc">!     Univ. of Tennessee, Univ. of California Berkeley, NAG Ltd.,</a>
  9525) <a name="l9525" style="background-color: #ffcccc">!     Courant Institute, Argonne National Lab, and Rice University</a>
  9526) <a name="l9526" style="background-color: #ffcccc">!     September 30, 1994</a>
  9527) <a name="l9527" style="background-color: #ffcccc">!</a>
  9528) <a name="l9528" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  9529) <a name="l9529" style="background-color: #ffcccc">      CHARACTER*6        SRNAME</a>
  9530) <a name="l9530" style="background-color: #ffcccc">      INTEGER            INFO</a>
  9531) <a name="l9531" style="background-color: #ffcccc">!     ..</a>
  9532) <a name="l9532" style="background-color: #ffcccc">!</a>
  9533) <a name="l9533" style="background-color: #ffcccc">!  Purpose</a>
  9534) <a name="l9534" style="background-color: #ffcccc">!  =======</a>
  9535) <a name="l9535" style="background-color: #ffcccc">!</a>
  9536) <a name="l9536" style="background-color: #ffcccc">!  XERBLA  is an error handler for the LAPACK routines.</a>
  9537) <a name="l9537" style="background-color: #ffcccc">!  It is called by an LAPACK routine if an input parameter has an</a>
  9538) <a name="l9538" style="background-color: #ffcccc">!  invalid value.  A message is printed and execution stops.</a>
  9539) <a name="l9539" style="background-color: #ffcccc">!</a>
  9540) <a name="l9540" style="background-color: #ffcccc">!  Installers may consider modifying the STOP statement in order to</a>
  9541) <a name="l9541" style="background-color: #ffcccc">!  call system-specific exception-handling facilities.</a>
  9542) <a name="l9542" style="background-color: #ffcccc">!</a>
  9543) <a name="l9543" style="background-color: #ffcccc">!  Arguments</a>
  9544) <a name="l9544" style="background-color: #ffcccc">!  =========</a>
  9545) <a name="l9545" style="background-color: #ffcccc">!</a>
  9546) <a name="l9546" style="background-color: #ffcccc">!  SRNAME  (input) CHARACTER*6</a>
  9547) <a name="l9547" style="background-color: #ffcccc">!          The name of the routine which called XERBLA.</a>
  9548) <a name="l9548" style="background-color: #ffcccc">!</a>
  9549) <a name="l9549" style="background-color: #ffcccc">!  INFO    (input) INTEGER</a>
  9550) <a name="l9550" style="background-color: #ffcccc">!          The position of the invalid parameter in the parameter list</a>
  9551) <a name="l9551" style="background-color: #ffcccc">!          of the calling routine.</a>
  9552) <a name="l9552" style="background-color: #ffcccc">!</a>
  9553) <a name="l9553" style="background-color: #ffcccc">! =====================================================================</a>
  9554) <a name="l9554" style="background-color: #ffcccc">!</a>
  9555) <a name="l9555" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  9556) <a name="l9556" style="background-color: #ffcccc">!</a>
  9557) <a name="l9557" style="background-color: #ffcccc">      write(iulog, FMT = 9999 )SRNAME, INFO</a>
  9558) <a name="l9558" style="background-color: #ffcccc">!</a>
  9559) <a name="l9559" style="background-color: #ffcccc">      call endrun('XERBLA')</a>
  9560) <a name="l9560" style="background-color: #ffcccc">!</a>
  9561) <a name="l9561" style="background-color: #ffcccc"> 9999 FORMAT( ' ** On entry to ', A6, ' parameter number ', I2, ' had ', &amp;</a>
  9562) <a name="l9562" style="background-color: #ffcccc">            'an illegal value' )</a>
  9563) <a name="l9563" style="background-color: #ffcccc">!</a>
  9564) <a name="l9564" style="background-color: #ffcccc">!     End of XERBLA</a>
  9565) <a name="l9565" style="background-color: #ffcccc">!</a>
  9566) <a name="l9566" style="background-color: #ffcccc">      END SUBROUTINE XERBLA</a>
  9567) <a name="l9567" style="background-color: #ffffff"></a>
  9568) <a name="l9568" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  9569) <a name="l9569" style="background-color: #ffffff"></a>
  9570) <a name="l9570" style="background-color: #ffffff">      subroutine </a><a style="background-color: #ffcccc">scopy(n,sx,incx,sy,incy)</a>
  9571) <a name="l9571" style="background-color: #ffcccc"></a>
  9572) <a name="l9572" style="background-color: #ffcccc">!</a>
  9573) <a name="l9573" style="background-color: #ffcccc">!     copies a vector, x, to a vector, y.</a>
  9574) <a name="l9574" style="background-color: #ffcccc">!     uses unrolled loops for increments equal to 1.</a>
  9575) <a name="l9575" style="background-color: #ffcccc">!     jack dongarra, linpack, 3/11/78.</a>
  9576) <a name="l9576" style="background-color: #ffcccc">!     modified 12/3/93, array(1) declarations changed to array(*)</a>
  9577) <a name="l9577" style="background-color: #ffcccc">!</a>
  9578) <a name="l9578" style="background-color: #ffcccc">      real(r8) sx(*),sy(*)</a>
  9579) <a name="l9579" style="background-color: #ffcccc">      integer i,incx,incy,ix,iy,m,mp1,n</a>
  9580) <a name="l9580" style="background-color: #ffcccc">!</a>
  9581) <a name="l9581" style="background-color: #ffcccc">      if(n.le.0)return</a>
  9582) <a name="l9582" style="background-color: #ffcccc">      if(incx.eq.1.and.incy.eq.1)go to 20</a>
  9583) <a name="l9583" style="background-color: #ffcccc">!</a>
  9584) <a name="l9584" style="background-color: #ffcccc">!        code for unequal increments or equal increments</a>
  9585) <a name="l9585" style="background-color: #ffcccc">!          not equal to 1</a>
  9586) <a name="l9586" style="background-color: #ffcccc">!</a>
  9587) <a name="l9587" style="background-color: #ffcccc">      ix = 1</a>
  9588) <a name="l9588" style="background-color: #ffcccc">      iy = 1</a>
  9589) <a name="l9589" style="background-color: #ffcccc">      if(incx.lt.0)ix = (-n+1)*incx + 1</a>
  9590) <a name="l9590" style="background-color: #ffcccc">      if(incy.lt.0)iy = (-n+1)*incy + 1</a>
  9591) <a name="l9591" style="background-color: #ffcccc">      do 10 i = 1,n</a>
  9592) <a name="l9592" style="background-color: #ffcccc">        sy(iy) = sx(ix)</a>
  9593) <a name="l9593" style="background-color: #ffcccc">        ix = ix + incx</a>
  9594) <a name="l9594" style="background-color: #ffcccc">        iy = iy + incy</a>
  9595) <a name="l9595" style="background-color: #ffcccc">   10 continue</a>
  9596) <a name="l9596" style="background-color: #ffcccc">      return</a>
  9597) <a name="l9597" style="background-color: #ffcccc">!</a>
  9598) <a name="l9598" style="background-color: #ffcccc">!        code for both increments equal to 1</a>
  9599) <a name="l9599" style="background-color: #ffcccc">!</a>
  9600) <a name="l9600" style="background-color: #ffcccc">!</a>
  9601) <a name="l9601" style="background-color: #ffcccc">!        clean-up loop</a>
  9602) <a name="l9602" style="background-color: #ffcccc">!</a>
  9603) <a name="l9603" style="background-color: #ffcccc">   20 m = mod(n,7)</a>
  9604) <a name="l9604" style="background-color: #ffcccc">      if( m .eq. 0 ) go to 40</a>
  9605) <a name="l9605" style="background-color: #ffcccc">      do 30 i = 1,m</a>
  9606) <a name="l9606" style="background-color: #ffcccc">        sy(i) = sx(i)</a>
  9607) <a name="l9607" style="background-color: #ffcccc">   30 continue</a>
  9608) <a name="l9608" style="background-color: #ffcccc">      if( n .lt. 7 ) return</a>
  9609) <a name="l9609" style="background-color: #ffcccc">   40 mp1 = m + 1</a>
  9610) <a name="l9610" style="background-color: #ffcccc">      do 50 i = mp1,n,7</a>
  9611) <a name="l9611" style="background-color: #ffcccc">        sy(i) = sx(i)</a>
  9612) <a name="l9612" style="background-color: #ffcccc">        sy(i + 1) = sx(i + 1)</a>
  9613) <a name="l9613" style="background-color: #ffcccc">        sy(i + 2) = sx(i + 2)</a>
  9614) <a name="l9614" style="background-color: #ffcccc">        sy(i + 3) = sx(i + 3)</a>
  9615) <a name="l9615" style="background-color: #ffcccc">        sy(i + 4) = sx(i + 4)</a>
  9616) <a name="l9616" style="background-color: #ffcccc">        sy(i + 5) = sx(i + 5)</a>
  9617) <a name="l9617" style="background-color: #ffcccc">        sy(i + 6) = sx(i + 6)</a>
  9618) <a name="l9618" style="background-color: #ffcccc">   50 continue</a>
  9619) <a name="l9619" style="background-color: #ffcccc">      return</a>
  9620) <a name="l9620" style="background-color: #ffcccc">      end subroutine scopy</a>
  9621) <a name="l9621" style="background-color: #ffffff"></a>
  9622) <a name="l9622" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  9623) <a name="l9623" style="background-color: #ffffff"></a>
  9624) <a name="l9624" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SGER  ( M, N, ALPHA, X, INCX, Y, INCY, A, LDA )</a>
  9625) <a name="l9625" style="background-color: #ffcccc"></a>
  9626) <a name="l9626" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  9627) <a name="l9627" style="background-color: #ffcccc">      REAL(r8)               ALPHA</a>
  9628) <a name="l9628" style="background-color: #ffcccc">      INTEGER            INCX, INCY, LDA, M, N</a>
  9629) <a name="l9629" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  9630) <a name="l9630" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), X( * ), Y( * )</a>
  9631) <a name="l9631" style="background-color: #ffcccc">!     ..</a>
  9632) <a name="l9632" style="background-color: #ffcccc">!</a>
  9633) <a name="l9633" style="background-color: #ffcccc">!  Purpose</a>
  9634) <a name="l9634" style="background-color: #ffcccc">!  =======</a>
  9635) <a name="l9635" style="background-color: #ffcccc">!</a>
  9636) <a name="l9636" style="background-color: #ffcccc">!  SGER   performs the rank 1 operation</a>
  9637) <a name="l9637" style="background-color: #ffcccc">!</a>
  9638) <a name="l9638" style="background-color: #ffcccc">!     A := alpha*x*y' + A,</a>
  9639) <a name="l9639" style="background-color: #ffcccc">!</a>
  9640) <a name="l9640" style="background-color: #ffcccc">!  where alpha is a scalar, x is an m element vector, y is an n element</a>
  9641) <a name="l9641" style="background-color: #ffcccc">!  vector and A is an m by n matrix.</a>
  9642) <a name="l9642" style="background-color: #ffcccc">!</a>
  9643) <a name="l9643" style="background-color: #ffcccc">!  Parameters</a>
  9644) <a name="l9644" style="background-color: #ffcccc">!  ==========</a>
  9645) <a name="l9645" style="background-color: #ffcccc">!</a>
  9646) <a name="l9646" style="background-color: #ffcccc">!  M      - INTEGER.</a>
  9647) <a name="l9647" style="background-color: #ffcccc">!           On entry, M specifies the number of rows of the matrix A.</a>
  9648) <a name="l9648" style="background-color: #ffcccc">!           M must be at least zero.</a>
  9649) <a name="l9649" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9650) <a name="l9650" style="background-color: #ffcccc">!</a>
  9651) <a name="l9651" style="background-color: #ffcccc">!  N      - INTEGER.</a>
  9652) <a name="l9652" style="background-color: #ffcccc">!           On entry, N specifies the number of columns of the matrix A.</a>
  9653) <a name="l9653" style="background-color: #ffcccc">!           N must be at least zero.</a>
  9654) <a name="l9654" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9655) <a name="l9655" style="background-color: #ffcccc">!</a>
  9656) <a name="l9656" style="background-color: #ffcccc">!  ALPHA  - REAL            .</a>
  9657) <a name="l9657" style="background-color: #ffcccc">!           On entry, ALPHA specifies the scalar alpha.</a>
  9658) <a name="l9658" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9659) <a name="l9659" style="background-color: #ffcccc">!</a>
  9660) <a name="l9660" style="background-color: #ffcccc">!  X      - REAL             array of dimension at least</a>
  9661) <a name="l9661" style="background-color: #ffcccc">!           ( 1 + ( m - 1 )*abs( INCX ) ).</a>
  9662) <a name="l9662" style="background-color: #ffcccc">!           Before entry, the incremented array X must contain the m</a>
  9663) <a name="l9663" style="background-color: #ffcccc">!           element vector x.</a>
  9664) <a name="l9664" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9665) <a name="l9665" style="background-color: #ffcccc">!</a>
  9666) <a name="l9666" style="background-color: #ffcccc">!  INCX   - INTEGER.</a>
  9667) <a name="l9667" style="background-color: #ffcccc">!           On entry, INCX specifies the increment for the elements of</a>
  9668) <a name="l9668" style="background-color: #ffcccc">!           X. INCX must not be zero.</a>
  9669) <a name="l9669" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9670) <a name="l9670" style="background-color: #ffcccc">!</a>
  9671) <a name="l9671" style="background-color: #ffcccc">!  Y      - REAL             array of dimension at least</a>
  9672) <a name="l9672" style="background-color: #ffcccc">!           ( 1 + ( n - 1 )*abs( INCY ) ).</a>
  9673) <a name="l9673" style="background-color: #ffcccc">!           Before entry, the incremented array Y must contain the n</a>
  9674) <a name="l9674" style="background-color: #ffcccc">!           element vector y.</a>
  9675) <a name="l9675" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9676) <a name="l9676" style="background-color: #ffcccc">!</a>
  9677) <a name="l9677" style="background-color: #ffcccc">!  INCY   - INTEGER.</a>
  9678) <a name="l9678" style="background-color: #ffcccc">!           On entry, INCY specifies the increment for the elements of</a>
  9679) <a name="l9679" style="background-color: #ffcccc">!           Y. INCY must not be zero.</a>
  9680) <a name="l9680" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9681) <a name="l9681" style="background-color: #ffcccc">!</a>
  9682) <a name="l9682" style="background-color: #ffcccc">!  A      - REAL             array of DIMENSION ( LDA, n ).</a>
  9683) <a name="l9683" style="background-color: #ffcccc">!           Before entry, the leading m by n part of the array A must</a>
  9684) <a name="l9684" style="background-color: #ffcccc">!           contain the matrix of coefficients. On exit, A is</a>
  9685) <a name="l9685" style="background-color: #ffcccc">!           overwritten by the updated matrix.</a>
  9686) <a name="l9686" style="background-color: #ffcccc">!</a>
  9687) <a name="l9687" style="background-color: #ffcccc">!  LDA    - INTEGER.</a>
  9688) <a name="l9688" style="background-color: #ffcccc">!           On entry, LDA specifies the first dimension of A as declared</a>
  9689) <a name="l9689" style="background-color: #ffcccc">!           in the calling (sub) program. LDA must be at least</a>
  9690) <a name="l9690" style="background-color: #ffcccc">!           max( 1, m ).</a>
  9691) <a name="l9691" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9692) <a name="l9692" style="background-color: #ffcccc">!</a>
  9693) <a name="l9693" style="background-color: #ffcccc">!</a>
  9694) <a name="l9694" style="background-color: #ffcccc">!  Level 2 Blas routine.</a>
  9695) <a name="l9695" style="background-color: #ffcccc">!</a>
  9696) <a name="l9696" style="background-color: #ffcccc">!  -- Written on 22-October-1986.</a>
  9697) <a name="l9697" style="background-color: #ffcccc">!     Jack Dongarra, Argonne National Lab.</a>
  9698) <a name="l9698" style="background-color: #ffcccc">!     Jeremy Du Croz, Nag Central Office.</a>
  9699) <a name="l9699" style="background-color: #ffcccc">!     Sven Hammarling, Nag Central Office.</a>
  9700) <a name="l9700" style="background-color: #ffcccc">!     Richard Hanson, Sandia National Labs.</a>
  9701) <a name="l9701" style="background-color: #ffcccc">!</a>
  9702) <a name="l9702" style="background-color: #ffcccc">!</a>
  9703) <a name="l9703" style="background-color: #ffcccc">!     .. Parameters ..</a>
  9704) <a name="l9704" style="background-color: #ffcccc">      REAL(r8)               ZERO</a>
  9705) <a name="l9705" style="background-color: #ffcccc">      PARAMETER        ( ZERO = 0.0E+0_r8 )</a>
  9706) <a name="l9706" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  9707) <a name="l9707" style="background-color: #ffcccc">      REAL(r8)               TEMP</a>
  9708) <a name="l9708" style="background-color: #ffcccc">      INTEGER            I, INFO, IX, J, JY, KX</a>
  9709) <a name="l9709" style="background-color: #ffcccc">!     ..</a>
  9710) <a name="l9710" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  9711) <a name="l9711" style="background-color: #ffcccc">!</a>
  9712) <a name="l9712" style="background-color: #ffcccc">!     Test the input parameters.</a>
  9713) <a name="l9713" style="background-color: #ffcccc">!</a>
  9714) <a name="l9714" style="background-color: #ffcccc">      INFO = 0</a>
  9715) <a name="l9715" style="background-color: #ffcccc">      IF     ( M.LT.0 )THEN</a>
  9716) <a name="l9716" style="background-color: #ffcccc">         INFO = 1</a>
  9717) <a name="l9717" style="background-color: #ffcccc">      ELSE IF( N.LT.0 )THEN</a>
  9718) <a name="l9718" style="background-color: #ffcccc">         INFO = 2</a>
  9719) <a name="l9719" style="background-color: #ffcccc">      ELSE IF( INCX.EQ.0 )THEN</a>
  9720) <a name="l9720" style="background-color: #ffcccc">         INFO = 5</a>
  9721) <a name="l9721" style="background-color: #ffcccc">      ELSE IF( INCY.EQ.0 )THEN</a>
  9722) <a name="l9722" style="background-color: #ffcccc">         INFO = 7</a>
  9723) <a name="l9723" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, M ) )THEN</a>
  9724) <a name="l9724" style="background-color: #ffcccc">         INFO = 9</a>
  9725) <a name="l9725" style="background-color: #ffcccc">      END IF</a>
  9726) <a name="l9726" style="background-color: #ffcccc">      IF( INFO.NE.0 )THEN</a>
  9727) <a name="l9727" style="background-color: #ffcccc">         CALL XERBLA( 'SGER  ', INFO )</a>
  9728) <a name="l9728" style="background-color: #ffcccc">         RETURN</a>
  9729) <a name="l9729" style="background-color: #ffcccc">      END IF</a>
  9730) <a name="l9730" style="background-color: #ffcccc">!</a>
  9731) <a name="l9731" style="background-color: #ffcccc">!     Quick return if possible.</a>
  9732) <a name="l9732" style="background-color: #ffcccc">!</a>
  9733) <a name="l9733" style="background-color: #ffcccc">      IF( ( M.EQ.0 ).OR.( N.EQ.0 ).OR.( ALPHA.EQ.ZERO ) ) &amp;</a>
  9734) <a name="l9734" style="background-color: #ffcccc">         RETURN</a>
  9735) <a name="l9735" style="background-color: #ffcccc">!</a>
  9736) <a name="l9736" style="background-color: #ffcccc">!     Start the operations. In this version the elements of A are</a>
  9737) <a name="l9737" style="background-color: #ffcccc">!     accessed sequentially with one pass through A.</a>
  9738) <a name="l9738" style="background-color: #ffcccc">!</a>
  9739) <a name="l9739" style="background-color: #ffcccc">      IF( INCY.GT.0 )THEN</a>
  9740) <a name="l9740" style="background-color: #ffcccc">         JY = 1</a>
  9741) <a name="l9741" style="background-color: #ffcccc">      ELSE</a>
  9742) <a name="l9742" style="background-color: #ffcccc">         JY = 1 - ( N - 1 )*INCY</a>
  9743) <a name="l9743" style="background-color: #ffcccc">      END IF</a>
  9744) <a name="l9744" style="background-color: #ffcccc">      IF( INCX.EQ.1 )THEN</a>
  9745) <a name="l9745" style="background-color: #ffcccc">         DO 20, J = 1, N</a>
  9746) <a name="l9746" style="background-color: #ffcccc">            IF( Y( JY ).NE.ZERO )THEN</a>
  9747) <a name="l9747" style="background-color: #ffcccc">               TEMP = ALPHA*Y( JY )</a>
  9748) <a name="l9748" style="background-color: #ffcccc">               DO 10, I = 1, M</a>
  9749) <a name="l9749" style="background-color: #ffcccc">                  A( I, J ) = A( I, J ) + X( I )*TEMP</a>
  9750) <a name="l9750" style="background-color: #ffcccc">   10          CONTINUE</a>
  9751) <a name="l9751" style="background-color: #ffcccc">            END IF</a>
  9752) <a name="l9752" style="background-color: #ffcccc">            JY = JY + INCY</a>
  9753) <a name="l9753" style="background-color: #ffcccc">   20    CONTINUE</a>
  9754) <a name="l9754" style="background-color: #ffcccc">      ELSE</a>
  9755) <a name="l9755" style="background-color: #ffcccc">         IF( INCX.GT.0 )THEN</a>
  9756) <a name="l9756" style="background-color: #ffcccc">            KX = 1</a>
  9757) <a name="l9757" style="background-color: #ffcccc">         ELSE</a>
  9758) <a name="l9758" style="background-color: #ffcccc">            KX = 1 - ( M - 1 )*INCX</a>
  9759) <a name="l9759" style="background-color: #ffcccc">         END IF</a>
  9760) <a name="l9760" style="background-color: #ffcccc">         DO 40, J = 1, N</a>
  9761) <a name="l9761" style="background-color: #ffcccc">            IF( Y( JY ).NE.ZERO )THEN</a>
  9762) <a name="l9762" style="background-color: #ffcccc">               TEMP = ALPHA*Y( JY )</a>
  9763) <a name="l9763" style="background-color: #ffcccc">               IX   = KX</a>
  9764) <a name="l9764" style="background-color: #ffcccc">               DO 30, I = 1, M</a>
  9765) <a name="l9765" style="background-color: #ffcccc">                  A( I, J ) = A( I, J ) + X( IX )*TEMP</a>
  9766) <a name="l9766" style="background-color: #ffcccc">                  IX        = IX        + INCX</a>
  9767) <a name="l9767" style="background-color: #ffcccc">   30          CONTINUE</a>
  9768) <a name="l9768" style="background-color: #ffcccc">            END IF</a>
  9769) <a name="l9769" style="background-color: #ffcccc">            JY = JY + INCY</a>
  9770) <a name="l9770" style="background-color: #ffcccc">   40    CONTINUE</a>
  9771) <a name="l9771" style="background-color: #ffcccc">      END IF</a>
  9772) <a name="l9772" style="background-color: #ffcccc">!</a>
  9773) <a name="l9773" style="background-color: #ffcccc">      RETURN</a>
  9774) <a name="l9774" style="background-color: #ffcccc">!</a>
  9775) <a name="l9775" style="background-color: #ffcccc">!     End of SGER  .</a>
  9776) <a name="l9776" style="background-color: #ffcccc">!</a>
  9777) <a name="l9777" style="background-color: #ffcccc">      END SUBROUTINE SGER</a>
  9778) <a name="l9778" style="background-color: #ffffff"></a>
  9779) <a name="l9779" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  9780) <a name="l9780" style="background-color: #ffffff"></a>
  9781) <a name="l9781" style="background-color: #ffffff">      FUNCTION </a><a style="background-color: #ffcccc">SNRM2 ( N, X, INCX )</a>
  9782) <a name="l9782" style="background-color: #ffcccc"></a>
  9783) <a name="l9783" style="background-color: #ffcccc">      real(r8) snrm2</a>
  9784) <a name="l9784" style="background-color: #ffcccc"></a>
  9785) <a name="l9785" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  9786) <a name="l9786" style="background-color: #ffcccc">      INTEGER                           INCX, N</a>
  9787) <a name="l9787" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  9788) <a name="l9788" style="background-color: #ffcccc">      REAL(r8)                              X( * )</a>
  9789) <a name="l9789" style="background-color: #ffcccc">!     ..</a>
  9790) <a name="l9790" style="background-color: #ffcccc">!</a>
  9791) <a name="l9791" style="background-color: #ffcccc">!  SNRM2 returns the euclidean norm of a vector via the function</a>
  9792) <a name="l9792" style="background-color: #ffcccc">!  name, so that</a>
  9793) <a name="l9793" style="background-color: #ffcccc">!</a>
  9794) <a name="l9794" style="background-color: #ffcccc">!     SNRM2 := sqrt( x'*x )</a>
  9795) <a name="l9795" style="background-color: #ffcccc">!</a>
  9796) <a name="l9796" style="background-color: #ffcccc">!</a>
  9797) <a name="l9797" style="background-color: #ffcccc">!</a>
  9798) <a name="l9798" style="background-color: #ffcccc">!  -- This version written on 25-October-1982.</a>
  9799) <a name="l9799" style="background-color: #ffcccc">!     Modified on 14-October-1993 to inline the call to SLASSQ.</a>
  9800) <a name="l9800" style="background-color: #ffcccc">!     Sven Hammarling, Nag Ltd.</a>
  9801) <a name="l9801" style="background-color: #ffcccc">!</a>
  9802) <a name="l9802" style="background-color: #ffcccc">!</a>
  9803) <a name="l9803" style="background-color: #ffcccc">!     .. Parameters ..</a>
  9804) <a name="l9804" style="background-color: #ffcccc">      REAL(r8)                  ONE         , ZERO</a>
  9805) <a name="l9805" style="background-color: #ffcccc">      PARAMETER           ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
  9806) <a name="l9806" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
  9807) <a name="l9807" style="background-color: #ffcccc">      INTEGER               IX</a>
  9808) <a name="l9808" style="background-color: #ffcccc">      REAL(r8)                  ABSXI, NORM, SCALE, SSQ</a>
  9809) <a name="l9809" style="background-color: #ffcccc">!     ..</a>
  9810) <a name="l9810" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
  9811) <a name="l9811" style="background-color: #ffcccc">      IF( N.LT.1 .OR. INCX.LT.1 )THEN</a>
  9812) <a name="l9812" style="background-color: #ffcccc">         NORM  = ZERO</a>
  9813) <a name="l9813" style="background-color: #ffcccc">      ELSE IF( N.EQ.1 )THEN</a>
  9814) <a name="l9814" style="background-color: #ffcccc">         NORM  = ABS( X( 1 ) )</a>
  9815) <a name="l9815" style="background-color: #ffcccc">      ELSE</a>
  9816) <a name="l9816" style="background-color: #ffcccc">         SCALE = ZERO</a>
  9817) <a name="l9817" style="background-color: #ffcccc">         SSQ   = ONE</a>
  9818) <a name="l9818" style="background-color: #ffcccc">!        The following loop is equivalent to this call to the LAPACK</a>
  9819) <a name="l9819" style="background-color: #ffcccc">!        auxiliary routine:</a>
  9820) <a name="l9820" style="background-color: #ffcccc">!        CALL SLASSQ( N, X, INCX, SCALE, SSQ )</a>
  9821) <a name="l9821" style="background-color: #ffcccc">!</a>
  9822) <a name="l9822" style="background-color: #ffcccc">         DO 10, IX = 1, 1 + ( N - 1 )*INCX, INCX</a>
  9823) <a name="l9823" style="background-color: #ffcccc">            IF( X( IX ).NE.ZERO )THEN</a>
  9824) <a name="l9824" style="background-color: #ffcccc">               ABSXI = ABS( X( IX ) )</a>
  9825) <a name="l9825" style="background-color: #ffcccc">               IF( SCALE.LT.ABSXI )THEN</a>
  9826) <a name="l9826" style="background-color: #ffcccc">                  SSQ   = ONE   + SSQ*( SCALE/ABSXI )**2</a>
  9827) <a name="l9827" style="background-color: #ffcccc">                  SCALE = ABSXI</a>
  9828) <a name="l9828" style="background-color: #ffcccc">               ELSE</a>
  9829) <a name="l9829" style="background-color: #ffcccc">                  SSQ   = SSQ   +     ( ABSXI/SCALE )**2</a>
  9830) <a name="l9830" style="background-color: #ffcccc">               END IF</a>
  9831) <a name="l9831" style="background-color: #ffcccc">            END IF</a>
  9832) <a name="l9832" style="background-color: #ffcccc">   10    CONTINUE</a>
  9833) <a name="l9833" style="background-color: #ffcccc">         NORM  = SCALE * SQRT( SSQ )</a>
  9834) <a name="l9834" style="background-color: #ffcccc">      END IF</a>
  9835) <a name="l9835" style="background-color: #ffcccc">!</a>
  9836) <a name="l9836" style="background-color: #ffcccc">      SNRM2 = NORM</a>
  9837) <a name="l9837" style="background-color: #ffcccc">      RETURN</a>
  9838) <a name="l9838" style="background-color: #ffcccc">!</a>
  9839) <a name="l9839" style="background-color: #ffcccc">!     End of SNRM2.</a>
  9840) <a name="l9840" style="background-color: #ffcccc">!</a>
  9841) <a name="l9841" style="background-color: #ffcccc">      END FUNCTION SNRM2</a>
  9842) <a name="l9842" style="background-color: #ffffff"></a>
  9843) <a name="l9843" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  9844) <a name="l9844" style="background-color: #ffffff"></a>
  9845) <a name="l9845" style="background-color: #ffffff">      subroutine </a><a style="background-color: #ffcccc">srot (n,sx,incx,sy,incy,c,s)</a>
  9846) <a name="l9846" style="background-color: #ffcccc">!</a>
  9847) <a name="l9847" style="background-color: #ffcccc">!     applies a plane rotation.</a>
  9848) <a name="l9848" style="background-color: #ffcccc">!     jack dongarra, linpack, 3/11/78.</a>
  9849) <a name="l9849" style="background-color: #ffcccc">!     modified 12/3/93, array(1) declarations changed to array(*)</a>
  9850) <a name="l9850" style="background-color: #ffcccc">!</a>
  9851) <a name="l9851" style="background-color: #ffcccc"></a>
  9852) <a name="l9852" style="background-color: #ffcccc">      real(r8) sx(*),sy(*),stemp,c,s</a>
  9853) <a name="l9853" style="background-color: #ffcccc">      integer i,incx,incy,ix,iy,n</a>
  9854) <a name="l9854" style="background-color: #ffcccc">!</a>
  9855) <a name="l9855" style="background-color: #ffcccc">      if(n.le.0)return</a>
  9856) <a name="l9856" style="background-color: #ffcccc">      if(incx.eq.1.and.incy.eq.1)go to 20</a>
  9857) <a name="l9857" style="background-color: #ffcccc">!</a>
  9858) <a name="l9858" style="background-color: #ffcccc">!       code for unequal increments or equal increments not equal</a>
  9859) <a name="l9859" style="background-color: #ffcccc">!         to 1</a>
  9860) <a name="l9860" style="background-color: #ffcccc">!</a>
  9861) <a name="l9861" style="background-color: #ffcccc">      ix = 1</a>
  9862) <a name="l9862" style="background-color: #ffcccc">      iy = 1</a>
  9863) <a name="l9863" style="background-color: #ffcccc">      if(incx.lt.0)ix = (-n+1)*incx + 1</a>
  9864) <a name="l9864" style="background-color: #ffcccc">      if(incy.lt.0)iy = (-n+1)*incy + 1</a>
  9865) <a name="l9865" style="background-color: #ffcccc">      do 10 i = 1,n</a>
  9866) <a name="l9866" style="background-color: #ffcccc">        stemp = c*sx(ix) + s*sy(iy)</a>
  9867) <a name="l9867" style="background-color: #ffcccc">        sy(iy) = c*sy(iy) - s*sx(ix)</a>
  9868) <a name="l9868" style="background-color: #ffcccc">        sx(ix) = stemp</a>
  9869) <a name="l9869" style="background-color: #ffcccc">        ix = ix + incx</a>
  9870) <a name="l9870" style="background-color: #ffcccc">        iy = iy + incy</a>
  9871) <a name="l9871" style="background-color: #ffcccc">   10 continue</a>
  9872) <a name="l9872" style="background-color: #ffcccc">      return</a>
  9873) <a name="l9873" style="background-color: #ffcccc">!</a>
  9874) <a name="l9874" style="background-color: #ffcccc">!       code for both increments equal to 1</a>
  9875) <a name="l9875" style="background-color: #ffcccc">!</a>
  9876) <a name="l9876" style="background-color: #ffcccc">   20 do 30 i = 1,n</a>
  9877) <a name="l9877" style="background-color: #ffcccc">        stemp = c*sx(i) + s*sy(i)</a>
  9878) <a name="l9878" style="background-color: #ffcccc">        sy(i) = c*sy(i) - s*sx(i)</a>
  9879) <a name="l9879" style="background-color: #ffcccc">        sx(i) = stemp</a>
  9880) <a name="l9880" style="background-color: #ffcccc">   30 continue</a>
  9881) <a name="l9881" style="background-color: #ffcccc">      return</a>
  9882) <a name="l9882" style="background-color: #ffcccc">      end subroutine srot</a>
  9883) <a name="l9883" style="background-color: #ffffff"></a>
  9884) <a name="l9884" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
  9885) <a name="l9885" style="background-color: #ffffff"></a>
  9886) <a name="l9886" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SGEMM ( TRANSA, TRANSB, M, N, K, ALPHA, A, LDA, B, LDB, &amp;</a>
  9887) <a name="l9887" style="background-color: #ffcccc">                         BETA, C, LDC )</a>
  9888) <a name="l9888" style="background-color: #ffcccc"></a>
  9889) <a name="l9889" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
  9890) <a name="l9890" style="background-color: #ffcccc">      CHARACTER*1        TRANSA, TRANSB</a>
  9891) <a name="l9891" style="background-color: #ffcccc">      INTEGER            M, N, K, LDA, LDB, LDC</a>
  9892) <a name="l9892" style="background-color: #ffcccc">      REAL(r8)               ALPHA, BETA</a>
  9893) <a name="l9893" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
  9894) <a name="l9894" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), B( LDB, * ), C( LDC, * )</a>
  9895) <a name="l9895" style="background-color: #ffcccc">!     ..</a>
  9896) <a name="l9896" style="background-color: #ffcccc">!</a>
  9897) <a name="l9897" style="background-color: #ffcccc">!  Purpose</a>
  9898) <a name="l9898" style="background-color: #ffcccc">!  =======</a>
  9899) <a name="l9899" style="background-color: #ffcccc">!</a>
  9900) <a name="l9900" style="background-color: #ffcccc">!  SGEMM  performs one of the matrix-matrix operations</a>
  9901) <a name="l9901" style="background-color: #ffcccc">!</a>
  9902) <a name="l9902" style="background-color: #ffcccc">!     C := alpha*op( A )*op( B ) + beta*C,</a>
  9903) <a name="l9903" style="background-color: #ffcccc">!</a>
  9904) <a name="l9904" style="background-color: #ffcccc">!  where  op( X ) is one of</a>
  9905) <a name="l9905" style="background-color: #ffcccc">!</a>
  9906) <a name="l9906" style="background-color: #ffcccc">!     op( X ) = X   or   op( X ) = X',</a>
  9907) <a name="l9907" style="background-color: #ffcccc">!</a>
  9908) <a name="l9908" style="background-color: #ffcccc">!  alpha and beta are scalars, and A, B and C are matrices, with op( A )</a>
  9909) <a name="l9909" style="background-color: #ffcccc">!  an m by k matrix,  op( B )  a  k by n matrix and  C an m by n matrix.</a>
  9910) <a name="l9910" style="background-color: #ffcccc">!</a>
  9911) <a name="l9911" style="background-color: #ffcccc">!  Parameters</a>
  9912) <a name="l9912" style="background-color: #ffcccc">!  ==========</a>
  9913) <a name="l9913" style="background-color: #ffcccc">!</a>
  9914) <a name="l9914" style="background-color: #ffcccc">!  TRANSA - CHARACTER*1.</a>
  9915) <a name="l9915" style="background-color: #ffcccc">!           On entry, TRANSA specifies the form of op( A ) to be used in</a>
  9916) <a name="l9916" style="background-color: #ffcccc">!           the matrix multiplication as follows:</a>
  9917) <a name="l9917" style="background-color: #ffcccc">!</a>
  9918) <a name="l9918" style="background-color: #ffcccc">!              TRANSA = 'N' or 'n',  op( A ) = A.</a>
  9919) <a name="l9919" style="background-color: #ffcccc">!</a>
  9920) <a name="l9920" style="background-color: #ffcccc">!              TRANSA = 'T' or 't',  op( A ) = A'.</a>
  9921) <a name="l9921" style="background-color: #ffcccc">!</a>
  9922) <a name="l9922" style="background-color: #ffcccc">!              TRANSA = 'C' or 'c',  op( A ) = A'.</a>
  9923) <a name="l9923" style="background-color: #ffcccc">!</a>
  9924) <a name="l9924" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9925) <a name="l9925" style="background-color: #ffcccc">!</a>
  9926) <a name="l9926" style="background-color: #ffcccc">!  TRANSB - CHARACTER*1.</a>
  9927) <a name="l9927" style="background-color: #ffcccc">!           On entry, TRANSB specifies the form of op( B ) to be used in</a>
  9928) <a name="l9928" style="background-color: #ffcccc">!           the matrix multiplication as follows:</a>
  9929) <a name="l9929" style="background-color: #ffcccc">!</a>
  9930) <a name="l9930" style="background-color: #ffcccc">!              TRANSB = 'N' or 'n',  op( B ) = B.</a>
  9931) <a name="l9931" style="background-color: #ffcccc">!</a>
  9932) <a name="l9932" style="background-color: #ffcccc">!              TRANSB = 'T' or 't',  op( B ) = B'.</a>
  9933) <a name="l9933" style="background-color: #ffcccc">!</a>
  9934) <a name="l9934" style="background-color: #ffcccc">!              TRANSB = 'C' or 'c',  op( B ) = B'.</a>
  9935) <a name="l9935" style="background-color: #ffcccc">!</a>
  9936) <a name="l9936" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9937) <a name="l9937" style="background-color: #ffcccc">!</a>
  9938) <a name="l9938" style="background-color: #ffcccc">!  M      - INTEGER.</a>
  9939) <a name="l9939" style="background-color: #ffcccc">!           On entry,  M  specifies  the number  of rows  of the  matrix</a>
  9940) <a name="l9940" style="background-color: #ffcccc">!           op( A )  and of the  matrix  C.  M  must  be at least  zero.</a>
  9941) <a name="l9941" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9942) <a name="l9942" style="background-color: #ffcccc">!</a>
  9943) <a name="l9943" style="background-color: #ffcccc">!  N      - INTEGER.</a>
  9944) <a name="l9944" style="background-color: #ffcccc">!           On entry,  N  specifies the number  of columns of the matrix</a>
  9945) <a name="l9945" style="background-color: #ffcccc">!           op( B ) and the number of columns of the matrix C. N must be</a>
  9946) <a name="l9946" style="background-color: #ffcccc">!           at least zero.</a>
  9947) <a name="l9947" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9948) <a name="l9948" style="background-color: #ffcccc">!</a>
  9949) <a name="l9949" style="background-color: #ffcccc">!  K      - INTEGER.</a>
  9950) <a name="l9950" style="background-color: #ffcccc">!           On entry,  K  specifies  the number of columns of the matrix</a>
  9951) <a name="l9951" style="background-color: #ffcccc">!           op( A ) and the number of rows of the matrix op( B ). K must</a>
  9952) <a name="l9952" style="background-color: #ffcccc">!           be at least  zero.</a>
  9953) <a name="l9953" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9954) <a name="l9954" style="background-color: #ffcccc">!</a>
  9955) <a name="l9955" style="background-color: #ffcccc">!  ALPHA  - REAL            .</a>
  9956) <a name="l9956" style="background-color: #ffcccc">!           On entry, ALPHA specifies the scalar alpha.</a>
  9957) <a name="l9957" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9958) <a name="l9958" style="background-color: #ffcccc">!</a>
  9959) <a name="l9959" style="background-color: #ffcccc">!  A      - REAL             array of DIMENSION ( LDA, ka ), where ka is</a>
  9960) <a name="l9960" style="background-color: #ffcccc">!           k  when  TRANSA = 'N' or 'n',  and is  m  otherwise.</a>
  9961) <a name="l9961" style="background-color: #ffcccc">!           Before entry with  TRANSA = 'N' or 'n',  the leading  m by k</a>
  9962) <a name="l9962" style="background-color: #ffcccc">!           part of the array  A  must contain the matrix  A,  otherwise</a>
  9963) <a name="l9963" style="background-color: #ffcccc">!           the leading  k by m  part of the array  A  must contain  the</a>
  9964) <a name="l9964" style="background-color: #ffcccc">!           matrix A.</a>
  9965) <a name="l9965" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9966) <a name="l9966" style="background-color: #ffcccc">!</a>
  9967) <a name="l9967" style="background-color: #ffcccc">!  LDA    - INTEGER.</a>
  9968) <a name="l9968" style="background-color: #ffcccc">!           On entry, LDA specifies the first dimension of A as declared</a>
  9969) <a name="l9969" style="background-color: #ffcccc">!           in the calling (sub) program. When  TRANSA = 'N' or 'n' then</a>
  9970) <a name="l9970" style="background-color: #ffcccc">!           LDA must be at least  max( 1, m ), otherwise  LDA must be at</a>
  9971) <a name="l9971" style="background-color: #ffcccc">!           least  max( 1, k ).</a>
  9972) <a name="l9972" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9973) <a name="l9973" style="background-color: #ffcccc">!</a>
  9974) <a name="l9974" style="background-color: #ffcccc">!  B      - REAL             array of DIMENSION ( LDB, kb ), where kb is</a>
  9975) <a name="l9975" style="background-color: #ffcccc">!           n  when  TRANSB = 'N' or 'n',  and is  k  otherwise.</a>
  9976) <a name="l9976" style="background-color: #ffcccc">!           Before entry with  TRANSB = 'N' or 'n',  the leading  k by n</a>
  9977) <a name="l9977" style="background-color: #ffcccc">!           part of the array  B  must contain the matrix  B,  otherwise</a>
  9978) <a name="l9978" style="background-color: #ffcccc">!           the leading  n by k  part of the array  B  must contain  the</a>
  9979) <a name="l9979" style="background-color: #ffcccc">!           matrix B.</a>
  9980) <a name="l9980" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9981) <a name="l9981" style="background-color: #ffcccc">!</a>
  9982) <a name="l9982" style="background-color: #ffcccc">!  LDB    - INTEGER.</a>
  9983) <a name="l9983" style="background-color: #ffcccc">!           On entry, LDB specifies the first dimension of B as declared</a>
  9984) <a name="l9984" style="background-color: #ffcccc">!           in the calling (sub) program. When  TRANSB = 'N' or 'n' then</a>
  9985) <a name="l9985" style="background-color: #ffcccc">!           LDB must be at least  max( 1, k ), otherwise  LDB must be at</a>
  9986) <a name="l9986" style="background-color: #ffcccc">!           least  max( 1, n ).</a>
  9987) <a name="l9987" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9988) <a name="l9988" style="background-color: #ffcccc">!</a>
  9989) <a name="l9989" style="background-color: #ffcccc">!  BETA   - REAL            .</a>
  9990) <a name="l9990" style="background-color: #ffcccc">!           On entry,  BETA  specifies the scalar  beta.  When  BETA  is</a>
  9991) <a name="l9991" style="background-color: #ffcccc">!           supplied as zero then C need not be set on input.</a>
  9992) <a name="l9992" style="background-color: #ffcccc">!           Unchanged on exit.</a>
  9993) <a name="l9993" style="background-color: #ffcccc">!</a>
  9994) <a name="l9994" style="background-color: #ffcccc">!  C      - REAL             array of DIMENSION ( LDC, n ).</a>
  9995) <a name="l9995" style="background-color: #ffcccc">!           Before entry, the leading  m by n  part of the array  C must</a>
  9996) <a name="l9996" style="background-color: #ffcccc">!           contain the matrix  C,  except when  beta  is zero, in which</a>
  9997) <a name="l9997" style="background-color: #ffcccc">!           case C need not be set on entry.</a>
  9998) <a name="l9998" style="background-color: #ffcccc">!           On exit, the array  C  is overwritten by the  m by n  matrix</a>
  9999) <a name="l9999" style="background-color: #ffcccc">!           ( alpha*op( A )*op( B ) + beta*C ).</a>
 10000) <a name="l10000" style="background-color: #ffcccc">!</a>
 10001) <a name="l10001" style="background-color: #ffcccc">!  LDC    - INTEGER.</a>
 10002) <a name="l10002" style="background-color: #ffcccc">!           On entry, LDC specifies the first dimension of C as declared</a>
 10003) <a name="l10003" style="background-color: #ffcccc">!           in  the  calling  (sub)  program.   LDC  must  be  at  least</a>
 10004) <a name="l10004" style="background-color: #ffcccc">!           max( 1, m ).</a>
 10005) <a name="l10005" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10006) <a name="l10006" style="background-color: #ffcccc">!</a>
 10007) <a name="l10007" style="background-color: #ffcccc">!</a>
 10008) <a name="l10008" style="background-color: #ffcccc">!  Level 3 Blas routine.</a>
 10009) <a name="l10009" style="background-color: #ffcccc">!</a>
 10010) <a name="l10010" style="background-color: #ffcccc">!  -- Written on 8-February-1989.</a>
 10011) <a name="l10011" style="background-color: #ffcccc">!     Jack Dongarra, Argonne National Laboratory.</a>
 10012) <a name="l10012" style="background-color: #ffcccc">!     Iain Duff, AERE Harwell.</a>
 10013) <a name="l10013" style="background-color: #ffcccc">!     Jeremy Du Croz, Numerical Algorithms Group Ltd.</a>
 10014) <a name="l10014" style="background-color: #ffcccc">!     Sven Hammarling, Numerical Algorithms Group Ltd.</a>
 10015) <a name="l10015" style="background-color: #ffcccc">!</a>
 10016) <a name="l10016" style="background-color: #ffcccc">!</a>
 10017) <a name="l10017" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
 10018) <a name="l10018" style="background-color: #ffcccc">      LOGICAL            NOTA, NOTB</a>
 10019) <a name="l10019" style="background-color: #ffcccc">      INTEGER            I, INFO, J, L, NCOLA, NROWA, NROWB</a>
 10020) <a name="l10020" style="background-color: #ffcccc">      REAL(r8)               TEMP</a>
 10021) <a name="l10021" style="background-color: #ffcccc">!     .. Parameters ..</a>
 10022) <a name="l10022" style="background-color: #ffcccc">      REAL(r8)               ONE         , ZERO</a>
 10023) <a name="l10023" style="background-color: #ffcccc">      PARAMETER        ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
 10024) <a name="l10024" style="background-color: #ffcccc">!     ..</a>
 10025) <a name="l10025" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
 10026) <a name="l10026" style="background-color: #ffcccc">!</a>
 10027) <a name="l10027" style="background-color: #ffcccc">!     Set  NOTA  and  NOTB  as  true if  A  and  B  respectively are not</a>
 10028) <a name="l10028" style="background-color: #ffcccc">!     transposed and set  NROWA, NCOLA and  NROWB  as the number of rows</a>
 10029) <a name="l10029" style="background-color: #ffcccc">!     and  columns of  A  and the  number of  rows  of  B  respectively.</a>
 10030) <a name="l10030" style="background-color: #ffcccc">!</a>
 10031) <a name="l10031" style="background-color: #ffcccc">      NOTA  = LSAME( TRANSA, 'N' )</a>
 10032) <a name="l10032" style="background-color: #ffcccc">      NOTB  = LSAME( TRANSB, 'N' )</a>
 10033) <a name="l10033" style="background-color: #ffcccc">      IF( NOTA )THEN</a>
 10034) <a name="l10034" style="background-color: #ffcccc">         NROWA = M</a>
 10035) <a name="l10035" style="background-color: #ffcccc">         NCOLA = K</a>
 10036) <a name="l10036" style="background-color: #ffcccc">      ELSE</a>
 10037) <a name="l10037" style="background-color: #ffcccc">         NROWA = K</a>
 10038) <a name="l10038" style="background-color: #ffcccc">         NCOLA = M</a>
 10039) <a name="l10039" style="background-color: #ffcccc">      END IF</a>
 10040) <a name="l10040" style="background-color: #ffcccc">      IF( NOTB )THEN</a>
 10041) <a name="l10041" style="background-color: #ffcccc">         NROWB = K</a>
 10042) <a name="l10042" style="background-color: #ffcccc">      ELSE</a>
 10043) <a name="l10043" style="background-color: #ffcccc">         NROWB = N</a>
 10044) <a name="l10044" style="background-color: #ffcccc">      END IF</a>
 10045) <a name="l10045" style="background-color: #ffcccc">!</a>
 10046) <a name="l10046" style="background-color: #ffcccc">!     Test the input parameters.</a>
 10047) <a name="l10047" style="background-color: #ffcccc">!</a>
 10048) <a name="l10048" style="background-color: #ffcccc">      INFO = 0</a>
 10049) <a name="l10049" style="background-color: #ffcccc">      IF(      ( .NOT.NOTA                 ).AND. &amp;</a>
 10050) <a name="l10050" style="background-color: #ffcccc">               ( .NOT.LSAME( TRANSA, 'C' ) ).AND. &amp;</a>
 10051) <a name="l10051" style="background-color: #ffcccc">               ( .NOT.LSAME( TRANSA, 'T' ) )      )THEN</a>
 10052) <a name="l10052" style="background-color: #ffcccc">         INFO = 1</a>
 10053) <a name="l10053" style="background-color: #ffcccc">      ELSE IF( ( .NOT.NOTB                 ).AND. &amp;</a>
 10054) <a name="l10054" style="background-color: #ffcccc">               ( .NOT.LSAME( TRANSB, 'C' ) ).AND. &amp;</a>
 10055) <a name="l10055" style="background-color: #ffcccc">               ( .NOT.LSAME( TRANSB, 'T' ) )      )THEN</a>
 10056) <a name="l10056" style="background-color: #ffcccc">         INFO = 2</a>
 10057) <a name="l10057" style="background-color: #ffcccc">      ELSE IF( M  .LT.0               )THEN</a>
 10058) <a name="l10058" style="background-color: #ffcccc">         INFO = 3</a>
 10059) <a name="l10059" style="background-color: #ffcccc">      ELSE IF( N  .LT.0               )THEN</a>
 10060) <a name="l10060" style="background-color: #ffcccc">         INFO = 4</a>
 10061) <a name="l10061" style="background-color: #ffcccc">      ELSE IF( K  .LT.0               )THEN</a>
 10062) <a name="l10062" style="background-color: #ffcccc">         INFO = 5</a>
 10063) <a name="l10063" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, NROWA ) )THEN</a>
 10064) <a name="l10064" style="background-color: #ffcccc">         INFO = 8</a>
 10065) <a name="l10065" style="background-color: #ffcccc">      ELSE IF( LDB.LT.MAX( 1, NROWB ) )THEN</a>
 10066) <a name="l10066" style="background-color: #ffcccc">         INFO = 10</a>
 10067) <a name="l10067" style="background-color: #ffcccc">      ELSE IF( LDC.LT.MAX( 1, M     ) )THEN</a>
 10068) <a name="l10068" style="background-color: #ffcccc">         INFO = 13</a>
 10069) <a name="l10069" style="background-color: #ffcccc">      END IF</a>
 10070) <a name="l10070" style="background-color: #ffcccc">      IF( INFO.NE.0 )THEN</a>
 10071) <a name="l10071" style="background-color: #ffcccc">         CALL XERBLA( 'SGEMM ', INFO )</a>
 10072) <a name="l10072" style="background-color: #ffcccc">         RETURN</a>
 10073) <a name="l10073" style="background-color: #ffcccc">      END IF</a>
 10074) <a name="l10074" style="background-color: #ffcccc">!</a>
 10075) <a name="l10075" style="background-color: #ffcccc">!     Quick return if possible.</a>
 10076) <a name="l10076" style="background-color: #ffcccc">!</a>
 10077) <a name="l10077" style="background-color: #ffcccc">      IF( ( M.EQ.0 ).OR.( N.EQ.0 ).OR. &amp;</a>
 10078) <a name="l10078" style="background-color: #ffcccc">          ( ( ( ALPHA.EQ.ZERO ).OR.( K.EQ.0 ) ).AND.( BETA.EQ.ONE ) ) ) &amp;</a>
 10079) <a name="l10079" style="background-color: #ffcccc">         RETURN</a>
 10080) <a name="l10080" style="background-color: #ffcccc">!</a>
 10081) <a name="l10081" style="background-color: #ffcccc">!     And if  alpha.eq.zero.</a>
 10082) <a name="l10082" style="background-color: #ffcccc">!</a>
 10083) <a name="l10083" style="background-color: #ffcccc">      IF( ALPHA.EQ.ZERO )THEN</a>
 10084) <a name="l10084" style="background-color: #ffcccc">         IF( BETA.EQ.ZERO )THEN</a>
 10085) <a name="l10085" style="background-color: #ffcccc">            DO 20, J = 1, N</a>
 10086) <a name="l10086" style="background-color: #ffcccc">               DO 10, I = 1, M</a>
 10087) <a name="l10087" style="background-color: #ffcccc">                  C( I, J ) = ZERO</a>
 10088) <a name="l10088" style="background-color: #ffcccc">   10          CONTINUE</a>
 10089) <a name="l10089" style="background-color: #ffcccc">   20       CONTINUE</a>
 10090) <a name="l10090" style="background-color: #ffcccc">         ELSE</a>
 10091) <a name="l10091" style="background-color: #ffcccc">            DO 40, J = 1, N</a>
 10092) <a name="l10092" style="background-color: #ffcccc">               DO 30, I = 1, M</a>
 10093) <a name="l10093" style="background-color: #ffcccc">                  C( I, J ) = BETA*C( I, J )</a>
 10094) <a name="l10094" style="background-color: #ffcccc">   30          CONTINUE</a>
 10095) <a name="l10095" style="background-color: #ffcccc">   40       CONTINUE</a>
 10096) <a name="l10096" style="background-color: #ffcccc">         END IF</a>
 10097) <a name="l10097" style="background-color: #ffcccc">         RETURN</a>
 10098) <a name="l10098" style="background-color: #ffcccc">      END IF</a>
 10099) <a name="l10099" style="background-color: #ffcccc">!</a>
 10100) <a name="l10100" style="background-color: #ffcccc">!     Start the operations.</a>
 10101) <a name="l10101" style="background-color: #ffcccc">!</a>
 10102) <a name="l10102" style="background-color: #ffcccc">      IF( NOTB )THEN</a>
 10103) <a name="l10103" style="background-color: #ffcccc">         IF( NOTA )THEN</a>
 10104) <a name="l10104" style="background-color: #ffcccc">!</a>
 10105) <a name="l10105" style="background-color: #ffcccc">!           Form  C := alpha*A*B + beta*C.</a>
 10106) <a name="l10106" style="background-color: #ffcccc">!</a>
 10107) <a name="l10107" style="background-color: #ffcccc">            DO 90, J = 1, N</a>
 10108) <a name="l10108" style="background-color: #ffcccc">               IF( BETA.EQ.ZERO )THEN</a>
 10109) <a name="l10109" style="background-color: #ffcccc">                  DO 50, I = 1, M</a>
 10110) <a name="l10110" style="background-color: #ffcccc">                     C( I, J ) = ZERO</a>
 10111) <a name="l10111" style="background-color: #ffcccc">   50             CONTINUE</a>
 10112) <a name="l10112" style="background-color: #ffcccc">               ELSE IF( BETA.NE.ONE )THEN</a>
 10113) <a name="l10113" style="background-color: #ffcccc">                  DO 60, I = 1, M</a>
 10114) <a name="l10114" style="background-color: #ffcccc">                     C( I, J ) = BETA*C( I, J )</a>
 10115) <a name="l10115" style="background-color: #ffcccc">   60             CONTINUE</a>
 10116) <a name="l10116" style="background-color: #ffcccc">               END IF</a>
 10117) <a name="l10117" style="background-color: #ffcccc">               DO 80, L = 1, K</a>
 10118) <a name="l10118" style="background-color: #ffcccc">                  IF( B( L, J ).NE.ZERO )THEN</a>
 10119) <a name="l10119" style="background-color: #ffcccc">                     TEMP = ALPHA*B( L, J )</a>
 10120) <a name="l10120" style="background-color: #ffcccc">                     DO 70, I = 1, M</a>
 10121) <a name="l10121" style="background-color: #ffcccc">                        C( I, J ) = C( I, J ) + TEMP*A( I, L )</a>
 10122) <a name="l10122" style="background-color: #ffcccc">   70                CONTINUE</a>
 10123) <a name="l10123" style="background-color: #ffcccc">                  END IF</a>
 10124) <a name="l10124" style="background-color: #ffcccc">   80          CONTINUE</a>
 10125) <a name="l10125" style="background-color: #ffcccc">   90       CONTINUE</a>
 10126) <a name="l10126" style="background-color: #ffcccc">         ELSE</a>
 10127) <a name="l10127" style="background-color: #ffcccc">!</a>
 10128) <a name="l10128" style="background-color: #ffcccc">!           Form  C := alpha*A'*B + beta*C</a>
 10129) <a name="l10129" style="background-color: #ffcccc">!</a>
 10130) <a name="l10130" style="background-color: #ffcccc">            DO 120, J = 1, N</a>
 10131) <a name="l10131" style="background-color: #ffcccc">               DO 110, I = 1, M</a>
 10132) <a name="l10132" style="background-color: #ffcccc">                  TEMP = ZERO</a>
 10133) <a name="l10133" style="background-color: #ffcccc">                  DO 100, L = 1, K</a>
 10134) <a name="l10134" style="background-color: #ffcccc">                     TEMP = TEMP + A( L, I )*B( L, J )</a>
 10135) <a name="l10135" style="background-color: #ffcccc">  100             CONTINUE</a>
 10136) <a name="l10136" style="background-color: #ffcccc">                  IF( BETA.EQ.ZERO )THEN</a>
 10137) <a name="l10137" style="background-color: #ffcccc">                     C( I, J ) = ALPHA*TEMP</a>
 10138) <a name="l10138" style="background-color: #ffcccc">                  ELSE</a>
 10139) <a name="l10139" style="background-color: #ffcccc">                     C( I, J ) = ALPHA*TEMP + BETA*C( I, J )</a>
 10140) <a name="l10140" style="background-color: #ffcccc">                  END IF</a>
 10141) <a name="l10141" style="background-color: #ffcccc">  110          CONTINUE</a>
 10142) <a name="l10142" style="background-color: #ffcccc">  120       CONTINUE</a>
 10143) <a name="l10143" style="background-color: #ffcccc">         END IF</a>
 10144) <a name="l10144" style="background-color: #ffcccc">      ELSE</a>
 10145) <a name="l10145" style="background-color: #ffcccc">         IF( NOTA )THEN</a>
 10146) <a name="l10146" style="background-color: #ffcccc">!</a>
 10147) <a name="l10147" style="background-color: #ffcccc">!           Form  C := alpha*A*B' + beta*C</a>
 10148) <a name="l10148" style="background-color: #ffcccc">!</a>
 10149) <a name="l10149" style="background-color: #ffcccc">            DO 170, J = 1, N</a>
 10150) <a name="l10150" style="background-color: #ffcccc">               IF( BETA.EQ.ZERO )THEN</a>
 10151) <a name="l10151" style="background-color: #ffcccc">                  DO 130, I = 1, M</a>
 10152) <a name="l10152" style="background-color: #ffcccc">                     C( I, J ) = ZERO</a>
 10153) <a name="l10153" style="background-color: #ffcccc">  130             CONTINUE</a>
 10154) <a name="l10154" style="background-color: #ffcccc">               ELSE IF( BETA.NE.ONE )THEN</a>
 10155) <a name="l10155" style="background-color: #ffcccc">                  DO 140, I = 1, M</a>
 10156) <a name="l10156" style="background-color: #ffcccc">                     C( I, J ) = BETA*C( I, J )</a>
 10157) <a name="l10157" style="background-color: #ffcccc">  140             CONTINUE</a>
 10158) <a name="l10158" style="background-color: #ffcccc">               END IF</a>
 10159) <a name="l10159" style="background-color: #ffcccc">               DO 160, L = 1, K</a>
 10160) <a name="l10160" style="background-color: #ffcccc">                  IF( B( J, L ).NE.ZERO )THEN</a>
 10161) <a name="l10161" style="background-color: #ffcccc">                     TEMP = ALPHA*B( J, L )</a>
 10162) <a name="l10162" style="background-color: #ffcccc">                     DO 150, I = 1, M</a>
 10163) <a name="l10163" style="background-color: #ffcccc">                        C( I, J ) = C( I, J ) + TEMP*A( I, L )</a>
 10164) <a name="l10164" style="background-color: #ffcccc">  150                CONTINUE</a>
 10165) <a name="l10165" style="background-color: #ffcccc">                  END IF</a>
 10166) <a name="l10166" style="background-color: #ffcccc">  160          CONTINUE</a>
 10167) <a name="l10167" style="background-color: #ffcccc">  170       CONTINUE</a>
 10168) <a name="l10168" style="background-color: #ffcccc">         ELSE</a>
 10169) <a name="l10169" style="background-color: #ffcccc">!</a>
 10170) <a name="l10170" style="background-color: #ffcccc">!           Form  C := alpha*A'*B' + beta*C</a>
 10171) <a name="l10171" style="background-color: #ffcccc">!</a>
 10172) <a name="l10172" style="background-color: #ffcccc">            DO 200, J = 1, N</a>
 10173) <a name="l10173" style="background-color: #ffcccc">               DO 190, I = 1, M</a>
 10174) <a name="l10174" style="background-color: #ffcccc">                  TEMP = ZERO</a>
 10175) <a name="l10175" style="background-color: #ffcccc">                  DO 180, L = 1, K</a>
 10176) <a name="l10176" style="background-color: #ffcccc">                     TEMP = TEMP + A( L, I )*B( J, L )</a>
 10177) <a name="l10177" style="background-color: #ffcccc">  180             CONTINUE</a>
 10178) <a name="l10178" style="background-color: #ffcccc">                  IF( BETA.EQ.ZERO )THEN</a>
 10179) <a name="l10179" style="background-color: #ffcccc">                     C( I, J ) = ALPHA*TEMP</a>
 10180) <a name="l10180" style="background-color: #ffcccc">                  ELSE</a>
 10181) <a name="l10181" style="background-color: #ffcccc">                     C( I, J ) = ALPHA*TEMP + BETA*C( I, J )</a>
 10182) <a name="l10182" style="background-color: #ffcccc">                  END IF</a>
 10183) <a name="l10183" style="background-color: #ffcccc">  190          CONTINUE</a>
 10184) <a name="l10184" style="background-color: #ffcccc">  200       CONTINUE</a>
 10185) <a name="l10185" style="background-color: #ffcccc">         END IF</a>
 10186) <a name="l10186" style="background-color: #ffcccc">      END IF</a>
 10187) <a name="l10187" style="background-color: #ffcccc">!</a>
 10188) <a name="l10188" style="background-color: #ffcccc">      RETURN</a>
 10189) <a name="l10189" style="background-color: #ffcccc">!</a>
 10190) <a name="l10190" style="background-color: #ffcccc">!     End of SGEMM .</a>
 10191) <a name="l10191" style="background-color: #ffcccc">!</a>
 10192) <a name="l10192" style="background-color: #ffcccc">      END SUBROUTINE SGEMM</a>
 10193) <a name="l10193" style="background-color: #ffffff"></a>
 10194) <a name="l10194" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
 10195) <a name="l10195" style="background-color: #ffffff"></a>
 10196) <a name="l10196" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">SGEMV ( TRANS, M, N, ALPHA, A, LDA, X, INCX, &amp;</a>
 10197) <a name="l10197" style="background-color: #ffcccc">                         BETA, Y, INCY )</a>
 10198) <a name="l10198" style="background-color: #ffcccc"></a>
 10199) <a name="l10199" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
 10200) <a name="l10200" style="background-color: #ffcccc">      REAL(r8)               ALPHA, BETA</a>
 10201) <a name="l10201" style="background-color: #ffcccc">      INTEGER            INCX, INCY, LDA, M, N</a>
 10202) <a name="l10202" style="background-color: #ffcccc">      CHARACTER*1        TRANS</a>
 10203) <a name="l10203" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
 10204) <a name="l10204" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), X( * ), Y( * )</a>
 10205) <a name="l10205" style="background-color: #ffcccc">!     ..</a>
 10206) <a name="l10206" style="background-color: #ffcccc">!</a>
 10207) <a name="l10207" style="background-color: #ffcccc">!  Purpose</a>
 10208) <a name="l10208" style="background-color: #ffcccc">!  =======</a>
 10209) <a name="l10209" style="background-color: #ffcccc">!</a>
 10210) <a name="l10210" style="background-color: #ffcccc">!  SGEMV  performs one of the matrix-vector operations</a>
 10211) <a name="l10211" style="background-color: #ffcccc">!</a>
 10212) <a name="l10212" style="background-color: #ffcccc">!     y := alpha*A*x + beta*y,   or   y := alpha*A'*x + beta*y,</a>
 10213) <a name="l10213" style="background-color: #ffcccc">!</a>
 10214) <a name="l10214" style="background-color: #ffcccc">!  where alpha and beta are scalars, x and y are vectors and A is an</a>
 10215) <a name="l10215" style="background-color: #ffcccc">!  m by n matrix.</a>
 10216) <a name="l10216" style="background-color: #ffcccc">!</a>
 10217) <a name="l10217" style="background-color: #ffcccc">!  Parameters</a>
 10218) <a name="l10218" style="background-color: #ffcccc">!  ==========</a>
 10219) <a name="l10219" style="background-color: #ffcccc">!</a>
 10220) <a name="l10220" style="background-color: #ffcccc">!  TRANS  - CHARACTER*1.</a>
 10221) <a name="l10221" style="background-color: #ffcccc">!           On entry, TRANS specifies the operation to be performed as</a>
 10222) <a name="l10222" style="background-color: #ffcccc">!           follows:</a>
 10223) <a name="l10223" style="background-color: #ffcccc">!</a>
 10224) <a name="l10224" style="background-color: #ffcccc">!              TRANS = 'N' or 'n'   y := alpha*A*x + beta*y.</a>
 10225) <a name="l10225" style="background-color: #ffcccc">!</a>
 10226) <a name="l10226" style="background-color: #ffcccc">!              TRANS = 'T' or 't'   y := alpha*A'*x + beta*y.</a>
 10227) <a name="l10227" style="background-color: #ffcccc">!</a>
 10228) <a name="l10228" style="background-color: #ffcccc">!              TRANS = 'C' or 'c'   y := alpha*A'*x + beta*y.</a>
 10229) <a name="l10229" style="background-color: #ffcccc">!</a>
 10230) <a name="l10230" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10231) <a name="l10231" style="background-color: #ffcccc">!</a>
 10232) <a name="l10232" style="background-color: #ffcccc">!  M      - INTEGER.</a>
 10233) <a name="l10233" style="background-color: #ffcccc">!           On entry, M specifies the number of rows of the matrix A.</a>
 10234) <a name="l10234" style="background-color: #ffcccc">!           M must be at least zero.</a>
 10235) <a name="l10235" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10236) <a name="l10236" style="background-color: #ffcccc">!</a>
 10237) <a name="l10237" style="background-color: #ffcccc">!  N      - INTEGER.</a>
 10238) <a name="l10238" style="background-color: #ffcccc">!           On entry, N specifies the number of columns of the matrix A.</a>
 10239) <a name="l10239" style="background-color: #ffcccc">!           N must be at least zero.</a>
 10240) <a name="l10240" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10241) <a name="l10241" style="background-color: #ffcccc">!</a>
 10242) <a name="l10242" style="background-color: #ffcccc">!  ALPHA  - REAL            .</a>
 10243) <a name="l10243" style="background-color: #ffcccc">!           On entry, ALPHA specifies the scalar alpha.</a>
 10244) <a name="l10244" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10245) <a name="l10245" style="background-color: #ffcccc">!</a>
 10246) <a name="l10246" style="background-color: #ffcccc">!  A      - REAL             array of DIMENSION ( LDA, n ).</a>
 10247) <a name="l10247" style="background-color: #ffcccc">!           Before entry, the leading m by n part of the array A must</a>
 10248) <a name="l10248" style="background-color: #ffcccc">!           contain the matrix of coefficients.</a>
 10249) <a name="l10249" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10250) <a name="l10250" style="background-color: #ffcccc">!</a>
 10251) <a name="l10251" style="background-color: #ffcccc">!  LDA    - INTEGER.</a>
 10252) <a name="l10252" style="background-color: #ffcccc">!           On entry, LDA specifies the first dimension of A as declared</a>
 10253) <a name="l10253" style="background-color: #ffcccc">!           in the calling (sub) program. LDA must be at least</a>
 10254) <a name="l10254" style="background-color: #ffcccc">!           max( 1, m ).</a>
 10255) <a name="l10255" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10256) <a name="l10256" style="background-color: #ffcccc">!</a>
 10257) <a name="l10257" style="background-color: #ffcccc">!  X      - REAL             array of DIMENSION at least</a>
 10258) <a name="l10258" style="background-color: #ffcccc">!           ( 1 + ( n - 1 )*abs( INCX ) ) when TRANS = 'N' or 'n'</a>
 10259) <a name="l10259" style="background-color: #ffcccc">!           and at least</a>
 10260) <a name="l10260" style="background-color: #ffcccc">!           ( 1 + ( m - 1 )*abs( INCX ) ) otherwise.</a>
 10261) <a name="l10261" style="background-color: #ffcccc">!           Before entry, the incremented array X must contain the</a>
 10262) <a name="l10262" style="background-color: #ffcccc">!           vector x.</a>
 10263) <a name="l10263" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10264) <a name="l10264" style="background-color: #ffcccc">!</a>
 10265) <a name="l10265" style="background-color: #ffcccc">!  INCX   - INTEGER.</a>
 10266) <a name="l10266" style="background-color: #ffcccc">!           On entry, INCX specifies the increment for the elements of</a>
 10267) <a name="l10267" style="background-color: #ffcccc">!           X. INCX must not be zero.</a>
 10268) <a name="l10268" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10269) <a name="l10269" style="background-color: #ffcccc">!</a>
 10270) <a name="l10270" style="background-color: #ffcccc">!  BETA   - REAL            .</a>
 10271) <a name="l10271" style="background-color: #ffcccc">!           On entry, BETA specifies the scalar beta. When BETA is</a>
 10272) <a name="l10272" style="background-color: #ffcccc">!           supplied as zero then Y need not be set on input.</a>
 10273) <a name="l10273" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10274) <a name="l10274" style="background-color: #ffcccc">!</a>
 10275) <a name="l10275" style="background-color: #ffcccc">!  Y      - REAL             array of DIMENSION at least</a>
 10276) <a name="l10276" style="background-color: #ffcccc">!           ( 1 + ( m - 1 )*abs( INCY ) ) when TRANS = 'N' or 'n'</a>
 10277) <a name="l10277" style="background-color: #ffcccc">!           and at least</a>
 10278) <a name="l10278" style="background-color: #ffcccc">!           ( 1 + ( n - 1 )*abs( INCY ) ) otherwise.</a>
 10279) <a name="l10279" style="background-color: #ffcccc">!           Before entry with BETA non-zero, the incremented array Y</a>
 10280) <a name="l10280" style="background-color: #ffcccc">!           must contain the vector y. On exit, Y is overwritten by the</a>
 10281) <a name="l10281" style="background-color: #ffcccc">!           updated vector y.</a>
 10282) <a name="l10282" style="background-color: #ffcccc">!</a>
 10283) <a name="l10283" style="background-color: #ffcccc">!  INCY   - INTEGER.</a>
 10284) <a name="l10284" style="background-color: #ffcccc">!           On entry, INCY specifies the increment for the elements of</a>
 10285) <a name="l10285" style="background-color: #ffcccc">!           Y. INCY must not be zero.</a>
 10286) <a name="l10286" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10287) <a name="l10287" style="background-color: #ffcccc">!</a>
 10288) <a name="l10288" style="background-color: #ffcccc">!</a>
 10289) <a name="l10289" style="background-color: #ffcccc">!  Level 2 Blas routine.</a>
 10290) <a name="l10290" style="background-color: #ffcccc">!</a>
 10291) <a name="l10291" style="background-color: #ffcccc">!  -- Written on 22-October-1986.</a>
 10292) <a name="l10292" style="background-color: #ffcccc">!     Jack Dongarra, Argonne National Lab.</a>
 10293) <a name="l10293" style="background-color: #ffcccc">!     Jeremy Du Croz, Nag Central Office.</a>
 10294) <a name="l10294" style="background-color: #ffcccc">!     Sven Hammarling, Nag Central Office.</a>
 10295) <a name="l10295" style="background-color: #ffcccc">!     Richard Hanson, Sandia National Labs.</a>
 10296) <a name="l10296" style="background-color: #ffcccc">!</a>
 10297) <a name="l10297" style="background-color: #ffcccc">!</a>
 10298) <a name="l10298" style="background-color: #ffcccc">!     .. Parameters ..</a>
 10299) <a name="l10299" style="background-color: #ffcccc">      REAL(r8)               ONE         , ZERO</a>
 10300) <a name="l10300" style="background-color: #ffcccc">      PARAMETER        ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
 10301) <a name="l10301" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
 10302) <a name="l10302" style="background-color: #ffcccc">      REAL(r8)               TEMP</a>
 10303) <a name="l10303" style="background-color: #ffcccc">      INTEGER            I, INFO, IX, IY, J, JX, JY, KX, KY, LENX, LENY</a>
 10304) <a name="l10304" style="background-color: #ffcccc">!     ..</a>
 10305) <a name="l10305" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
 10306) <a name="l10306" style="background-color: #ffcccc">!</a>
 10307) <a name="l10307" style="background-color: #ffcccc">!     Test the input parameters.</a>
 10308) <a name="l10308" style="background-color: #ffcccc">!</a>
 10309) <a name="l10309" style="background-color: #ffcccc">      INFO = 0</a>
 10310) <a name="l10310" style="background-color: #ffcccc">      IF     ( .NOT.LSAME( TRANS, 'N' ).AND. &amp;</a>
 10311) <a name="l10311" style="background-color: #ffcccc">               .NOT.LSAME( TRANS, 'T' ).AND. &amp;</a>
 10312) <a name="l10312" style="background-color: #ffcccc">               .NOT.LSAME( TRANS, 'C' )      )THEN</a>
 10313) <a name="l10313" style="background-color: #ffcccc">         INFO = 1</a>
 10314) <a name="l10314" style="background-color: #ffcccc">      ELSE IF( M.LT.0 )THEN</a>
 10315) <a name="l10315" style="background-color: #ffcccc">         INFO = 2</a>
 10316) <a name="l10316" style="background-color: #ffcccc">      ELSE IF( N.LT.0 )THEN</a>
 10317) <a name="l10317" style="background-color: #ffcccc">         INFO = 3</a>
 10318) <a name="l10318" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, M ) )THEN</a>
 10319) <a name="l10319" style="background-color: #ffcccc">         INFO = 6</a>
 10320) <a name="l10320" style="background-color: #ffcccc">      ELSE IF( INCX.EQ.0 )THEN</a>
 10321) <a name="l10321" style="background-color: #ffcccc">         INFO = 8</a>
 10322) <a name="l10322" style="background-color: #ffcccc">      ELSE IF( INCY.EQ.0 )THEN</a>
 10323) <a name="l10323" style="background-color: #ffcccc">         INFO = 11</a>
 10324) <a name="l10324" style="background-color: #ffcccc">      END IF</a>
 10325) <a name="l10325" style="background-color: #ffcccc">      IF( INFO.NE.0 )THEN</a>
 10326) <a name="l10326" style="background-color: #ffcccc">         CALL XERBLA( 'SGEMV ', INFO )</a>
 10327) <a name="l10327" style="background-color: #ffcccc">         RETURN</a>
 10328) <a name="l10328" style="background-color: #ffcccc">      END IF</a>
 10329) <a name="l10329" style="background-color: #ffcccc">!</a>
 10330) <a name="l10330" style="background-color: #ffcccc">!     Quick return if possible.</a>
 10331) <a name="l10331" style="background-color: #ffcccc">!</a>
 10332) <a name="l10332" style="background-color: #ffcccc">      IF( ( M.EQ.0 ).OR.( N.EQ.0 ).OR. &amp;</a>
 10333) <a name="l10333" style="background-color: #ffcccc">          ( ( ALPHA.EQ.ZERO ).AND.( BETA.EQ.ONE ) ) ) &amp;</a>
 10334) <a name="l10334" style="background-color: #ffcccc">         RETURN</a>
 10335) <a name="l10335" style="background-color: #ffcccc">!</a>
 10336) <a name="l10336" style="background-color: #ffcccc">!     Set  LENX  and  LENY, the lengths of the vectors x and y, and set</a>
 10337) <a name="l10337" style="background-color: #ffcccc">!     up the start points in  X  and  Y.</a>
 10338) <a name="l10338" style="background-color: #ffcccc">!</a>
 10339) <a name="l10339" style="background-color: #ffcccc">      IF( LSAME( TRANS, 'N' ) )THEN</a>
 10340) <a name="l10340" style="background-color: #ffcccc">         LENX = N</a>
 10341) <a name="l10341" style="background-color: #ffcccc">         LENY = M</a>
 10342) <a name="l10342" style="background-color: #ffcccc">      ELSE</a>
 10343) <a name="l10343" style="background-color: #ffcccc">         LENX = M</a>
 10344) <a name="l10344" style="background-color: #ffcccc">         LENY = N</a>
 10345) <a name="l10345" style="background-color: #ffcccc">      END IF</a>
 10346) <a name="l10346" style="background-color: #ffcccc">      IF( INCX.GT.0 )THEN</a>
 10347) <a name="l10347" style="background-color: #ffcccc">         KX = 1</a>
 10348) <a name="l10348" style="background-color: #ffcccc">      ELSE</a>
 10349) <a name="l10349" style="background-color: #ffcccc">         KX = 1 - ( LENX - 1 )*INCX</a>
 10350) <a name="l10350" style="background-color: #ffcccc">      END IF</a>
 10351) <a name="l10351" style="background-color: #ffcccc">      IF( INCY.GT.0 )THEN</a>
 10352) <a name="l10352" style="background-color: #ffcccc">         KY = 1</a>
 10353) <a name="l10353" style="background-color: #ffcccc">      ELSE</a>
 10354) <a name="l10354" style="background-color: #ffcccc">         KY = 1 - ( LENY - 1 )*INCY</a>
 10355) <a name="l10355" style="background-color: #ffcccc">      END IF</a>
 10356) <a name="l10356" style="background-color: #ffcccc">!</a>
 10357) <a name="l10357" style="background-color: #ffcccc">!     Start the operations. In this version the elements of A are</a>
 10358) <a name="l10358" style="background-color: #ffcccc">!     accessed sequentially with one pass through A.</a>
 10359) <a name="l10359" style="background-color: #ffcccc">!</a>
 10360) <a name="l10360" style="background-color: #ffcccc">!     First form  y := beta*y.</a>
 10361) <a name="l10361" style="background-color: #ffcccc">!</a>
 10362) <a name="l10362" style="background-color: #ffcccc">      IF( BETA.NE.ONE )THEN</a>
 10363) <a name="l10363" style="background-color: #ffcccc">         IF( INCY.EQ.1 )THEN</a>
 10364) <a name="l10364" style="background-color: #ffcccc">            IF( BETA.EQ.ZERO )THEN</a>
 10365) <a name="l10365" style="background-color: #ffcccc">               DO 10, I = 1, LENY</a>
 10366) <a name="l10366" style="background-color: #ffcccc">                  Y( I ) = ZERO</a>
 10367) <a name="l10367" style="background-color: #ffcccc">   10          CONTINUE</a>
 10368) <a name="l10368" style="background-color: #ffcccc">            ELSE</a>
 10369) <a name="l10369" style="background-color: #ffcccc">               DO 20, I = 1, LENY</a>
 10370) <a name="l10370" style="background-color: #ffcccc">                  Y( I ) = BETA*Y( I )</a>
 10371) <a name="l10371" style="background-color: #ffcccc">   20          CONTINUE</a>
 10372) <a name="l10372" style="background-color: #ffcccc">            END IF</a>
 10373) <a name="l10373" style="background-color: #ffcccc">         ELSE</a>
 10374) <a name="l10374" style="background-color: #ffcccc">            IY = KY</a>
 10375) <a name="l10375" style="background-color: #ffcccc">            IF( BETA.EQ.ZERO )THEN</a>
 10376) <a name="l10376" style="background-color: #ffcccc">               DO 30, I = 1, LENY</a>
 10377) <a name="l10377" style="background-color: #ffcccc">                  Y( IY ) = ZERO</a>
 10378) <a name="l10378" style="background-color: #ffcccc">                  IY      = IY   + INCY</a>
 10379) <a name="l10379" style="background-color: #ffcccc">   30          CONTINUE</a>
 10380) <a name="l10380" style="background-color: #ffcccc">            ELSE</a>
 10381) <a name="l10381" style="background-color: #ffcccc">               DO 40, I = 1, LENY</a>
 10382) <a name="l10382" style="background-color: #ffcccc">                  Y( IY ) = BETA*Y( IY )</a>
 10383) <a name="l10383" style="background-color: #ffcccc">                  IY      = IY           + INCY</a>
 10384) <a name="l10384" style="background-color: #ffcccc">   40          CONTINUE</a>
 10385) <a name="l10385" style="background-color: #ffcccc">            END IF</a>
 10386) <a name="l10386" style="background-color: #ffcccc">         END IF</a>
 10387) <a name="l10387" style="background-color: #ffcccc">      END IF</a>
 10388) <a name="l10388" style="background-color: #ffcccc">      IF( ALPHA.EQ.ZERO ) &amp;</a>
 10389) <a name="l10389" style="background-color: #ffcccc">         RETURN</a>
 10390) <a name="l10390" style="background-color: #ffcccc">      IF( LSAME( TRANS, 'N' ) )THEN</a>
 10391) <a name="l10391" style="background-color: #ffcccc">!</a>
 10392) <a name="l10392" style="background-color: #ffcccc">!        Form  y := alpha*A*x + y.</a>
 10393) <a name="l10393" style="background-color: #ffcccc">!</a>
 10394) <a name="l10394" style="background-color: #ffcccc">         JX = KX</a>
 10395) <a name="l10395" style="background-color: #ffcccc">         IF( INCY.EQ.1 )THEN</a>
 10396) <a name="l10396" style="background-color: #ffcccc">            DO 60, J = 1, N</a>
 10397) <a name="l10397" style="background-color: #ffcccc">               IF( X( JX ).NE.ZERO )THEN</a>
 10398) <a name="l10398" style="background-color: #ffcccc">                  TEMP = ALPHA*X( JX )</a>
 10399) <a name="l10399" style="background-color: #ffcccc">                  DO 50, I = 1, M</a>
 10400) <a name="l10400" style="background-color: #ffcccc">                     Y( I ) = Y( I ) + TEMP*A( I, J )</a>
 10401) <a name="l10401" style="background-color: #ffcccc">   50             CONTINUE</a>
 10402) <a name="l10402" style="background-color: #ffcccc">               END IF</a>
 10403) <a name="l10403" style="background-color: #ffcccc">               JX = JX + INCX</a>
 10404) <a name="l10404" style="background-color: #ffcccc">   60       CONTINUE</a>
 10405) <a name="l10405" style="background-color: #ffcccc">         ELSE</a>
 10406) <a name="l10406" style="background-color: #ffcccc">            DO 80, J = 1, N</a>
 10407) <a name="l10407" style="background-color: #ffcccc">               IF( X( JX ).NE.ZERO )THEN</a>
 10408) <a name="l10408" style="background-color: #ffcccc">                  TEMP = ALPHA*X( JX )</a>
 10409) <a name="l10409" style="background-color: #ffcccc">                  IY   = KY</a>
 10410) <a name="l10410" style="background-color: #ffcccc">                  DO 70, I = 1, M</a>
 10411) <a name="l10411" style="background-color: #ffcccc">                     Y( IY ) = Y( IY ) + TEMP*A( I, J )</a>
 10412) <a name="l10412" style="background-color: #ffcccc">                     IY      = IY      + INCY</a>
 10413) <a name="l10413" style="background-color: #ffcccc">   70             CONTINUE</a>
 10414) <a name="l10414" style="background-color: #ffcccc">               END IF</a>
 10415) <a name="l10415" style="background-color: #ffcccc">               JX = JX + INCX</a>
 10416) <a name="l10416" style="background-color: #ffcccc">   80       CONTINUE</a>
 10417) <a name="l10417" style="background-color: #ffcccc">         END IF</a>
 10418) <a name="l10418" style="background-color: #ffcccc">      ELSE</a>
 10419) <a name="l10419" style="background-color: #ffcccc">!</a>
 10420) <a name="l10420" style="background-color: #ffcccc">!        Form  y := alpha*A'*x + y.</a>
 10421) <a name="l10421" style="background-color: #ffcccc">!</a>
 10422) <a name="l10422" style="background-color: #ffcccc">         JY = KY</a>
 10423) <a name="l10423" style="background-color: #ffcccc">         IF( INCX.EQ.1 )THEN</a>
 10424) <a name="l10424" style="background-color: #ffcccc">            DO 100, J = 1, N</a>
 10425) <a name="l10425" style="background-color: #ffcccc">               TEMP = ZERO</a>
 10426) <a name="l10426" style="background-color: #ffcccc">               DO 90, I = 1, M</a>
 10427) <a name="l10427" style="background-color: #ffcccc">                  TEMP = TEMP + A( I, J )*X( I )</a>
 10428) <a name="l10428" style="background-color: #ffcccc">   90          CONTINUE</a>
 10429) <a name="l10429" style="background-color: #ffcccc">               Y( JY ) = Y( JY ) + ALPHA*TEMP</a>
 10430) <a name="l10430" style="background-color: #ffcccc">               JY      = JY      + INCY</a>
 10431) <a name="l10431" style="background-color: #ffcccc">  100       CONTINUE</a>
 10432) <a name="l10432" style="background-color: #ffcccc">         ELSE</a>
 10433) <a name="l10433" style="background-color: #ffcccc">            DO 120, J = 1, N</a>
 10434) <a name="l10434" style="background-color: #ffcccc">               TEMP = ZERO</a>
 10435) <a name="l10435" style="background-color: #ffcccc">               IX   = KX</a>
 10436) <a name="l10436" style="background-color: #ffcccc">               DO 110, I = 1, M</a>
 10437) <a name="l10437" style="background-color: #ffcccc">                  TEMP = TEMP + A( I, J )*X( IX )</a>
 10438) <a name="l10438" style="background-color: #ffcccc">                  IX   = IX   + INCX</a>
 10439) <a name="l10439" style="background-color: #ffcccc">  110          CONTINUE</a>
 10440) <a name="l10440" style="background-color: #ffcccc">               Y( JY ) = Y( JY ) + ALPHA*TEMP</a>
 10441) <a name="l10441" style="background-color: #ffcccc">               JY      = JY      + INCY</a>
 10442) <a name="l10442" style="background-color: #ffcccc">  120       CONTINUE</a>
 10443) <a name="l10443" style="background-color: #ffcccc">         END IF</a>
 10444) <a name="l10444" style="background-color: #ffcccc">      END IF</a>
 10445) <a name="l10445" style="background-color: #ffcccc">!</a>
 10446) <a name="l10446" style="background-color: #ffcccc">      RETURN</a>
 10447) <a name="l10447" style="background-color: #ffcccc">!</a>
 10448) <a name="l10448" style="background-color: #ffcccc">!     End of SGEMV .</a>
 10449) <a name="l10449" style="background-color: #ffcccc">!</a>
 10450) <a name="l10450" style="background-color: #ffcccc">      END SUBROUTINE SGEMV</a>
 10451) <a name="l10451" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
 10452) <a name="l10452" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
 10453) <a name="l10453" style="background-color: #ffffff"></a>
 10454) <a name="l10454" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">STRMM ( SIDE, UPLO, TRANSA, DIAG, M, N, ALPHA, A, LDA, &amp;</a>
 10455) <a name="l10455" style="background-color: #ffcccc">                         B, LDB )</a>
 10456) <a name="l10456" style="background-color: #ffcccc"></a>
 10457) <a name="l10457" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
 10458) <a name="l10458" style="background-color: #ffcccc">      CHARACTER*1        SIDE, UPLO, TRANSA, DIAG</a>
 10459) <a name="l10459" style="background-color: #ffcccc">      INTEGER            M, N, LDA, LDB</a>
 10460) <a name="l10460" style="background-color: #ffcccc">      REAL(r8)               ALPHA</a>
 10461) <a name="l10461" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
 10462) <a name="l10462" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), B( LDB, * )</a>
 10463) <a name="l10463" style="background-color: #ffcccc">!     ..</a>
 10464) <a name="l10464" style="background-color: #ffcccc">!</a>
 10465) <a name="l10465" style="background-color: #ffcccc">!  Purpose</a>
 10466) <a name="l10466" style="background-color: #ffcccc">!  =======</a>
 10467) <a name="l10467" style="background-color: #ffcccc">!</a>
 10468) <a name="l10468" style="background-color: #ffcccc">!  STRMM  performs one of the matrix-matrix operations</a>
 10469) <a name="l10469" style="background-color: #ffcccc">!</a>
 10470) <a name="l10470" style="background-color: #ffcccc">!     B := alpha*op( A )*B,   or   B := alpha*B*op( A ),</a>
 10471) <a name="l10471" style="background-color: #ffcccc">!</a>
 10472) <a name="l10472" style="background-color: #ffcccc">!  where  alpha  is a scalar,  B  is an m by n matrix,  A  is a unit, or</a>
 10473) <a name="l10473" style="background-color: #ffcccc">!  non-unit,  upper or lower triangular matrix  and  op( A )  is one  of</a>
 10474) <a name="l10474" style="background-color: #ffcccc">!</a>
 10475) <a name="l10475" style="background-color: #ffcccc">!     op( A ) = A   or   op( A ) = A'.</a>
 10476) <a name="l10476" style="background-color: #ffcccc">!</a>
 10477) <a name="l10477" style="background-color: #ffcccc">!  Parameters</a>
 10478) <a name="l10478" style="background-color: #ffcccc">!  ==========</a>
 10479) <a name="l10479" style="background-color: #ffcccc">!</a>
 10480) <a name="l10480" style="background-color: #ffcccc">!  SIDE   - CHARACTER*1.</a>
 10481) <a name="l10481" style="background-color: #ffcccc">!           On entry,  SIDE specifies whether  op( A ) multiplies B from</a>
 10482) <a name="l10482" style="background-color: #ffcccc">!           the left or right as follows:</a>
 10483) <a name="l10483" style="background-color: #ffcccc">!</a>
 10484) <a name="l10484" style="background-color: #ffcccc">!              SIDE = 'L' or 'l'   B := alpha*op( A )*B.</a>
 10485) <a name="l10485" style="background-color: #ffcccc">!</a>
 10486) <a name="l10486" style="background-color: #ffcccc">!              SIDE = 'R' or 'r'   B := alpha*B*op( A ).</a>
 10487) <a name="l10487" style="background-color: #ffcccc">!</a>
 10488) <a name="l10488" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10489) <a name="l10489" style="background-color: #ffcccc">!</a>
 10490) <a name="l10490" style="background-color: #ffcccc">!  UPLO   - CHARACTER*1.</a>
 10491) <a name="l10491" style="background-color: #ffcccc">!           On entry, UPLO specifies whether the matrix A is an upper or</a>
 10492) <a name="l10492" style="background-color: #ffcccc">!           lower triangular matrix as follows:</a>
 10493) <a name="l10493" style="background-color: #ffcccc">!</a>
 10494) <a name="l10494" style="background-color: #ffcccc">!              UPLO = 'U' or 'u'   A is an upper triangular matrix.</a>
 10495) <a name="l10495" style="background-color: #ffcccc">!</a>
 10496) <a name="l10496" style="background-color: #ffcccc">!              UPLO = 'L' or 'l'   A is a lower triangular matrix.</a>
 10497) <a name="l10497" style="background-color: #ffcccc">!</a>
 10498) <a name="l10498" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10499) <a name="l10499" style="background-color: #ffcccc">!</a>
 10500) <a name="l10500" style="background-color: #ffcccc">!  TRANSA - CHARACTER*1.</a>
 10501) <a name="l10501" style="background-color: #ffcccc">!           On entry, TRANSA specifies the form of op( A ) to be used in</a>
 10502) <a name="l10502" style="background-color: #ffcccc">!           the matrix multiplication as follows:</a>
 10503) <a name="l10503" style="background-color: #ffcccc">!</a>
 10504) <a name="l10504" style="background-color: #ffcccc">!              TRANSA = 'N' or 'n'   op( A ) = A.</a>
 10505) <a name="l10505" style="background-color: #ffcccc">!</a>
 10506) <a name="l10506" style="background-color: #ffcccc">!              TRANSA = 'T' or 't'   op( A ) = A'.</a>
 10507) <a name="l10507" style="background-color: #ffcccc">!</a>
 10508) <a name="l10508" style="background-color: #ffcccc">!              TRANSA = 'C' or 'c'   op( A ) = A'.</a>
 10509) <a name="l10509" style="background-color: #ffcccc">!</a>
 10510) <a name="l10510" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10511) <a name="l10511" style="background-color: #ffcccc">!</a>
 10512) <a name="l10512" style="background-color: #ffcccc">!  DIAG   - CHARACTER*1.</a>
 10513) <a name="l10513" style="background-color: #ffcccc">!           On entry, DIAG specifies whether or not A is unit triangular</a>
 10514) <a name="l10514" style="background-color: #ffcccc">!           as follows:</a>
 10515) <a name="l10515" style="background-color: #ffcccc">!</a>
 10516) <a name="l10516" style="background-color: #ffcccc">!              DIAG = 'U' or 'u'   A is assumed to be unit triangular.</a>
 10517) <a name="l10517" style="background-color: #ffcccc">!</a>
 10518) <a name="l10518" style="background-color: #ffcccc">!              DIAG = 'N' or 'n'   A is not assumed to be unit</a>
 10519) <a name="l10519" style="background-color: #ffcccc">!                                  triangular.</a>
 10520) <a name="l10520" style="background-color: #ffcccc">!</a>
 10521) <a name="l10521" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10522) <a name="l10522" style="background-color: #ffcccc">!</a>
 10523) <a name="l10523" style="background-color: #ffcccc">!  M      - INTEGER.</a>
 10524) <a name="l10524" style="background-color: #ffcccc">!           On entry, M specifies the number of rows of B. M must be at</a>
 10525) <a name="l10525" style="background-color: #ffcccc">!           least zero.</a>
 10526) <a name="l10526" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10527) <a name="l10527" style="background-color: #ffcccc">!</a>
 10528) <a name="l10528" style="background-color: #ffcccc">!  N      - INTEGER.</a>
 10529) <a name="l10529" style="background-color: #ffcccc">!           On entry, N specifies the number of columns of B.  N must be</a>
 10530) <a name="l10530" style="background-color: #ffcccc">!           at least zero.</a>
 10531) <a name="l10531" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10532) <a name="l10532" style="background-color: #ffcccc">!</a>
 10533) <a name="l10533" style="background-color: #ffcccc">!  ALPHA  - REAL            .</a>
 10534) <a name="l10534" style="background-color: #ffcccc">!           On entry,  ALPHA specifies the scalar  alpha. When  alpha is</a>
 10535) <a name="l10535" style="background-color: #ffcccc">!           zero then  A is not referenced and  B need not be set before</a>
 10536) <a name="l10536" style="background-color: #ffcccc">!           entry.</a>
 10537) <a name="l10537" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10538) <a name="l10538" style="background-color: #ffcccc">!</a>
 10539) <a name="l10539" style="background-color: #ffcccc">!  A      - REAL             array of DIMENSION ( LDA, k ), where k is m</a>
 10540) <a name="l10540" style="background-color: #ffcccc">!           when  SIDE = 'L' or 'l'  and is  n  when  SIDE = 'R' or 'r'.</a>
 10541) <a name="l10541" style="background-color: #ffcccc">!           Before entry  with  UPLO = 'U' or 'u',  the  leading  k by k</a>
 10542) <a name="l10542" style="background-color: #ffcccc">!           upper triangular part of the array  A must contain the upper</a>
 10543) <a name="l10543" style="background-color: #ffcccc">!           triangular matrix  and the strictly lower triangular part of</a>
 10544) <a name="l10544" style="background-color: #ffcccc">!           A is not referenced.</a>
 10545) <a name="l10545" style="background-color: #ffcccc">!           Before entry  with  UPLO = 'L' or 'l',  the  leading  k by k</a>
 10546) <a name="l10546" style="background-color: #ffcccc">!           lower triangular part of the array  A must contain the lower</a>
 10547) <a name="l10547" style="background-color: #ffcccc">!           triangular matrix  and the strictly upper triangular part of</a>
 10548) <a name="l10548" style="background-color: #ffcccc">!           A is not referenced.</a>
 10549) <a name="l10549" style="background-color: #ffcccc">!           Note that when  DIAG = 'U' or 'u',  the diagonal elements of</a>
 10550) <a name="l10550" style="background-color: #ffcccc">!           A  are not referenced either,  but are assumed to be  unity.</a>
 10551) <a name="l10551" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10552) <a name="l10552" style="background-color: #ffcccc">!</a>
 10553) <a name="l10553" style="background-color: #ffcccc">!  LDA    - INTEGER.</a>
 10554) <a name="l10554" style="background-color: #ffcccc">!           On entry, LDA specifies the first dimension of A as declared</a>
 10555) <a name="l10555" style="background-color: #ffcccc">!           in the calling (sub) program.  When  SIDE = 'L' or 'l'  then</a>
 10556) <a name="l10556" style="background-color: #ffcccc">!           LDA  must be at least  max( 1, m ),  when  SIDE = 'R' or 'r'</a>
 10557) <a name="l10557" style="background-color: #ffcccc">!           then LDA must be at least max( 1, n ).</a>
 10558) <a name="l10558" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10559) <a name="l10559" style="background-color: #ffcccc">!</a>
 10560) <a name="l10560" style="background-color: #ffcccc">!  B      - REAL             array of DIMENSION ( LDB, n ).</a>
 10561) <a name="l10561" style="background-color: #ffcccc">!           Before entry,  the leading  m by n part of the array  B must</a>
 10562) <a name="l10562" style="background-color: #ffcccc">!           contain the matrix  B,  and  on exit  is overwritten  by the</a>
 10563) <a name="l10563" style="background-color: #ffcccc">!           transformed matrix.</a>
 10564) <a name="l10564" style="background-color: #ffcccc">!</a>
 10565) <a name="l10565" style="background-color: #ffcccc">!  LDB    - INTEGER.</a>
 10566) <a name="l10566" style="background-color: #ffcccc">!           On entry, LDB specifies the first dimension of B as declared</a>
 10567) <a name="l10567" style="background-color: #ffcccc">!           in  the  calling  (sub)  program.   LDB  must  be  at  least</a>
 10568) <a name="l10568" style="background-color: #ffcccc">!           max( 1, m ).</a>
 10569) <a name="l10569" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10570) <a name="l10570" style="background-color: #ffcccc">!</a>
 10571) <a name="l10571" style="background-color: #ffcccc">!</a>
 10572) <a name="l10572" style="background-color: #ffcccc">!  Level 3 Blas routine.</a>
 10573) <a name="l10573" style="background-color: #ffcccc">!</a>
 10574) <a name="l10574" style="background-color: #ffcccc">!  -- Written on 8-February-1989.</a>
 10575) <a name="l10575" style="background-color: #ffcccc">!     Jack Dongarra, Argonne National Laboratory.</a>
 10576) <a name="l10576" style="background-color: #ffcccc">!     Iain Duff, AERE Harwell.</a>
 10577) <a name="l10577" style="background-color: #ffcccc">!     Jeremy Du Croz, Numerical Algorithms Group Ltd.</a>
 10578) <a name="l10578" style="background-color: #ffcccc">!     Sven Hammarling, Numerical Algorithms Group Ltd.</a>
 10579) <a name="l10579" style="background-color: #ffcccc">!</a>
 10580) <a name="l10580" style="background-color: #ffcccc">!</a>
 10581) <a name="l10581" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
 10582) <a name="l10582" style="background-color: #ffcccc">      LOGICAL            LSIDE, NOUNIT, UPPER</a>
 10583) <a name="l10583" style="background-color: #ffcccc">      INTEGER            I, INFO, J, K, NROWA</a>
 10584) <a name="l10584" style="background-color: #ffcccc">      REAL(r8)               TEMP</a>
 10585) <a name="l10585" style="background-color: #ffcccc">!     .. Parameters ..</a>
 10586) <a name="l10586" style="background-color: #ffcccc">      REAL(r8)               ONE         , ZERO</a>
 10587) <a name="l10587" style="background-color: #ffcccc">      PARAMETER        ( ONE = 1.0E+0_r8, ZERO = 0.0E+0_r8 )</a>
 10588) <a name="l10588" style="background-color: #ffcccc">!     ..</a>
 10589) <a name="l10589" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
 10590) <a name="l10590" style="background-color: #ffcccc">!</a>
 10591) <a name="l10591" style="background-color: #ffcccc">!     Test the input parameters.</a>
 10592) <a name="l10592" style="background-color: #ffcccc">!</a>
 10593) <a name="l10593" style="background-color: #ffcccc">      LSIDE  = LSAME( SIDE  , 'L' )</a>
 10594) <a name="l10594" style="background-color: #ffcccc">      IF( LSIDE )THEN</a>
 10595) <a name="l10595" style="background-color: #ffcccc">         NROWA = M</a>
 10596) <a name="l10596" style="background-color: #ffcccc">      ELSE</a>
 10597) <a name="l10597" style="background-color: #ffcccc">         NROWA = N</a>
 10598) <a name="l10598" style="background-color: #ffcccc">      END IF</a>
 10599) <a name="l10599" style="background-color: #ffcccc">      NOUNIT = LSAME( DIAG  , 'N' )</a>
 10600) <a name="l10600" style="background-color: #ffcccc">      UPPER  = LSAME( UPLO  , 'U' )</a>
 10601) <a name="l10601" style="background-color: #ffcccc">!</a>
 10602) <a name="l10602" style="background-color: #ffcccc">      INFO   = 0</a>
 10603) <a name="l10603" style="background-color: #ffcccc">      IF(      ( .NOT.LSIDE                ).AND. &amp;</a>
 10604) <a name="l10604" style="background-color: #ffcccc">               ( .NOT.LSAME( SIDE  , 'R' ) )      )THEN</a>
 10605) <a name="l10605" style="background-color: #ffcccc">         INFO = 1</a>
 10606) <a name="l10606" style="background-color: #ffcccc">      ELSE IF( ( .NOT.UPPER                ).AND. &amp;</a>
 10607) <a name="l10607" style="background-color: #ffcccc">               ( .NOT.LSAME( UPLO  , 'L' ) )      )THEN</a>
 10608) <a name="l10608" style="background-color: #ffcccc">         INFO = 2</a>
 10609) <a name="l10609" style="background-color: #ffcccc">      ELSE IF( ( .NOT.LSAME( TRANSA, 'N' ) ).AND. &amp;</a>
 10610) <a name="l10610" style="background-color: #ffcccc">               ( .NOT.LSAME( TRANSA, 'T' ) ).AND. &amp;</a>
 10611) <a name="l10611" style="background-color: #ffcccc">               ( .NOT.LSAME( TRANSA, 'C' ) )      )THEN</a>
 10612) <a name="l10612" style="background-color: #ffcccc">         INFO = 3</a>
 10613) <a name="l10613" style="background-color: #ffcccc">      ELSE IF( ( .NOT.LSAME( DIAG  , 'U' ) ).AND. &amp;</a>
 10614) <a name="l10614" style="background-color: #ffcccc">               ( .NOT.LSAME( DIAG  , 'N' ) )      )THEN</a>
 10615) <a name="l10615" style="background-color: #ffcccc">         INFO = 4</a>
 10616) <a name="l10616" style="background-color: #ffcccc">      ELSE IF( M  .LT.0               )THEN</a>
 10617) <a name="l10617" style="background-color: #ffcccc">         INFO = 5</a>
 10618) <a name="l10618" style="background-color: #ffcccc">      ELSE IF( N  .LT.0               )THEN</a>
 10619) <a name="l10619" style="background-color: #ffcccc">         INFO = 6</a>
 10620) <a name="l10620" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, NROWA ) )THEN</a>
 10621) <a name="l10621" style="background-color: #ffcccc">         INFO = 9</a>
 10622) <a name="l10622" style="background-color: #ffcccc">      ELSE IF( LDB.LT.MAX( 1, M     ) )THEN</a>
 10623) <a name="l10623" style="background-color: #ffcccc">         INFO = 11</a>
 10624) <a name="l10624" style="background-color: #ffcccc">      END IF</a>
 10625) <a name="l10625" style="background-color: #ffcccc">      IF( INFO.NE.0 )THEN</a>
 10626) <a name="l10626" style="background-color: #ffcccc">         CALL XERBLA( 'STRMM ', INFO )</a>
 10627) <a name="l10627" style="background-color: #ffcccc">         RETURN</a>
 10628) <a name="l10628" style="background-color: #ffcccc">      END IF</a>
 10629) <a name="l10629" style="background-color: #ffcccc">!</a>
 10630) <a name="l10630" style="background-color: #ffcccc">!     Quick return if possible.</a>
 10631) <a name="l10631" style="background-color: #ffcccc">!</a>
 10632) <a name="l10632" style="background-color: #ffcccc">      IF( N.EQ.0 ) &amp;</a>
 10633) <a name="l10633" style="background-color: #ffcccc">         RETURN</a>
 10634) <a name="l10634" style="background-color: #ffcccc">!</a>
 10635) <a name="l10635" style="background-color: #ffcccc">!     And when  alpha.eq.zero.</a>
 10636) <a name="l10636" style="background-color: #ffcccc">!</a>
 10637) <a name="l10637" style="background-color: #ffcccc">      IF( ALPHA.EQ.ZERO )THEN</a>
 10638) <a name="l10638" style="background-color: #ffcccc">         DO 20, J = 1, N</a>
 10639) <a name="l10639" style="background-color: #ffcccc">            DO 10, I = 1, M</a>
 10640) <a name="l10640" style="background-color: #ffcccc">               B( I, J ) = ZERO</a>
 10641) <a name="l10641" style="background-color: #ffcccc">   10       CONTINUE</a>
 10642) <a name="l10642" style="background-color: #ffcccc">   20    CONTINUE</a>
 10643) <a name="l10643" style="background-color: #ffcccc">         RETURN</a>
 10644) <a name="l10644" style="background-color: #ffcccc">      END IF</a>
 10645) <a name="l10645" style="background-color: #ffcccc">!</a>
 10646) <a name="l10646" style="background-color: #ffcccc">!     Start the operations.</a>
 10647) <a name="l10647" style="background-color: #ffcccc">!</a>
 10648) <a name="l10648" style="background-color: #ffcccc">      IF( LSIDE )THEN</a>
 10649) <a name="l10649" style="background-color: #ffcccc">         IF( LSAME( TRANSA, 'N' ) )THEN</a>
 10650) <a name="l10650" style="background-color: #ffcccc">!</a>
 10651) <a name="l10651" style="background-color: #ffcccc">!           Form  B := alpha*A*B.</a>
 10652) <a name="l10652" style="background-color: #ffcccc">!</a>
 10653) <a name="l10653" style="background-color: #ffcccc">            IF( UPPER )THEN</a>
 10654) <a name="l10654" style="background-color: #ffcccc">               DO 50, J = 1, N</a>
 10655) <a name="l10655" style="background-color: #ffcccc">                  DO 40, K = 1, M</a>
 10656) <a name="l10656" style="background-color: #ffcccc">                     IF( B( K, J ).NE.ZERO )THEN</a>
 10657) <a name="l10657" style="background-color: #ffcccc">                        TEMP = ALPHA*B( K, J )</a>
 10658) <a name="l10658" style="background-color: #ffcccc">                        DO 30, I = 1, K - 1</a>
 10659) <a name="l10659" style="background-color: #ffcccc">                           B( I, J ) = B( I, J ) + TEMP*A( I, K )</a>
 10660) <a name="l10660" style="background-color: #ffcccc">   30                   CONTINUE</a>
 10661) <a name="l10661" style="background-color: #ffcccc">                        IF( NOUNIT ) &amp;</a>
 10662) <a name="l10662" style="background-color: #ffcccc">                           TEMP = TEMP*A( K, K )</a>
 10663) <a name="l10663" style="background-color: #ffcccc">                        B( K, J ) = TEMP</a>
 10664) <a name="l10664" style="background-color: #ffcccc">                     END IF</a>
 10665) <a name="l10665" style="background-color: #ffcccc">   40             CONTINUE</a>
 10666) <a name="l10666" style="background-color: #ffcccc">   50          CONTINUE</a>
 10667) <a name="l10667" style="background-color: #ffcccc">            ELSE</a>
 10668) <a name="l10668" style="background-color: #ffcccc">               DO 80, J = 1, N</a>
 10669) <a name="l10669" style="background-color: #ffcccc">                  DO 70 K = M, 1, -1</a>
 10670) <a name="l10670" style="background-color: #ffcccc">                     IF( B( K, J ).NE.ZERO )THEN</a>
 10671) <a name="l10671" style="background-color: #ffcccc">                        TEMP      = ALPHA*B( K, J )</a>
 10672) <a name="l10672" style="background-color: #ffcccc">                        B( K, J ) = TEMP</a>
 10673) <a name="l10673" style="background-color: #ffcccc">                        IF( NOUNIT ) &amp;</a>
 10674) <a name="l10674" style="background-color: #ffcccc">                           B( K, J ) = B( K, J )*A( K, K )</a>
 10675) <a name="l10675" style="background-color: #ffcccc">                        DO 60, I = K + 1, M</a>
 10676) <a name="l10676" style="background-color: #ffcccc">                           B( I, J ) = B( I, J ) + TEMP*A( I, K )</a>
 10677) <a name="l10677" style="background-color: #ffcccc">   60                   CONTINUE</a>
 10678) <a name="l10678" style="background-color: #ffcccc">                     END IF</a>
 10679) <a name="l10679" style="background-color: #ffcccc">   70             CONTINUE</a>
 10680) <a name="l10680" style="background-color: #ffcccc">   80          CONTINUE</a>
 10681) <a name="l10681" style="background-color: #ffcccc">            END IF</a>
 10682) <a name="l10682" style="background-color: #ffcccc">         ELSE</a>
 10683) <a name="l10683" style="background-color: #ffcccc">!</a>
 10684) <a name="l10684" style="background-color: #ffcccc">!           Form  B := alpha*A'*B.</a>
 10685) <a name="l10685" style="background-color: #ffcccc">!</a>
 10686) <a name="l10686" style="background-color: #ffcccc">            IF( UPPER )THEN</a>
 10687) <a name="l10687" style="background-color: #ffcccc">               DO 110, J = 1, N</a>
 10688) <a name="l10688" style="background-color: #ffcccc">                  DO 100, I = M, 1, -1</a>
 10689) <a name="l10689" style="background-color: #ffcccc">                     TEMP = B( I, J )</a>
 10690) <a name="l10690" style="background-color: #ffcccc">                     IF( NOUNIT ) &amp;</a>
 10691) <a name="l10691" style="background-color: #ffcccc">                        TEMP = TEMP*A( I, I )</a>
 10692) <a name="l10692" style="background-color: #ffcccc">                     DO 90, K = 1, I - 1</a>
 10693) <a name="l10693" style="background-color: #ffcccc">                        TEMP = TEMP + A( K, I )*B( K, J )</a>
 10694) <a name="l10694" style="background-color: #ffcccc">   90                CONTINUE</a>
 10695) <a name="l10695" style="background-color: #ffcccc">                     B( I, J ) = ALPHA*TEMP</a>
 10696) <a name="l10696" style="background-color: #ffcccc">  100             CONTINUE</a>
 10697) <a name="l10697" style="background-color: #ffcccc">  110          CONTINUE</a>
 10698) <a name="l10698" style="background-color: #ffcccc">            ELSE</a>
 10699) <a name="l10699" style="background-color: #ffcccc">               DO 140, J = 1, N</a>
 10700) <a name="l10700" style="background-color: #ffcccc">                  DO 130, I = 1, M</a>
 10701) <a name="l10701" style="background-color: #ffcccc">                     TEMP = B( I, J )</a>
 10702) <a name="l10702" style="background-color: #ffcccc">                     IF( NOUNIT ) &amp;</a>
 10703) <a name="l10703" style="background-color: #ffcccc">                        TEMP = TEMP*A( I, I )</a>
 10704) <a name="l10704" style="background-color: #ffcccc">                     DO 120, K = I + 1, M</a>
 10705) <a name="l10705" style="background-color: #ffcccc">                        TEMP = TEMP + A( K, I )*B( K, J )</a>
 10706) <a name="l10706" style="background-color: #ffcccc">  120                CONTINUE</a>
 10707) <a name="l10707" style="background-color: #ffcccc">                     B( I, J ) = ALPHA*TEMP</a>
 10708) <a name="l10708" style="background-color: #ffcccc">  130             CONTINUE</a>
 10709) <a name="l10709" style="background-color: #ffcccc">  140          CONTINUE</a>
 10710) <a name="l10710" style="background-color: #ffcccc">            END IF</a>
 10711) <a name="l10711" style="background-color: #ffcccc">         END IF</a>
 10712) <a name="l10712" style="background-color: #ffcccc">      ELSE</a>
 10713) <a name="l10713" style="background-color: #ffcccc">         IF( LSAME( TRANSA, 'N' ) )THEN</a>
 10714) <a name="l10714" style="background-color: #ffcccc">!</a>
 10715) <a name="l10715" style="background-color: #ffcccc">!           Form  B := alpha*B*A.</a>
 10716) <a name="l10716" style="background-color: #ffcccc">!</a>
 10717) <a name="l10717" style="background-color: #ffcccc">            IF( UPPER )THEN</a>
 10718) <a name="l10718" style="background-color: #ffcccc">               DO 180, J = N, 1, -1</a>
 10719) <a name="l10719" style="background-color: #ffcccc">                  TEMP = ALPHA</a>
 10720) <a name="l10720" style="background-color: #ffcccc">                  IF( NOUNIT ) &amp;</a>
 10721) <a name="l10721" style="background-color: #ffcccc">                     TEMP = TEMP*A( J, J )</a>
 10722) <a name="l10722" style="background-color: #ffcccc">                  DO 150, I = 1, M</a>
 10723) <a name="l10723" style="background-color: #ffcccc">                     B( I, J ) = TEMP*B( I, J )</a>
 10724) <a name="l10724" style="background-color: #ffcccc">  150             CONTINUE</a>
 10725) <a name="l10725" style="background-color: #ffcccc">                  DO 170, K = 1, J - 1</a>
 10726) <a name="l10726" style="background-color: #ffcccc">                     IF( A( K, J ).NE.ZERO )THEN</a>
 10727) <a name="l10727" style="background-color: #ffcccc">                        TEMP = ALPHA*A( K, J )</a>
 10728) <a name="l10728" style="background-color: #ffcccc">                        DO 160, I = 1, M</a>
 10729) <a name="l10729" style="background-color: #ffcccc">                           B( I, J ) = B( I, J ) + TEMP*B( I, K )</a>
 10730) <a name="l10730" style="background-color: #ffcccc">  160                   CONTINUE</a>
 10731) <a name="l10731" style="background-color: #ffcccc">                     END IF</a>
 10732) <a name="l10732" style="background-color: #ffcccc">  170             CONTINUE</a>
 10733) <a name="l10733" style="background-color: #ffcccc">  180          CONTINUE</a>
 10734) <a name="l10734" style="background-color: #ffcccc">            ELSE</a>
 10735) <a name="l10735" style="background-color: #ffcccc">               DO 220, J = 1, N</a>
 10736) <a name="l10736" style="background-color: #ffcccc">                  TEMP = ALPHA</a>
 10737) <a name="l10737" style="background-color: #ffcccc">                  IF( NOUNIT ) &amp;</a>
 10738) <a name="l10738" style="background-color: #ffcccc">                     TEMP = TEMP*A( J, J )</a>
 10739) <a name="l10739" style="background-color: #ffcccc">                  DO 190, I = 1, M</a>
 10740) <a name="l10740" style="background-color: #ffcccc">                     B( I, J ) = TEMP*B( I, J )</a>
 10741) <a name="l10741" style="background-color: #ffcccc">  190             CONTINUE</a>
 10742) <a name="l10742" style="background-color: #ffcccc">                  DO 210, K = J + 1, N</a>
 10743) <a name="l10743" style="background-color: #ffcccc">                     IF( A( K, J ).NE.ZERO )THEN</a>
 10744) <a name="l10744" style="background-color: #ffcccc">                        TEMP = ALPHA*A( K, J )</a>
 10745) <a name="l10745" style="background-color: #ffcccc">                        DO 200, I = 1, M</a>
 10746) <a name="l10746" style="background-color: #ffcccc">                           B( I, J ) = B( I, J ) + TEMP*B( I, K )</a>
 10747) <a name="l10747" style="background-color: #ffcccc">  200                   CONTINUE</a>
 10748) <a name="l10748" style="background-color: #ffcccc">                     END IF</a>
 10749) <a name="l10749" style="background-color: #ffcccc">  210             CONTINUE</a>
 10750) <a name="l10750" style="background-color: #ffcccc">  220          CONTINUE</a>
 10751) <a name="l10751" style="background-color: #ffcccc">            END IF</a>
 10752) <a name="l10752" style="background-color: #ffcccc">         ELSE</a>
 10753) <a name="l10753" style="background-color: #ffcccc">!</a>
 10754) <a name="l10754" style="background-color: #ffcccc">!           Form  B := alpha*B*A'.</a>
 10755) <a name="l10755" style="background-color: #ffcccc">!</a>
 10756) <a name="l10756" style="background-color: #ffcccc">            IF( UPPER )THEN</a>
 10757) <a name="l10757" style="background-color: #ffcccc">               DO 260, K = 1, N</a>
 10758) <a name="l10758" style="background-color: #ffcccc">                  DO 240, J = 1, K - 1</a>
 10759) <a name="l10759" style="background-color: #ffcccc">                     IF( A( J, K ).NE.ZERO )THEN</a>
 10760) <a name="l10760" style="background-color: #ffcccc">                        TEMP = ALPHA*A( J, K )</a>
 10761) <a name="l10761" style="background-color: #ffcccc">                        DO 230, I = 1, M</a>
 10762) <a name="l10762" style="background-color: #ffcccc">                           B( I, J ) = B( I, J ) + TEMP*B( I, K )</a>
 10763) <a name="l10763" style="background-color: #ffcccc">  230                   CONTINUE</a>
 10764) <a name="l10764" style="background-color: #ffcccc">                     END IF</a>
 10765) <a name="l10765" style="background-color: #ffcccc">  240             CONTINUE</a>
 10766) <a name="l10766" style="background-color: #ffcccc">                  TEMP = ALPHA</a>
 10767) <a name="l10767" style="background-color: #ffcccc">                  IF( NOUNIT ) &amp;</a>
 10768) <a name="l10768" style="background-color: #ffcccc">                     TEMP = TEMP*A( K, K )</a>
 10769) <a name="l10769" style="background-color: #ffcccc">                  IF( TEMP.NE.ONE )THEN</a>
 10770) <a name="l10770" style="background-color: #ffcccc">                     DO 250, I = 1, M</a>
 10771) <a name="l10771" style="background-color: #ffcccc">                        B( I, K ) = TEMP*B( I, K )</a>
 10772) <a name="l10772" style="background-color: #ffcccc">  250                CONTINUE</a>
 10773) <a name="l10773" style="background-color: #ffcccc">                  END IF</a>
 10774) <a name="l10774" style="background-color: #ffcccc">  260          CONTINUE</a>
 10775) <a name="l10775" style="background-color: #ffcccc">            ELSE</a>
 10776) <a name="l10776" style="background-color: #ffcccc">               DO 300, K = N, 1, -1</a>
 10777) <a name="l10777" style="background-color: #ffcccc">                  DO 280, J = K + 1, N</a>
 10778) <a name="l10778" style="background-color: #ffcccc">                     IF( A( J, K ).NE.ZERO )THEN</a>
 10779) <a name="l10779" style="background-color: #ffcccc">                        TEMP = ALPHA*A( J, K )</a>
 10780) <a name="l10780" style="background-color: #ffcccc">                        DO 270, I = 1, M</a>
 10781) <a name="l10781" style="background-color: #ffcccc">                           B( I, J ) = B( I, J ) + TEMP*B( I, K )</a>
 10782) <a name="l10782" style="background-color: #ffcccc">  270                   CONTINUE</a>
 10783) <a name="l10783" style="background-color: #ffcccc">                     END IF</a>
 10784) <a name="l10784" style="background-color: #ffcccc">  280             CONTINUE</a>
 10785) <a name="l10785" style="background-color: #ffcccc">                  TEMP = ALPHA</a>
 10786) <a name="l10786" style="background-color: #ffcccc">                  IF( NOUNIT ) &amp;</a>
 10787) <a name="l10787" style="background-color: #ffcccc">                     TEMP = TEMP*A( K, K )</a>
 10788) <a name="l10788" style="background-color: #ffcccc">                  IF( TEMP.NE.ONE )THEN</a>
 10789) <a name="l10789" style="background-color: #ffcccc">                     DO 290, I = 1, M</a>
 10790) <a name="l10790" style="background-color: #ffcccc">                        B( I, K ) = TEMP*B( I, K )</a>
 10791) <a name="l10791" style="background-color: #ffcccc">  290                CONTINUE</a>
 10792) <a name="l10792" style="background-color: #ffcccc">                  END IF</a>
 10793) <a name="l10793" style="background-color: #ffcccc">  300          CONTINUE</a>
 10794) <a name="l10794" style="background-color: #ffcccc">            END IF</a>
 10795) <a name="l10795" style="background-color: #ffcccc">         END IF</a>
 10796) <a name="l10796" style="background-color: #ffcccc">      END IF</a>
 10797) <a name="l10797" style="background-color: #ffcccc">!</a>
 10798) <a name="l10798" style="background-color: #ffcccc">      RETURN</a>
 10799) <a name="l10799" style="background-color: #ffcccc">!</a>
 10800) <a name="l10800" style="background-color: #ffcccc">!     End of STRMM .</a>
 10801) <a name="l10801" style="background-color: #ffcccc">!</a>
 10802) <a name="l10802" style="background-color: #ffcccc">      END SUBROUTINE STRMM</a>
 10803) <a name="l10803" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
 10804) <a name="l10804" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
 10805) <a name="l10805" style="background-color: #ffffff"></a>
 10806) <a name="l10806" style="background-color: #ffffff">      SUBROUTINE </a><a style="background-color: #ffcccc">STRMV ( UPLO, TRANS, DIAG, N, A, LDA, X, INCX )</a>
 10807) <a name="l10807" style="background-color: #ffcccc"></a>
 10808) <a name="l10808" style="background-color: #ffcccc">!     .. Scalar Arguments ..</a>
 10809) <a name="l10809" style="background-color: #ffcccc">      INTEGER            INCX, LDA, N</a>
 10810) <a name="l10810" style="background-color: #ffcccc">      CHARACTER*1        DIAG, TRANS, UPLO</a>
 10811) <a name="l10811" style="background-color: #ffcccc">!     .. Array Arguments ..</a>
 10812) <a name="l10812" style="background-color: #ffcccc">      REAL(r8)               A( LDA, * ), X( * )</a>
 10813) <a name="l10813" style="background-color: #ffcccc">!     ..</a>
 10814) <a name="l10814" style="background-color: #ffcccc">!</a>
 10815) <a name="l10815" style="background-color: #ffcccc">!  Purpose</a>
 10816) <a name="l10816" style="background-color: #ffcccc">!  =======</a>
 10817) <a name="l10817" style="background-color: #ffcccc">!</a>
 10818) <a name="l10818" style="background-color: #ffcccc">!  STRMV  performs one of the matrix-vector operations</a>
 10819) <a name="l10819" style="background-color: #ffcccc">!</a>
 10820) <a name="l10820" style="background-color: #ffcccc">!     x := A*x,   or   x := A'*x,</a>
 10821) <a name="l10821" style="background-color: #ffcccc">!</a>
 10822) <a name="l10822" style="background-color: #ffcccc">!  where x is an n element vector and  A is an n by n unit, or non-unit,</a>
 10823) <a name="l10823" style="background-color: #ffcccc">!  upper or lower triangular matrix.</a>
 10824) <a name="l10824" style="background-color: #ffcccc">!</a>
 10825) <a name="l10825" style="background-color: #ffcccc">!  Parameters</a>
 10826) <a name="l10826" style="background-color: #ffcccc">!  ==========</a>
 10827) <a name="l10827" style="background-color: #ffcccc">!</a>
 10828) <a name="l10828" style="background-color: #ffcccc">!  UPLO   - CHARACTER*1.</a>
 10829) <a name="l10829" style="background-color: #ffcccc">!           On entry, UPLO specifies whether the matrix is an upper or</a>
 10830) <a name="l10830" style="background-color: #ffcccc">!           lower triangular matrix as follows:</a>
 10831) <a name="l10831" style="background-color: #ffcccc">!</a>
 10832) <a name="l10832" style="background-color: #ffcccc">!              UPLO = 'U' or 'u'   A is an upper triangular matrix.</a>
 10833) <a name="l10833" style="background-color: #ffcccc">!</a>
 10834) <a name="l10834" style="background-color: #ffcccc">!              UPLO = 'L' or 'l'   A is a lower triangular matrix.</a>
 10835) <a name="l10835" style="background-color: #ffcccc">!</a>
 10836) <a name="l10836" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10837) <a name="l10837" style="background-color: #ffcccc">!</a>
 10838) <a name="l10838" style="background-color: #ffcccc">!  TRANS  - CHARACTER*1.</a>
 10839) <a name="l10839" style="background-color: #ffcccc">!           On entry, TRANS specifies the operation to be performed as</a>
 10840) <a name="l10840" style="background-color: #ffcccc">!           follows:</a>
 10841) <a name="l10841" style="background-color: #ffcccc">!</a>
 10842) <a name="l10842" style="background-color: #ffcccc">!              TRANS = 'N' or 'n'   x := A*x.</a>
 10843) <a name="l10843" style="background-color: #ffcccc">!</a>
 10844) <a name="l10844" style="background-color: #ffcccc">!              TRANS = 'T' or 't'   x := A'*x.</a>
 10845) <a name="l10845" style="background-color: #ffcccc">!</a>
 10846) <a name="l10846" style="background-color: #ffcccc">!              TRANS = 'C' or 'c'   x := A'*x.</a>
 10847) <a name="l10847" style="background-color: #ffcccc">!</a>
 10848) <a name="l10848" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10849) <a name="l10849" style="background-color: #ffcccc">!</a>
 10850) <a name="l10850" style="background-color: #ffcccc">!  DIAG   - CHARACTER*1.</a>
 10851) <a name="l10851" style="background-color: #ffcccc">!           On entry, DIAG specifies whether or not A is unit</a>
 10852) <a name="l10852" style="background-color: #ffcccc">!           triangular as follows:</a>
 10853) <a name="l10853" style="background-color: #ffcccc">!</a>
 10854) <a name="l10854" style="background-color: #ffcccc">!              DIAG = 'U' or 'u'   A is assumed to be unit triangular.</a>
 10855) <a name="l10855" style="background-color: #ffcccc">!</a>
 10856) <a name="l10856" style="background-color: #ffcccc">!              DIAG = 'N' or 'n'   A is not assumed to be unit</a>
 10857) <a name="l10857" style="background-color: #ffcccc">!                                  triangular.</a>
 10858) <a name="l10858" style="background-color: #ffcccc">!</a>
 10859) <a name="l10859" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10860) <a name="l10860" style="background-color: #ffcccc">!</a>
 10861) <a name="l10861" style="background-color: #ffcccc">!  N      - INTEGER.</a>
 10862) <a name="l10862" style="background-color: #ffcccc">!           On entry, N specifies the order of the matrix A.</a>
 10863) <a name="l10863" style="background-color: #ffcccc">!           N must be at least zero.</a>
 10864) <a name="l10864" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10865) <a name="l10865" style="background-color: #ffcccc">!</a>
 10866) <a name="l10866" style="background-color: #ffcccc">!  A      - REAL             array of DIMENSION ( LDA, n ).</a>
 10867) <a name="l10867" style="background-color: #ffcccc">!           Before entry with  UPLO = 'U' or 'u', the leading n by n</a>
 10868) <a name="l10868" style="background-color: #ffcccc">!           upper triangular part of the array A must contain the upper</a>
 10869) <a name="l10869" style="background-color: #ffcccc">!           triangular matrix and the strictly lower triangular part of</a>
 10870) <a name="l10870" style="background-color: #ffcccc">!           A is not referenced.</a>
 10871) <a name="l10871" style="background-color: #ffcccc">!           Before entry with UPLO = 'L' or 'l', the leading n by n</a>
 10872) <a name="l10872" style="background-color: #ffcccc">!           lower triangular part of the array A must contain the lower</a>
 10873) <a name="l10873" style="background-color: #ffcccc">!           triangular matrix and the strictly upper triangular part of</a>
 10874) <a name="l10874" style="background-color: #ffcccc">!           A is not referenced.</a>
 10875) <a name="l10875" style="background-color: #ffcccc">!           Note that when  DIAG = 'U' or 'u', the diagonal elements of</a>
 10876) <a name="l10876" style="background-color: #ffcccc">!           A are not referenced either, but are assumed to be unity.</a>
 10877) <a name="l10877" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10878) <a name="l10878" style="background-color: #ffcccc">!</a>
 10879) <a name="l10879" style="background-color: #ffcccc">!  LDA    - INTEGER.</a>
 10880) <a name="l10880" style="background-color: #ffcccc">!           On entry, LDA specifies the first dimension of A as declared</a>
 10881) <a name="l10881" style="background-color: #ffcccc">!           in the calling (sub) program. LDA must be at least</a>
 10882) <a name="l10882" style="background-color: #ffcccc">!           max( 1, n ).</a>
 10883) <a name="l10883" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10884) <a name="l10884" style="background-color: #ffcccc">!</a>
 10885) <a name="l10885" style="background-color: #ffcccc">!  X      - REAL             array of dimension at least</a>
 10886) <a name="l10886" style="background-color: #ffcccc">!           ( 1 + ( n - 1 )*abs( INCX ) ).</a>
 10887) <a name="l10887" style="background-color: #ffcccc">!           Before entry, the incremented array X must contain the n</a>
 10888) <a name="l10888" style="background-color: #ffcccc">!           element vector x. On exit, X is overwritten with the</a>
 10889) <a name="l10889" style="background-color: #ffcccc">!           tranformed vector x.</a>
 10890) <a name="l10890" style="background-color: #ffcccc">!</a>
 10891) <a name="l10891" style="background-color: #ffcccc">!  INCX   - INTEGER.</a>
 10892) <a name="l10892" style="background-color: #ffcccc">!           On entry, INCX specifies the increment for the elements of</a>
 10893) <a name="l10893" style="background-color: #ffcccc">!           X. INCX must not be zero.</a>
 10894) <a name="l10894" style="background-color: #ffcccc">!           Unchanged on exit.</a>
 10895) <a name="l10895" style="background-color: #ffcccc">!</a>
 10896) <a name="l10896" style="background-color: #ffcccc">!</a>
 10897) <a name="l10897" style="background-color: #ffcccc">!  Level 2 Blas routine.</a>
 10898) <a name="l10898" style="background-color: #ffcccc">!</a>
 10899) <a name="l10899" style="background-color: #ffcccc">!  -- Written on 22-October-1986.</a>
 10900) <a name="l10900" style="background-color: #ffcccc">!     Jack Dongarra, Argonne National Lab.</a>
 10901) <a name="l10901" style="background-color: #ffcccc">!     Jeremy Du Croz, Nag Central Office.</a>
 10902) <a name="l10902" style="background-color: #ffcccc">!     Sven Hammarling, Nag Central Office.</a>
 10903) <a name="l10903" style="background-color: #ffcccc">!     Richard Hanson, Sandia National Labs.</a>
 10904) <a name="l10904" style="background-color: #ffcccc">!</a>
 10905) <a name="l10905" style="background-color: #ffcccc">!</a>
 10906) <a name="l10906" style="background-color: #ffcccc">!     .. Parameters ..</a>
 10907) <a name="l10907" style="background-color: #ffcccc">      REAL(r8)               ZERO</a>
 10908) <a name="l10908" style="background-color: #ffcccc">      PARAMETER        ( ZERO = 0.0E+0_r8 )</a>
 10909) <a name="l10909" style="background-color: #ffcccc">!     .. Local Scalars ..</a>
 10910) <a name="l10910" style="background-color: #ffcccc">      REAL(r8)               TEMP</a>
 10911) <a name="l10911" style="background-color: #ffcccc">      INTEGER            I, INFO, IX, J, JX, KX</a>
 10912) <a name="l10912" style="background-color: #ffcccc">      LOGICAL            NOUNIT</a>
 10913) <a name="l10913" style="background-color: #ffcccc">!     ..</a>
 10914) <a name="l10914" style="background-color: #ffcccc">!     .. Executable Statements ..</a>
 10915) <a name="l10915" style="background-color: #ffcccc">!</a>
 10916) <a name="l10916" style="background-color: #ffcccc">!     Test the input parameters.</a>
 10917) <a name="l10917" style="background-color: #ffcccc">!</a>
 10918) <a name="l10918" style="background-color: #ffcccc">      INFO = 0</a>
 10919) <a name="l10919" style="background-color: #ffcccc">      IF     ( .NOT.LSAME( UPLO , 'U' ).AND. &amp;</a>
 10920) <a name="l10920" style="background-color: #ffcccc">               .NOT.LSAME( UPLO , 'L' )      )THEN</a>
 10921) <a name="l10921" style="background-color: #ffcccc">         INFO = 1</a>
 10922) <a name="l10922" style="background-color: #ffcccc">      ELSE IF( .NOT.LSAME( TRANS, 'N' ).AND. &amp;</a>
 10923) <a name="l10923" style="background-color: #ffcccc">               .NOT.LSAME( TRANS, 'T' ).AND. &amp;</a>
 10924) <a name="l10924" style="background-color: #ffcccc">               .NOT.LSAME( TRANS, 'C' )      )THEN</a>
 10925) <a name="l10925" style="background-color: #ffcccc">         INFO = 2</a>
 10926) <a name="l10926" style="background-color: #ffcccc">      ELSE IF( .NOT.LSAME( DIAG , 'U' ).AND. &amp;</a>
 10927) <a name="l10927" style="background-color: #ffcccc">               .NOT.LSAME( DIAG , 'N' )      )THEN</a>
 10928) <a name="l10928" style="background-color: #ffcccc">         INFO = 3</a>
 10929) <a name="l10929" style="background-color: #ffcccc">      ELSE IF( N.LT.0 )THEN</a>
 10930) <a name="l10930" style="background-color: #ffcccc">         INFO = 4</a>
 10931) <a name="l10931" style="background-color: #ffcccc">      ELSE IF( LDA.LT.MAX( 1, N ) )THEN</a>
 10932) <a name="l10932" style="background-color: #ffcccc">         INFO = 6</a>
 10933) <a name="l10933" style="background-color: #ffcccc">      ELSE IF( INCX.EQ.0 )THEN</a>
 10934) <a name="l10934" style="background-color: #ffcccc">         INFO = 8</a>
 10935) <a name="l10935" style="background-color: #ffcccc">      END IF</a>
 10936) <a name="l10936" style="background-color: #ffcccc">      IF( INFO.NE.0 )THEN</a>
 10937) <a name="l10937" style="background-color: #ffcccc">         CALL XERBLA( 'STRMV ', INFO )</a>
 10938) <a name="l10938" style="background-color: #ffcccc">         RETURN</a>
 10939) <a name="l10939" style="background-color: #ffcccc">      END IF</a>
 10940) <a name="l10940" style="background-color: #ffcccc">!</a>
 10941) <a name="l10941" style="background-color: #ffcccc">!     Quick return if possible.</a>
 10942) <a name="l10942" style="background-color: #ffcccc">!</a>
 10943) <a name="l10943" style="background-color: #ffcccc">      IF( N.EQ.0 ) &amp;</a>
 10944) <a name="l10944" style="background-color: #ffcccc">         RETURN</a>
 10945) <a name="l10945" style="background-color: #ffcccc">!</a>
 10946) <a name="l10946" style="background-color: #ffcccc">      NOUNIT = LSAME( DIAG, 'N' )</a>
 10947) <a name="l10947" style="background-color: #ffcccc">!</a>
 10948) <a name="l10948" style="background-color: #ffcccc">!     Set up the start point in X if the increment is not unity. This</a>
 10949) <a name="l10949" style="background-color: #ffcccc">!     will be  ( N - 1 )*INCX  too small for descending loops.</a>
 10950) <a name="l10950" style="background-color: #ffcccc">!</a>
 10951) <a name="l10951" style="background-color: #ffcccc">      IF( INCX.LE.0 )THEN</a>
 10952) <a name="l10952" style="background-color: #ffcccc">         KX = 1 - ( N - 1 )*INCX</a>
 10953) <a name="l10953" style="background-color: #ffcccc">      ELSE IF( INCX.NE.1 )THEN</a>
 10954) <a name="l10954" style="background-color: #ffcccc">         KX = 1</a>
 10955) <a name="l10955" style="background-color: #ffcccc">      END IF</a>
 10956) <a name="l10956" style="background-color: #ffcccc">!</a>
 10957) <a name="l10957" style="background-color: #ffcccc">!     Start the operations. In this version the elements of A are</a>
 10958) <a name="l10958" style="background-color: #ffcccc">!     accessed sequentially with one pass through A.</a>
 10959) <a name="l10959" style="background-color: #ffcccc">!</a>
 10960) <a name="l10960" style="background-color: #ffcccc">      IF( LSAME( TRANS, 'N' ) )THEN</a>
 10961) <a name="l10961" style="background-color: #ffcccc">!</a>
 10962) <a name="l10962" style="background-color: #ffcccc">!        Form  x := A*x.</a>
 10963) <a name="l10963" style="background-color: #ffcccc">!</a>
 10964) <a name="l10964" style="background-color: #ffcccc">         IF( LSAME( UPLO, 'U' ) )THEN</a>
 10965) <a name="l10965" style="background-color: #ffcccc">            IF( INCX.EQ.1 )THEN</a>
 10966) <a name="l10966" style="background-color: #ffcccc">               DO 20, J = 1, N</a>
 10967) <a name="l10967" style="background-color: #ffcccc">                  IF( X( J ).NE.ZERO )THEN</a>
 10968) <a name="l10968" style="background-color: #ffcccc">                     TEMP = X( J )</a>
 10969) <a name="l10969" style="background-color: #ffcccc">                     DO 10, I = 1, J - 1</a>
 10970) <a name="l10970" style="background-color: #ffcccc">                        X( I ) = X( I ) + TEMP*A( I, J )</a>
 10971) <a name="l10971" style="background-color: #ffcccc">   10                CONTINUE</a>
 10972) <a name="l10972" style="background-color: #ffcccc">                     IF( NOUNIT ) &amp;</a>
 10973) <a name="l10973" style="background-color: #ffcccc">                        X( J ) = X( J )*A( J, J )</a>
 10974) <a name="l10974" style="background-color: #ffcccc">                  END IF</a>
 10975) <a name="l10975" style="background-color: #ffcccc">   20          CONTINUE</a>
 10976) <a name="l10976" style="background-color: #ffcccc">            ELSE</a>
 10977) <a name="l10977" style="background-color: #ffcccc">               JX = KX</a>
 10978) <a name="l10978" style="background-color: #ffcccc">               DO 40, J = 1, N</a>
 10979) <a name="l10979" style="background-color: #ffcccc">                  IF( X( JX ).NE.ZERO )THEN</a>
 10980) <a name="l10980" style="background-color: #ffcccc">                     TEMP = X( JX )</a>
 10981) <a name="l10981" style="background-color: #ffcccc">                     IX   = KX</a>
 10982) <a name="l10982" style="background-color: #ffcccc">                     DO 30, I = 1, J - 1</a>
 10983) <a name="l10983" style="background-color: #ffcccc">                        X( IX ) = X( IX ) + TEMP*A( I, J )</a>
 10984) <a name="l10984" style="background-color: #ffcccc">                        IX      = IX      + INCX</a>
 10985) <a name="l10985" style="background-color: #ffcccc">   30                CONTINUE</a>
 10986) <a name="l10986" style="background-color: #ffcccc">                     IF( NOUNIT ) &amp;</a>
 10987) <a name="l10987" style="background-color: #ffcccc">                        X( JX ) = X( JX )*A( J, J )</a>
 10988) <a name="l10988" style="background-color: #ffcccc">                  END IF</a>
 10989) <a name="l10989" style="background-color: #ffcccc">                  JX = JX + INCX</a>
 10990) <a name="l10990" style="background-color: #ffcccc">   40          CONTINUE</a>
 10991) <a name="l10991" style="background-color: #ffcccc">            END IF</a>
 10992) <a name="l10992" style="background-color: #ffcccc">         ELSE</a>
 10993) <a name="l10993" style="background-color: #ffcccc">            IF( INCX.EQ.1 )THEN</a>
 10994) <a name="l10994" style="background-color: #ffcccc">               DO 60, J = N, 1, -1</a>
 10995) <a name="l10995" style="background-color: #ffcccc">                  IF( X( J ).NE.ZERO )THEN</a>
 10996) <a name="l10996" style="background-color: #ffcccc">                     TEMP = X( J )</a>
 10997) <a name="l10997" style="background-color: #ffcccc">                     DO 50, I = N, J + 1, -1</a>
 10998) <a name="l10998" style="background-color: #ffcccc">                        X( I ) = X( I ) + TEMP*A( I, J )</a>
 10999) <a name="l10999" style="background-color: #ffcccc">   50                CONTINUE</a>
 11000) <a name="l11000" style="background-color: #ffcccc">                     IF( NOUNIT ) &amp;</a>
 11001) <a name="l11001" style="background-color: #ffcccc">                        X( J ) = X( J )*A( J, J )</a>
 11002) <a name="l11002" style="background-color: #ffcccc">                  END IF</a>
 11003) <a name="l11003" style="background-color: #ffcccc">   60          CONTINUE</a>
 11004) <a name="l11004" style="background-color: #ffcccc">            ELSE</a>
 11005) <a name="l11005" style="background-color: #ffcccc">               KX = KX + ( N - 1 )*INCX</a>
 11006) <a name="l11006" style="background-color: #ffcccc">               JX = KX</a>
 11007) <a name="l11007" style="background-color: #ffcccc">               DO 80, J = N, 1, -1</a>
 11008) <a name="l11008" style="background-color: #ffcccc">                  IF( X( JX ).NE.ZERO )THEN</a>
 11009) <a name="l11009" style="background-color: #ffcccc">                     TEMP = X( JX )</a>
 11010) <a name="l11010" style="background-color: #ffcccc">                     IX   = KX</a>
 11011) <a name="l11011" style="background-color: #ffcccc">                     DO 70, I = N, J + 1, -1</a>
 11012) <a name="l11012" style="background-color: #ffcccc">                        X( IX ) = X( IX ) + TEMP*A( I, J )</a>
 11013) <a name="l11013" style="background-color: #ffcccc">                        IX      = IX      - INCX</a>
 11014) <a name="l11014" style="background-color: #ffcccc">   70                CONTINUE</a>
 11015) <a name="l11015" style="background-color: #ffcccc">                     IF( NOUNIT ) &amp;</a>
 11016) <a name="l11016" style="background-color: #ffcccc">                        X( JX ) = X( JX )*A( J, J )</a>
 11017) <a name="l11017" style="background-color: #ffcccc">                  END IF</a>
 11018) <a name="l11018" style="background-color: #ffcccc">                  JX = JX - INCX</a>
 11019) <a name="l11019" style="background-color: #ffcccc">   80          CONTINUE</a>
 11020) <a name="l11020" style="background-color: #ffcccc">            END IF</a>
 11021) <a name="l11021" style="background-color: #ffcccc">         END IF</a>
 11022) <a name="l11022" style="background-color: #ffcccc">      ELSE</a>
 11023) <a name="l11023" style="background-color: #ffcccc">!</a>
 11024) <a name="l11024" style="background-color: #ffcccc">!        Form  x := A'*x.</a>
 11025) <a name="l11025" style="background-color: #ffcccc">!</a>
 11026) <a name="l11026" style="background-color: #ffcccc">         IF( LSAME( UPLO, 'U' ) )THEN</a>
 11027) <a name="l11027" style="background-color: #ffcccc">            IF( INCX.EQ.1 )THEN</a>
 11028) <a name="l11028" style="background-color: #ffcccc">               DO 100, J = N, 1, -1</a>
 11029) <a name="l11029" style="background-color: #ffcccc">                  TEMP = X( J )</a>
 11030) <a name="l11030" style="background-color: #ffcccc">                  IF( NOUNIT ) &amp;</a>
 11031) <a name="l11031" style="background-color: #ffcccc">                     TEMP = TEMP*A( J, J )</a>
 11032) <a name="l11032" style="background-color: #ffcccc">                  DO 90, I = J - 1, 1, -1</a>
 11033) <a name="l11033" style="background-color: #ffcccc">                     TEMP = TEMP + A( I, J )*X( I )</a>
 11034) <a name="l11034" style="background-color: #ffcccc">   90             CONTINUE</a>
 11035) <a name="l11035" style="background-color: #ffcccc">                  X( J ) = TEMP</a>
 11036) <a name="l11036" style="background-color: #ffcccc">  100          CONTINUE</a>
 11037) <a name="l11037" style="background-color: #ffcccc">            ELSE</a>
 11038) <a name="l11038" style="background-color: #ffcccc">               JX = KX + ( N - 1 )*INCX</a>
 11039) <a name="l11039" style="background-color: #ffcccc">               DO 120, J = N, 1, -1</a>
 11040) <a name="l11040" style="background-color: #ffcccc">                  TEMP = X( JX )</a>
 11041) <a name="l11041" style="background-color: #ffcccc">                  IX   = JX</a>
 11042) <a name="l11042" style="background-color: #ffcccc">                  IF( NOUNIT ) &amp;</a>
 11043) <a name="l11043" style="background-color: #ffcccc">                     TEMP = TEMP*A( J, J )</a>
 11044) <a name="l11044" style="background-color: #ffcccc">                  DO 110, I = J - 1, 1, -1</a>
 11045) <a name="l11045" style="background-color: #ffcccc">                     IX   = IX   - INCX</a>
 11046) <a name="l11046" style="background-color: #ffcccc">                     TEMP = TEMP + A( I, J )*X( IX )</a>
 11047) <a name="l11047" style="background-color: #ffcccc">  110             CONTINUE</a>
 11048) <a name="l11048" style="background-color: #ffcccc">                  X( JX ) = TEMP</a>
 11049) <a name="l11049" style="background-color: #ffcccc">                  JX      = JX   - INCX</a>
 11050) <a name="l11050" style="background-color: #ffcccc">  120          CONTINUE</a>
 11051) <a name="l11051" style="background-color: #ffcccc">            END IF</a>
 11052) <a name="l11052" style="background-color: #ffcccc">         ELSE</a>
 11053) <a name="l11053" style="background-color: #ffcccc">            IF( INCX.EQ.1 )THEN</a>
 11054) <a name="l11054" style="background-color: #ffcccc">               DO 140, J = 1, N</a>
 11055) <a name="l11055" style="background-color: #ffcccc">                  TEMP = X( J )</a>
 11056) <a name="l11056" style="background-color: #ffcccc">                  IF( NOUNIT ) &amp;</a>
 11057) <a name="l11057" style="background-color: #ffcccc">                     TEMP = TEMP*A( J, J )</a>
 11058) <a name="l11058" style="background-color: #ffcccc">                  DO 130, I = J + 1, N</a>
 11059) <a name="l11059" style="background-color: #ffcccc">                     TEMP = TEMP + A( I, J )*X( I )</a>
 11060) <a name="l11060" style="background-color: #ffcccc">  130             CONTINUE</a>
 11061) <a name="l11061" style="background-color: #ffcccc">                  X( J ) = TEMP</a>
 11062) <a name="l11062" style="background-color: #ffcccc">  140          CONTINUE</a>
 11063) <a name="l11063" style="background-color: #ffcccc">            ELSE</a>
 11064) <a name="l11064" style="background-color: #ffcccc">               JX = KX</a>
 11065) <a name="l11065" style="background-color: #ffcccc">               DO 160, J = 1, N</a>
 11066) <a name="l11066" style="background-color: #ffcccc">                  TEMP = X( JX )</a>
 11067) <a name="l11067" style="background-color: #ffcccc">                  IX   = JX</a>
 11068) <a name="l11068" style="background-color: #ffcccc">                  IF( NOUNIT ) &amp;</a>
 11069) <a name="l11069" style="background-color: #ffcccc">                     TEMP = TEMP*A( J, J )</a>
 11070) <a name="l11070" style="background-color: #ffcccc">                  DO 150, I = J + 1, N</a>
 11071) <a name="l11071" style="background-color: #ffcccc">                     IX   = IX   + INCX</a>
 11072) <a name="l11072" style="background-color: #ffcccc">                     TEMP = TEMP + A( I, J )*X( IX )</a>
 11073) <a name="l11073" style="background-color: #ffcccc">  150             CONTINUE</a>
 11074) <a name="l11074" style="background-color: #ffcccc">                  X( JX ) = TEMP</a>
 11075) <a name="l11075" style="background-color: #ffcccc">                  JX      = JX   + INCX</a>
 11076) <a name="l11076" style="background-color: #ffcccc">  160          CONTINUE</a>
 11077) <a name="l11077" style="background-color: #ffcccc">            END IF</a>
 11078) <a name="l11078" style="background-color: #ffcccc">         END IF</a>
 11079) <a name="l11079" style="background-color: #ffcccc">      END IF</a>
 11080) <a name="l11080" style="background-color: #ffcccc">!</a>
 11081) <a name="l11081" style="background-color: #ffcccc">      RETURN</a>
 11082) <a name="l11082" style="background-color: #ffcccc">!</a>
 11083) <a name="l11083" style="background-color: #ffcccc">!     End of STRMV .</a>
 11084) <a name="l11084" style="background-color: #ffcccc">!</a>
 11085) <a name="l11085" style="background-color: #ffcccc">      END SUBROUTINE STRMV</a>
 11086) <a name="l11086" style="background-color: #ffcccc"></a><a style="background-color: #ffffff"> </a>
 11087) <a name="l11087" style="background-color: #ffffff">!--------1---------2---------3---------4---------5---------6---------7---------8</a>
 11088) <a name="l11088" style="background-color: #ffffff"></a>
 11089) <a name="l11089" style="background-color: #ffffff">end module sgexx</a>
</pre>
<hr size=1 noshade>
<table border=0 cellpadding=3 cellspacing=0 width="100%" style="color:black;font-weight:normal;font-family:Verdana,Arial;font-size:xx-small">
<td width="50%">
<table border=0 cellpadding=3 cellspacing=0>
<tr>
<td>
<a target="_new" href="http://www.intel.com"><img src="__IntelR.gif" border="0"></a>
</td>
<td style="font-size:xx-small">
<i>generated by </i><BR><a target="_new" href="http://www.intel.com/software/products/compilers">Intel(R) C++/Fortran Compiler code-coverage tool</a>
</td>
</tr>
</table>
</td>
<td>
<table border=0 cellpadding=3 cellspacing=0 width="50%">
<tr><a>Web-Page Owner: <a href="mailto:nobody">Nobody</a></tr>
</table>
</td>
</table>
</body>
</html>
